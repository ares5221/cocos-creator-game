var cc = cc || {};
cc._tmp = cc._tmp || {};
cc._LogInfos = {};
var _p = window,
_p = Object.prototype,
_p = null;
cc._drawingUtil = null;
cc._renderContext = null;
cc._supportRender = !1;
cc._canvas = null;
cc.container = null;
cc._gameDiv = null;
window.ENABLE_IMAEG_POOL = !0;
cc.each = function(a, b, c) {
    if (a) if (a instanceof Array) for (var d = 0,
    e = a.length; d < e && !1 !== b.call(c, a[d], d); d++);
    else for (d in a) if (!1 === b.call(c, a[d], d)) break
};
cc.extend = function(a) {
    var b = 2 <= arguments.length ? Array.prototype.slice.call(arguments, 1) : [];
    cc.each(b,
    function(b) {
        for (var d in b) b.hasOwnProperty(d) && (a[d] = b[d])
    });
    return a
};
cc.inherits = function(a, b) {
    function c() {}
    c.prototype = b.prototype;
    a.superClass_ = b.prototype;
    a.prototype = new c;
    a.prototype.constructor = a
};
cc.isFunction = function(a) {
    return "function" === typeof a
};
cc.isNumber = function(a) {
    return "number" === typeof a || "[object Number]" === Object.prototype.toString.call(a)
};
cc.isString = function(a) {
    return "string" === typeof a || "[object String]" === Object.prototype.toString.call(a)
};
cc.isArray = function(a) {
    return Array.isArray(a) || "object" === typeof a && "[object Array]" === Object.prototype.toString.call(a)
};
cc.isUndefined = function(a) {
    return "undefined" === typeof a
};
cc.isObject = function(a) {
    return "object" === typeof a && "[object Object]" === Object.prototype.toString.call(a)
};
cc.isCrossOrigin = function(a) {
    if (!a) return cc.log("invalid URL"),
    !1;
    var b = a.indexOf("://");
    if ( - 1 === b) return ! 1;
    b = a.indexOf("/", b + 3);
    return ( - 1 === b ? a: a.substring(0, b)) !== location.origin
};
cc.AsyncPool = function(a, b, c, d, e) {
    var f = this;
    f._finished = !1;
    f._srcObj = a;
    f._limit = b;
    f._pool = [];
    f._iterator = c;
    f._iteratorTarget = e;
    f._onEnd = d;
    f._onEndTarget = e;
    f._results = a instanceof Array ? [] : {};
    f._errors = a instanceof Array ? [] : {};
    cc.each(a,
    function(a, b) {
        f._pool.push({
            index: b,
            value: a
        })
    });
    f.size = f._pool.length;
    f.finishedSize = 0;
    f._workingSize = 0;
    f._limit = f._limit || f.size;
    f.onIterator = function(a, b) {
        f._iterator = a;
        f._iteratorTarget = b
    };
    f.onEnd = function(a, b) {
        f._onEnd = a;
        f._onEndTarget = b
    };
    f._handleItem = function() {
        var a = this;
        if (! (0 === a._pool.length || a._workingSize >= a._limit)) {
            var b = a._pool.shift(),
            c = b.value,
            d = b.index;
            a._workingSize++;
            a._iterator.call(a._iteratorTarget, c, d,
            function(b, c) {
                if (!a._finished) if (b ? a._errors[this.index] = b: a._results[this.index] = c, a.finishedSize++, a._workingSize--, a.finishedSize === a.size) a.onEnd(0 === a._errors.length ? null: a._errors, a._results);
                else a._handleItem()
            }.bind(b), a)
        }
    };
    f.flow = function() {
        if (0 === this._pool.length) this._onEnd && this._onEnd.call(this._onEndTarget, null, []);
        else for (var a = 0; a < this._limit; a++) this._handleItem()
    };
    f.onEnd = function(a, b) {
        f._finished = !0;
        if (f._onEnd) {
            var c = f._onEnd,
            d = f._onEndTarget;
            f._onEnd = null;
            f._onEndTarget = null;
            c.call(d, a, b)
        }
    }
};
cc.async = {
    series: function(a, b, c) {
        a = new cc.AsyncPool(a, 1,
        function(a, b, f) {
            a.call(c, f)
        },
        b, c);
        a.flow();
        return a
    },
    parallel: function(a, b, c) {
        a = new cc.AsyncPool(a, 0,
        function(a, b, f) {
            a.call(c, f)
        },
        b, c);
        a.flow();
        return a
    },
    waterfall: function(a, b, c) {
        var d = [],
        e = [null],
        f = new cc.AsyncPool(a, 1,
        function(b, f, k) {
            d.push(function(b) {
                d = Array.prototype.slice.call(arguments, 1);
                a.length - 1 === f && (e = e.concat(d));
                k.apply(null, arguments)
            });
            b.apply(c, d)
        },
        function(a) {
            if (b) {
                if (a) return b.call(c, a);
                b.apply(c, e)
            }
        });
        f.flow();
        return f
    },
    map: function(a, b, c, d) {
        var e = b;
        "object" === typeof b && (c = b.cb, d = b.iteratorTarget, e = b.iterator);
        a = new cc.AsyncPool(a, 0, e, c, d);
        a.flow();
        return a
    },
    mapLimit: function(a, b, c, d, e) {
        a = new cc.AsyncPool(a, b, c, d, e);
        a.flow();
        return a
    }
};
cc.path = {
    normalizeRE: /[^\.\/]+\/\.\.\//,
    join: function() {
        for (var a = arguments.length,
        b = "",
        c = 0; c < a; c++) b = (b + ("" === b ? "": "/") + arguments[c]).replace(/(\/|\\\\)$/, "");
        return b
    },
    extname: function(a) {
        return (a = /(\.[^\.\/\?\\]*)(\?.*)?$/.exec(a)) ? a[1] : null
    },
    mainFileName: function(a) {
        if (a) {
            var b = a.lastIndexOf(".");
            if ( - 1 !== b) return a.substring(0, b)
        }
        return a
    },
    basename: function(a, b) {
        var c = a.indexOf("?");
        0 < c && (a = a.substring(0, c));
        c = /(\/|\\\\)([^(\/|\\\\)]+)$/g.exec(a.replace(/(\/|\\\\)$/, ""));
        if (!c) return null;
        c = c[2];
        return b && a.substring(a.length - b.length).toLowerCase() === b.toLowerCase() ? c.substring(0, c.length - b.length) : c
    },
    dirname: function(a) {
        return a.replace(/((.*)(\/|\\|\\\\))?(.*?\..*$)?/, "$2")
    },
    changeExtname: function(a, b) {
        b = b || "";
        var c = a.indexOf("?"),
        d = "";
        0 < c && (d = a.substring(c), a = a.substring(0, c));
        c = a.lastIndexOf(".");
        return 0 > c ? a + b + d: a.substring(0, c) + b + d
    },
    changeBasename: function(a, b, c) {
        if (0 === b.indexOf(".")) return this.changeExtname(a, b);
        var d = a.indexOf("?"),
        e = "";
        c = c ? this.extname(a) : "";
        0 < d && (e = a.substring(d), a = a.substring(0, d));
        d = a.lastIndexOf("/");
        return a.substring(0, 0 >= d ? 0 : d + 1) + b + c + e
    },
    _normalize: function(a) {
        var b = a = String(a);
        do b = a,
        a = a.replace(this.normalizeRE, "");
        while (b.length !== a.length);
        return a
    }
};
var imagePool = {
    _pool: Array(10),
    _MAX: 10,
    _smallImg: "data:image/gif;base64,R0lGODlhAQABAAAAACwAAAAAAQABAAA\x3d",
    count: 0,
    get: function() {
        if (0 < this.count) {
            this.count--;
            var a = this._pool[this.count];
            this._pool[this.count] = null;
            return a
        }
        return new Image
    },
    put: function(a) {
        var b = this._pool;
        a instanceof HTMLImageElement && this.count < this._MAX && (a.src = this._smallImg, b[this.count] = a, this.count++)
    }
};
cc.loader = function() {
    var a = {},
    b = {},
    c = {},
    d = {},
    e = {},
    f = /^(?:https?|ftp):\/\/\S*$/i;
    return {
        resPath: "",
        audioPath: "",
        cache: {},
        getXMLHttpRequest: function() {
            var a = window.XMLHttpRequest ? new window.XMLHttpRequest: new ActiveXObject("MSXML2.XMLHTTP");
            a.timeout = 1E4;
            void 0 === a.ontimeout && (a._timeoutId = -1);
            return a
        },
        _getArgs4Js: function(a) {
            var b = a[0],
            c = a[1],
            d = a[2],
            e = ["", null, null];
            if (1 === a.length) e[1] = b instanceof Array ? b: [b];
            else if (2 === a.length)"function" === typeof c ? (e[1] = b instanceof Array ? b: [b], e[2] = c) : (e[0] = b || "", e[1] = c instanceof Array ? c: [c]);
            else if (3 === a.length) e[0] = b || "",
            e[1] = c instanceof Array ? c: [c],
            e[2] = d;
            else throw Error("arguments error to load js!");
            return e
        },
        isLoading: function(a) {
            return void 0 !== e[a]
        },
        loadJs: function(b, c, d) {
            var e = this,
            f = e._getArgs4Js(arguments),
            s = f[0],
            t = f[1],
            f = f[2]; - 1 < navigator.userAgent.indexOf("Trident/5") ? e._loadJs4Dependency(s, t, 0, f) : cc.async.map(t,
            function(b, c, d) {
                b = cc.path.join(s, b);
                if (a[b]) return d(null);
                e._createScript(b, !1, d)
            },
            f)
        },
        loadJsWithImg: function(a, b, c) {
            var d = this._loadJsImg(),
            e = this._getArgs4Js(arguments);
            this.loadJs(e[0], e[1],
            function(a) {
                if (a) throw Error(a);
                d.parentNode.removeChild(d);
                if (e[2]) e[2]()
            })
        },
        _createScript: function(b, c, d) {
            var e = document,
            f = document.createElement("script");
            f.async = c;
            a[b] = !0;
            cc.game.config.noCache && "string" === typeof b ? this._noCacheRex.test(b) ? f.src = b + "\x26_t\x3d" + (new Date - 0) : f.src = b + "?_t\x3d" + (new Date - 0) : f.src = b;
            f.addEventListener("load",
            function() {
                f.parentNode.removeChild(f);
                this.removeEventListener("load", arguments.callee, !1);
                d()
            },
            !1);
            f.addEventListener("error",
            function() {
                f.parentNode.removeChild(f);
                d("Load " + b + " failed!")
            },
            !1);
            e.body.appendChild(f)
        },
        _loadJs4Dependency: function(a, b, c, d) {
            if (c >= b.length) d && d();
            else {
                var e = this;
                e._createScript(cc.path.join(a, b[c]), !1,
                function(f) {
                    if (f) return d(f);
                    e._loadJs4Dependency(a, b, c + 1, d)
                })
            }
        },
        _loadJsImg: function() {
            var a = document,
            b = a.getElementById("cocos2d_loadJsImg");
            if (!b) {
                b = document.createElement("img");
                cc._loadingImage && (b.src = cc._loadingImage);
                a = a.getElementById(cc.game.config.id);
                a.style.backgroundColor = "transparent";
                a.parentNode.appendChild(b);
                var c = getComputedStyle ? getComputedStyle(a) : a.currentStyle;
                c || (c = {
                    width: a.width,
                    height: a.height
                });
                b.style.left = a.offsetLeft + (parseFloat(c.width) - b.width) / 2 + "px";
                b.style.top = a.offsetTop + (parseFloat(c.height) - b.height) / 2 + "px";
                b.style.position = "absolute"
            }
            return b
        },
        loadTxt: function(a, b) {
            if (cc._isNodeJs) require("fs").readFile(a,
            function(a, c) {
                a ? b(a) : b(null, c.toString())
            });
            else {
                var c = this.getXMLHttpRequest(),
                d = "load " + a + " failed!";
                c.open("GET", a, !0);
                if (/msie/i.test(navigator.userAgent) && !/opera/i.test(navigator.userAgent)) c.setRequestHeader("Accept-Charset", "utf-8"),
                c.onreadystatechange = function() {
                    4 === c.readyState && (200 === c.status || 0 === c.status ? b(null, c.responseText) : b({
                        status: c.status,
                        errorMessage: d
                    },
                    null))
                };
                else {
                    c.overrideMimeType && c.overrideMimeType("text/plain; charset\x3dutf-8");
                    var e = function() {
                        c.removeEventListener("load", e);
                        c.removeEventListener("error", f);
                        0 <= c._timeoutId ? clearTimeout(c._timeoutId) : c.removeEventListener("timeout", t);
                        4 === c.readyState && (200 === c.status || 0 === c.status ? b(null, c.responseText) : b({
                            status: c.status,
                            errorMessage: d
                        },
                        null))
                    },
                    f = function() {
                        c.removeEventListener("load", e);
                        c.removeEventListener("error", f);
                        0 <= c._timeoutId ? clearTimeout(c._timeoutId) : c.removeEventListener("timeout", t);
                        b({
                            status: c.status,
                            errorMessage: d
                        },
                        null)
                    },
                    t = function() {
                        c.removeEventListener("load", e);
                        c.removeEventListener("error", f);
                        0 <= c._timeoutId ? clearTimeout(c._timeoutId) : c.removeEventListener("timeout", t);
                        b({
                            status: c.status,
                            errorMessage: "Request timeout: " + d
                        },
                        null)
                    };
                    c.addEventListener("load", e);
                    c.addEventListener("error", f);
                    void 0 === c.ontimeout ? c._timeoutId = setTimeout(function() {
                        t()
                    },
                    c.timeout) : c.addEventListener("timeout", t)
                }
                c.send(null)
            }
        },
        loadCsb: function(a, b) {
            var c = cc.loader.getXMLHttpRequest(),
            d = "load " + a + " failed!";
            c.open("GET", a, !0);
            c.responseType = "arraybuffer";
            var e = function() {
                c.removeEventListener("load", e);
                c.removeEventListener("error", f);
                0 <= c._timeoutId ? clearTimeout(c._timeoutId) : c.removeEventListener("timeout", t);
                var a = c.response;
                a && (window.msg = a);
                4 === c.readyState && (200 === c.status || 0 === c.status ? b(null, c.response) : b({
                    status: c.status,
                    errorMessage: d
                },
                null))
            },
            f = function() {
                c.removeEventListener("load", e);
                c.removeEventListener("error", f);
                0 <= c._timeoutId ? clearTimeout(c._timeoutId) : c.removeEventListener("timeout", t);
                b({
                    status: c.status,
                    errorMessage: d
                },
                null)
            },
            t = function() {
                c.removeEventListener("load", e);
                c.removeEventListener("error", f);
                0 <= c._timeoutId ? clearTimeout(c._timeoutId) : c.removeEventListener("timeout", t);
                b({
                    status: c.status,
                    errorMessage: "Request timeout: " + d
                },
                null)
            };
            c.addEventListener("load", e);
            c.addEventListener("error", f);
            void 0 === c.ontimeout ? c._timeoutId = setTimeout(function() {
                t()
            },
            c.timeout) : c.addEventListener("timeout", t);
            c.send(null)
        },
        loadJson: function(a, b) {
            this.loadTxt(a,
            function(a, c) {
                if (a) b(a);
                else {
                    try {
                        var d = JSON.parse(c)
                    } catch(e) {
                        b(null, null);
                        return
                    }
                    b(null, d)
                }
            })
        },
        _checkIsImageURL: function(a) {
            return null != /(\.png)|(\.jpg)|(\.bmp)|(\.jpeg)|(\.gif)/.exec(a)
        },
        loadImg: function(a, b, c, d) {
            var f = {
                isCrossOrigin: !0
            };
            void 0 !== c ? f.isCrossOrigin = void 0 === b.isCrossOrigin ? f.isCrossOrigin: b.isCrossOrigin: void 0 !== b && (c = b);
            if (b = this.getRes(a)) return c && c(null, b),
            null;
            if (b = e[a]) return b.callbacks.push(c),
            b.img;
            d = d || imagePool.get();
            d.crossOrigin = f.isCrossOrigin && "file://" !== location.origin ? "Anonymous": null;
            var s = function() {
                this.removeEventListener("load", s, !1);
                this.removeEventListener("error", p, !1);
                var b = e[a];
                if (b) {
                    for (var c = b.callbacks,
                    f = 0; f < c.length; ++f) {
                        var h = c[f];
                        h && h(null, d)
                    }
                    b.img = null;
                    delete e[a]
                }
                window.ENABLE_IMAEG_POOL && cc._renderType === cc.game.RENDER_TYPE_WEBGL && imagePool.put(d)
            },
            t = this,
            p = function() {
                this.removeEventListener("load", s, !1);
                this.removeEventListener("error", p, !1);
                if ("https:" !== window.location.protocol && d.crossOrigin && "anonymous" === d.crossOrigin.toLowerCase()) f.isCrossOrigin = !1,
                t.release(a),
                cc.loader.loadImg(a, f, c, d);
                else {
                    var b = e[a];
                    if (b) {
                        for (var h = b.callbacks,
                        x = 0; x < h.length; ++x) {
                            var y = h[x];
                            y && y("load image failed")
                        }
                        b.img = null;
                        delete e[a]
                    }
                    cc._renderType === cc.game.RENDER_TYPE_WEBGL && imagePool.put(d)
                }
            };
            e[a] = {
                img: d,
                callbacks: c ? [c] : []
            };
            d.addEventListener("load", s);
            d.addEventListener("error", p);
            d.src = a;
            return d
        },
        _loadResIterator: function(a, c, d) {
            var e = this,
            r = null,
            s = a.type;
            s ? (s = "." + s.toLowerCase(), r = a.src ? a.src: a.name + s) : (r = a, s = cc.path.extname(r));
            if (c = e.getRes(r)) return d(null, c);
            c = null;
            s && (c = b[s.toLowerCase()]);
            if (!c) return cc.error("loader for [" + s + "] not exists!"),
            d();
            s = r;
            f.test(r) || (s = c.getBasePath ? c.getBasePath() : e.resPath, s = e.getUrl(s, r));
            cc.game.config.noCache && "string" === typeof s && (s = e._noCacheRex.test(s) ? s + ("\x26_t\x3d" + (new Date - 0)) : s + ("?_t\x3d" + (new Date - 0)));
            c.load(s, r, a,
            function(a, b) {
                a ? (cc.log(a), e.cache[r] = null, delete e.cache[r], d({
                    status: 520,
                    errorMessage: a
                },
                null)) : (e.cache[r] = b, d(null, b))
            })
        },
        _noCacheRex: /\?/,
        getUrl: function(a, d) {
            var e = cc.path;
            if (void 0 !== a && void 0 === d) {
                d = a;
                var f = e.extname(d),
                f = f ? f.toLowerCase() : "";
                a = (f = b[f]) ? f.getBasePath ? f.getBasePath() : this.resPath: this.resPath
            }
            d = cc.path.join(a || "", d);
            if (d.match(/[\/(\\\\)]lang[\/(\\\\)]/i)) {
                if (c[d]) return c[d];
                e = e.extname(d) || "";
                d = c[d] = d.substring(0, d.length - e.length) + "_" + cc.sys.language + e
            }
            return d
        },
        load: function(a, b, c) {
            var d = this,
            e = arguments.length;
            if (0 === e) throw Error("arguments error!");
            3 === e ? "function" === typeof b && (b = "function" === typeof c ? {
                trigger: b,
                cb: c
            }: {
                cb: b,
                cbTarget: c
            }) : 2 === e ? "function" === typeof b && (b = {
                cb: b
            }) : 1 === e && (b = {});
            a instanceof Array || (a = [a]);
            e = new cc.AsyncPool(a, cc.CONCURRENCY_HTTP_REQUEST_COUNT,
            function(a, c, e, f) {
                d._loadResIterator(a, c,
                function(a) {
                    var c = Array.prototype.slice.call(arguments, 1);
                    b.trigger && b.trigger.call(b.triggerTarget, c[0], f.size, f.finishedSize);
                    e(a, c[0])
                })
            },
            b.cb, b.cbTarget);
            e.flow();
            return e
        },
        _handleAliases: function(a, b) {
            var c = [],
            e;
            for (e in a) {
                var f = a[e];
                d[e] = f;
                c.push(f)
            }
            this.load(c, b)
        },
        loadAliases: function(a, b) {
            var c = this,
            d = c.getRes(a);
            d ? c._handleAliases(d.filenames, b) : c.load(a,
            function(a, d) {
                c._handleAliases(d[0].filenames, b)
            })
        },
        register: function(a, c) {
            if (a && c) {
                if ("string" === typeof a) return b[a.trim().toLowerCase()] = c;
                for (var d = 0,
                e = a.length; d < e; d++) b["." + a[d].trim().toLowerCase()] = c
            }
        },
        getRes: function(a) {
            return this.cache[a] || this.cache[d[a]]
        },
        _getAliase: function(a) {
            return d[a]
        },
        release: function(a) {
            var b = this.cache,
            c = e[a];
            c && (c.img = null, delete e[a]);
            delete b[a];
            delete b[d[a]];
            delete d[a]
        },
        releaseAll: function() {
            var a = this.cache,
            b;
            for (b in a) delete a[b];
            for (b in d) delete d[b]
        }
    }
} ();
cc.formatStr = function() {
    var a = arguments,
    b = a.length;
    if (1 > b) return "";
    var c = a[0],
    d = !0;
    "object" === typeof c && (d = !1);
    for (var e = 1; e < b; ++e) {
        var f = a[e];
        if (d) for (;;) {
            var g = null;
            if ("number" === typeof f && (g = c.match(/(%d)|(%s)/))) {
                c = c.replace(/(%d)|(%s)/, f);
                break
            }
            c = (g = c.match(/%s/)) ? c.replace(/%s/, f) : c + ("    " + f);
            break
        } else c += "    " + f
    }
    return c
}; (function() {
    function a(a) {
        var b = cc.game.CONFIG_KEY,
        c = parseInt(a[b.renderMode]) || 0;
        if (isNaN(c) || 2 < c || 0 > c) a[b.renderMode] = 0;
        cc._renderType = cc.game.RENDER_TYPE_CANVAS;
        cc._supportRender = !1;
        0 === c ? cc.sys.capabilities.opengl ? (cc._renderType = cc.game.RENDER_TYPE_WEBGL, cc._supportRender = !0) : cc.sys.capabilities.canvas && (cc._renderType = cc.game.RENDER_TYPE_CANVAS, cc._supportRender = !0) : 1 === c && cc.sys.capabilities.canvas ? (cc._renderType = cc.game.RENDER_TYPE_CANVAS, cc._supportRender = !0) : 2 === c && cc.sys.capabilities.opengl && (cc._renderType = cc.game.RENDER_TYPE_WEBGL, cc._supportRender = !0)
    }
    function b(a, c, d) {
        if (h[c]) return null;
        d = d || "";
        var e = [],
        f = a[c];
        if (!f) throw Error("can not find module [" + c + "]");
        c = cc.path;
        for (var g = 0,
        k = f.length; g < k; g++) {
            var m = f[g];
            if (!h[m]) {
                var w = c.extname(m);
                w ? ".js" === w.toLowerCase() && e.push(c.join(d, m)) : (w = b(a, m, d)) && (e = e.concat(w));
                h[m] = 1
            }
        }
        return e
    }
    function c(a) {
        cc._initDebugSetting && cc._initDebugSetting(a[cc.game.CONFIG_KEY.debugMode]);
        cc._engineLoaded = !0;
        console.log(cc.ENGINE_VERSION);
        m && m()
    }
    function d(a) {
        var d = a[cc.game.CONFIG_KEY.engineDir],
        e = cc.loader;
        if (cc.Class) c(a);
        else {
            var f = cc.path.join(d, "moduleConfig.json");
            e.loadJson(f,
            function(e, f) {
                if (e) throw Error(e);
                var g = a.modules || [],
                h = f.module,
                k = [];
                cc.sys.capabilities.opengl && 0 > g.indexOf("base4webgl") ? g.splice(0, 0, "base4webgl") : 0 > g.indexOf("core") && g.splice(0, 0, "core");
                for (var p = 0,
                m = g.length; p < m; p++) {
                    var t = b(h, g[p], d);
                    t && (k = k.concat(t))
                }
                cc.loader.loadJsWithImg(k,
                function(b) {
                    if (b) throw b;
                    c(a)
                })
            })
        }
    }
    function e() {
        this.removeEventListener("load", e, !1);
        d(cc.game.config)
    }
    var f = document.createElement("canvas"),
    g = document.createElement("canvas");
    cc.create3DContext = function(a, b) {
        for (var c = ["webgl", "experimental-webgl", "webkit-3d", "moz-webgl"], d = null, e = 0; e < c.length; ++e) {
            try {
                d = a.getContext(c[e], b)
            } catch(f) {}
            if (d) break
        }
        return d
    }; (function() {
        cc.sys = {};
        var a = cc.sys;
        a.LANGUAGE_ENGLISH = "en";
        a.LANGUAGE_CHINESE = "zh";
        a.LANGUAGE_FRENCH = "fr";
        a.LANGUAGE_ITALIAN = "it";
        a.LANGUAGE_GERMAN = "de";
        a.LANGUAGE_SPANISH = "es";
        a.LANGUAGE_DUTCH = "du";
        a.LANGUAGE_RUSSIAN = "ru";
        a.LANGUAGE_KOREAN = "ko";
        a.LANGUAGE_JAPANESE = "ja";
        a.LANGUAGE_HUNGARIAN = "hu";
        a.LANGUAGE_PORTUGUESE = "pt";
        a.LANGUAGE_ARABIC = "ar";
        a.LANGUAGE_NORWEGIAN = "no";
        a.LANGUAGE_POLISH = "pl";
        a.LANGUAGE_UNKNOWN = "unkonwn";
        a.OS_IOS = "iOS";
        a.OS_ANDROID = "Android";
        a.OS_WINDOWS = "Windows";
        a.OS_MARMALADE = "Marmalade";
        a.OS_LINUX = "Linux";
        a.OS_BADA = "Bada";
        a.OS_BLACKBERRY = "Blackberry";
        a.OS_OSX = "OS X";
        a.OS_WP8 = "WP8";
        a.OS_WINRT = "WINRT";
        a.OS_UNKNOWN = "Unknown";
        a.UNKNOWN = -1;
        a.WIN32 = 0;
        a.LINUX = 1;
        a.MACOS = 2;
        a.ANDROID = 3;
        a.IPHONE = 4;
        a.IPAD = 5;
        a.BLACKBERRY = 6;
        a.NACL = 7;
        a.EMSCRIPTEN = 8;
        a.TIZEN = 9;
        a.WINRT = 10;
        a.WP8 = 11;
        a.MOBILE_BROWSER = 100;
        a.DESKTOP_BROWSER = 101;
        a.BROWSER_TYPE_WECHAT = "wechat";
        a.BROWSER_TYPE_ANDROID = "androidbrowser";
        a.BROWSER_TYPE_IE = "ie";
        a.BROWSER_TYPE_QQ_APP = "qq";
        a.BROWSER_TYPE_QQ = "qqbrowser";
        a.BROWSER_TYPE_MOBILE_QQ = "mqqbrowser";
        a.BROWSER_TYPE_UC = "ucbrowser";
        a.BROWSER_TYPE_360 = "360browser";
        a.BROWSER_TYPE_BAIDU_APP = "baiduboxapp";
        a.BROWSER_TYPE_BAIDU = "baidubrowser";
        a.BROWSER_TYPE_MAXTHON = "maxthon";
        a.BROWSER_TYPE_OPERA = "opera";
        a.BROWSER_TYPE_OUPENG = "oupeng";
        a.BROWSER_TYPE_MIUI = "miuibrowser";
        a.BROWSER_TYPE_FIREFOX = "firefox";
        a.BROWSER_TYPE_SAFARI = "safari";
        a.BROWSER_TYPE_CHROME = "chrome";
        a.BROWSER_TYPE_LIEBAO = "liebao";
        a.BROWSER_TYPE_QZONE = "qzone";
        a.BROWSER_TYPE_SOUGOU = "sogou";
        a.BROWSER_TYPE_UNKNOWN = "unknown";
        a.isNative = !1;
        var b = window,
        c = b.navigator,
        d = document,
        e = d.documentElement,
        h = c.userAgent.toLowerCase();
        a.isMobile = /mobile|android|iphone|ipad/.test(h);
        a.platform = a.isMobile ? a.MOBILE_BROWSER: a.DESKTOP_BROWSER;
        var k = c.language,
        k = (k = k ? k: c.browserLanguage) ? k.split("-")[0] : a.LANGUAGE_ENGLISH;
        a.language = k;
        var m = !1,
        k = !1,
        w = "",
        B = 0,
        z = /android (\d+(?:\.\d+)+)/i.exec(h) || /android (\d+(?:\.\d+)+)/i.exec(c.platform);
        z && (m = !0, w = z[1] || "", B = parseInt(w) || 0); (z = /(iPad|iPhone|iPod).*OS ((\d+_?){2,3})/i.exec(h)) ? (k = !0, w = z[2] || "", B = parseInt(w) || 0) : /(iPhone|iPad|iPod)/.exec(c.platform) && (k = !0, w = "", B = 0);
        z = a.OS_UNKNOWN; - 1 !== c.appVersion.indexOf("Win") ? z = a.OS_WINDOWS: k ? z = a.OS_IOS: -1 !== c.appVersion.indexOf("Mac") ? z = a.OS_OSX: -1 !== c.appVersion.indexOf("X11") && -1 === c.appVersion.indexOf("Linux") ? z = a.OS_UNIX: m ? z = a.OS_ANDROID: -1 !== c.appVersion.indexOf("Linux") && (z = a.OS_LINUX);
        a.os = z;
        a.osVersion = w;
        a.osMainVersion = B;
        a.browserType = a.BROWSER_TYPE_UNKNOWN; (function() {
            var b = /qqbrowser|qq|chrome|safari|firefox|opr|oupeng|opera/i,
            c = /micromessenger|mqqbrowser|sogou|qzone|liebao|ucbrowser|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|mxbrowser|trident|miuibrowser/i.exec(h);
            c || (c = b.exec(h));
            b = c ? c[0] : a.BROWSER_TYPE_UNKNOWN;
            "micromessenger" === b ? b = a.BROWSER_TYPE_WECHAT: "safari" === b && m ? b = a.BROWSER_TYPE_ANDROID: "trident" === b ? b = a.BROWSER_TYPE_IE: "360 aphone" === b ? b = a.BROWSER_TYPE_360: "mxbrowser" === b ? b = a.BROWSER_TYPE_MAXTHON: "opr" === b && (b = a.BROWSER_TYPE_OPERA);
            a.browserType = b
        })();
        a.browserVersion = ""; (function() {
            var b = /(msie |rv:|firefox|chrome|ucbrowser|qq|oupeng|opera|opr|safari|miui)(mobile)?(browser)?\/?([\d.]+)/i,
            c = h.match(/(mqqbrowser|micromessenger|sogou|qzone|liebao|maxthon|mxbrowser|baidu)(mobile)?(browser)?\/?([\d.]+)/i);
            c || (c = h.match(b));
            a.browserVersion = c ? c[4] : ""
        })();
        k = window.devicePixelRatio || 1;
        a.windowPixelResolution = {
            width: k * (window.innerWidth || document.documentElement.clientWidth),
            height: k * (window.innerHeight || document.documentElement.clientHeight)
        };
        a._checkWebGLRenderMode = function() {
            if (cc._renderType !== cc.game.RENDER_TYPE_WEBGL) throw Error("This feature supports WebGL render mode only.");
        };
        a._supportCanvasNewBlendModes = function() {
            var a = f;
            a.width = 1;
            a.height = 1;
            a = a.getContext("2d");
            a.fillStyle = "#000";
            a.fillRect(0, 0, 1, 1);
            a.globalCompositeOperation = "multiply";
            var b = g;
            b.width = 1;
            b.height = 1;
            var c = b.getContext("2d");
            c.fillStyle = "#fff";
            c.fillRect(0, 0, 1, 1);
            a.drawImage(b, 0, 0, 1, 1);
            return 0 === a.getImageData(0, 0, 1, 1).data[0]
        } ();
        cc.sys.isMobile && (k = document.createElement("style"), k.type = "text/css", document.body.appendChild(k), k.textContent = "body,canvas,div{ -moz-user-select: none;-webkit-user-select: none;-ms-user-select: none;-khtml-user-select: none;-webkit-tap-highlight-color:rgba(0,0,0,0);}");
        try {
            var A = a.localStorage = b.localStorage;
            A.setItem("storage", "");
            A.removeItem("storage");
            A = null
        } catch(D) {
            A = function() {
                cc.warn("Warning: localStorage isn't enabled. Please confirm browser cookie or privacy option")
            },
            a.localStorage = {
                getItem: A,
                setItem: A,
                removeItem: A,
                clear: A
            }
        }
        A = !!f.getContext("2d");
        k = !1;
        if (b.WebGLRenderingContext) {
            w = document.createElement("CANVAS");
            try {
                if (cc.create3DContext(w) && (k = !0), k && a.os === a.OS_IOS && 9 === a.osMainVersion && (window.indexedDB || (k = !1)), k && a.os === a.OS_ANDROID) {
                    var C = parseFloat(a.browserVersion);
                    switch (a.browserType) {
                    case a.BROWSER_TYPE_MOBILE_QQ:
                    case a.BROWSER_TYPE_BAIDU:
                    case a.BROWSER_TYPE_BAIDU_APP:
                        k = 6.2 <= C ? !0 : !1;
                        break;
                    case a.BROWSER_TYPE_CHROME:
                        k = 30 <= C ? !0 : !1;
                        break;
                    case a.BROWSER_TYPE_ANDROID:
                        a.osMainVersion && 5 <= a.osMainVersion && (k = !0);
                        break;
                    case a.BROWSER_TYPE_UNKNOWN:
                    case a.BROWSER_TYPE_360:
                    case a.BROWSER_TYPE_MIUI:
                    case a.BROWSER_TYPE_UC:
                        k = !1
                    }
                }
            } catch(H) {}
            w = null
        }
        C = a.capabilities = {
            canvas: A,
            opengl: k
        };
        if (void 0 !== e.ontouchstart || void 0 !== d.ontouchstart || c.msPointerEnabled) C.touches = !0;
        void 0 !== e.onmouseup && (C.mouse = !0);
        void 0 !== e.onkeyup && (C.keyboard = !0);
        if (b.DeviceMotionEvent || b.DeviceOrientationEvent) C.accelerometer = !0;
        a.garbageCollect = function() {};
        a.dumpRoot = function() {};
        a.restartVM = function() {};
        a.cleanScript = function(a) {};
        a.isObjectValid = function(a) {
            return a ? !0 : !1
        };
        a.dump = function() {
            var a;
            a = "" + ("isMobile : " + this.isMobile + "\r\n");
            a += "language : " + this.language + "\r\n";
            a += "browserType : " + this.browserType + "\r\n";
            a += "browserVersion : " + this.browserVersion + "\r\n";
            a += "capabilities : " + JSON.stringify(this.capabilities) + "\r\n";
            a += "os : " + this.os + "\r\n";
            a += "osVersion : " + this.osVersion + "\r\n";
            a += "platform : " + this.platform + "\r\n";
            a += "Using " + (cc._renderType === cc.game.RENDER_TYPE_WEBGL ? "WEBGL": "CANVAS") + " renderer.\r\n";
            cc.log(a)
        };
        a.openURL = function(a) {
            window.open(a)
        };
        a.now = function() {
            return Date.now ? Date.now() : +new Date
        }
    })();
    g = f = null;
    cc.log = cc.warn = cc.error = cc.assert = function() {};
    var h = {},
    k = !1,
    m = null;
    cc._engineLoaded = !1;
    cc.initEngine = function(b, c) {
        if (k) {
            var f = m;
            m = function() {
                f && f();
                c && c()
            }
        } else m = c,
        !cc.game.config && b ? cc.game.config = b: cc.game.config || cc.game._loadConfig(),
        b = cc.game.config,
        a(b),
        document.body ? d(b) : cc._addEventListener(window, "load", e, !1),
        k = !0
    }
})();
cc.game = {
    DEBUG_MODE_NONE: 0,
    DEBUG_MODE_INFO: 1,
    DEBUG_MODE_WARN: 2,
    DEBUG_MODE_ERROR: 3,
    DEBUG_MODE_INFO_FOR_WEB_PAGE: 4,
    DEBUG_MODE_WARN_FOR_WEB_PAGE: 5,
    DEBUG_MODE_ERROR_FOR_WEB_PAGE: 6,
    EVENT_HIDE: "game_on_hide",
    EVENT_SHOW: "game_on_show",
    EVENT_RESIZE: "game_on_resize",
    EVENT_RENDERER_INITED: "renderer_inited",
    RENDER_TYPE_CANVAS: 0,
    RENDER_TYPE_WEBGL: 1,
    RENDER_TYPE_OPENGL: 2,
    _eventHide: null,
    _eventShow: null,
    CONFIG_KEY: {
        width: "width",
        height: "height",
        engineDir: "engineDir",
        modules: "modules",
        debugMode: "debugMode",
        exposeClassName: "exposeClassName",
        showFPS: "showFPS",
        frameRate: "frameRate",
        id: "id",
        renderMode: "renderMode",
        jsList: "jsList"
    },
    _paused: !0,
    _configLoaded: !1,
    _prepareCalled: !1,
    _prepared: !1,
    _rendererInitialized: !1,
    _renderContext: null,
    _intervalId: null,
    _lastTime: null,
    _frameTime: null,
    frame: null,
    container: null,
    canvas: null,
    config: null,
    onStart: null,
    onStop: null,
    setFrameRate: function(a) {
        this.config[this.CONFIG_KEY.frameRate] = a;
        this._intervalId && window.cancelAnimationFrame(this._intervalId);
        this._intervalId = 0;
        this._paused = !0;
        this._setAnimFrame();
        this._runMainLoop()
    },
    step: function() {
        cc.director.mainLoop()
    },
    pause: function() {
        this._paused || (this._paused = !0, cc.audioEngine && cc.audioEngine._pausePlaying(), this._intervalId && window.cancelAnimationFrame(this._intervalId), this._intervalId = 0)
    },
    resume: function() {
        this._paused && (this._paused = !1, cc.audioEngine && cc.audioEngine._resumePlaying(), this._runMainLoop())
    },
    isPaused: function() {
        return this._paused
    },
    restart: function() {
        cc.director.popToSceneStackLevel(0);
        cc.audioEngine && cc.audioEngine.end();
        cc.game.onStart()
    },
    end: function() {
        close()
    },
    prepare: function(a) {
        var b = this,
        c = b.config,
        d = b.CONFIG_KEY;
        this._configLoaded ? this._prepared ? a && a() : this._prepareCalled || (cc._engineLoaded ? (this._prepareCalled = !0, this._initRenderer(c[d.width], c[d.height]), cc.view = cc.EGLView._getInstance(), cc.director = cc.Director._getInstance(), cc.director.setOpenGLView && cc.director.setOpenGLView(cc.view), cc.winSize = cc.director.getWinSize(), this._initEvents(), this._setAnimFrame(), this._runMainLoop(), (c = c[d.jsList]) ? cc.loader.loadJsWithImg(c,
        function(c) {
            if (c) throw Error(c);
            b._prepared = !0;
            a && a()
        }) : a && a()) : cc.initEngine(this.config,
        function() {
            b.prepare(a)
        })) : this._loadConfig(function() {
            b.prepare(a)
        })
    },
    run: function(a, b) {
        "function" === typeof a ? cc.game.onStart = a: (a && ("string" === typeof a ? (cc.game.config || this._loadConfig(), cc.game.config[cc.game.CONFIG_KEY.id] = a) : cc.game.config = a), "function" === typeof b && (cc.game.onStart = b));
        this.prepare(cc.game.onStart && cc.game.onStart.bind(cc.game))
    },
    _setAnimFrame: function() {
        this._lastTime = new Date;
        var a = cc.game.config[cc.game.CONFIG_KEY.frameRate];
        this._frameTime = 1E3 / a;
        60 !== a && 30 !== a ? (window.requestAnimFrame = this._stTime, window.cancelAnimationFrame = this._ctTime) : (window.requestAnimFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || this._stTime, window.cancelAnimationFrame = window.cancelAnimationFrame || window.cancelRequestAnimationFrame || window.msCancelRequestAnimationFrame || window.mozCancelRequestAnimationFrame || window.oCancelRequestAnimationFrame || window.webkitCancelRequestAnimationFrame || window.msCancelAnimationFrame || window.mozCancelAnimationFrame || window.webkitCancelAnimationFrame || window.oCancelAnimationFrame || this._ctTime)
    },
    _stTime: function(a) {
        var b = (new Date).getTime(),
        c = Math.max(0, cc.game._frameTime - (b - cc.game._lastTime)),
        d = window.setTimeout(function() {
            a()
        },
        c);
        cc.game._lastTime = b + c;
        return d
    },
    _ctTime: function(a) {
        window.clearTimeout(a)
    },
    _runMainLoop: function() {
        var a = this,
        b, c = a.config,
        d = a.CONFIG_KEY,
        e = cc.director,
        f = !0,
        g = c[d.frameRate];
        e.setDisplayStats(c[d.showFPS]);
        b = function() {
            a._paused || (30 === g && (f = !f) || e.mainLoop(), a._intervalId = window.requestAnimFrame(b))
        };
        a._intervalId = window.requestAnimFrame(b);
        a._paused = !1
    },
    _loadConfig: function(a) {
        var b = this.config || document.ccConfig;
        if (b) this._initConfig(b),
        a && a();
        else {
            for (var c = document.getElementsByTagName("script"), d = 0; d < c.length && (b = c[d].getAttribute("cocos"), "" !== b && !b); d++);
            var e = this,
            b = function(b, c) {
                var d = null,
                d = "FaceBook" == sdkName ? {
                    showFPS: !1,
                    noCache: !1,
                    frameRate: 60,
                    project_type: "javascript",
                    debugMode: 1,
                    renderMode: 0,
                    id: "gameCanvas"
                }: JSON.parse(c);
                e._initConfig(d);
                a && a()
            };
            if (d < c.length) {
                if (c = c[d].src) c = /(.*)\//.exec(c)[0],
                cc.loader.resPath = c,
                c = cc.path.join(c, "project.json");
                cc.loader.loadTxt(c, b)
            }
            "FaceBook" == sdkName ? b(null, null) : cc.loader.loadTxt("project.json", b)
        }
    },
    _initConfig: function(a) {
        var b = this.CONFIG_KEY,
        c = a[b.modules];
        a[b.showFPS] = "undefined" === typeof a[b.showFPS] ? !0 : a[b.showFPS];
        a[b.engineDir] = a[b.engineDir] || "frameworks/cocos2d-html5";
        null == a[b.debugMode] && (a[b.debugMode] = 0);
        a[b.exposeClassName] = !!a[b.exposeClassName];
        a[b.frameRate] = a[b.frameRate] || 60;
        null == a[b.renderMode] && (a[b.renderMode] = 0);
        null == a[b.registerSystemEvent] && (a[b.registerSystemEvent] = !0);
        c && 0 > c.indexOf("core") && c.splice(0, 0, "core");
        c && (a[b.modules] = c);
        this.config = a;
        this._configLoaded = !0
    },
    _initRenderer: function(a, b) {
        if (!this._rendererInitialized) {
            if (!cc._supportRender) throw Error("The renderer doesn't support the renderMode " + this.config[this.CONFIG_KEY.renderMode]);
            var c = this.config[cc.game.CONFIG_KEY.id],
            d = window,
            c = cc.$(c) || cc.$("#" + c),
            e,
            f;
            "CANVAS" === c.tagName ? (a = a || c.width, b = b || c.height, this.canvas = cc._canvas = e = c, this.container = cc.container = f = document.createElement("DIV"), e.parentNode && e.parentNode.insertBefore(f, e)) : ("DIV" !== c.tagName && cc.log("Warning: target element is not a DIV or CANVAS"), a = a || c.clientWidth, b = b || c.clientHeight, this.canvas = cc._canvas = e = cc.$(document.createElement("CANVAS")), this.container = cc.container = f = document.createElement("DIV"), c.appendChild(f));
            f.setAttribute("id", "Cocos2dGameContainer");
            f.appendChild(e);
            this.frame = f.parentNode === document.body ? document.documentElement: f.parentNode;
            e.addClass("gameCanvas");
            e.setAttribute("width", a || 480);
            e.setAttribute("height", b || 320);
            e.setAttribute("tabindex", 99);
            cc._renderType === cc.game.RENDER_TYPE_WEBGL && (this._renderContext = cc._renderContext = cc.webglContext = cc.create3DContext(e, {
                stencil: !0,
                alpha: !1
            }));
            this._renderContext ? (cc.renderer = cc.rendererWebGL, d.gl = this._renderContext, cc.renderer.init(), cc._drawingUtil = new cc.DrawingPrimitiveWebGL(this._renderContext), cc.textureCache._initializingRenderer(), cc.glExt = {},
            cc.glExt.instanced_arrays = d.gl.getExtension("ANGLE_instanced_arrays"), cc.glExt.element_uint = d.gl.getExtension("OES_element_index_uint")) : (cc._renderType = cc.game.RENDER_TYPE_CANVAS, cc.renderer = cc.rendererCanvas, this._renderContext = cc._renderContext = new cc.CanvasContextWrapper(e.getContext("2d")), cc._drawingUtil = cc.DrawingPrimitiveCanvas ? new cc.DrawingPrimitiveCanvas(this._renderContext) : null);
            cc._gameDiv = f;
            cc.game.canvas.oncontextmenu = function() {
                if (!cc._isContextMenuEnable) return ! 1
            };
            this.dispatchEvent(this.EVENT_RENDERER_INITED, !0);
            this._rendererInitialized = !0
        }
    },
    _initEvents: function() {
        var a = window,
        b;
        this._eventHide = this._eventHide || new cc.EventCustom(this.EVENT_HIDE);
        this._eventHide.setUserData(this);
        this._eventShow = this._eventShow || new cc.EventCustom(this.EVENT_SHOW);
        this._eventShow.setUserData(this);
        this.config[this.CONFIG_KEY.registerSystemEvent] && cc.inputManager.registerSystemEvent(this.canvas);
        cc.isUndefined(document.hidden) ? cc.isUndefined(document.mozHidden) ? cc.isUndefined(document.msHidden) ? cc.isUndefined(document.webkitHidden) || (b = "webkitHidden") : b = "msHidden": b = "mozHidden": b = "hidden";
        var c = ["visibilitychange", "mozvisibilitychange", "msvisibilitychange", "webkitvisibilitychange", "qbrowserVisibilityChange"],
        d = function() {
            cc.eventManager && cc.game._eventHide && cc.eventManager.dispatchEvent(cc.game._eventHide)
        },
        e = function() {
            cc.eventManager && cc.game._eventShow && cc.eventManager.dispatchEvent(cc.game._eventShow)
        };
        if (b) for (var f = 0; f < c.length; f++) document.addEventListener(c[f],
        function(a) {
            var c = document[b]; (c = c || a.hidden) ? d() : e()
        },
        !1);
        else a.addEventListener("blur", d, !1),
        a.addEventListener("focus", e, !1); - 1 < navigator.userAgent.indexOf("MicroMessenger") && (a.onfocus = function() {
            e()
        });
        "onpageshow" in window && "onpagehide" in window && (a.addEventListener("pagehide", d, !1), a.addEventListener("pageshow", e, !1));
        cc.eventManager.addCustomListener(cc.game.EVENT_HIDE,
        function() {
            cc.game.pause()
        });
        cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,
        function() {
            cc.game.resume()
        })
    }
};
Function.prototype.bind = Function.prototype.bind ||
function(a) {
    if (!cc.isFunction(this)) throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");
    var b = Array.prototype.slice.call(arguments, 1),
    c = this,
    d = function() {},
    e = function() {
        return c.apply(this instanceof d && a ? this: a, b.concat(Array.prototype.slice.call(arguments)))
    };
    d.prototype = this.prototype;
    e.prototype = new d;
    return e
};
cc.EventHelper = function() {};
cc.EventHelper.prototype = {
    constructor: cc.EventHelper,
    apply: function(a) {
        a.addEventListener = cc.EventHelper.prototype.addEventListener;
        a.hasEventListener = cc.EventHelper.prototype.hasEventListener;
        a.removeEventListener = cc.EventHelper.prototype.removeEventListener;
        a.dispatchEvent = cc.EventHelper.prototype.dispatchEvent
    },
    addEventListener: function(a, b, c) {
        if ("load" === a && this._textureLoaded) setTimeout(function() {
            b.call(c)
        },
        0);
        else {
            void 0 === this._listeners && (this._listeners = {});
            var d = this._listeners;
            void 0 === d[a] && (d[a] = []);
            this.hasEventListener(a, b, c) || d[a].push({
                callback: b,
                eventTarget: c
            })
        }
    },
    hasEventListener: function(a, b, c) {
        if (void 0 === this._listeners) return ! 1;
        var d = this._listeners;
        if (void 0 !== d[a]) {
            a = 0;
            for (var e = d.length; a < e; a++) {
                var f = d[a];
                if (f.callback === b && f.eventTarget === c) return ! 0
            }
        }
        return ! 1
    },
    removeEventListener: function(a, b, c) {
        if (void 0 !== this._listeners && (a = this._listeners[a], void 0 !== a)) for (var d = 0; d < a.length;) {
            var e = a[d];
            e.eventTarget === c && e.callback === b ? a.splice(d, 1) : d++
        }
    },
    removeEventTarget: function(a, b, c) {
        if (void 0 !== this._listeners && (a = this._listeners[a], void 0 !== a)) for (b = 0; b < a.length;) a[b].eventTarget === c ? a.splice(b, 1) : b++
    },
    dispatchEvent: function(a, b) {
        if (void 0 !== this._listeners) {
            null == b && (b = !0);
            var c = this._listeners[a];
            if (void 0 !== c) {
                for (var d = [], e = c.length, f = 0; f < e; f++) d[f] = c[f];
                for (f = 0; f < e; f++) d[f].callback.call(d[f].eventTarget, this);
                b && (c.length = 0)
            }
        }
    }
};
cc.EventHelper.prototype.apply(cc.game);
cc._LogInfos = {
    ActionManager_addAction: "cc.ActionManager.addAction(): action must be non-null",
    ActionManager_removeAction: "cocos2d: removeAction: Target not found",
    ActionManager_removeActionByTag: "cc.ActionManager.removeActionByTag(): an invalid tag",
    ActionManager_removeActionByTag_2: "cc.ActionManager.removeActionByTag(): target must be non-null",
    ActionManager_getActionByTag: "cc.ActionManager.getActionByTag(): an invalid tag",
    ActionManager_getActionByTag_2: "cocos2d : getActionByTag(tag \x3d %s): Action not found",
    configuration_dumpInfo: "cocos2d: **** WARNING **** CC_ENABLE_PROFILERS is defined. Disable it when you finish profiling (from ccConfig.js)",
    configuration_loadConfigFile: "Expected 'data' dict, but not found. Config file: %s",
    configuration_loadConfigFile_2: "Please load the resource first : %s",
    Director_resume: "cocos2d: Director: Error in gettimeofday",
    Director_setProjection: "cocos2d: Director: unrecognized projection",
    Director_popToSceneStackLevel: "cocos2d: Director: unrecognized projection",
    Director_popToSceneStackLevel_2: "cocos2d: Director: Error in gettimeofday",
    Director_popScene: "running scene should not null",
    Director_pushScene: "the scene should not null",
    arrayVerifyType: "element type is wrong!",
    Scheduler_scheduleCallbackForTarget: "CCSheduler#scheduleCallback. Callback already scheduled. Updating interval from:%s to %s",
    Scheduler_scheduleCallbackForTarget_2: "cc.scheduler.scheduleCallbackForTarget(): callback_fn should be non-null.",
    Scheduler_scheduleCallbackForTarget_3: "cc.scheduler.scheduleCallbackForTarget(): target should be non-null.",
    Scheduler_pauseTarget: "cc.Scheduler.pauseTarget():target should be non-null",
    Scheduler_resumeTarget: "cc.Scheduler.resumeTarget():target should be non-null",
    Scheduler_isTargetPaused: "cc.Scheduler.isTargetPaused():target should be non-null",
    Node_getZOrder: "getZOrder is deprecated. Please use getLocalZOrder instead.",
    Node_setZOrder: "setZOrder is deprecated. Please use setLocalZOrder instead.",
    Node_getRotation: "RotationX !\x3d RotationY. Don't know which one to return",
    Node_getScale: "ScaleX !\x3d ScaleY. Don't know which one to return",
    Node_addChild: "An Node can't be added as a child of itself.",
    Node_addChild_2: "child already added. It can't be added again",
    Node_addChild_3: "child must be non-null",
    Node_removeFromParentAndCleanup: "removeFromParentAndCleanup is deprecated. Use removeFromParent instead",
    Node_boundingBox: "boundingBox is deprecated. Use getBoundingBox instead",
    Node_removeChildByTag: "argument tag is an invalid tag",
    Node_removeChildByTag_2: "cocos2d: removeChildByTag(tag \x3d %s): child not found!",
    Node_removeAllChildrenWithCleanup: "removeAllChildrenWithCleanup is deprecated. Use removeAllChildren instead",
    Node_stopActionByTag: "cc.Node.stopActionBy(): argument tag an invalid tag",
    Node_getActionByTag: "cc.Node.getActionByTag(): argument tag is an invalid tag",
    Node_resumeSchedulerAndActions: "resumeSchedulerAndActions is deprecated, please use resume instead.",
    Node_pauseSchedulerAndActions: "pauseSchedulerAndActions is deprecated, please use pause instead.",
    Node__arrayMakeObjectsPerformSelector: "Unknown callback function",
    Node_reorderChild: "cc.Node.reorderChild(): child must be non-null",
    Node_reorderChild_2: "cc.Node.reorderChild(): this child is not in children list",
    Node_runAction: "cc.Node.runAction(): action must be non-null",
    Node_schedule: "callback function must be non-null",
    Node_schedule_2: "interval must be positive",
    Node_initWithTexture: "cocos2d: Could not initialize cc.AtlasNode. Invalid Texture.",
    AtlasNode_updateAtlasValues: "cc.AtlasNode.updateAtlasValues(): Shall be overridden in subclasses",
    AtlasNode_initWithTileFile: "",
    AtlasNode__initWithTexture: "cocos2d: Could not initialize cc.AtlasNode. Invalid Texture.",
    _EventListenerKeyboard_checkAvailable: "cc._EventListenerKeyboard.checkAvailable(): Invalid EventListenerKeyboard!",
    _EventListenerTouchOneByOne_checkAvailable: "cc._EventListenerTouchOneByOne.checkAvailable(): Invalid EventListenerTouchOneByOne!",
    _EventListenerTouchAllAtOnce_checkAvailable: "cc._EventListenerTouchAllAtOnce.checkAvailable(): Invalid EventListenerTouchAllAtOnce!",
    _EventListenerAcceleration_checkAvailable: "cc._EventListenerAcceleration.checkAvailable(): _onAccelerationEvent must be non-nil",
    EventListener_create: "Invalid parameter.",
    __getListenerID: "Don't call this method if the event is for touch.",
    eventManager__forceAddEventListener: "Invalid scene graph priority!",
    eventManager_addListener: "0 priority is forbidden for fixed priority since it's used for scene graph based priority.",
    eventManager_removeListeners: "Invalid listener type!",
    eventManager_setPriority: "Can't set fixed priority with scene graph based listener.",
    eventManager_addListener_2: "Invalid parameters.",
    eventManager_addListener_3: "listener must be a cc.EventListener object when adding a fixed priority listener",
    eventManager_addListener_4: "The listener has been registered, please don't register it again.",
    LayerMultiplex_initWithLayers: "parameters should not be ending with null in Javascript",
    LayerMultiplex_switchTo: "Invalid index in MultiplexLayer switchTo message",
    LayerMultiplex_switchToAndReleaseMe: "Invalid index in MultiplexLayer switchTo message",
    LayerMultiplex_addLayer: "cc.Layer.addLayer(): layer should be non-null",
    EGLView_setDesignResolutionSize: "Resolution not valid",
    EGLView_setDesignResolutionSize_2: "should set resolutionPolicy",
    inputManager_handleTouchesBegin: "The touches is more than MAX_TOUCHES, nUnusedIndex \x3d %s",
    swap: "cc.swap is being modified from original macro, please check usage",
    checkGLErrorDebug: "WebGL error %s",
    animationCache__addAnimationsWithDictionary: "cocos2d: cc.AnimationCache: No animations were found in provided dictionary.",
    animationCache__addAnimationsWithDictionary_2: "cc.AnimationCache. Invalid animation format",
    animationCache_addAnimations: "cc.AnimationCache.addAnimations(): File could not be found",
    animationCache__parseVersion1: "cocos2d: cc.AnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",
    animationCache__parseVersion1_2: "cocos2d: cc.AnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",
    animationCache__parseVersion1_3: "cocos2d: cc.AnimationCache: None of the frames for animation '%s' were found in the cc.SpriteFrameCache. Animation is not being added to the Animation Cache.",
    animationCache__parseVersion1_4: "cocos2d: cc.AnimationCache: An animation in your dictionary refers to a frame which is not in the cc.SpriteFrameCache. Some or all of the frames for the animation '%s' may be missing.",
    animationCache__parseVersion2: "cocos2d: CCAnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",
    animationCache__parseVersion2_2: "cocos2d: cc.AnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",
    animationCache_addAnimations_2: "cc.AnimationCache.addAnimations(): Invalid texture file name",
    Sprite_ignoreAnchorPointForPosition: "cc.Sprite.ignoreAnchorPointForPosition(): it is invalid in cc.Sprite when using SpriteBatchNode",
    Sprite_setDisplayFrameWithAnimationName: "cc.Sprite.setDisplayFrameWithAnimationName(): Frame not found",
    Sprite_setDisplayFrameWithAnimationName_2: "cc.Sprite.setDisplayFrameWithAnimationName(): Invalid frame index",
    Sprite_setDisplayFrame: "setDisplayFrame is deprecated, please use setSpriteFrame instead.",
    Sprite__updateBlendFunc: "cc.Sprite._updateBlendFunc(): _updateBlendFunc doesn't work when the sprite is rendered using a cc.CCSpriteBatchNode",
    Sprite_initWithSpriteFrame: "cc.Sprite.initWithSpriteFrame(): spriteFrame should be non-null",
    Sprite_initWithSpriteFrameName: "cc.Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null",
    Sprite_initWithSpriteFrameName1: " is null, please check.",
    Sprite_initWithFile: "cc.Sprite.initWithFile(): filename should be non-null",
    Sprite_setDisplayFrameWithAnimationName_3: "cc.Sprite.setDisplayFrameWithAnimationName(): animationName must be non-null",
    Sprite_addChild: "cc.Sprite.addChild(): cc.Sprite only supports cc.Sprites as children when using cc.SpriteBatchNode",
    Sprite_addChild_2: "cc.Sprite.addChild(): cc.Sprite only supports a sprite using same texture as children when using cc.SpriteBatchNode",
    Sprite_addChild_3: "cc.Sprite.addChild(): child should be non-null",
    Sprite_setTexture: "cc.Sprite.texture setter: Batched sprites should use the same texture as the batchnode",
    Sprite_updateQuadFromSprite: "cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",
    Sprite_insertQuadFromSprite: "cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",
    Sprite_addChild_4: "cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children",
    Sprite_addChild_5: "cc.SpriteBatchNode.addChild(): cc.Sprite is not using the same texture",
    Sprite_initWithTexture: "Sprite.initWithTexture(): Argument must be non-nil ",
    Sprite_setSpriteFrame: "Invalid spriteFrameName",
    Sprite_setTexture_2: "Invalid argument: cc.Sprite.texture setter expects a CCTexture2D.",
    Sprite_updateQuadFromSprite_2: "cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null",
    Sprite_insertQuadFromSprite_2: "cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null",
    SpriteBatchNode_addSpriteWithoutQuad: "cc.SpriteBatchNode.addQuadFromSprite(): SpriteBatchNode only supports cc.Sprites as children",
    SpriteBatchNode_increaseAtlasCapacity: "cocos2d: CCSpriteBatchNode: resizing TextureAtlas capacity from %s to %s.",
    SpriteBatchNode_increaseAtlasCapacity_2: "cocos2d: WARNING: Not enough memory to resize the atlas",
    SpriteBatchNode_reorderChild: "cc.SpriteBatchNode.addChild(): Child doesn't belong to Sprite",
    SpriteBatchNode_removeChild: "cc.SpriteBatchNode.addChild(): sprite batch node should contain the child",
    SpriteBatchNode_addSpriteWithoutQuad_2: "cc.SpriteBatchNode.addQuadFromSprite(): child should be non-null",
    SpriteBatchNode_reorderChild_2: "cc.SpriteBatchNode.addChild(): child should be non-null",
    spriteFrameCache__getFrameConfig: "cocos2d: WARNING: originalWidth/Height not found on the cc.SpriteFrame. AnchorPoint won't work as expected. Regenrate the .plist",
    spriteFrameCache_addSpriteFrames: "cocos2d: WARNING: an alias with name %s already exists",
    spriteFrameCache__checkConflict: "cocos2d: WARNING: Sprite frame: %s has already been added by another source, please fix name conflit",
    spriteFrameCache_getSpriteFrame: "cocos2d: cc.SpriteFrameCahce: Frame %s not found",
    spriteFrameCache__getFrameConfig_2: "Please load the resource first : %s",
    spriteFrameCache_addSpriteFrames_2: "cc.SpriteFrameCache.addSpriteFrames(): plist should be non-null",
    spriteFrameCache_addSpriteFrames_3: "Argument must be non-nil",
    CCSpriteBatchNode_updateQuadFromSprite: "cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",
    CCSpriteBatchNode_insertQuadFromSprite: "cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",
    CCSpriteBatchNode_addChild: "cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children",
    CCSpriteBatchNode_initWithTexture: "Sprite.initWithTexture(): Argument must be non-nil ",
    CCSpriteBatchNode_addChild_2: "cc.Sprite.addChild(): child should be non-null",
    CCSpriteBatchNode_setSpriteFrame: "Invalid spriteFrameName",
    CCSpriteBatchNode_setTexture: "Invalid argument: cc.Sprite texture setter expects a CCTexture2D.",
    CCSpriteBatchNode_updateQuadFromSprite_2: "cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null",
    CCSpriteBatchNode_insertQuadFromSprite_2: "cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null",
    CCSpriteBatchNode_addChild_3: "cc.SpriteBatchNode.addChild(): child should be non-null",
    TextureAtlas_initWithFile: "cocos2d: Could not open file: %s",
    TextureAtlas_insertQuad: "cc.TextureAtlas.insertQuad(): invalid totalQuads",
    TextureAtlas_initWithTexture: "cc.TextureAtlas.initWithTexture():texture should be non-null",
    TextureAtlas_updateQuad: "cc.TextureAtlas.updateQuad(): quad should be non-null",
    TextureAtlas_updateQuad_2: "cc.TextureAtlas.updateQuad(): Invalid index",
    TextureAtlas_insertQuad_2: "cc.TextureAtlas.insertQuad(): Invalid index",
    TextureAtlas_insertQuads: "cc.TextureAtlas.insertQuad(): Invalid index + amount",
    TextureAtlas_insertQuadFromIndex: "cc.TextureAtlas.insertQuadFromIndex(): Invalid newIndex",
    TextureAtlas_insertQuadFromIndex_2: "cc.TextureAtlas.insertQuadFromIndex(): Invalid fromIndex",
    TextureAtlas_removeQuadAtIndex: "cc.TextureAtlas.removeQuadAtIndex(): Invalid index",
    TextureAtlas_removeQuadsAtIndex: "cc.TextureAtlas.removeQuadsAtIndex(): index + amount out of bounds",
    TextureAtlas_moveQuadsFromIndex: "cc.TextureAtlas.moveQuadsFromIndex(): move is out of bounds",
    TextureAtlas_moveQuadsFromIndex_2: "cc.TextureAtlas.moveQuadsFromIndex(): Invalid newIndex",
    TextureAtlas_moveQuadsFromIndex_3: "cc.TextureAtlas.moveQuadsFromIndex(): Invalid oldIndex",
    textureCache_addPVRTCImage: "TextureCache:addPVRTCImage does not support on HTML5",
    textureCache_addETCImage: "TextureCache:addPVRTCImage does not support on HTML5",
    textureCache_textureForKey: "textureForKey is deprecated. Please use getTextureForKey instead.",
    textureCache_addPVRImage: "addPVRImage does not support on HTML5",
    textureCache_addUIImage: "cocos2d: Couldn't add UIImage in TextureCache",
    textureCache_dumpCachedTextureInfo: "cocos2d: '%s' id\x3d%s %s x %s",
    textureCache_dumpCachedTextureInfo_2: "cocos2d: '%s' id\x3d HTMLCanvasElement %s x %s",
    textureCache_dumpCachedTextureInfo_3: "cocos2d: TextureCache dumpDebugInfo: %s textures, HTMLCanvasElement for %s KB (%s MB)",
    textureCache_addUIImage_2: "cc.Texture.addUIImage(): image should be non-null",
    Texture2D_initWithETCFile: "initWithETCFile does not support on HTML5",
    Texture2D_initWithPVRFile: "initWithPVRFile does not support on HTML5",
    Texture2D_initWithPVRTCData: "initWithPVRTCData does not support on HTML5",
    Texture2D_addImage: "cc.Texture.addImage(): path should be non-null",
    Texture2D_initWithImage: "cocos2d: cc.Texture2D. Can't create Texture. UIImage is nil",
    Texture2D_initWithImage_2: "cocos2d: WARNING: Image (%s x %s) is bigger than the supported %s x %s",
    Texture2D_initWithString: "initWithString isn't supported on cocos2d-html5",
    Texture2D_initWithETCFile_2: "initWithETCFile does not support on HTML5",
    Texture2D_initWithPVRFile_2: "initWithPVRFile does not support on HTML5",
    Texture2D_initWithPVRTCData_2: "initWithPVRTCData does not support on HTML5",
    Texture2D_bitsPerPixelForFormat: "bitsPerPixelForFormat: %s, cannot give useful result, it's a illegal pixel format",
    Texture2D__initPremultipliedATextureWithImage: "cocos2d: cc.Texture2D: Using RGB565 texture since image has no alpha",
    Texture2D_addImage_2: "cc.Texture.addImage(): path should be non-null",
    Texture2D_initWithData: "NSInternalInconsistencyException",
    MissingFile: "Missing file: %s",
    radiansToDegress: "cc.radiansToDegress() should be called cc.radiansToDegrees()",
    RectWidth: "Rect width exceeds maximum margin: %s",
    RectHeight: "Rect height exceeds maximum margin: %s",
    EventManager__updateListeners: "If program goes here, there should be event in dispatch.",
    EventManager__updateListeners_2: "_inDispatch should be 1 here."
};
cc._logToWebPage = function(a) {
    if (cc._canvas) {
        var b = cc._logList,
        c = document;
        if (!b) {
            var d = c.createElement("Div"),
            b = d.style;
            d.setAttribute("id", "logInfoDiv");
            cc._canvas.parentNode.appendChild(d);
            d.setAttribute("width", "200");
            d.setAttribute("height", cc._canvas.height);
            b.zIndex = "99999";
            b.position = "absolute";
            b.top = "0";
            b.left = "0";
            b = cc._logList = c.createElement("textarea");
            c = b.style;
            b.setAttribute("rows", "20");
            b.setAttribute("cols", "30");
            b.setAttribute("disabled", !0);
            d.appendChild(b);
            c.backgroundColor = "transparent";
            c.borderBottom = "1px solid #cccccc";
            c.borderRightWidth = "0px";
            c.borderLeftWidth = "0px";
            c.borderTopWidth = "0px";
            c.borderTopStyle = "none";
            c.borderRightStyle = "none";
            c.borderLeftStyle = "none";
            c.padding = "0px";
            c.margin = 0
        }
        b.value = b.value + a + "\r\n";
        b.scrollTop = b.scrollHeight
    }
};
cc._formatString = function(a) {
    if (cc.isObject(a)) try {
        return JSON.stringify(a)
    } catch(b) {
        return ""
    } else return a
};
cc._initDebugSetting = function(a) {
    var b = cc.game;
    if (a !== b.DEBUG_MODE_NONE) {
        var c;
        a > b.DEBUG_MODE_ERROR ? (c = cc._logToWebPage.bind(cc), cc.error = function() {
            c("ERROR :  " + cc.formatStr.apply(cc, arguments))
        },
        cc.assert = function(a, b) {
            if (!a && b) {
                for (var f = 2; f < arguments.length; f++) b = b.replace(/(%s)|(%d)/, cc._formatString(arguments[f]));
                c("Assert: " + b)
            }
        },
        a !== b.DEBUG_MODE_ERROR_FOR_WEB_PAGE && (cc.warn = function() {
            c("WARN :  " + cc.formatStr.apply(cc, arguments))
        }), a === b.DEBUG_MODE_INFO_FOR_WEB_PAGE && (cc.log = function() {
            c(cc.formatStr.apply(cc, arguments))
        })) : console && console.log.apply && (cc.error = Function.prototype.bind.call(console.error, console), cc.assert = console.assert ? Function.prototype.bind.call(console.assert, console) : function(a, b) {
            if (!a && b) {
                for (var c = 2; c < arguments.length; c++) b = b.replace(/(%s)|(%d)/, cc._formatString(arguments[c]));
                throw Error(b);
            }
        },
        a !== b.DEBUG_MODE_ERROR && (cc.warn = Function.prototype.bind.call(console.warn, console)), a === b.DEBUG_MODE_INFO && (cc.log = Function.prototype.bind.call(console.log, console)))
    }
};
cc.loader.loadBinary = function(a, b) {
    var c = this,
    d = this.getXMLHttpRequest(),
    e = "load " + a + " failed!";
    d.open("GET", a, !0);
    d.responseType = "arraybuffer";
    cc.loader.loadBinary._IEFilter ? (d.setRequestHeader("Accept-Charset", "x-user-defined"), d.onreadystatechange = function() {
        if (4 === d.readyState && 200 === d.status) {
            var a = cc._convertResponseBodyToText(d.responseBody);
            b(null, c._str2Uint8Array(a))
        } else b(e)
    }) : (d.overrideMimeType && d.overrideMimeType("text/plain; charset\x3dx-user-defined"), d.onload = function() {
        4 === d.readyState && 200 === d.status ? b(null, new Uint8Array(d.response)) : b(e)
    });
    d.send(null)
};
cc.loader.loadBinary._IEFilter = /msie/i.test(navigator.userAgent) && !/opera/i.test(navigator.userAgent) && window.IEBinaryToArray_ByteStr && window.IEBinaryToArray_ByteStr_Last;
cc.loader._str2Uint8Array = function(a) {
    if (!a) return null;
    for (var b = new Uint8Array(a.length), c = 0; c < a.length; c++) b[c] = a.charCodeAt(c) & 255;
    return b
};
cc.loader.loadBinarySync = function(a) {
    var b = this.getXMLHttpRequest();
    b.timeout = 0;
    var c = "load " + a + " failed!";
    b.open("GET", a, !1);
    a = null;
    if (cc.loader.loadBinary._IEFilter) {
        b.setRequestHeader("Accept-Charset", "x-user-defined");
        b.send(null);
        if (200 !== b.status) return cc.log(c),
        null; (b = cc._convertResponseBodyToText(b.responseBody)) && (a = this._str2Uint8Array(b))
    } else {
        b.overrideMimeType && b.overrideMimeType("text/plain; charset\x3dx-user-defined");
        b.send(null);
        if (200 !== b.status) return cc.log(c),
        null;
        a = this._str2Uint8Array(b.responseText)
    }
    return a
};
window.Uint8Array = window.Uint8Array || window.Array;
if (cc.loader.loadBinary._IEFilter) {
    var IEBinaryToArray_ByteStr_Script = '\x3c!-- IEBinaryToArray_ByteStr --\x3e\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr \x3d CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex \x3d LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last \x3d Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last \x3d ""\r\n   End If\r\nEnd Function\r\n',
    myVBScript = document.createElement("script");
    myVBScript.type = "text/vbscript";
    myVBScript.textContent = IEBinaryToArray_ByteStr_Script;
    document.body.appendChild(myVBScript);
    cc._convertResponseBodyToText = function(a) {
        for (var b = {},
        c = 0; 256 > c; c++) for (var d = 0; 256 > d; d++) b[String.fromCharCode(c + 256 * d)] = String.fromCharCode(c) + String.fromCharCode(d);
        c = IEBinaryToArray_ByteStr(a);
        a = IEBinaryToArray_ByteStr_Last(a);
        return c.replace(/[\s\S]/g,
        function(a) {
            return b[a]
        }) + a
    }
};
cc = cc || {};
cc._loadingImage = "data:image/gif;base64,R0lGODlhEAAQALMNAD8/P7+/vyoqKlVVVX9/fxUVFUBAQGBgYMDAwC8vL5CQkP///wAAAP///wAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFAAANACwAAAAAEAAQAAAEO5DJSau9OOvNex0IMnDIsiCkiW6g6BmKYlBFkhSUEgQKlQCARG6nEBwOgl+QApMdCIRD7YZ5RjlGpCUCACH5BAUAAA0ALAAAAgAOAA4AAAQ6kLGB0JA4M7QW0hrngRllkYyhKAYqKUGguAws0ypLS8JxCLQDgXAIDg+FRKIA6v0SAECCBpXSkstMBAAh+QQFAAANACwAAAAACgAQAAAEOJDJORAac6K1kDSKYmydpASBUl0mqmRfaGTCcQgwcxDEke+9XO2WkxQSiUIuAQAkls0n7JgsWq8RACH5BAUAAA0ALAAAAAAOAA4AAAQ6kMlplDIzTxWC0oxwHALnDQgySAdBHNWFLAvCukc215JIZihVIZEogDIJACBxnCSXTcmwGK1ar1hrBAAh+QQFAAANACwAAAAAEAAKAAAEN5DJKc4RM+tDyNFTkSQF5xmKYmQJACTVpQSBwrpJNteZSGYoFWjIGCAQA2IGsVgglBOmEyoxIiMAIfkEBQAADQAsAgAAAA4ADgAABDmQSVZSKjPPBEDSGucJxyGA1XUQxAFma/tOpDlnhqIYN6MEAUXvF+zldrMBAjHoIRYLhBMqvSmZkggAIfkEBQAADQAsBgAAAAoAEAAABDeQyUmrnSWlYhMASfeFVbZdjHAcgnUQxOHCcqWylKEohqUEAYVkgEAMfkEJYrFA6HhKJsJCNFoiACH5BAUAAA0ALAIAAgAOAA4AAAQ3kMlJq704611SKloCAEk4lln3DQgyUMJxCBKyLAh1EMRR3wiDQmHY9SQslyIQUMRmlmVTIyRaIgA7";
cc._fpsImage = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAAgCAYAAAD9qabkAAAKQ2lDQ1BJQ0MgcHJvZmlsZQAAeNqdU3dYk/cWPt/3ZQ9WQtjwsZdsgQAiI6wIyBBZohCSAGGEEBJAxYWIClYUFRGcSFXEgtUKSJ2I4qAouGdBiohai1VcOO4f3Ke1fXrv7e371/u855zn/M55zw+AERImkeaiagA5UoU8Otgfj09IxMm9gAIVSOAEIBDmy8JnBcUAAPADeXh+dLA//AGvbwACAHDVLiQSx+H/g7pQJlcAIJEA4CIS5wsBkFIAyC5UyBQAyBgAsFOzZAoAlAAAbHl8QiIAqg0A7PRJPgUA2KmT3BcA2KIcqQgAjQEAmShHJAJAuwBgVYFSLALAwgCgrEAiLgTArgGAWbYyRwKAvQUAdo5YkA9AYACAmUIszAAgOAIAQx4TzQMgTAOgMNK/4KlfcIW4SAEAwMuVzZdL0jMUuJXQGnfy8ODiIeLCbLFCYRcpEGYJ5CKcl5sjE0jnA0zODAAAGvnRwf44P5Dn5uTh5mbnbO/0xaL+a/BvIj4h8d/+vIwCBAAQTs/v2l/l5dYDcMcBsHW/a6lbANpWAGjf+V0z2wmgWgrQevmLeTj8QB6eoVDIPB0cCgsL7SViob0w44s+/zPhb+CLfvb8QB7+23rwAHGaQJmtwKOD/XFhbnauUo7nywRCMW735yP+x4V//Y4p0eI0sVwsFYrxWIm4UCJNx3m5UpFEIcmV4hLpfzLxH5b9CZN3DQCshk/ATrYHtctswH7uAQKLDljSdgBAfvMtjBoLkQAQZzQyefcAAJO/+Y9AKwEAzZek4wAAvOgYXKiUF0zGCAAARKCBKrBBBwzBFKzADpzBHbzAFwJhBkRADCTAPBBCBuSAHAqhGJZBGVTAOtgEtbADGqARmuEQtMExOA3n4BJcgetwFwZgGJ7CGLyGCQRByAgTYSE6iBFijtgizggXmY4EImFINJKApCDpiBRRIsXIcqQCqUJqkV1II/ItchQ5jVxA+pDbyCAyivyKvEcxlIGyUQPUAnVAuagfGorGoHPRdDQPXYCWomvRGrQePYC2oqfRS+h1dAB9io5jgNExDmaM2WFcjIdFYIlYGibHFmPlWDVWjzVjHVg3dhUbwJ5h7wgkAouAE+wIXoQQwmyCkJBHWExYQ6gl7CO0EroIVwmDhDHCJyKTqE+0JXoS+cR4YjqxkFhGrCbuIR4hniVeJw4TX5NIJA7JkuROCiElkDJJC0lrSNtILaRTpD7SEGmcTCbrkG3J3uQIsoCsIJeRt5APkE+S+8nD5LcUOsWI4kwJoiRSpJQSSjVlP+UEpZ8yQpmgqlHNqZ7UCKqIOp9aSW2gdlAvU4epEzR1miXNmxZDy6Qto9XQmmlnafdoL+l0ugndgx5Fl9CX0mvoB+nn6YP0dwwNhg2Dx0hiKBlrGXsZpxi3GS+ZTKYF05eZyFQw1zIbmWeYD5hvVVgq9ip8FZHKEpU6lVaVfpXnqlRVc1U/1XmqC1SrVQ+rXlZ9pkZVs1DjqQnUFqvVqR1Vu6k2rs5Sd1KPUM9RX6O+X/2C+mMNsoaFRqCGSKNUY7fGGY0hFsYyZfFYQtZyVgPrLGuYTWJbsvnsTHYF+xt2L3tMU0NzqmasZpFmneZxzQEOxrHg8DnZnErOIc4NznstAy0/LbHWaq1mrX6tN9p62r7aYu1y7Rbt69rvdXCdQJ0snfU6bTr3dQm6NrpRuoW623XP6j7TY+t56Qn1yvUO6d3RR/Vt9KP1F+rv1u/RHzcwNAg2kBlsMThj8MyQY+hrmGm40fCE4agRy2i6kcRoo9FJoye4Ju6HZ+M1eBc+ZqxvHGKsNN5l3Gs8YWJpMtukxKTF5L4pzZRrmma60bTTdMzMyCzcrNisyeyOOdWca55hvtm82/yNhaVFnMVKizaLx5balnzLBZZNlvesmFY+VnlW9VbXrEnWXOss623WV2xQG1ebDJs6m8u2qK2brcR2m23fFOIUjynSKfVTbtox7PzsCuya7AbtOfZh9iX2bfbPHcwcEh3WO3Q7fHJ0dcx2bHC866ThNMOpxKnD6VdnG2ehc53zNRemS5DLEpd2lxdTbaeKp26fesuV5RruutK10/Wjm7ub3K3ZbdTdzD3Ffav7TS6bG8ldwz3vQfTw91jicczjnaebp8LzkOcvXnZeWV77vR5Ps5wmntYwbcjbxFvgvct7YDo+PWX6zukDPsY+Ap96n4e+pr4i3z2+I37Wfpl+B/ye+zv6y/2P+L/hefIW8U4FYAHBAeUBvYEagbMDawMfBJkEpQc1BY0FuwYvDD4VQgwJDVkfcpNvwBfyG/ljM9xnLJrRFcoInRVaG/owzCZMHtYRjobPCN8Qfm+m+UzpzLYIiOBHbIi4H2kZmRf5fRQpKjKqLupRtFN0cXT3LNas5Fn7Z72O8Y+pjLk722q2cnZnrGpsUmxj7Ju4gLiquIF4h/hF8ZcSdBMkCe2J5MTYxD2J43MC52yaM5zkmlSWdGOu5dyiuRfm6c7Lnnc8WTVZkHw4hZgSl7I/5YMgQlAvGE/lp25NHRPyhJuFT0W+oo2iUbG3uEo8kuadVpX2ON07fUP6aIZPRnXGMwlPUit5kRmSuSPzTVZE1t6sz9lx2S05lJyUnKNSDWmWtCvXMLcot09mKyuTDeR55m3KG5OHyvfkI/lz89sVbIVM0aO0Uq5QDhZML6greFsYW3i4SL1IWtQz32b+6vkjC4IWfL2QsFC4sLPYuHhZ8eAiv0W7FiOLUxd3LjFdUrpkeGnw0n3LaMuylv1Q4lhSVfJqedzyjlKD0qWlQyuCVzSVqZTJy26u9Fq5YxVhlWRV72qX1VtWfyoXlV+scKyorviwRrjm4ldOX9V89Xlt2treSrfK7etI66Trbqz3Wb+vSr1qQdXQhvANrRvxjeUbX21K3nShemr1js20zcrNAzVhNe1bzLas2/KhNqP2ep1/XctW/a2rt77ZJtrWv913e/MOgx0VO97vlOy8tSt4V2u9RX31btLugt2PGmIbur/mft24R3dPxZ6Pe6V7B/ZF7+tqdG9s3K+/v7IJbVI2jR5IOnDlm4Bv2pvtmne1cFoqDsJB5cEn36Z8e+NQ6KHOw9zDzd+Zf7f1COtIeSvSOr91rC2jbaA9ob3v6IyjnR1eHUe+t/9+7zHjY3XHNY9XnqCdKD3x+eSCk+OnZKeenU4/PdSZ3Hn3TPyZa11RXb1nQ8+ePxd07ky3X/fJ897nj13wvHD0Ivdi2yW3S609rj1HfnD94UivW2/rZffL7Vc8rnT0Tes70e/Tf/pqwNVz1/jXLl2feb3vxuwbt24m3Ry4Jbr1+Hb27Rd3Cu5M3F16j3iv/L7a/eoH+g/qf7T+sWXAbeD4YMBgz8NZD+8OCYee/pT/04fh0kfMR9UjRiONj50fHxsNGr3yZM6T4aeypxPPyn5W/3nrc6vn3/3i+0vPWPzY8Av5i8+/rnmp83Lvq6mvOscjxx+8znk98ab8rc7bfe+477rfx70fmSj8QP5Q89H6Y8en0E/3Pud8/vwv94Tz+4A5JREAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfcAgcQLxxUBNp/AAAQZ0lEQVR42u2be3QVVZbGv1N17829eRLyIKAEOiISEtPhJTJAYuyBDmhWjAEx4iAGBhxA4wABbVAMWUAeykMCM+HRTcBRWkNH2l5moS0LCCrQTkYeQWBQSCAIgYRXEpKbW/XNH5zS4noR7faPEeu31l0h4dSpvc+t/Z199jkFWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhY/H9D/MR9qfKnLj/00U71aqfJn9+HCkCR/Wk36ddsgyJ/1wF4fkDfqqm9/gPsUeTnVr6a2xlQfnxdI7zs0W7irzD17Ytb2WT7EeNv/r4ox1O3Quf2QP2pgt9utwfout4FQE8AVBSlnaRmfvAURQkg2RlAbwB9AThlW5L0GaiKojhJhgOIBqDa7XaPrusdPtr5kQwF0BVAAoBIABRCKDd5aFUhRDAAw57eAOwAhKIoupft3zoqhB1AqLwuHIBut9uFt02qqvqRDJR2dAEQJj/BAOjn56dqmma+xiaECAEQAWAggLsB6A6HQ2iaZggBhBAqgEAAnQB0kzaEmT4hAITT6VQ8Ho/HJAKKECJQtr8LwD1y/A1/vcdfEUIEyfZ9AcQbYvZ942Px88L2UwlJR0dH0EMPPbRj5syZPUeNGrXR7Xb/641xIwJ1XY9NSUlZm52dfW+XLl1w8uRJzJ8//+OGhoYJqqqe1TSt1Wsm9NN1PSIqKmr12rVrR5WUlHy1bdu2AQCumWc3IYRD1/UwVVXnFRQUTIuNjUVzczN2797dWFJSkq8oymZd15sAGAEnFEUJ1nX9nzIzM1dnZmZGh4SE4OTJk5g5c+Zf29vbp9pstrMej6fVOyhIhgAYU1hY+B+hoaGoqKg4XVlZea+XTULTNFdCQsLGiRMnPuR2u3UhBOV9eeDAAWXTpk095DUe6WsoyRE5OTlr0tLSAux2O/bs2cO5c+e+pijKUpIXSHaQVAGkvPLKK++6XK4OksJLCFlXV2cvKSlJBFAjhU+x2WwhHo9nUHp6+urMzMy7wsLCUF9fjxdffPHjxsbGiTab7WuPx9NiEutOuq4PyMjI+M+srKyYqKgoHD58GDNmzNjq8XhyVFU9b/q+LH7hBAEYu3PnTlZVVRFAGgCX6f/tAHoOHDjwa0p27txp/JO9e/f+QM7cipw9nfL3kQBKt2zZQpJ87rnn6mQmoHilw2EACs+cOUOSrK+vZ1NTE0nyo48+IoBpxswoBcMJ4Ndjx471kOTFixe5d+9ekqTH42H//v13A4jyzpAURfEH0H/OnDnthu1z5sw558MmFUCPWbNmnaMP3nrrLZoyDmP8Hl68eDFJ8siRI9/Yc+zYMQKYKdtAztrTrl27xptRXV1NAKMAOAyBBBA/Y8aMdpLs6Ojgxx9//E37+++//29yvFXppwvAwMcee8xjtDHsuXLlCqOjo//ia3wsfpkoALqFhoZuIckJEyackimm3dQmEMDUmpoakmRISMhhAHOHDx/eQJIbN24kgKEyMAHAFRMTs2XXrl1saWkhSZ0kp0+ffhrAr3wEW/S8efOukORLL72kA1gKYMPWrVtJkk899dRJAHeYrgsEsIQkjx8/TgDvAPjd448/3kaSb7zxBmUa7vC6z53BwcFbSHL9+vU6Sc6aNes8gF5ewWAH0PfVV18lSQL4DMBGIcQ6AKtcLleBFC2jXtFt8ODBe0iyoqKCAJYByC8qKmJDQwOzsrK+MAmqo1OnTveHhoa+GRkZ+XZkZOSWiIiIvzgcjk9mzpypkWRmZuZpmbYbGV4AgPnNzc1sa2sjgN0A5iQmJtaSZHl5OQHcb/K3s81mW0uSTU1NBFAFYFbfvn1Pk+Tbb79NAA8IIVzW42/hByA+Pz/fLR/2ZXIda05NI/z9/TeR5J49ewhgqlxTrtI0jY2NjQQw3zTLuWJiYjaUlJToS5Ys6fjkk080kwDEeAmADcA9GzZsIElGRUW9CyAWwLApU6Y0kOSKFSsog9QICGdERMTGsrIyZmVlEcC9AB4IDw/fTpLbtm0jgN94CUAnAJmVlZVcs2aNZ/LkyRdJcvbs2b4EwAkgZfPmzTxw4AABFAN4BkC6vFeUSewcAO5duXIlSTIhIaEawGMAxgKYAmAGgCS73e5vrKVk/yGythANYEhCQsIhkly+fDkBpKqqGmL6DgIALDKN/3yZpVWQZGVlJQE8aPI3KiMjo5okV61aRQAjAPQBMPfIkSN0u90EUCBtsPiFEwpgbn19PdetW2fM5N4zQ9ekpKQqkty0aRMBpMjiWM6JEydIkoqirJUFJ6iq6pAPVy8A6cZMehMBUACEuVyuFwG8HBwcPEIWx367ZMkSjSQXLVrUJouTRorrkAHdA8BdQogsAOsKCwtJkmPGjDkvMw2bDDo/ADEjRoz4XylyFbm5uY0mAbjLyyZ/AOOrq6tZVlbWsWDBgo69e/eyoqKCgwcPPg4gSQaoIRbp27dvN7KF+tLSUr28vJwFBQXtMpvpYRIM7+wrAkDeqVOnePbsWQIoNKfzpiXPg8uXLydJJicnNwF4f+nSpW6STEtLq5fjYwhk1wkTJtSQ5Ouvv04AqTKj+N2xY8dIkgEBAW/Ie1v8wncRegwZMmQvSfbr12+3Ua33WqPfOWbMmP0kWVpaSgCDZAqcfejQIWNZsEGKgvnh9gfQb9myZd8nAEJVVZtMkUNk8CcNHTq0liR1XWdYWNhmH1mJIme80OnTp18x1rp5eXkEsNJms92Fb7e/IgEsvHz5Mp999tkmAI/l5uZeMC0B7vEqqAYAyL106RJJsra2lpWVld+sucePH38ZQG+5NncBeOrgwYMkqbe3t/Po0aOsra011wAWyl0H7x0JJ4DE+fPnu0kyPT29DsDdUrBuyNKEEAkAdpw/f/6GeoEM8GUmfwEgPCIiopwkGxsbabPZPgOw6L777vvm4p49e26VGYjFLxUhhD+ApLKyMp44ccIoVnXybgbgzkcfffRzklyzZg0BDJYCMMmoCwQFBXkLgLGWvvcWAgBToSsKwNPTp09vMR7UuLi4rwH0lgU8c/Db5ezbeeTIkRWzZ8++aMxu+fn5BPCADBwHgP4LFy701NXVEUAJgAnPP/98kyxMNgHo53A4zH77BQQETMvPz7+Um5vbBuAlAFMSExPPmdbVL0qh8Acw8fDhw5SCchVAEYAVb775JknyhRdeaJYztHfxMwLAaqNwCGC2FArv8x0hAHKNLGPKlCme5OTk/Zs3bzb7O0wKiiG8KXl5ed8IxenTp0mSR48e1UmyW7duWywBuD2xyQcgFECgoih+8H1gyJgZV5Lkyy+/3CbTRIePtl2HDBmyw1QBHyGDdXZdXR1JUghRKkXBjOMHCoBdpr0L3nvvPZLkF198wejo6O0A4lVVDTb74HQ6AwD8Wq7Jh8rgGgDgQ13XjVR8qaxJuADMbmlpYXl5uV5UVNRWUFDgfv/993Vj/ZydnU1c37eHXML4S3viAcQqitJD2l104cIFY8lTKsXSBWBMVVWVcd9yed2A1NTUQ6Zl00CvLMMOoHdubm6zFIlWOf5+PsY/Kj09vdrU11QAwwGsv3jxIk21m2DZr10I0RXAuAcffPBgaWkpV69eTYfDcdiwUxY0w6xw+flX8L1xApjevXv3lREREaW6rofB93aPDUDQpEmTMgHgtddeqwBwEd/utZvpqK6uPgEAcXFxkA94NwB9unfvjrNnz4LklwDcf08iIqv66Zs2bXrl4YcfxooVKxAbG7uqrq5uAYA2TdOEqqpGYIi2tjbl6aeffu/YsWPv5uTk7JaC1wHg4Pnz542MwoVvTx+21dbWYvjw4WLixIl+2dnZ9lGjRgmSTE1NRUpKCkwFTGiaxtTU1OXTpk3707Bhw/6g67pDipnT4biuj7qut+Lbk3Vf1tTUXI9qu91Pjq1QFEUBgJaWFgBo8yGOQ8eNGxcAAOvXr/8QwBUfYygAKL169eoCABcuXACAWtn2hOGv0+kMNO1KiPDw8F4A4rZv3/7R1KlTR0+bNu1ht9u9r1+/fqitrQXJgwDarRC6/QjPzs4+QJIffPCB9/aQmSAA43ft2mW0e1QGoi8CAPyLsZccExNTC2BlRkbGRdOyYJCP2csBIN6UAZzCd7cBbQCijYp/dXU1ExMTz6SmptaMHj36f9LS0vYlJCRsl6mxIWSdu3fv/g5J7t+/nwC2AShMTk6+SJKff/45AWRLYbD7+fndAeDf5BJnLoCCyZMnt5JkdnZ2C4B/F0KEm1Pu+Pj4rST55ZdfEsBWAK+mpaVdMo3raDn7KwDuSEpK+m+S3LBhAwG8DuCtHTt2UBbpjgC408vvcFVV15HkuXPnjMp+p5uMf0RcXNyHJNnQ0EBVVfcCWBQXF3fG+Jv0yxABPwB5LS0tRmFxN4BlTzzxxGWSXLx4sS5F3GGFy+1Hp5SUlJq6ujoWFxdTpsZ2H+0iIyMj/0iSWVlZX5mr5jfJFroPGzasxlhTnjp1iiTZ3NxMl8tlrCd9pfa9SkpKSJI5OTmnZOageLUZZqxvfVFWVkZcPwdgNwnSCKPqb17jkmR8fPzfZMDZ5CRsFBmNI7h95s2b1yhT7/MAYmStwCx4vy0uLqa3v5qmEcCfvSr1QQAeXb16NY3Cm3HQ55133iGAp+SxZTNhKSkpfzUddkrFjYevzAQCeGjp0qXfsYckY2NjTwD4leGDLCL2HTdunNtoY+zWSHFcIHdsFCtcfuZ1vO9Eqs3m7/F47sb1k2qX/f3997W2tl7BjWfpBYDOzzzzzIVJkyZh0KBBCwEsB3AJvl9AETabLcDj8dwRFRW1ctasWb8JCgpSzp07d62wsPC/Wltb8xRFadR1/ZqPXYbgAQMGbI2Pjw/+6quv9ldVVT0r01ezuPRJSUn5Y9euXXVd11WzDaqq6kePHm3+7LPPRgO4KlNuxWazhXo8nuTk5OSXMjIyEl0uFxoaGtqKior+dPXq1VdUVT0jj7r68ieoT58+vx8yZMjdx48fP1JVVTVF9m20VW02WyfZf97YsWPjXS4X6urqWvPy8jYCWCyEuEDS8FdVFKWzruv//OSTTy5OTk7uqWkaPv3007qysrJ8RVH+LI8ym8/rB3Tu3HnRI488knLo0KG2ffv2ZQI4C98vP6mqqoZqmpaclpa2cOTIkX39/f3R0NDQUVxc/G5TU9PLqqrWa5rWLH1QVFUN0TStX1JSUvH48eP7BwYG4uDBg1cKCgpeBbBe2u+2Qug2EwD5N5sMPuNtMe8XP4TT6Qxoa2sbIGeXvUKIK7d4IISiKC5d1wPljOfA9bPwzYqiXNV13dd6Uqiq6qdpml2mpe02m63d4/G4vcTF5fF47LJf71nJA6BZVVW3pmntuPHlmAD5wk6Q9NnbHp9vHaqq6tA0zU/64PZhk1FfCZB9G/23ALiqKEqzD39tpvbGUqoFwFUhRLP3yzpCCDtJpxyXDulfG27+pqRR3DXsUWVd4Yq0x/taVQjhIhksC8L+ABpM9ljBf5sKwI8pIBr75L5E4vvu+UNeG/a+hv+AL7yFH8qPtOfHjtOP6V/Bja8D6z/B2Nys/1u9Xv33tLf4GfF/LC4GCJwByWIAAAAASUVORK5CYII\x3d";
cc._loaderImage = "data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAAlAAD/4QMpaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjAtYzA2MCA2MS4xMzQ3NzcsIDIwMTAvMDIvMTItMTc6MzI6MDAgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjM4MDBEMDY2QTU1MjExRTFBQTAzQjEzMUNFNzMxRkQwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjM4MDBEMDY1QTU1MjExRTFBQTAzQjEzMUNFNzMxRkQwIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzUgV2luZG93cyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU2RTk0OEM4OERCNDExRTE5NEUyRkE3M0M3QkE1NTlEIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU2RTk0OEM5OERCNDExRTE5NEUyRkE3M0M3QkE1NTlEIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+/+4ADkFkb2JlAGTAAAAAAf/bAIQADQkJCQoJDQoKDRMMCwwTFhENDREWGhUVFhUVGhkUFhUVFhQZGR0fIB8dGScnKionJzk4ODg5QEBAQEBAQEBAQAEODAwOEA4RDw8RFA4RDhQVERISERUfFRUXFRUfKB0ZGRkZHSgjJiAgICYjLCwoKCwsNzc1NzdAQEBAQEBAQEBA/8AAEQgAyACgAwEiAAIRAQMRAf/EALAAAAEFAQEAAAAAAAAAAAAAAAQAAgMFBgcBAQEAAwEBAAAAAAAAAAAAAAAAAQMEAgUQAAIBAgIEBwoLBgQGAwAAAAECAwAEEQUhMRIGQVFxsTITFGGBwdEiQlKSMzWRoeFicqKyI1NzFYJjJDQWB9KjVCbxwkNkJWXik3QRAAIBAgMFBQcDBQEAAAAAAAABAhEDIRIEMUFRcTJhwVIUBZGhsSJyEzOB0ULhYpIjUxX/2gAMAwEAAhEDEQA/AMJSpUqAVKlXuFAeUq9wpUB5XuFe4V6ooDzZHDox0CnGMinzwl7Z8NajaHeoO3vmTBZBtp9YUIqTEV5ROxHKnWRnaU8VRMhFBUjpV7hSoSeUq9pUB5Sr2lhQHlKvcK8oBV7hSFSRrtaKAZs07YNPM1pG2xJIAw1jSeandry/8X4m8VCKkWwaWwam7Xl/4v1W8VLtmX/i/VbxUoKkWwakSM407tmX/i/VbxUmzGwjQsjdY41IARie/U0IbZO0kNtCXnOCkEBeFu4KI3Bs7DNb27ya+jDx3kJeEnpJJEcQVbWDsk17u5urd591ucZkWhym2Vnd9RkCDEpFxDRpbw0bunu5mlp2De2FMLYXOD2wB2xbOeraUcYGJ72mlSUiqzzdzMd3Z3mixltA2yzcK/NlHM1DQyRXce1HocdNOEfJXZ88y9ZojOqhiBszIRiHQ8Y4cK5TvHuzLljHNMqxNoDjLFraHHnjPxcNCGVbxEUzYNTx5jZSxhpW6qTzlwJ+DCvO2Zf+L9VvFSgqyHYNLYNTdssPxfibxUu15f8Ai/VPiqCakOwa82DU/a8v/F+JvFTDdWPBL8R8VKCvYRYV5UzoMAy6QdIIqI0B4KJtxiRQwou16QoGUkntH5Tz0RbZbmF2hktraSVBo2lUkY8tDye0flPPXTslVUyiyVRsjqUOA4yMT8dW2ram2m6UVTNq9S7EIyUVJydMTn/6DnP+im9Wl+g5z/opvVrpteEhQWY4AaSTwAVf5WPiZh/9S5/zj7zltzlmYWkfWXNvJDGTgGcYDHirR7i7mSbwXParsFMrgb7w6jKw/wCmnc9I14kF3vpvCljbMyWMOJL4aEiB8qU/ObUK7HYWVrl1pFZWiCOCBQqKOLjPGTrNZZqKbUXVHq2nNwTuJRk1VpbgXN8s7Rk5ym0UQQzhIG2NAjhxHWbI+gCBVjBBFbwxwQqEiiUJGg1BVGAFe7dV28WYLYZFmF2Th1UD7JGjymGyn1iK5OyzIBGB1HgrLZhamzumQAGJwSqnSCh1q3GOCodxt4cxurdcpzuN4cyhiWaF5Bg09udUmnWw1H/jV9nFuJ7Quo+8h8peThFA+047vduyMtk7fYqTl07YFdfUufMPzT5p71UdtlmYXaGS2t3mQHAsgxANdadYJopLe4QS2867EsZ4QfCNYrCFbjdDPmgkYyWFxgVf04ifJf6ScNdRUW1XBb6FU5TjF5EpSSrGu/s5lN+g5z/opvVpfoOc/wCim9WtdHnatvObJXDW7xLGhB8nrPaY9/HCr+tEdPCVaSeDoYLnqF63lzW4/PFSW3ecxbI84VSzWUwUaSdg0DXXK5nvAipnd6qgKvWnQO7pri9ZUEmm3Vl2j1kr8pRlFRyquBNZjGxQ/S56Y1S2fu9OVueon11Szahoou06QoQUXadIVCD2FJJ7R+U89dMydv8Axdn+TH9muZye0flPPXQstlK5Tbka1gUjlC1q0vVLkeb6r+O3Tx9xcY1nt8c0NrZCyiOE1108NYjGv1joo7Js1jzKyScYLIvkzL6LDwHXVJksH9Sb49dKNq0tj1jA6uriOCL+02FWX7iVtZX1/AzaHTyeoauKn2MX9W79zebiZCuR5MjSrhfXuEtwTrUeZH+yNfdrRNcxI6IzhXlJEak6WIGJ2Rw4ChWnChndtlVBLMdQA0k1gbXNMzzDfDLs6mjaPKppJbWwJ1bOwwxw43OnHh71YT3DpfWUJmFlb5jHHDdeXBHIsrRea5TSqvxqG04cNN62vetoCS4tre5mgnkGE9q+3DKOkuI2WX6LDQRRHWDh1UCtwj7QRg2wdl8Djgw1qe7XvW0BQ3kfZ7mSLgU+T9E6RVbnuVrnWVSWqj+Lt8ZbRuHEdKPkYVcZ2MJY5fSGyeVar45+rkWQHAqccalPE5km1htWK5nK4Wnt5FuUBUwOMG4nGkA/BXUrW4S6torlOjMgcd/xVn7rLo7zKs0uEjCNeSvdwoBhgsZxX1l2j36k3Lu+uyprdj5Vs5A+i/lD48a0aaVJOPi7jB6lbzWozpjB48pf1NDXNN4vfl7+Z4BXS65pvF78vfzPAK71XTHmZ/S/yT+jvJ7L3fHytz1E+upbL+Qj5W56jfXWRnsIYKLtekKEFGWvSFQgyjk9o/Keet3YthlMP/5x9msJJ7R+U89biyb/AMXEv7gD6tadL1T+kwepRrC39ZkLDMbiwMvUHRPG0bjlGg8ore/23sxBldxfMPLupNhT8yL/AORNZbdzJ484scytxgLqJY5LZj6Q2sV5G1Vud1mjjyG0ij0NEGSZToKyhjtqw4waztuiXA3qKTbSxltfGhbZlE95ZtZqxVbgiOZhrER9ph3Svk9+pJILZ4Y4DGBFCUMKjRsGPobPFhUfW0NJmljE2xJcIrcI2vFUEln1lRXd6lrazXT9GCNpD+yNqoI7mOVduNw6nzlOIoPOUa6yye1XXcbMR5GdQ3xY0BSbj31/FcTQZirJ+q431q7anbHCTZ72Bw7lbPrKBMcBWNNgbMBBh+bsjBdni0VJ1lARZs6yWiupxCuMDy6KpS2IwOo6DTr3Mre3e5tZZVUM4ZBjqOOJoWO4jkXajcOOMHGgDISvWIrdAkKR80+TzVl908bPPL3LzxOuHdifxVfiTAg92qI/w+/8gGgSyN/mR7XPVlp0lF/3L3mbVKtu5Hjbk/8AHE2Fc03i9+Xv5ngFdKNc13i9+Xv5ngFaNV0x5nn+l/kn9HeEWXu+PlbnqJ9dS2Xu9OVueon11kZ7CGCjLXpCgxRlr0hUIPYUcntH5Tz1s8vb+Bt1/dqPirGSe0flPPWusG/g4Py15q06XqlyMWvVYQ+ruI9xJOqzO9hOto/sP8tbGOFIrmWeM7IuMDMnAXXQJOUjQeOsJk0nY96ip0CYunrjaHx1t+srPJUbXBm2LrFPikwTOb+T+VhbZxGMrDXp83x1QSy2tucJpUjPETp+Cn5/ftaRvKvtp3Kx48HG3erHMzOxZiWZtLMdJNQSbbL71Vk6yynViOkqnEEfOWtPbXi3EQkGg6mXiNckjeSJxJGxR10qw0GtxuxmvbImD4CZMFlA4fRfv0BqesqqzTMZNMEDbIHtHH2QeCiZJSqMQdOGiue53mz3czQwsRbIcNHnkec3c4qAMuriz68gTIToxwOOnlp0MjxMJYW741Gs3RVldtbygE/dMcHX/moDaxTiWNZB53B3arb8/wC+4SOF4sf/AKxU9kcBsfOGHfoUHtG/RbzY5Die5HHhXdvavqiZ9Q8Jdlq4/gbKua7xe/L38zwCuhpf2Uk/Zo50kmwJKIdogDjw1VzzeL35e/meAVp1LTgqY4nn+mRauzqmqwrjzCLL3fHytz1E+upLL+Qj5W56jfXWRnroYKLtekKEFF2vSFQg9hSSe0flPPWosm/hIfoLzVl5PaPynnrRWb/w0X0F5q06XqlyM2sVYx5gmbFre/t71NY2T+0h8VbSO5SWNJUOKSAMp7jDGspmMPaLRlXS6eWve1/FRO7WYdbZm1Y/eW/R7qHxHRXGojlm3ulid6aVbaW+OALvgCLq2Hm9WxHKWqjhj6xsK1e8dm15l4niG1LZkswGsxtrPeOmsvayBJA1VItlWjptLuTdPMo7LtjRDq9naK4+WF9IrUW7BaHOljGqVHB7w2hzVoZt87d8vaNYSLl02CcRsDEbJbj71Uu7UBkvJ7/D7q2QoDxySaAO8MTXdxRVMpRp5XZOWdF/ms7R5XdyKfKWJsO/5PhrG5XlNxmEywW6bTnTxAAcJNbGSMXkM1pjgbiNo1PziPJ+Os7u7m/6ReM00ZOgxSpqYYHT3wRXMKN4ll9zUG4bQfNshu8sZVuEA2hirA4qe/VOwwrVbzbww5mI44UKRRYkbWG0S3JWctbd7u5WFfOOLHiUdJqmaipfLsIsObhWe001lMkMVvJNjhghIALMcBxCs7fxXQmkupx1bXDswGPlaTidVaEyKNXkoo4eBV+Sq7L7Vs9zcBgeyQ4GQ/MB1crmoim2orezqcowTuSeEY48jQ7oZX2PLzdyLhNd6RjrEY6I7+uspvH78vfzPAK6UAAAFGAGgAcArmu8Xvy9/M8ArTfio24RW5nnaG67uou3H/KPuqT2X8hHytz1G+upLL3enK3PUb66ys9RDBRdr0hQgou06QqEGUkntH5Tz1e238vF9BeaqKT2j8p56vbb+Xi+gvNWjTdUuRn1XTHmTh8KrJTJlt8t1CPIY44cGnpJVjTJYkmjaN9Ib4u7V923njTethRauZJV3PaW1rfLIiXEDYg6R4VYc9CXW7thfOZbKdbGZtLW8uPVY/u3GrkNUkM9zlcxUjbhfWOA90cRq4gv4LhdqN+VToNYWmnRm9NNVWNTyHc6VWBv8wt4YeHqm6xyPmroq1Z7WGFLSxTq7WLSuPSdjrkfumq5yHXDUeA92oO2SKpVumNAaoJLMXH3myp0rpJ4uKhc3tbDM5BMri1zAj79j7KTiY8TcdBpcsith0286o+sPCagEX9Pzg4zXUCp6QYse8oouCG3tk6m1BYv05W6T+IdyolxbHDAAa2OgDlNCz3ryN2WxBd5PJMg1t81eId2ukqnLlTBbfcuY+9uJLiRcvtPvHdsHK+cfRHcHDWsyawjyy0WBcDI3lTP6TeIcFV+S5OmXx9bJg1048o8Cj0V8Jq2DVu09nL80up7OxHi+oal3P8AXB/IsZS8T/YOV65zvCcc7vfzPAK3ivWCz445zeH954BXOr6I8yfSfyz+jvCLP3fHytz1G+upLP3fHytz1E+usbPaQ0UXadIUIKLtekKhB7Ckk9o/Keer22/l4/oLzVRSe0flPPV7b/y8X0F5q0abqlyM+q6Y8yQsBTDMor1o8aiaE1pbluMqS3sbLLHIhSRQyngqukhaJ9uBjo+H5aOa3ao2t34qouRlLajTalGP8v0IY8ylXQ+PKPFU/bYXOLPge6CKia0LaxTOxHu1Q7cuBd9yPEJ7TbjXKO8CajbMIF6CNIeNvJHjqIWJ7tSpYkalqVblwIdyG+RGXur0hXYJFxal+Dhq5y3slkv3Y2pD0pTr+QUClpJRUdo9XW4OLrTHtM16cZLLWkeC7y4jvlNEpcRtw1Ux27Ci448NZrTFy3nn3IQWxlgGrDZ3pza7/M8ArZo+ArF5171uvp+CqdV0R5l/psUrs2vB3hdl7vTlbnqJ9dS2Xu+PlbnqJ9dY2eshooq16QoQUXa9IVCD2FLJ7RuU89WNtmUSQqkgYMgw0accKrpPaPynnrZWG4Vi+VWmY5tnMWXG+XrIYnA0rhj0mdcTgdNdwnKDqjmduM1SRR/qlr8/4KX6pa8T/BVzDuLZXudRZblmbxXcPUNPc3KqCIwrbOzgrHEnHjoyD+3eSXkht7DeKG4umDGOJVUklfouThXfmbnZ7Cvy1vt9pmv1W1+d8FL9VteJvgq5yrcOGfLmzHN80iyyETPbptAEFo2ZG8pmUa1OFNn3Ky6W/sbDKM5hv5bx2WTZA+7RF2y52WOPJTzE+z2Dy1vt9pT/AKpacTerS/U7Tib1a04/t7kDXPY03jhN0W6sQ7K7W3q2dnrMccaDy/8At80kuZfqWYxWNtlcvUPPhiGYhWDeUy7IwYU8xPs9g8tb7faUn6pacTerTxm9oOBvVq3v9z927aynuId44LiWKNnjhAXF2UYhRg516qpsryjLr21665zFLSTaK9U2GOA87SwqY37knRU+BzOzags0s1Oyr+BKM6sxwP6tSDPLMen6vy0rvdm3Sxlu7K/S7WDDrFUDUTxgnTU826eXW7KlxmqQuwDBXUKcD+1Xee/wXuKX5XDGWLapSVcOyhEM/seJ/V+WnjeGx4pPV+Wkm6kKZlFay3Jlt7iFpYZY8ASVK6DjtDDA0f8A0Tl340/1f8Ndx8xJVWXB0KbktFFpNzdVXAC/qOwA0CQni2flrO3Vwbm5lnI2TKxbDirX/wBE5d+NcfV/wVR7xZPa5U9utvI8nWhmbbw0YEAYYAVxfhfy5rlKR4Fulu6X7mW1mzT8S4Yis/5CPlbnqJ9dSWfu9OVueon11mZvQ2i7XpChKKtekKhBlNJ7R+U89bDfGTb3a3ZX0Lcj6kdY+T2j8p560288m1kWQr6MJ+ylSAr+2cnV5renjs3H1loX+3j9XvbbtxLN9lqW4UnV5jdnjtXHxihtyZNjeSBu5J9k1BJe7xy7W5CJ/wCzuD/mTVTf2+fq97LJuLrPsNRueS7W6aJ/38x+vLVXuY+xvHaNxbf2GoCezf8A36j/APsSf8w1sLnqczTefJluYoLm5uo5F61sBshItP1cNFYe1f8A3ir/APfE/wCZUe9bB94r5jwuPsrQFhmG4l/Z2M17HdW90tuu3IkTHaCjWdIw0VVZdks9/C06yJFEp2dp+E1bbqybGTZ8vpQD7L1XRv8A7blT96Oda7tpNuuNE37Cq9KSisjyuUoxrStKllHbLlWTXsMs8chuSuwEPDqwoLe5y+YRE/gLzmqRekvKKtd4327yM/ulHxmrHJStySWVRyrjxKI2XC/CTlnlPPKTpTdFbP0L1bgrf5Lp0G3dPhQHwV0S1lzBsns3sESR8Crh9WAJGjSOKuU3E+zdZQ3oJh8IArdZXFDmOTpHa3i2+YrI2KtKy4ricBsBuHHgFXSo440+Wa2qqxjvM9uMoy+WvzWpLCWWWE28HxL6e43ojgkeSCBY1Ri5BGIUDT51cl3vm276BBqSEH4WbxV0tlkyXJcxTMb+OW6uY9mGHrCzDQwwAbTp2uKuTZ9N1uYsfRRR8WPhrm419mSSjRyiqxVK7y23B/ftuTm2oSdJyzNVw3BFn7vTlbnqF9dS2fu9OVueon11lZuQ2iLdsGFD05H2dNQGV0ntG5Tz1dWm9N1b2kVq8EVwsI2UaQaQOKhmitZGLOmk68DhSFvY+gfWNSAg7z3Qvo7yKCKIohiaNR5LKxx8qpxvjcqS0VpbxvwOAcRQPZ7D0G9Y0uz2HoH1jUCpLY7zXlpbm3eKO5QuzjrBqZji3x17PvNcyT288VvDBJbMWUovS2hslW7mFQ9nsPQPrGl2ew9A+saCod/WNxtbYsrfb17WBxx5ddD2281xC88klvDcSXEnWuzrqOGGC9zRUPZ7D0G9Y0uzWHoH1jQVCLreq6ntZbaO3it1mGy7RjTs1X2mYy20ZiCq8ZOODcdEdmsPQb1jS7PYegfWNdJuLqnQiSUlRqpFLmryxtH1Ma7Qw2gNNPOdSt0oI27p007s9h6B9Y0uz2HoH1jXX3Z+I4+1b8IJdX89xLHKQFMXQUahpxoiPN5P+onfU+A0/s9h6DesaXZ7D0D6xpG7OLbUtu0StW5JJx2bBsmbtiSiEk+cxoCWWSaVpZOk2vDVo0VYdnsPQb1jSNvZcCH1jSd2c+p1XAmFqEOmOPEfaH+BQd1ueo211IzrgFUYKNAAqI1WztCpUqVCRUqVKgFSpUqAVKlSoBUqVKgFSpUqAVKlSoBUqVKgFSpUqAVKlSoD/9k\x3d";
cc = cc || {};
cc.defineGetterSetter = function(a, b, c, d, e, f) {
    if (a.__defineGetter__) c && a.__defineGetter__(b, c),
    d && a.__defineSetter__(b, d);
    else if (Object.defineProperty) {
        var g = {
            enumerable: !1,
            configurable: !0
        };
        c && (g.get = c);
        d && (g.set = d);
        Object.defineProperty(a, b, g)
    } else throw Error("browser does not support getters");
    if (!e && !f) for (var g = null != c,
    h = void 0 != d,
    k = Object.getOwnPropertyNames(a), m = 0; m < k.length; m++) {
        var r = k[m];
        if ((a.__lookupGetter__ ? !a.__lookupGetter__(r) : !Object.getOwnPropertyDescriptor(a, r)) && "function" === typeof a[r]) {
            var s = a[r];
            if (g && s === c && (e = r, !h || f)) break;
            if (h && s === d && (f = r, !g || e)) break
        }
    }
    a = a.constructor;
    e && (a.__getters__ || (a.__getters__ = {}), a.__getters__[e] = b);
    f && (a.__setters__ || (a.__setters__ = {}), a.__setters__[f] = b)
};
cc.clone = function(a) {
    var b = a.constructor ? new a.constructor: {},
    c;
    for (c in a) {
        var d = a[c];
        b[c] = "object" !== typeof d || !d || d instanceof cc.Node || d instanceof HTMLElement ? d: cc.clone(d)
    }
    return b
};
cc.inject = function(a, b) {
    for (var c in a) b[c] = a[c]
};
var ClassManager = function() {
    var a = 0 | 998 * Math.random(),
    b = 0 | 998 * Math.random();
    this.getNewID = function() {
        return a++
    };
    this.getNewInstanceId = function() {
        return b++
    }
},
classManager = new ClassManager; (function() {
    var a = /\b_super\b/;
    cc.Class = function() {};
    cc.Class.extend = function(b) {
        var c = this.prototype,
        d = Object.create(c),
        e = {
            writable: !0,
            enumerable: !1,
            configurable: !0
        },
        f;
        cc.game.config && cc.game.config[cc.game.CONFIG_KEY.exposeClassName] ? (f = "(function " + (b._className || "Class") + " (arg0, arg1, arg2, arg3, arg4, arg5) {\n", f += "    this.__instanceId \x3d classManager.getNewInstanceId();\n    if (this.ctor) {\n", f += "        switch (arguments.length) {\n", f += "        case 0: this.ctor(); break;\n", f += "        case 1: this.ctor(arg0); break;\n", f += "        case 3: this.ctor(arg0, arg1, arg2); break;\n", f += "        case 4: this.ctor(arg0, arg1, arg2, arg3); break;\n", f += "        case 5: this.ctor(arg0, arg1, arg2, arg3, arg4); break;\n", f += "        default: this.ctor.apply(this, arguments);\n", f += "        }\n", f += "    }\n", f += "})", f = eval(f)) : f = function(a, b, c, d, e) {
            this.__instanceId = classManager.getNewInstanceId();
            if (this.ctor) switch (arguments.length) {
            case 0:
                this.ctor();
                break;
            case 1:
                this.ctor(a);
                break;
            case 2:
                this.ctor(a, b);
                break;
            case 3:
                this.ctor(a, b, c);
                break;
            case 4:
                this.ctor(a, b, c, d);
                break;
            case 5:
                this.ctor(a, b, c, d, e);
                break;
            default:
                this.ctor.apply(this, arguments)
            }
        };
        e.value = classManager.getNewID();
        Object.defineProperty(d, "__pid", e);
        f.prototype = d;
        e.value = f;
        Object.defineProperty(d, "constructor", e);
        this.__getters__ && (f.__getters__ = cc.clone(this.__getters__));
        this.__setters__ && (f.__setters__ = cc.clone(this.__setters__));
        for (var g = 0,
        h = arguments.length; g < h; ++g) {
            var k = arguments[g],
            m;
            for (m in k) {
                var r = "function" === typeof k[m],
                s = "function" === typeof c[m],
                t = a.test(k[m]);
                r && s && t ? (e.value = function(a, b) {
                    return function() {
                        var d = this._super;
                        this._super = c[a];
                        var e = b.apply(this, arguments);
                        this._super = d;
                        return e
                    }
                } (m, k[m]), Object.defineProperty(d, m, e)) : r ? (e.value = k[m], Object.defineProperty(d, m, e)) : d[m] = k[m];
                if (r) {
                    var p, v;
                    if (this.__getters__ && this.__getters__[m]) {
                        var r = this.__getters__[m],
                        u;
                        for (u in this.__setters__) if (this.__setters__[u] === r) {
                            v = u;
                            break
                        }
                        cc.defineGetterSetter(d, r, k[m], k[v] ? k[v] : d[v], m, v)
                    }
                    if (this.__setters__ && this.__setters__[m]) {
                        r = this.__setters__[m];
                        for (u in this.__getters__) if (this.__getters__[u] === r) {
                            p = u;
                            break
                        }
                        cc.defineGetterSetter(d, r, k[p] ? k[p] : d[p], k[m], p, m)
                    }
                }
            }
        }
        f.extend = cc.Class.extend;
        f.implement = function(a) {
            for (var b in a) d[b] = a[b]
        };
        return f
    }
})();
cc = cc || {};
cc._tmp = cc._tmp || {};
cc.associateWithNative = function(a, b) {};
cc.KEY = {
    none: 0,
    back: 6,
    menu: 18,
    backspace: 8,
    tab: 9,
    enter: 13,
    shift: 16,
    ctrl: 17,
    alt: 18,
    pause: 19,
    capslock: 20,
    escape: 27,
    space: 32,
    pageup: 33,
    pagedown: 34,
    end: 35,
    home: 36,
    left: 37,
    up: 38,
    right: 39,
    down: 40,
    select: 41,
    insert: 45,
    Delete: 46,
    0 : 48,
    1 : 49,
    2 : 50,
    3 : 51,
    4 : 52,
    5 : 53,
    6 : 54,
    7 : 55,
    8 : 56,
    9 : 57,
    a: 65,
    b: 66,
    c: 67,
    d: 68,
    e: 69,
    f: 70,
    g: 71,
    h: 72,
    i: 73,
    j: 74,
    k: 75,
    l: 76,
    m: 77,
    n: 78,
    o: 79,
    p: 80,
    q: 81,
    r: 82,
    s: 83,
    t: 84,
    u: 85,
    v: 86,
    w: 87,
    x: 88,
    y: 89,
    z: 90,
    num0: 96,
    num1: 97,
    num2: 98,
    num3: 99,
    num4: 100,
    num5: 101,
    num6: 102,
    num7: 103,
    num8: 104,
    num9: 105,
    "*": 106,
    "+": 107,
    "-": 109,
    numdel: 110,
    "/": 111,
    f1: 112,
    f2: 113,
    f3: 114,
    f4: 115,
    f5: 116,
    f6: 117,
    f7: 118,
    f8: 119,
    f9: 120,
    f10: 121,
    f11: 122,
    f12: 123,
    numlock: 144,
    scrolllock: 145,
    ";": 186,
    semicolon: 186,
    equal: 187,
    "\x3d": 187,
    ",": 188,
    comma: 188,
    dash: 189,
    ".": 190,
    period: 190,
    forwardslash: 191,
    grave: 192,
    "[": 219,
    openbracket: 219,
    backslash: 220,
    "]": 221,
    closebracket: 221,
    quote: 222,
    dpadLeft: 1E3,
    dpadRight: 1001,
    dpadUp: 1003,
    dpadDown: 1004,
    dpadCenter: 1005
};
cc.FMT_JPG = 0;
cc.FMT_PNG = 1;
cc.FMT_TIFF = 2;
cc.FMT_RAWDATA = 3;
cc.FMT_WEBP = 4;
cc.FMT_UNKNOWN = 5;
cc.getImageFormatByData = function(a) {
    return 8 < a.length && 137 === a[0] && 80 === a[1] && 78 === a[2] && 71 === a[3] && 13 === a[4] && 10 === a[5] && 26 === a[6] && 10 === a[7] ? cc.FMT_PNG: 2 < a.length && (73 === a[0] && 73 === a[1] || 77 === a[0] && 77 === a[1] || 255 === a[0] && 216 === a[1]) ? cc.FMT_TIFF: cc.FMT_UNKNOWN
};
cc.Point = function(a, b) {
    this.x = a || 0;
    this.y = b || 0
};
cc.p = function(a, b) {
    return void 0 === a ? {
        x: 0,
        y: 0
    }: void 0 === b ? {
        x: a.x,
        y: a.y
    }: {
        x: a,
        y: b
    }
};
cc.pointEqualToPoint = function(a, b) {
    return a && b && a.x === b.x && a.y === b.y
};
cc.Size = function(a, b) {
    this.width = a || 0;
    this.height = b || 0
};
cc.size = function(a, b) {
    return void 0 === a ? {
        width: 0,
        height: 0
    }: void 0 === b ? {
        width: a.width,
        height: a.height
    }: {
        width: a,
        height: b
    }
};
cc.sizeEqualToSize = function(a, b) {
    return a && b && a.width === b.width && a.height === b.height
};
cc.Rect = function(a, b, c, d) {
    this.x = a || 0;
    this.y = b || 0;
    this.width = c || 0;
    this.height = d || 0
};
cc.rect = function(a, b, c, d) {
    return void 0 === a ? {
        x: 0,
        y: 0,
        width: 0,
        height: 0
    }: void 0 === b ? {
        x: a.x,
        y: a.y,
        width: a.width,
        height: a.height
    }: {
        x: a,
        y: b,
        width: c,
        height: d
    }
};
cc.rectEqualToRect = function(a, b) {
    return a && b && a.x === b.x && a.y === b.y && a.width === b.width && a.height === b.height
};
cc._rectEqualToZero = function(a) {
    return a && 0 === a.x && 0 === a.y && 0 === a.width && 0 === a.height
};
cc.rectContainsRect = function(a, b) {
    return a && b ? !(a.x >= b.x || a.y >= b.y || a.x + a.width <= b.x + b.width || a.y + a.height <= b.y + b.height) : !1
};
cc.rectGetMaxX = function(a) {
    return a.x + a.width
};
cc.rectGetMidX = function(a) {
    return a.x + a.width / 2
};
cc.rectGetMinX = function(a) {
    return a.x
};
cc.rectGetMaxY = function(a) {
    return a.y + a.height
};
cc.rectGetMidY = function(a) {
    return a.y + a.height / 2
};
cc.rectGetMinY = function(a) {
    return a.y
};
cc.rectContainsPoint = function(a, b) {
    return b.x >= cc.rectGetMinX(a) && b.x <= cc.rectGetMaxX(a) && b.y >= cc.rectGetMinY(a) && b.y <= cc.rectGetMaxY(a)
};
cc.rectIntersectsRect = function(a, b) {
    var c = a.y + a.height,
    d = b.x + b.width,
    e = b.y + b.height;
    return ! (a.x + a.width < b.x || d < a.x || c < b.y || e < a.y)
};
cc.rectOverlapsRect = function(a, b) {
    return ! (a.x + a.width < b.x || b.x + b.width < a.x || a.y + a.height < b.y || b.y + b.height < a.y)
};
cc.rectUnion = function(a, b) {
    var c = cc.rect(0, 0, 0, 0);
    c.x = Math.min(a.x, b.x);
    c.y = Math.min(a.y, b.y);
    c.width = Math.max(a.x + a.width, b.x + b.width) - c.x;
    c.height = Math.max(a.y + a.height, b.y + b.height) - c.y;
    return c
};
cc.rectIntersection = function(a, b) {
    var c = cc.rect(Math.max(cc.rectGetMinX(a), cc.rectGetMinX(b)), Math.max(cc.rectGetMinY(a), cc.rectGetMinY(b)), 0, 0);
    c.width = Math.min(cc.rectGetMaxX(a), cc.rectGetMaxX(b)) - cc.rectGetMinX(c);
    c.height = Math.min(cc.rectGetMaxY(a), cc.rectGetMaxY(b)) - cc.rectGetMinY(c);
    return c
};
cc.SAXParser = cc.Class.extend({
    _parser: null,
    _isSupportDOMParser: null,
    ctor: function() {
        window.DOMParser ? (this._isSupportDOMParser = !0, this._parser = new DOMParser) : this._isSupportDOMParser = !1
    },
    parse: function(a) {
        return this._parseXML(a)
    },
    _parseXML: function(a) {
        var b;
        this._isSupportDOMParser ? b = this._parser.parseFromString(a, "text/xml") : (b = new ActiveXObject("Microsoft.XMLDOM"), b.async = "false", b.loadXML(a));
        return b
    }
});
cc.PlistParser = cc.SAXParser.extend({
    parse: function(a) {
        a = this._parseXML(a).documentElement;
        if ("plist" !== a.tagName) return cc.warn("Not a plist file!"),
        {};
        for (var b = null,
        c = 0,
        d = a.childNodes.length; c < d && (b = a.childNodes[c], 1 !== b.nodeType); c++);
        return this._parseNode(b)
    },
    _parseNode: function(a) {
        var b = null,
        c = a.tagName;
        if ("dict" === c) b = this._parseDict(a);
        else if ("array" === c) b = this._parseArray(a);
        else if ("string" === c) if (1 === a.childNodes.length) b = a.firstChild.nodeValue;
        else for (b = "", c = 0; c < a.childNodes.length; c++) b += a.childNodes[c].nodeValue;
        else "false" === c ? b = !1 : "true" === c ? b = !0 : "real" === c ? b = parseFloat(a.firstChild.nodeValue) : "integer" === c && (b = parseInt(a.firstChild.nodeValue, 10));
        return b
    },
    _parseArray: function(a) {
        for (var b = [], c = 0, d = a.childNodes.length; c < d; c++) {
            var e = a.childNodes[c];
            1 === e.nodeType && b.push(this._parseNode(e))
        }
        return b
    },
    _parseDict: function(a) {
        for (var b = {},
        c = null,
        d = 0,
        e = a.childNodes.length; d < e; d++) {
            var f = a.childNodes[d];
            1 === f.nodeType && ("key" === f.tagName ? c = f.firstChild.nodeValue: b[c] = this._parseNode(f))
        }
        return b
    }
});
cc.saxParser = new cc.SAXParser;
cc.plistParser = new cc.PlistParser;
cc._txtLoader = {
    load: function(a, b, c, d) {
        cc.loader.loadTxt(a, d)
    }
};
cc.loader.register(["txt", "xml", "vsh", "fsh", "atlas"], cc._txtLoader);
cc._jsonLoader = {
    load: function(a, b, c, d) {
        cc.loader.loadJson(a, d)
    }
};
cc.loader.register(["json", "ExportJson"], cc._jsonLoader);
cc._jsLoader = {
    load: function(a, b, c, d) {
        cc.loader.loadJs(a, d)
    }
};
cc.loader.register(["js"], cc._jsLoader);
cc._imgLoader = {
    load: function(a, b, c, d) {
        c = cc.loader.isLoading(a) ?
        function(a, c) {
            if (a) return d(a);
            var g = cc.textureCache.getTextureForKey(b) || cc.textureCache.handleLoadedTexture(b, c);
            d(null, g)
        }: function(a, c) {
            if (a) return d(a);
            var g = cc.textureCache.handleLoadedTexture(b, c);
            d(null, g)
        };
        cc.loader.loadImg(a, c)
    }
};
cc.loader.register("png jpg bmp jpeg gif ico tiff webp".split(" "), cc._imgLoader);
cc._serverImgLoader = {
    load: function(a, b, c, d) {
        cc._imgLoader.load(c.src, b, c, d)
    }
};
cc.loader.register(["serverImg"], cc._serverImgLoader);
cc._plistLoader = {
    load: function(a, b, c, d) {
        cc.loader.loadTxt(a,
        function(a, b) {
            if (a) return d(a);
            d(null, cc.plistParser.parse(b))
        })
    }
};
cc.loader.register(["plist"], cc._plistLoader);
cc._fontLoader = {
    TYPE: {
        ".eot": "embedded-opentype",
        ".ttf": "truetype",
        ".ttc": "truetype",
        ".woff": "woff",
        ".svg": "svg"
    },
    _loadFont: function(a, b, c) {
        var d = document,
        e = cc.path,
        f = this.TYPE,
        g = document.createElement("style");
        g.type = "text/css";
        d.body.appendChild(g);
        var h = "",
        h = isNaN(a - 0) ? h + ("@font-face { font-family:" + a + "; src:") : h + ("@font-face { font-family:'" + a + "'; src:");
        if (b instanceof Array) for (var k = 0,
        m = b.length; k < m; k++) c = e.extname(b[k]).toLowerCase(),
        h += "url('" + b[k] + "') format('" + f[c] + "')",
        h += k === m - 1 ? ";": ",";
        else c = c.toLowerCase(),
        h += "url('" + b + "') format('" + f[c] + "');";
        g.textContent += h + "}";
        b = document.createElement("div");
        c = b.style;
        c.fontFamily = a;
        b.innerHTML = ".";
        c.position = "absolute";
        c.left = "-100px";
        c.top = "-100px";
        d.body.appendChild(b)
    },
    load: function(a, b, c, d) {
        b = c.type;
        a = c.name;
        b = c.srcs;
        cc.isString(c) ? (b = cc.path.extname(c), a = cc.path.basename(c, b), this._loadFont(a, c, b)) : this._loadFont(a, b);
        document.fonts ? document.fonts.load("1em " + a).then(function() {
            d(null, !0)
        },
        function(a) {
            d(a)
        }) : d(null, !0)
    }
};
cc.loader.register("font eot ttf woff svg ttc".split(" "), cc._fontLoader);
cc._binaryLoader = {
    load: function(a, b, c, d) {
        cc.loader.loadBinary(a, d)
    }
};
cc._csbLoader = {
    load: function(a, b, c, d) {
        cc.loader.loadCsb(a, d)
    }
};
cc.loader.register(["csb"], cc._csbLoader);
window.CocosEngine = cc.ENGINE_VERSION = "Cocos2d-JS v3.16";
cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL = 0;
cc.DIRECTOR_STATS_POSITION = cc.p(0, 0);
cc.DIRECTOR_FPS_INTERVAL = 0.5;
cc.COCOSNODE_RENDER_SUBPIXEL = 1;
cc.SPRITEBATCHNODE_RENDER_SUBPIXEL = 1;
cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA = 1;
cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP = 0;
cc.TEXTURE_ATLAS_USE_VAO = 0;
cc.TEXTURE_NPOT_SUPPORT = 0;
cc.RETINA_DISPLAY_FILENAME_SUFFIX = "-hd";
cc.USE_LA88_LABELS = 1;
cc.SPRITE_DEBUG_DRAW = 0;
cc.SPRITEBATCHNODE_DEBUG_DRAW = 0;
cc.LABELBMFONT_DEBUG_DRAW = 0;
cc.LABELATLAS_DEBUG_DRAW = 0;
cc.DRAWNODE_TOTAL_VERTICES = 2E4;
cc.DEFAULT_ENGINE = cc.ENGINE_VERSION + "-canvas";
cc.ENABLE_STACKABLE_ACTIONS = 1;
cc.ENABLE_GL_STATE_CACHE = 1;
cc.$ = function(a) {
    var b = this === cc ? document: this;
    if (a = a instanceof HTMLElement ? a: b.querySelector(a)) a.find = a.find || cc.$,
    a.hasClass = a.hasClass ||
    function(a) {
        return this.className.match(RegExp("(\\s|^)" + a + "(\\s|$)"))
    },
    a.addClass = a.addClass ||
    function(a) {
        this.hasClass(a) || (this.className && (this.className += " "), this.className += a);
        return this
    },
    a.removeClass = a.removeClass ||
    function(a) {
        this.hasClass(a) && (this.className = this.className.replace(a, ""));
        return this
    },
    a.remove = a.remove ||
    function() {
        this.parentNode && this.parentNode.removeChild(this);
        return this
    },
    a.appendTo = a.appendTo ||
    function(a) {
        a.appendChild(this);
        return this
    },
    a.prependTo = a.prependTo ||
    function(a) {
        a.childNodes[0] ? a.insertBefore(this, a.childNodes[0]) : a.appendChild(this);
        return this
    },
    a.transforms = a.transforms ||
    function() {
        this.style[cc.$.trans] = cc.$.translate(this.position) + cc.$.rotate(this.rotation) + cc.$.scale(this.scale) + cc.$.skew(this.skew);
        return this
    },
    a.position = a.position || {
        x: 0,
        y: 0
    },
    a.rotation = a.rotation || 0,
    a.scale = a.scale || {
        x: 1,
        y: 1
    },
    a.skew = a.skew || {
        x: 0,
        y: 0
    },
    a.translates = function(a, b) {
        this.position.x = a;
        this.position.y = b;
        this.transforms();
        return this
    },
    a.rotate = function(a) {
        this.rotation = a;
        this.transforms();
        return this
    },
    a.resize = function(a, b) {
        this.scale.x = a;
        this.scale.y = b;
        this.transforms();
        return this
    },
    a.setSkew = function(a, b) {
        this.skew.x = a;
        this.skew.y = b;
        this.transforms();
        return this
    };
    return a
};
switch (cc.sys.browserType) {
case cc.sys.BROWSER_TYPE_FIREFOX:
    cc.$.pfx = "Moz";
    cc.$.hd = !0;
    break;
case cc.sys.BROWSER_TYPE_CHROME:
case cc.sys.BROWSER_TYPE_SAFARI:
    cc.$.pfx = "webkit";
    cc.$.hd = !0;
    break;
case cc.sys.BROWSER_TYPE_OPERA:
    cc.$.pfx = "O";
    cc.$.hd = !1;
    break;
case cc.sys.BROWSER_TYPE_IE:
    cc.$.pfx = "ms";
    cc.$.hd = !1;
    break;
default:
    cc.$.pfx = "webkit",
    cc.$.hd = !0
}
cc.$.trans = cc.$.pfx + "Transform";
cc.$.translate = cc.$.hd ?
function(a) {
    return "translate3d(" + a.x + "px, " + a.y + "px, 0) "
}: function(a) {
    return "translate(" + a.x + "px, " + a.y + "px) "
};
cc.$.rotate = cc.$.hd ?
function(a) {
    return "rotateZ(" + a + "deg) "
}: function(a) {
    return "rotate(" + a + "deg) "
};
cc.$.scale = function(a) {
    return "scale(" + a.x + ", " + a.y + ") "
};
cc.$.skew = function(a) {
    return "skewX(" + -a.x + "deg) skewY(" + a.y + "deg)"
};
cc.$new = function(a) {
    return cc.$(document.createElement(a))
};
cc.$.findpos = function(a) {
    var b = 0,
    c = 0;
    do b += a.offsetLeft,
    c += a.offsetTop;
    while (a = a.offsetParent);
    return {
        x: b,
        y: c
    }
};
cc.INVALID_INDEX = -1;
cc.PI = Math.PI;
cc.FLT_MAX = parseFloat("3.402823466e+38F");
cc.FLT_MIN = parseFloat("1.175494351e-38F");
cc.RAD = cc.PI / 180;
cc.DEG = 180 / cc.PI;
cc.UINT_MAX = 4294967295;
cc.swap = function(a, b, c) {
    if (!cc.isObject(c) || cc.isUndefined(c.x) || cc.isUndefined(c.y)) cc.log(cc._LogInfos.swap);
    else {
        var d = c[a];
        c[a] = c[b];
        c[b] = d
    }
};
cc.lerp = function(a, b, c) {
    return a + (b - a) * c
};
cc.rand = function() {
    return 16777215 * Math.random()
};
cc.randomMinus1To1 = function() {
    return 2 * (Math.random() - 0.5)
};
cc.random0To1 = Math.random;
cc.degreesToRadians = function(a) {
    return a * cc.RAD
};
cc.radiansToDegrees = function(a) {
    return a * cc.DEG
};
cc.radiansToDegress = function(a) {
    cc.log(cc._LogInfos.radiansToDegress);
    return a * cc.DEG
};
cc.REPEAT_FOREVER = Number.MAX_VALUE - 1;
cc.nodeDrawSetup = function(a) {
    a._shaderProgram && (a._glProgramState.apply(), a._shaderProgram.setUniformForModelViewAndProjectionMatrixWithMat4())
};
cc.enableDefaultGLStates = function() {};
cc.disableDefaultGLStates = function() {};
cc.incrementGLDraws = function(a) {
    cc.g_NumberOfDraws += a
};
cc.FLT_EPSILON = 1.192092896E-7;
cc.contentScaleFactor = function() {
    return cc.director._contentScaleFactor
};
cc.pointPointsToPixels = function(a) {
    var b = cc.contentScaleFactor();
    return cc.p(a.x * b, a.y * b)
};
cc.pointPixelsToPoints = function(a) {
    var b = cc.contentScaleFactor();
    return cc.p(a.x / b, a.y / b)
};
cc._pointPixelsToPointsOut = function(a, b) {
    var c = cc.contentScaleFactor();
    b.x = a.x / c;
    b.y = a.y / c
};
cc.sizePointsToPixels = function(a) {
    var b = cc.contentScaleFactor();
    return cc.size(a.width * b, a.height * b)
};
cc.sizePixelsToPoints = function(a) {
    var b = cc.contentScaleFactor();
    return cc.size(a.width / b, a.height / b)
};
cc._sizePixelsToPointsOut = function(a, b) {
    var c = cc.contentScaleFactor();
    b.width = a.width / c;
    b.height = a.height / c
};
cc.rectPixelsToPoints = function(a) {
    var b = cc.contentScaleFactor();
    return cc.rect(a.x / b, a.y / b, a.width / b, a.height / b)
};
cc.rectPointsToPixels = function(a) {
    var b = cc.contentScaleFactor();
    return cc.rect(a.x * b, a.y * b, a.width * b, a.height * b)
};
cc.ONE = 1;
cc.ZERO = 0;
cc.SRC_ALPHA = 770;
cc.SRC_ALPHA_SATURATE = 776;
cc.SRC_COLOR = 768;
cc.DST_ALPHA = 772;
cc.DST_COLOR = 774;
cc.ONE_MINUS_SRC_ALPHA = 771;
cc.ONE_MINUS_SRC_COLOR = 769;
cc.ONE_MINUS_DST_ALPHA = 773;
cc.ONE_MINUS_DST_COLOR = 775;
cc.ONE_MINUS_CONSTANT_ALPHA = 32772;
cc.ONE_MINUS_CONSTANT_COLOR = 32770;
cc.LINEAR = 9729;
cc.REPEAT = 10497;
cc.CLAMP_TO_EDGE = 33071;
cc.MIRRORED_REPEAT = 33648;
cc.BLEND_SRC = cc.SRC_ALPHA;
cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,
function() {
    cc._renderType === cc.game.RENDER_TYPE_WEBGL && cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA && (cc.BLEND_SRC = cc.ONE)
});
cc.BLEND_DST = cc.ONE_MINUS_SRC_ALPHA;
cc.checkGLErrorDebug = function() {
    if (cc.renderMode === cc.game.RENDER_TYPE_WEBGL) {
        var a = cc._renderContext.getError();
        a && cc.log(cc._LogInfos.checkGLErrorDebug, a)
    }
};
cc.ORIENTATION_PORTRAIT = 1;
cc.ORIENTATION_LANDSCAPE = 2;
cc.ORIENTATION_AUTO = 3;
cc.CONCURRENCY_HTTP_REQUEST_COUNT = cc.sys.isMobile ? 20 : 0;
cc.BATCH_VERTEX_COUNT = 2E3;
cc.VERTEX_ATTRIB_FLAG_NONE = 0;
cc.VERTEX_ATTRIB_FLAG_POSITION = 1;
cc.VERTEX_ATTRIB_FLAG_COLOR = 2;
cc.VERTEX_ATTRIB_FLAG_TEX_COORDS = 4;
cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX = cc.VERTEX_ATTRIB_FLAG_POSITION | cc.VERTEX_ATTRIB_FLAG_COLOR | cc.VERTEX_ATTRIB_FLAG_TEX_COORDS;
cc.GL_ALL = 0;
cc.VERTEX_ATTRIB_POSITION = 0;
cc.VERTEX_ATTRIB_COLOR = 1;
cc.VERTEX_ATTRIB_TEX_COORDS = 2;
cc.VERTEX_ATTRIB_MAX = 7;
cc.UNIFORM_PMATRIX = 0;
cc.UNIFORM_MVMATRIX = 1;
cc.UNIFORM_MVPMATRIX = 2;
cc.UNIFORM_TIME = 3;
cc.UNIFORM_SINTIME = 4;
cc.UNIFORM_COSTIME = 5;
cc.UNIFORM_RANDOM01 = 6;
cc.UNIFORM_SAMPLER = 7;
cc.UNIFORM_MAX = 8;
cc.SHADER_POSITION_TEXTURECOLOR = "ShaderPositionTextureColor";
cc.SHADER_SPRITE_POSITION_TEXTURECOLOR = "ShaderSpritePositionTextureColor";
cc.SHADER_SPRITE_POSITION_TEXTURECOLOR_GRAY = "ShaderSpritePositionTextureColorGray";
cc.SHADER_POSITION_TEXTURECOLORALPHATEST = "ShaderPositionTextureColorAlphaTest";
cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST = "ShaderSpritePositionTextureColorAlphaTest";
cc.SHADER_POSITION_COLOR = "ShaderPositionColor";
cc.SHADER_SPRITE_POSITION_COLOR = "ShaderSpritePositionColor";
cc.SHADER_POSITION_TEXTURE = "ShaderPositionTexture";
cc.SHADER_POSITION_TEXTURE_UCOLOR = "ShaderPositionTextureUColor";
cc.SHADER_POSITION_TEXTUREA8COLOR = "ShaderPositionTextureA8Color";
cc.SHADER_POSITION_UCOLOR = "ShaderPositionUColor";
cc.SHADER_POSITION_LENGTHTEXTURECOLOR = "ShaderPositionLengthTextureColor";
cc.UNIFORM_PMATRIX_S = "CC_PMatrix";
cc.UNIFORM_MVMATRIX_S = "CC_MVMatrix";
cc.UNIFORM_MVPMATRIX_S = "CC_MVPMatrix";
cc.UNIFORM_TIME_S = "CC_Time";
cc.UNIFORM_SINTIME_S = "CC_SinTime";
cc.UNIFORM_COSTIME_S = "CC_CosTime";
cc.UNIFORM_RANDOM01_S = "CC_Random01";
cc.UNIFORM_SAMPLER_S = "CC_Texture0";
cc.UNIFORM_ALPHA_TEST_VALUE_S = "CC_alpha_value";
cc.ATTRIBUTE_NAME_COLOR = "a_color";
cc.ATTRIBUTE_NAME_POSITION = "a_position";
cc.ATTRIBUTE_NAME_TEX_COORD = "a_texCoord";
cc.ATTRIBUTE_NAME_MVMAT = "a_mvMatrix";
cc.ITEM_SIZE = 32;
cc.CURRENT_ITEM = 3233828865;
cc.ZOOM_ACTION_TAG = 3233828866;
cc.NORMAL_TAG = 8801;
cc.SELECTED_TAG = 8802;
cc.DISABLE_TAG = 8803;
cc.arrayVerifyType = function(a, b) {
    if (a && 0 < a.length) for (var c = 0; c < a.length; c++) if (! (a[c] instanceof b)) return cc.log("element type is wrong!"),
    !1;
    return ! 0
};
cc.arrayRemoveObject = function(a, b) {
    for (var c = 0,
    d = a.length; c < d; c++) if (a[c] === b) {
        a.splice(c, 1);
        break
    }
};
cc.arrayRemoveArray = function(a, b) {
    for (var c = 0,
    d = b.length; c < d; c++) cc.arrayRemoveObject(a, b[c])
};
cc.arrayAppendObjectsToIndex = function(a, b, c) {
    a.splice.apply(a, [c, 0].concat(b));
    return a
};
cc.copyArray = function(a) {
    var b, c = a.length,
    d = Array(c);
    for (b = 0; b < c; b += 1) d[b] = a[b];
    return d
};
cc.Color = function(a, b, c, d) {
    this._val = ((a || 0) << 24 >>> 0) + ((b || 0) << 16) + ((c || 0) << 8) + ("number" === typeof d ? d: 255)
};
_p = cc.Color.prototype;
_p._getR = function() {
    return (this._val & 4278190080) >>> 24
};
_p._setR = function(a) {
    this._val = this._val & 16777215 | a << 24 >>> 0
};
_p._getG = function() {
    return (this._val & 16711680) >> 16
};
_p._setG = function(a) {
    this._val = this._val & 4278255615 | a << 16
};
_p._getB = function() {
    return (this._val & 65280) >> 8
};
_p._setB = function(a) {
    this._val = this._val & 4294902015 | a << 8
};
_p._getA = function() {
    return this._val & 255
};
_p._setA = function(a) {
    this._val = this._val & 4294967040 | a
};
cc.defineGetterSetter(_p, "r", _p._getR, _p._setR);
cc.defineGetterSetter(_p, "g", _p._getG, _p._setG);
cc.defineGetterSetter(_p, "b", _p._getB, _p._setB);
cc.defineGetterSetter(_p, "a", _p._getA, _p._setA);
cc.color = function(a, b, c, d) {
    return void 0 === a ? new cc.Color(0, 0, 0, 255) : "object" === typeof a ? new cc.Color(a.r, a.g, a.b, null == a.a ? 255 : a.a) : "string" === typeof a ? cc.hexToColor(a) : new cc.Color(a, b, c, null == d ? 255 : d)
};
cc.colorEqual = function(a, b) {
    return a.r === b.r && a.g === b.g && a.b === b.b
};
cc.Acceleration = function(a, b, c, d) {
    this.x = a || 0;
    this.y = b || 0;
    this.z = c || 0;
    this.timestamp = d || 0
};
cc.Vertex2F = function(a, b, c, d) {
    this._arrayBuffer = c || new ArrayBuffer(cc.Vertex2F.BYTES_PER_ELEMENT);
    this._offset = d || 0;
    this._view = new Float32Array(this._arrayBuffer, this._offset, 2);
    this._view[0] = a || 0;
    this._view[1] = b || 0
};
cc.Vertex2F.BYTES_PER_ELEMENT = 8;
_p = cc.Vertex2F.prototype;
_p._getX = function() {
    return this._view[0]
};
_p._setX = function(a) {
    this._view[0] = a
};
_p._getY = function() {
    return this._view[1]
};
_p._setY = function(a) {
    this._view[1] = a
};
cc.defineGetterSetter(_p, "x", _p._getX, _p._setX);
cc.defineGetterSetter(_p, "y", _p._getY, _p._setY);
cc.Vertex3F = function(a, b, c, d, e) {
    this._arrayBuffer = d || new ArrayBuffer(cc.Vertex3F.BYTES_PER_ELEMENT);
    this._offset = e || 0;
    this._view = new Float32Array(this._arrayBuffer, this._offset, 3);
    this._view[0] = a || 0;
    this._view[1] = b || 0;
    this._view[2] = c || 0
};
cc.Vertex3F.BYTES_PER_ELEMENT = 12;
_p = cc.Vertex3F.prototype;
_p._getX = function() {
    return this._view[0]
};
_p._setX = function(a) {
    this._view[0] = a
};
_p._getY = function() {
    return this._view[1]
};
_p._setY = function(a) {
    this._view[1] = a
};
_p._getZ = function() {
    return this._view[2]
};
_p._setZ = function(a) {
    this._view[2] = a
};
cc.defineGetterSetter(_p, "x", _p._getX, _p._setX);
cc.defineGetterSetter(_p, "y", _p._getY, _p._setY);
cc.defineGetterSetter(_p, "z", _p._getZ, _p._setZ);
cc.Tex2F = function(a, b, c, d) {
    this._arrayBuffer = c || new ArrayBuffer(cc.Tex2F.BYTES_PER_ELEMENT);
    this._offset = d || 0;
    this._view = new Float32Array(this._arrayBuffer, this._offset, 2);
    this._view[0] = a || 0;
    this._view[1] = b || 0
};
cc.Tex2F.BYTES_PER_ELEMENT = 8;
_p = cc.Tex2F.prototype;
_p._getU = function() {
    return this._view[0]
};
_p._setU = function(a) {
    this._view[0] = a
};
_p._getV = function() {
    return this._view[1]
};
_p._setV = function(a) {
    this._view[1] = a
};
cc.defineGetterSetter(_p, "u", _p._getU, _p._setU);
cc.defineGetterSetter(_p, "v", _p._getV, _p._setV);
cc.Quad2 = function(a, b, c, d, e, f) {
    this._arrayBuffer = e || new ArrayBuffer(cc.Quad2.BYTES_PER_ELEMENT);
    this._offset = f || 0;
    e = this._arrayBuffer;
    f = this._offset;
    var g = cc.Vertex2F.BYTES_PER_ELEMENT;
    this._tl = a ? new cc.Vertex2F(a.x, a.y, e, f) : new cc.Vertex2F(0, 0, e, f);
    f += g;
    this._tr = b ? new cc.Vertex2F(b.x, b.y, e, f) : new cc.Vertex2F(0, 0, e, f);
    f += g;
    this._bl = c ? new cc.Vertex2F(c.x, c.y, e, f) : new cc.Vertex2F(0, 0, e, f);
    f += g;
    this._br = d ? new cc.Vertex2F(d.x, d.y, e, f) : new cc.Vertex2F(0, 0, e, f)
};
cc.Quad2.BYTES_PER_ELEMENT = 32;
_p = cc.Quad2.prototype;
_p._getTL = function() {
    return this._tl
};
_p._setTL = function(a) {
    this._tl._view[0] = a.x;
    this._tl._view[1] = a.y
};
_p._getTR = function() {
    return this._tr
};
_p._setTR = function(a) {
    this._tr._view[0] = a.x;
    this._tr._view[1] = a.y
};
_p._getBL = function() {
    return this._bl
};
_p._setBL = function(a) {
    this._bl._view[0] = a.x;
    this._bl._view[1] = a.y
};
_p._getBR = function() {
    return this._br
};
_p._setBR = function(a) {
    this._br._view[0] = a.x;
    this._br._view[1] = a.y
};
cc.defineGetterSetter(_p, "tl", _p._getTL, _p._setTL);
cc.defineGetterSetter(_p, "tr", _p._getTR, _p._setTR);
cc.defineGetterSetter(_p, "bl", _p._getBL, _p._setBL);
cc.defineGetterSetter(_p, "br", _p._getBR, _p._setBR);
cc.Quad3 = function(a, b, c, d, e, f) {
    this._arrayBuffer = e || new ArrayBuffer(cc.Quad3.BYTES_PER_ELEMENT);
    this._offset = f || 0;
    e = this._arrayBuffer;
    f = this._offset;
    var g = cc.Vertex3F.BYTES_PER_ELEMENT;
    this.bl = a ? new cc.Vertex3F(a.x, a.y, a.z, e, f) : new cc.Vertex3F(0, 0, 0, e, f);
    f += g;
    this.br = b ? new cc.Vertex3F(b.x, b.y, b.z, e, f) : new cc.Vertex3F(0, 0, 0, e, f);
    f += g;
    this.tl = c ? new cc.Vertex3F(c.x, c.y, c.z, e, f) : new cc.Vertex3F(0, 0, 0, e, f);
    f += g;
    this.tr = d ? new cc.Vertex3F(d.x, d.y, d.z, e, f) : new cc.Vertex3F(0, 0, 0, e, f)
};
cc.Quad3.BYTES_PER_ELEMENT = 48;
cc.V3F_C4B_T2F = function(a, b, c, d, e) {
    this._arrayBuffer = d || new ArrayBuffer(cc.V3F_C4B_T2F.BYTES_PER_ELEMENT);
    this._offset = e || 0;
    d = this._arrayBuffer;
    e = this._offset;
    this._vertices = a ? new cc.Vertex3F(a.x, a.y, a.z, d, e) : new cc.Vertex3F(0, 0, 0, d, e);
    e += cc.Vertex3F.BYTES_PER_ELEMENT;
    this._colors = b ? new cc._WebGLColor(b.r, b.g, b.b, b.a, d, e) : new cc._WebGLColor(0, 0, 0, 0, d, e);
    e += cc._WebGLColor.BYTES_PER_ELEMENT;
    this._texCoords = c ? new cc.Tex2F(c.u, c.v, d, e) : new cc.Tex2F(0, 0, d, e)
};
cc.V3F_C4B_T2F.BYTES_PER_ELEMENT = 24;
_p = cc.V3F_C4B_T2F.prototype;
_p._getVertices = function() {
    return this._vertices
};
_p._setVertices = function(a) {
    var b = this._vertices;
    b._view[0] = a.x;
    b._view[1] = a.y;
    b._view[2] = a.z
};
_p._getColor = function() {
    return this._colors
};
_p._setColor = function(a) {
    var b = this._colors;
    b._view[0] = a.r;
    b._view[1] = a.g;
    b._view[2] = a.b;
    b._view[3] = a.a
};
_p._getTexCoords = function() {
    return this._texCoords
};
_p._setTexCoords = function(a) {
    this._texCoords._view[0] = a.u;
    this._texCoords._view[1] = a.v
};
cc.defineGetterSetter(_p, "vertices", _p._getVertices, _p._setVertices);
cc.defineGetterSetter(_p, "colors", _p._getColor, _p._setColor);
cc.defineGetterSetter(_p, "texCoords", _p._getTexCoords, _p._setTexCoords);
cc.V3F_C4B_T2F_Quad = function(a, b, c, d, e, f) {
    this._arrayBuffer = e || new ArrayBuffer(cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT);
    this._offset = f || 0;
    e = this._arrayBuffer;
    f = this._offset;
    var g = cc.V3F_C4B_T2F.BYTES_PER_ELEMENT;
    this._tl = a ? new cc.V3F_C4B_T2F(a.vertices, a.colors, a.texCoords, e, f) : new cc.V3F_C4B_T2F(null, null, null, e, f);
    f += g;
    this._bl = b ? new cc.V3F_C4B_T2F(b.vertices, b.colors, b.texCoords, e, f) : new cc.V3F_C4B_T2F(null, null, null, e, f);
    f += g;
    this._tr = c ? new cc.V3F_C4B_T2F(c.vertices, c.colors, c.texCoords, e, f) : new cc.V3F_C4B_T2F(null, null, null, e, f);
    f += g;
    this._br = d ? new cc.V3F_C4B_T2F(d.vertices, d.colors, d.texCoords, e, f) : new cc.V3F_C4B_T2F(null, null, null, e, f)
};
cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT = 96;
_p = cc.V3F_C4B_T2F_Quad.prototype;
_p._getTL = function() {
    return this._tl
};
_p._setTL = function(a) {
    var b = this._tl;
    b.vertices = a.vertices;
    b.colors = a.colors;
    b.texCoords = a.texCoords
};
_p._getBL = function() {
    return this._bl
};
_p._setBL = function(a) {
    var b = this._bl;
    b.vertices = a.vertices;
    b.colors = a.colors;
    b.texCoords = a.texCoords
};
_p._getTR = function() {
    return this._tr
};
_p._setTR = function(a) {
    var b = this._tr;
    b.vertices = a.vertices;
    b.colors = a.colors;
    b.texCoords = a.texCoords
};
_p._getBR = function() {
    return this._br
};
_p._setBR = function(a) {
    var b = this._br;
    b.vertices = a.vertices;
    b.colors = a.colors;
    b.texCoords = a.texCoords
};
_p._getArrayBuffer = function() {
    return this._arrayBuffer
};
cc.defineGetterSetter(_p, "tl", _p._getTL, _p._setTL);
cc.defineGetterSetter(_p, "tr", _p._getTR, _p._setTR);
cc.defineGetterSetter(_p, "bl", _p._getBL, _p._setBL);
cc.defineGetterSetter(_p, "br", _p._getBR, _p._setBR);
cc.defineGetterSetter(_p, "arrayBuffer", _p._getArrayBuffer, null);
cc.V3F_C4B_T2F_QuadZero = function() {
    return new cc.V3F_C4B_T2F_Quad
};
cc.V3F_C4B_T2F_QuadCopy = function(a) {
    if (!a) return cc.V3F_C4B_T2F_QuadZero();
    var b = a.tl,
    c = a.bl,
    d = a.tr;
    a = a.br;
    return {
        tl: {
            vertices: {
                x: b.vertices.x,
                y: b.vertices.y,
                z: b.vertices.z
            },
            colors: {
                r: b.colors.r,
                g: b.colors.g,
                b: b.colors.b,
                a: b.colors.a
            },
            texCoords: {
                u: b.texCoords.u,
                v: b.texCoords.v
            }
        },
        bl: {
            vertices: {
                x: c.vertices.x,
                y: c.vertices.y,
                z: c.vertices.z
            },
            colors: {
                r: c.colors.r,
                g: c.colors.g,
                b: c.colors.b,
                a: c.colors.a
            },
            texCoords: {
                u: c.texCoords.u,
                v: c.texCoords.v
            }
        },
        tr: {
            vertices: {
                x: d.vertices.x,
                y: d.vertices.y,
                z: d.vertices.z
            },
            colors: {
                r: d.colors.r,
                g: d.colors.g,
                b: d.colors.b,
                a: d.colors.a
            },
            texCoords: {
                u: d.texCoords.u,
                v: d.texCoords.v
            }
        },
        br: {
            vertices: {
                x: a.vertices.x,
                y: a.vertices.y,
                z: a.vertices.z
            },
            colors: {
                r: a.colors.r,
                g: a.colors.g,
                b: a.colors.b,
                a: a.colors.a
            },
            texCoords: {
                u: a.texCoords.u,
                v: a.texCoords.v
            }
        }
    }
};
cc.V3F_C4B_T2F_QuadsCopy = function(a) {
    if (!a) return [];
    for (var b = [], c = 0; c < a.length; c++) b.push(cc.V3F_C4B_T2F_QuadCopy(a[c]));
    return b
};
cc.V2F_C4B_T2F = function(a, b, c, d, e) {
    this._arrayBuffer = d || new ArrayBuffer(cc.V2F_C4B_T2F.BYTES_PER_ELEMENT);
    this._offset = e || 0;
    d = this._arrayBuffer;
    e = this._offset;
    this._vertices = a ? new cc.Vertex2F(a.x, a.y, d, e) : new cc.Vertex2F(0, 0, d, e);
    e += cc.Vertex2F.BYTES_PER_ELEMENT;
    this._colors = b ? new cc._WebGLColor(b.r, b.g, b.b, b.a, d, e) : new cc._WebGLColor(0, 0, 0, 0, d, e);
    e += cc._WebGLColor.BYTES_PER_ELEMENT;
    this._texCoords = c ? new cc.Tex2F(c.u, c.v, d, e) : new cc.Tex2F(0, 0, d, e)
};
cc.V2F_C4B_T2F.BYTES_PER_ELEMENT = 20;
_p = cc.V2F_C4B_T2F.prototype;
_p._getVertices = function() {
    return this._vertices
};
_p._setVertices = function(a) {
    this._vertices._view[0] = a.x;
    this._vertices._view[1] = a.y
};
_p._getColor = function() {
    return this._colors
};
_p._setColor = function(a) {
    var b = this._colors;
    b._view[0] = a.r;
    b._view[1] = a.g;
    b._view[2] = a.b;
    b._view[3] = a.a
};
_p._getTexCoords = function() {
    return this._texCoords
};
_p._setTexCoords = function(a) {
    this._texCoords._view[0] = a.u;
    this._texCoords._view[1] = a.v
};
cc.defineGetterSetter(_p, "vertices", _p._getVertices, _p._setVertices);
cc.defineGetterSetter(_p, "colors", _p._getColor, _p._setColor);
cc.defineGetterSetter(_p, "texCoords", _p._getTexCoords, _p._setTexCoords);
cc.V2F_C4B_T2F_Triangle = function(a, b, c, d, e) {
    this._arrayBuffer = d || new ArrayBuffer(cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT);
    this._offset = e || 0;
    d = this._arrayBuffer;
    e = this._offset;
    var f = cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;
    this._a = a ? new cc.V2F_C4B_T2F(a.vertices, a.colors, a.texCoords, d, e) : new cc.V2F_C4B_T2F(null, null, null, d, e);
    e += f;
    this._b = b ? new cc.V2F_C4B_T2F(b.vertices, b.colors, b.texCoords, d, e) : new cc.V2F_C4B_T2F(null, null, null, d, e);
    e += f;
    this._c = c ? new cc.V2F_C4B_T2F(c.vertices, c.colors, c.texCoords, d, e) : new cc.V2F_C4B_T2F(null, null, null, d, e)
};
cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT = 60;
_p = cc.V2F_C4B_T2F_Triangle.prototype;
_p._getA = function() {
    return this._a
};
_p._setA = function(a) {
    var b = this._a;
    b.vertices = a.vertices;
    b.colors = a.colors;
    b.texCoords = a.texCoords
};
_p._getB = function() {
    return this._b
};
_p._setB = function(a) {
    var b = this._b;
    b.vertices = a.vertices;
    b.colors = a.colors;
    b.texCoords = a.texCoords
};
_p._getC = function() {
    return this._c
};
_p._setC = function(a) {
    var b = this._c;
    b.vertices = a.vertices;
    b.colors = a.colors;
    b.texCoords = a.texCoords
};
cc.defineGetterSetter(_p, "a", _p._getA, _p._setA);
cc.defineGetterSetter(_p, "b", _p._getB, _p._setB);
cc.defineGetterSetter(_p, "c", _p._getC, _p._setC);
cc.vertex2 = function(a, b) {
    return new cc.Vertex2F(a, b)
};
cc.vertex3 = function(a, b, c) {
    return new cc.Vertex3F(a, b, c)
};
cc.tex2 = function(a, b) {
    return new cc.Tex2F(a, b)
};
cc.BlendFunc = function(a, b) {
    this.src = a;
    this.dst = b
};
cc.blendFuncDisable = function() {
    return new cc.BlendFunc(cc.ONE, cc.ZERO)
};
cc.hexToColor = function(a) {
    a = a.replace(/^#?/, "0x");
    a = parseInt(a);
    return new cc.Color(a >> 16, (a >> 8) % 256, a % 256)
};
cc.colorToHex = function(a) {
    var b = a.r.toString(16),
    c = a.g.toString(16),
    d = a.b.toString(16);
    return "#" + (16 > a.r ? "0" + b: b) + (16 > a.g ? "0" + c: c) + (16 > a.b ? "0" + d: d)
};
cc.TEXT_ALIGNMENT_LEFT = 0;
cc.TEXT_ALIGNMENT_CENTER = 1;
cc.TEXT_ALIGNMENT_RIGHT = 2;
cc.VERTICAL_TEXT_ALIGNMENT_TOP = 0;
cc.VERTICAL_TEXT_ALIGNMENT_CENTER = 1;
cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM = 2;
cc._Dictionary = cc.Class.extend({
    _keyMapTb: null,
    _valueMapTb: null,
    __currId: 0,
    ctor: function() {
        this._keyMapTb = {};
        this._valueMapTb = {};
        this.__currId = 2 << (0 | 10 * Math.random())
    },
    __getKey: function() {
        this.__currId++;
        return "key_" + this.__currId
    },
    setObject: function(a, b) {
        if (null != b) {
            var c = this.__getKey();
            this._keyMapTb[c] = b;
            this._valueMapTb[c] = a
        }
    },
    objectForKey: function(a) {
        if (null == a) return null;
        var b = this._keyMapTb,
        c;
        for (c in b) if (b[c] === a) return this._valueMapTb[c];
        return null
    },
    valueForKey: function(a) {
        return this.objectForKey(a)
    },
    removeObjectForKey: function(a) {
        if (null != a) {
            var b = this._keyMapTb,
            c;
            for (c in b) if (b[c] === a) {
                delete this._valueMapTb[c];
                delete b[c];
                break
            }
        }
    },
    removeObjectsForKeys: function(a) {
        if (null != a) for (var b = 0; b < a.length; b++) this.removeObjectForKey(a[b])
    },
    allKeys: function() {
        var a = [],
        b = this._keyMapTb,
        c;
        for (c in b) a.push(b[c]);
        return a
    },
    removeAllObjects: function() {
        this._keyMapTb = {};
        this._valueMapTb = {}
    },
    count: function() {
        return this.allKeys().length
    }
});
cc.FontDefinition = function(a) {
    this.fontName = "Arial";
    this.fontSize = 12;
    this.textAlign = cc.TEXT_ALIGNMENT_CENTER;
    this.verticalAlign = cc.VERTICAL_TEXT_ALIGNMENT_TOP;
    this.fillStyle = cc.color(255, 255, 255, 255);
    this.boundingHeight = this.boundingWidth = 0;
    this.strokeEnabled = !1;
    this.strokeStyle = cc.color(255, 255, 255, 255);
    this.lineWidth = 1;
    this.fontWeight = this.fontStyle = this.lineHeight = "normal";
    this.shadowEnabled = !1;
    this.shadowBlur = this.shadowOffsetY = this.shadowOffsetX = 0;
    this.shadowOpacity = 1;
    if (a && a instanceof Object) for (var b in a) this[b] = a[b]
};
cc.FontDefinition.prototype._getCanvasFontStr = function() {
    return this.fontStyle + " " + this.fontWeight + " " + this.fontSize + "px/" + (this.lineHeight.charAt ? this.lineHeight: this.lineHeight + "px") + " '" + this.fontName + "'"
};
cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,
function() {
    cc._renderType === cc.game.RENDER_TYPE_WEBGL && (cc._WebGLColor = function(a, b, c, d, e, f) {
        this._arrayBuffer = e || new ArrayBuffer(cc._WebGLColor.BYTES_PER_ELEMENT);
        this._offset = f || 0;
        this._view = new Uint8Array(this._arrayBuffer, this._offset, 4);
        this._view[0] = a || 0;
        this._view[1] = b || 0;
        this._view[2] = c || 0;
        this._view[3] = null == d ? 255 : d;
        void 0 === d && (this.a_undefined = !0)
    },
    cc._WebGLColor.BYTES_PER_ELEMENT = 4, _p = cc._WebGLColor.prototype, _p._getR = function() {
        return this._view[0]
    },
    _p._setR = function(a) {
        this._view[0] = 0 > a ? 0 : a
    },
    _p._getG = function() {
        return this._view[1]
    },
    _p._setG = function(a) {
        this._view[1] = 0 > a ? 0 : a
    },
    _p._getB = function() {
        return this._view[2]
    },
    _p._setB = function(a) {
        this._view[2] = 0 > a ? 0 : a
    },
    _p._getA = function() {
        return this._view[3]
    },
    _p._setA = function(a) {
        this._view[3] = 0 > a ? 0 : a
    },
    cc.defineGetterSetter(_p, "r", _p._getR, _p._setR), cc.defineGetterSetter(_p, "g", _p._getG, _p._setG), cc.defineGetterSetter(_p, "b", _p._getB, _p._setB), cc.defineGetterSetter(_p, "a", _p._getA, _p._setA))
});
_p = cc.color;
_p._getWhite = function() {
    return cc.color(255, 255, 255)
};
_p._getYellow = function() {
    return cc.color(255, 255, 0)
};
_p._getBlue = function() {
    return cc.color(0, 0, 255)
};
_p._getGreen = function() {
    return cc.color(0, 255, 0)
};
_p._getRed = function() {
    return cc.color(255, 0, 0)
};
_p._getMagenta = function() {
    return cc.color(255, 0, 255)
};
_p._getBlack = function() {
    return cc.color(0, 0, 0)
};
_p._getOrange = function() {
    return cc.color(255, 127, 0)
};
_p._getGray = function() {
    return cc.color(166, 166, 166)
};
cc.defineGetterSetter(_p, "WHITE", _p._getWhite);
cc.defineGetterSetter(_p, "YELLOW", _p._getYellow);
cc.defineGetterSetter(_p, "BLUE", _p._getBlue);
cc.defineGetterSetter(_p, "GREEN", _p._getGreen);
cc.defineGetterSetter(_p, "RED", _p._getRed);
cc.defineGetterSetter(_p, "MAGENTA", _p._getMagenta);
cc.defineGetterSetter(_p, "BLACK", _p._getBlack);
cc.defineGetterSetter(_p, "ORANGE", _p._getOrange);
cc.defineGetterSetter(_p, "GRAY", _p._getGray);
cc.BlendFunc._disable = function() {
    return new cc.BlendFunc(cc.ONE, cc.ZERO)
};
cc.BlendFunc._alphaPremultiplied = function() {
    return new cc.BlendFunc(cc.ONE, cc.ONE_MINUS_SRC_ALPHA)
};
cc.BlendFunc._alphaNonPremultiplied = function() {
    return new cc.BlendFunc(cc.SRC_ALPHA, cc.ONE_MINUS_SRC_ALPHA)
};
cc.BlendFunc._additive = function() {
    return new cc.BlendFunc(cc.SRC_ALPHA, cc.ONE)
};
cc.defineGetterSetter(cc.BlendFunc, "DISABLE", cc.BlendFunc._disable);
cc.defineGetterSetter(cc.BlendFunc, "ALPHA_PREMULTIPLIED", cc.BlendFunc._alphaPremultiplied);
cc.defineGetterSetter(cc.BlendFunc, "ALPHA_NON_PREMULTIPLIED", cc.BlendFunc._alphaNonPremultiplied);
cc.defineGetterSetter(cc.BlendFunc, "ADDITIVE", cc.BlendFunc._additive);
cc.Touches = [];
cc.TouchesIntergerDict = {};
cc.DENSITYDPI_DEVICE = "device-dpi";
cc.DENSITYDPI_HIGH = "high-dpi";
cc.DENSITYDPI_MEDIUM = "medium-dpi";
cc.DENSITYDPI_LOW = "low-dpi";
var __BrowserGetter = {
    init: function() {
        this.html = document.documentElement
    },
    availWidth: function(a) {
        return a && a !== this.html ? a.clientWidth: window.innerWidth
    },
    availHeight: function(a) {
        return a && a !== this.html ? a.clientHeight: window.innerHeight
    },
    meta: {
        width: "device-width"
    },
    adaptationType: cc.sys.browserType
}; - 1 < window.navigator.userAgent.indexOf("OS 8_1_") && (__BrowserGetter.adaptationType = cc.sys.BROWSER_TYPE_MIUI);
cc.sys.os === cc.sys.OS_IOS && (__BrowserGetter.adaptationType = cc.sys.BROWSER_TYPE_SAFARI);
switch (__BrowserGetter.adaptationType) {
case cc.sys.BROWSER_TYPE_SAFARI:
    __BrowserGetter.meta["minimal-ui"] = "true";
    break;
case cc.sys.BROWSER_TYPE_CHROME:
    __BrowserGetter.__defineGetter__("target-densitydpi",
    function() {
        return cc.view._targetDensityDPI
    });
    break;
case cc.sys.BROWSER_TYPE_MIUI:
    __BrowserGetter.init = function(a) {
        if (!a.__resizeWithBrowserSize) {
            var b = function() {
                a.setDesignResolutionSize(a._designResolutionSize.width, a._designResolutionSize.height, a._resolutionPolicy);
                window.removeEventListener("resize", b, !1)
            };
            window.addEventListener("resize", b, !1)
        }
    }
}
var _scissorRect = null;
cc.EGLView = cc.Class.extend({
    _delegate: null,
    _frameSize: null,
    _designResolutionSize: null,
    _originalDesignResolutionSize: null,
    _viewPortRect: null,
    _visibleRect: null,
    _retinaEnabled: !1,
    _autoFullScreen: !1,
    _devicePixelRatio: 1,
    _viewName: "",
    _resizeCallback: null,
    _orientationChanging: !0,
    _resizing: !1,
    _scaleX: 1,
    _originalScaleX: 1,
    _scaleY: 1,
    _originalScaleY: 1,
    _isRotated: !1,
    _orientation: 3,
    _resolutionPolicy: null,
    _rpExactFit: null,
    _rpShowAll: null,
    _rpNoBorder: null,
    _rpFixedHeight: null,
    _rpFixedWidth: null,
    _initialized: !1,
    _contentTranslateLeftTop: null,
    _frame: null,
    _frameZoomFactor: 1,
    __resizeWithBrowserSize: !1,
    _isAdjustViewPort: !0,
    _targetDensityDPI: null,
    ctor: function() {
        var a = document,
        b = cc.ContainerStrategy,
        c = cc.ContentStrategy;
        __BrowserGetter.init(this);
        this._frame = cc.container.parentNode === a.body ? a.documentElement: cc.container.parentNode;
        this._frameSize = cc.size(0, 0);
        this._initFrameSize();
        var a = cc._canvas.width,
        d = cc._canvas.height;
        this._designResolutionSize = cc.size(a, d);
        this._originalDesignResolutionSize = cc.size(a, d);
        this._viewPortRect = cc.rect(0, 0, a, d);
        this._visibleRect = cc.rect(0, 0, a, d);
        this._contentTranslateLeftTop = {
            left: 0,
            top: 0
        };
        this._viewName = "Cocos2dHTML5";
        a = cc.sys;
        cc.visibleRect && cc.visibleRect.init(this._visibleRect);
        this._rpExactFit = new cc.ResolutionPolicy(b.EQUAL_TO_FRAME, c.EXACT_FIT);
        this._rpShowAll = new cc.ResolutionPolicy(b.PROPORTION_TO_FRAME, c.SHOW_ALL);
        this._rpNoBorder = new cc.ResolutionPolicy(b.EQUAL_TO_FRAME, c.NO_BORDER);
        this._rpFixedHeight = new cc.ResolutionPolicy(b.EQUAL_TO_FRAME, c.FIXED_HEIGHT);
        this._rpFixedWidth = new cc.ResolutionPolicy(b.EQUAL_TO_FRAME, c.FIXED_WIDTH);
        this._targetDensityDPI = cc.DENSITYDPI_HIGH;
        a.isMobile && window.addEventListener("orientationchange", this._orientationChange)
    },
    _resizeEvent: function() {
        var a;
        a = this.setDesignResolutionSize ? this: cc.view;
        if (!a._orientationChanging) {
            var b = a._frameSize.width,
            c = a._frameSize.height,
            d = a._isRotated;
            if (cc.sys.isMobile) {
                var e = cc.game.container.style,
                f = e.margin;
                e.margin = "0";
                e.display = "none";
                a._initFrameSize();
                e.margin = f;
                e.display = "block"
            } else a._initFrameSize();
            if (a._isRotated !== d || a._frameSize.width !== b || a._frameSize.height !== c) b = a._originalDesignResolutionSize.width,
            c = a._originalDesignResolutionSize.height,
            a._resizing = !0,
            0 < b && a.setDesignResolutionSize(b, c, a._resolutionPolicy),
            a._resizing = !1,
            cc.eventManager.dispatchCustomEvent("canvas-resize"),
            a._resizeCallback && a._resizeCallback.call()
        }
    },
    _orientationChange: function() {
        cc.view._orientationChanging = !0;
        cc.sys.isMobile && (cc.game.container.style.display = "none");
        setTimeout(function() {
            cc.view._orientationChanging = !1;
            cc.view._resizeEvent()
        },
        300)
    },
    setTargetDensityDPI: function(a) {
        this._targetDensityDPI = a;
        this._adjustViewportMeta()
    },
    getTargetDensityDPI: function() {
        return this._targetDensityDPI
    },
    resizeWithBrowserSize: function(a) {
        a ? this.__resizeWithBrowserSize || (this.__resizeWithBrowserSize = !0, window.addEventListener("resize", this._resizeEvent)) : this.__resizeWithBrowserSize && (this.__resizeWithBrowserSize = !1, window.removeEventListener("resize", this._resizeEvent))
    },
    setResizeCallback: function(a) {
        if ("function" === typeof a || null == a) this._resizeCallback = a
    },
    setOrientation: function(a) { (a &= cc.ORIENTATION_AUTO) && this._orientation !== a && (this._orientation = a, this._resolutionPolicy && this.setDesignResolutionSize(this._originalDesignResolutionSize.width, this._originalDesignResolutionSize.height, this._resolutionPolicy))
    },
    setDocumentPixelWidth: function(a) {
        this._setViewportMeta({
            width: a
        },
        !0);
        document.documentElement.style.width = a + "px";
        document.body.style.width = "100%";
        this.setDesignResolutionSize(this._designResolutionSize.width, this._designResolutionSize.height, this._resolutionPolicy)
    },
    _initFrameSize: function() {
        var a = this._frameSize,
        b = __BrowserGetter.availWidth(this._frame),
        c = __BrowserGetter.availHeight(this._frame),
        d = b >= c; ! cc.sys.isMobile || d && this._orientation & cc.ORIENTATION_LANDSCAPE || !d && this._orientation & cc.ORIENTATION_PORTRAIT ? (a.width = b, a.height = c, cc.container.style["-webkit-transform"] = "rotate(0deg)", cc.container.style.transform = "rotate(0deg)", this._isRotated = !1) : (a.width = c, a.height = b, cc.container.style["-webkit-transform"] = "rotate(90deg)", cc.container.style.transform = "rotate(90deg)", cc.container.style["-webkit-transform-origin"] = "0px 0px 0px", cc.container.style.transformOrigin = "0px 0px 0px", this._isRotated = !0)
    },
    _adjustSizeKeepCanvasSize: function() {
        var a = this._originalDesignResolutionSize.width,
        b = this._originalDesignResolutionSize.height;
        0 < a && this.setDesignResolutionSize(a, b, this._resolutionPolicy)
    },
    _setViewportMeta: function(a, b) {
        var c = document.getElementById("cocosMetaElement");
        c && b && document.head.removeChild(c);
        var d = document.getElementsByName("viewport"),
        d = d ? d[0] : null,
        e,
        f,
        g;
        e = d ? d.content: "";
        c = c || document.createElement("meta");
        c.id = "cocosMetaElement";
        c.name = "viewport";
        c.content = "";
        for (f in a) - 1 == e.indexOf(f) ? e += "," + f + "\x3d" + a[f] : b && (g = RegExp(f + "s*\x3ds*[^,]+"), e.replace(g, f + "\x3d" + a[f]));
        /^,/.test(e) && (e = e.substr(1));
        c.content = e;
        d && (d.content = e);
        document.head.appendChild(c)
    },
    _adjustViewportMeta: function() {
        this._isAdjustViewPort && (this._setViewportMeta(__BrowserGetter.meta, !1), this._isAdjustViewPort = !1)
    },
    _setScaleXYForRenderTexture: function() {
        var a = cc.contentScaleFactor();
        this._scaleY = this._scaleX = a
    },
    _resetScale: function() {
        this._scaleX = this._originalScaleX;
        this._scaleY = this._originalScaleY
    },
    _adjustSizeToBrowser: function() {},
    initialize: function() {
        this._initialized = !0
    },
    adjustViewPort: function(a) {
        this._isAdjustViewPort = a
    },
    enableRetina: function(a) {
        this._retinaEnabled = !!a
    },
    isRetinaEnabled: function() {
        return this._retinaEnabled
    },
    enableAutoFullScreen: function(a) {
        a && a !== this._autoFullScreen && cc.sys.isMobile && this._frame === document.documentElement ? (this._autoFullScreen = !0, cc.screen.autoFullScreen(this._frame)) : this._autoFullScreen = !1
    },
    isAutoFullScreenEnabled: function() {
        return this._autoFullScreen
    },
    isOpenGLReady: function() {
        return cc.game.canvas && cc._renderContext
    },
    setFrameZoomFactor: function(a) {
        this._frameZoomFactor = a;
        this.centerWindow();
        cc.director.setProjection(cc.director.getProjection())
    },
    swapBuffers: function() {},
    setIMEKeyboardState: function(a) {},
    setContentTranslateLeftTop: function(a, b) {
        this._contentTranslateLeftTop = {
            left: a,
            top: b
        }
    },
    getContentTranslateLeftTop: function() {
        return this._contentTranslateLeftTop
    },
    getCanvasSize: function() {
        return cc.size(cc._canvas.width, cc._canvas.height)
    },
    getFrameSize: function() {
        return cc.size(this._frameSize.width, this._frameSize.height)
    },
    setFrameSize: function(a, b) {
        this._frameSize.width = a;
        this._frameSize.height = b;
        this._frame.style.width = a + "px";
        this._frame.style.height = b + "px";
        this._resizeEvent();
        cc.director.setProjection(cc.director.getProjection())
    },
    getVisibleSize: function() {
        return cc.size(this._visibleRect.width, this._visibleRect.height)
    },
    getVisibleSizeInPixel: function() {
        return cc.size(this._visibleRect.width * this._scaleX, this._visibleRect.height * this._scaleY)
    },
    getVisibleOrigin: function() {
        return cc.p(this._visibleRect.x, this._visibleRect.y)
    },
    getVisibleOriginInPixel: function() {
        return cc.p(this._visibleRect.x * this._scaleX, this._visibleRect.y * this._scaleY)
    },
    canSetContentScaleFactor: function() {
        return ! 0
    },
    getResolutionPolicy: function() {
        return this._resolutionPolicy
    },
    setResolutionPolicy: function(a) {
        if (a instanceof cc.ResolutionPolicy) this._resolutionPolicy = a;
        else {
            var b = cc.ResolutionPolicy;
            a === b.EXACT_FIT && (this._resolutionPolicy = this._rpExactFit);
            a === b.SHOW_ALL && (this._resolutionPolicy = this._rpShowAll);
            a === b.NO_BORDER && (this._resolutionPolicy = this._rpNoBorder);
            a === b.FIXED_HEIGHT && (this._resolutionPolicy = this._rpFixedHeight);
            a === b.FIXED_WIDTH && (this._resolutionPolicy = this._rpFixedWidth)
        }
    },
    setDesignResolutionSize: function(a, b, c) {
        if (0 < a || 0 < b) if (this.setResolutionPolicy(c), (c = this._resolutionPolicy) && c.preApply(this), cc.sys.isMobile && this._adjustViewportMeta(), this._resizing || this._initFrameSize(), c) {
            this._originalDesignResolutionSize.width = this._designResolutionSize.width = a;
            this._originalDesignResolutionSize.height = this._designResolutionSize.height = b;
            var d = c.apply(this, this._designResolutionSize);
            d.scale && 2 === d.scale.length && (this._scaleX = d.scale[0], this._scaleY = d.scale[1]);
            d.viewport && (a = this._viewPortRect, b = this._visibleRect, d = d.viewport, a.x = d.x, a.y = d.y, a.width = d.width, a.height = d.height, b.x = -a.x / this._scaleX, b.y = -a.y / this._scaleY, b.width = cc._canvas.width / this._scaleX, b.height = cc._canvas.height / this._scaleY, cc._renderContext.setOffset && cc._renderContext.setOffset(a.x, -a.y));
            a = cc.director;
            a._winSizeInPoints.width = this._designResolutionSize.width;
            a._winSizeInPoints.height = this._designResolutionSize.height;
            c.postApply(this);
            cc.winSize.width = a._winSizeInPoints.width;
            cc.winSize.height = a._winSizeInPoints.height;
            cc._renderType === cc.game.RENDER_TYPE_WEBGL ? a.setGLDefaultValues() : cc._renderType === cc.game.RENDER_TYPE_CANVAS && (cc.renderer._allNeedDraw = !0);
            this._originalScaleX = this._scaleX;
            this._originalScaleY = this._scaleY;
            cc.visibleRect && cc.visibleRect.init(this._visibleRect)
        } else cc.log(cc._LogInfos.EGLView_setDesignResolutionSize_2);
        else cc.log(cc._LogInfos.EGLView_setDesignResolutionSize)
    },
    getDesignResolutionSize: function() {
        return cc.size(this._designResolutionSize.width, this._designResolutionSize.height)
    },
    setRealPixelResolution: function(a, b, c) {
        this._setViewportMeta({
            width: a
        },
        !0);
        document.documentElement.style.width = a + "px";
        document.body.style.width = a + "px";
        document.body.style.left = "0px";
        document.body.style.top = "0px";
        this.setDesignResolutionSize(a, b, c)
    },
    setViewPortInPoints: function(a, b, c, d) {
        var e = this._frameZoomFactor,
        f = this._scaleX,
        g = this._scaleY;
        cc._renderContext.viewport(a * f * e + this._viewPortRect.x * e, b * g * e + this._viewPortRect.y * e, c * f * e, d * g * e)
    },
    setScissorInPoints: function(a, b, c, d) {
        var e = this._frameZoomFactor,
        f = this._scaleX,
        g = this._scaleY;
        a = Math.ceil(a * f * e + this._viewPortRect.x * e);
        b = Math.ceil(b * g * e + this._viewPortRect.y * e);
        c = Math.ceil(c * f * e);
        d = Math.ceil(d * g * e);
        _scissorRect || (e = gl.getParameter(gl.SCISSOR_BOX), _scissorRect = cc.rect(e[0], e[1], e[2], e[3]));
        if (_scissorRect.x != a || _scissorRect.y != b || _scissorRect.width != c || _scissorRect.height != d) _scissorRect.x = a,
        _scissorRect.y = b,
        _scissorRect.width = c,
        _scissorRect.height = d,
        cc._renderContext.scissor(a, b, c, d)
    },
    isScissorEnabled: function() {
        return cc._renderContext.isEnabled(gl.SCISSOR_TEST)
    },
    getScissorRect: function() {
        if (!_scissorRect) {
            var a = gl.getParameter(gl.SCISSOR_BOX);
            _scissorRect = cc.rect(a[0], a[1], a[2], a[3])
        }
        var a = 1 / this._scaleX,
        b = 1 / this._scaleY;
        return cc.rect((_scissorRect.x - this._viewPortRect.x) * a, (_scissorRect.y - this._viewPortRect.y) * b, _scissorRect.width * a, _scissorRect.height * b)
    },
    setViewName: function(a) {
        null != a && 0 < a.length && (this._viewName = a)
    },
    getViewName: function() {
        return this._viewName
    },
    getViewPortRect: function() {
        return this._viewPortRect
    },
    getScaleX: function() {
        return this._scaleX
    },
    getScaleY: function() {
        return this._scaleY
    },
    getDevicePixelRatio: function() {
        return this._devicePixelRatio
    },
    convertToLocationInView: function(a, b, c) {
        a = this._devicePixelRatio * (a - c.left);
        b = this._devicePixelRatio * (c.top + c.height - b);
        return this._isRotated ? {
            x: this._viewPortRect.width - b,
            y: a
        }: {
            x: a,
            y: b
        }
    },
    _convertMouseToLocationInView: function(a, b) {
        var c = this._viewPortRect;
        a.x = (this._devicePixelRatio * (a.x - b.left) - c.x) / this._scaleX;
        a.y = (this._devicePixelRatio * (b.top + b.height - a.y) - c.y) / this._scaleY
    },
    _convertPointWithScale: function(a) {
        var b = this._viewPortRect;
        a.x = (a.x - b.x) / this._scaleX;
        a.y = (a.y - b.y) / this._scaleY
    },
    _convertTouchesWithScale: function(a) {
        for (var b = this._viewPortRect,
        c = this._scaleX,
        d = this._scaleY,
        e, f, g = 0; g < a.length; g++) e = a[g],
        f = e._point,
        e = e._prevPoint,
        f.x = (f.x - b.x) / c,
        f.y = (f.y - b.y) / d,
        e.x = (e.x - b.x) / c,
        e.y = (e.y - b.y) / d
    }
});
cc.EGLView._getInstance = function() {
    this._instance || (this._instance = this._instance || new cc.EGLView, this._instance.initialize());
    return this._instance
};
cc.ContainerStrategy = cc.Class.extend({
    preApply: function(a) {},
    apply: function(a, b) {},
    postApply: function(a) {},
    _setupContainer: function(a, b, c) {
        var d = cc.game.canvas,
        e = cc.game.container;
        cc.sys.os === cc.sys.OS_ANDROID && (document.body.style.width = (a._isRotated ? c: b) + "px", document.body.style.height = (a._isRotated ? b: c) + "px");
        e.style.width = d.style.width = b + "px";
        e.style.height = d.style.height = c + "px";
        e = a._devicePixelRatio = 1;
        a.isRetinaEnabled() && (e = a._devicePixelRatio = Math.min(2, window.devicePixelRatio || 1));
        d.width = b * e;
        d.height = c * e;
        cc._renderContext.resetCache && cc._renderContext.resetCache()
    },
    _fixContainer: function() {
        document.body.insertBefore(cc.container, document.body.firstChild);
        var a = document.body.style;
        a.width = window.innerWidth + "px";
        a.height = window.innerHeight + "px";
        a.overflow = "hidden";
        a = cc.container.style;
        a.position = "fixed";
        a.left = a.top = "0px";
        document.body.scrollTop = 0
    }
});
cc.ContentStrategy = cc.Class.extend({
    _result: {
        scale: [1, 1],
        viewport: null
    },
    _buildResult: function(a, b, c, d, e, f) {
        2 > Math.abs(a - c) && (c = a);
        2 > Math.abs(b - d) && (d = b);
        a = cc.rect(Math.round((a - c) / 2), Math.round((b - d) / 2), c, d);
        this._result.scale = [e, f];
        this._result.viewport = a;
        return this._result
    },
    preApply: function(a) {},
    apply: function(a, b) {
        return {
            scale: [1, 1]
        }
    },
    postApply: function(a) {}
}); (function() {
    var a = cc.ContainerStrategy.extend({
        apply: function(a) {
            var b = a._frameSize.height,
            c = cc.container.style;
            this._setupContainer(a, a._frameSize.width, a._frameSize.height);
            c.margin = a._isRotated ? "0 0 0 " + b + "px": "0px"
        }
    }),
    b = cc.ContainerStrategy.extend({
        apply: function(a, b) {
            var c = a._frameSize.width,
            d = a._frameSize.height,
            e = cc.container.style,
            r = b.width,
            s = b.height,
            t = c / r,
            p = d / s,
            v, u;
            t < p ? (v = c, u = s * t) : (v = r * p, u = d);
            r = Math.round((c - v) / 2);
            u = Math.round((d - u) / 2);
            this._setupContainer(a, c - 2 * r, d - 2 * u);
            e.margin = a._isRotated ? "0 0 0 " + d + "px": "0px";
            e.paddingLeft = r + "px";
            e.paddingRight = r + "px";
            e.paddingTop = u + "px";
            e.paddingBottom = u + "px"
        }
    });
    a.extend({
        preApply: function(a) {
            this._super(a);
            a._frame = document.documentElement
        },
        apply: function(a) {
            this._super(a);
            this._fixContainer()
        }
    });
    b.extend({
        preApply: function(a) {
            this._super(a);
            a._frame = document.documentElement
        },
        apply: function(a, b) {
            this._super(a, b);
            this._fixContainer()
        }
    });
    var c = cc.ContainerStrategy.extend({
        apply: function(a) {
            this._setupContainer(a, cc._canvas.width, cc._canvas.height)
        }
    });
    cc.ContainerStrategy.EQUAL_TO_FRAME = new a;
    cc.ContainerStrategy.PROPORTION_TO_FRAME = new b;
    cc.ContainerStrategy.ORIGINAL_CONTAINER = new c;
    var a = cc.ContentStrategy.extend({
        apply: function(a, b) {
            var c = cc._canvas.width,
            d = cc._canvas.height;
            return this._buildResult(c, d, c, d, c / b.width, d / b.height)
        }
    }),
    b = cc.ContentStrategy.extend({
        apply: function(a, b) {
            var c = cc._canvas.width,
            d = cc._canvas.height,
            e = b.width,
            r = b.height,
            s = c / e,
            t = d / r,
            p = 0,
            v, u;
            s < t ? (p = s, v = c, u = r * p) : (p = t, v = e * p, u = d);
            return this._buildResult(c, d, v, u, p, p)
        }
    }),
    c = cc.ContentStrategy.extend({
        apply: function(a, b) {
            var c = cc._canvas.width,
            d = cc._canvas.height,
            e = b.width,
            r = b.height,
            s = c / e,
            t = d / r,
            p, v, u;
            s < t ? (p = t, v = e * p, u = d) : (p = s, v = c, u = r * p);
            return this._buildResult(c, d, v, u, p, p)
        }
    }),
    d = cc.ContentStrategy.extend({
        apply: function(a, b) {
            var c = cc._canvas.width,
            d = cc._canvas.height,
            e = d / b.height;
            return this._buildResult(c, d, c, d, e, e)
        },
        postApply: function(a) {
            cc.director._winSizeInPoints = a.getVisibleSize()
        }
    }),
    e = cc.ContentStrategy.extend({
        apply: function(a, b) {
            var c = cc._canvas.width,
            d = cc._canvas.height,
            e = c / b.width;
            return this._buildResult(c, d, c, d, e, e)
        },
        postApply: function(a) {
            cc.director._winSizeInPoints = a.getVisibleSize()
        }
    });
    cc.ContentStrategy.EXACT_FIT = new a;
    cc.ContentStrategy.SHOW_ALL = new b;
    cc.ContentStrategy.NO_BORDER = new c;
    cc.ContentStrategy.FIXED_HEIGHT = new d;
    cc.ContentStrategy.FIXED_WIDTH = new e
})();
cc.ResolutionPolicy = cc.Class.extend({
    _containerStrategy: null,
    _contentStrategy: null,
    ctor: function(a, b) {
        this.setContainerStrategy(a);
        this.setContentStrategy(b)
    },
    preApply: function(a) {
        this._containerStrategy.preApply(a);
        this._contentStrategy.preApply(a)
    },
    apply: function(a, b) {
        this._containerStrategy.apply(a, b);
        return this._contentStrategy.apply(a, b)
    },
    postApply: function(a) {
        this._containerStrategy.postApply(a);
        this._contentStrategy.postApply(a)
    },
    setContainerStrategy: function(a) {
        a instanceof cc.ContainerStrategy && (this._containerStrategy = a)
    },
    setContentStrategy: function(a) {
        a instanceof cc.ContentStrategy && (this._contentStrategy = a)
    }
});
cc.ResolutionPolicy.EXACT_FIT = 0;
cc.ResolutionPolicy.NO_BORDER = 1;
cc.ResolutionPolicy.SHOW_ALL = 2;
cc.ResolutionPolicy.FIXED_HEIGHT = 3;
cc.ResolutionPolicy.FIXED_WIDTH = 4;
cc.ResolutionPolicy.UNKNOWN = 5;
cc.screen = {
    _supportsFullScreen: !1,
    _preOnFullScreenChange: null,
    _touchEvent: "",
    _fn: null,
    _fnMap: [["requestFullscreen", "exitFullscreen", "fullscreenchange", "fullscreenEnabled", "fullscreenElement"], ["requestFullScreen", "exitFullScreen", "fullScreenchange", "fullScreenEnabled", "fullScreenElement"], ["webkitRequestFullScreen", "webkitCancelFullScreen", "webkitfullscreenchange", "webkitIsFullScreen", "webkitCurrentFullScreenElement"], ["mozRequestFullScreen", "mozCancelFullScreen", "mozfullscreenchange", "mozFullScreen", "mozFullScreenElement"], ["msRequestFullscreen", "msExitFullscreen", "MSFullscreenChange", "msFullscreenEnabled", "msFullscreenElement"]],
    init: function() {
        this._fn = {};
        var a, b, c = this._fnMap,
        d;
        a = 0;
        for (l = c.length; a < l; a++) if ((b = c[a]) && b[1] in document) {
            a = 0;
            for (d = b.length; a < d; a++) this._fn[c[0][a]] = b[a];
            break
        }
        this._supportsFullScreen = "undefined" !== typeof this._fn.requestFullscreen;
        this._touchEvent = "ontouchstart" in window ? "touchstart": "mousedown"
    },
    fullScreen: function() {
        return this._supportsFullScreen ? void 0 === document[this._fn.fullscreenElement] || null === document[this._fn.fullscreenElement] ? !1 : !0 : !1
    },
    requestFullScreen: function(a, b) {
        if (this._supportsFullScreen) {
            a = a || document.documentElement;
            if (b) {
                var c = this._fn.fullscreenchange;
                this._preOnFullScreenChange && document.removeEventListener(c, this._preOnFullScreenChange);
                this._preOnFullScreenChange = b;
                document.addEventListener(c, b, !1)
            }
            return a[this._fn.requestFullscreen]()
        }
    },
    exitFullScreen: function() {
        return this._supportsFullScreen ? document[this._fn.exitFullscreen]() : !0
    },
    autoFullScreen: function(a, b) {
        function c() {
            d.removeEventListener(e._touchEvent, c);
            e.requestFullScreen(a, b)
        }
        a = a || document.body;
        var d = cc.game.canvas || a,
        e = this;
        this.requestFullScreen(a, b);
        d.addEventListener(this._touchEvent, c)
    }
};
cc.screen.init();
cc.visibleRect = {
    topLeft: cc.p(0, 0),
    topRight: cc.p(0, 0),
    top: cc.p(0, 0),
    bottomLeft: cc.p(0, 0),
    bottomRight: cc.p(0, 0),
    bottom: cc.p(0, 0),
    center: cc.p(0, 0),
    left: cc.p(0, 0),
    right: cc.p(0, 0),
    width: 0,
    height: 0,
    init: function(a) {
        var b = this.width = a.width,
        c = this.height = a.height,
        d = a.x;
        a = a.y;
        var e = a + c,
        f = d + b;
        this.topLeft.x = d;
        this.topLeft.y = e;
        this.topRight.x = f;
        this.topRight.y = e;
        this.top.x = d + b / 2;
        this.top.y = e;
        this.bottomLeft.x = d;
        this.bottomLeft.y = a;
        this.bottomRight.x = f;
        this.bottomRight.y = a;
        this.bottom.x = d + b / 2;
        this.bottom.y = a;
        this.center.x = d + b / 2;
        this.center.y = a + c / 2;
        this.left.x = d;
        this.left.y = a + c / 2;
        this.right.x = f;
        this.right.y = a + c / 2
    }
};
cc.UIInterfaceOrientationLandscapeLeft = -90;
cc.UIInterfaceOrientationLandscapeRight = 90;
cc.UIInterfaceOrientationPortraitUpsideDown = 180;
cc.UIInterfaceOrientationPortrait = 0;
cc.inputManager = {
    TOUCH_TIMEOUT: 5E3,
    _mousePressed: !1,
    _isRegisterEvent: !1,
    _preTouchPoint: cc.p(0, 0),
    _prevMousePoint: cc.p(0, 0),
    _preTouchPool: [],
    _preTouchPoolPointer: 0,
    _touches: [],
    _touchesIntegerDict: {},
    _indexBitsUsed: 0,
    _maxTouches: 5,
    _accelEnabled: !1,
    _accelInterval: 1 / 30,
    _accelMinus: 1,
    _accelCurTime: 0,
    _acceleration: null,
    _accelDeviceEvent: null,
    _getUnUsedIndex: function() {
        for (var a = this._indexBitsUsed,
        b = cc.sys.now(), c = 0; c < this._maxTouches; c++) {
            if (a & 1) {
                var d = this._touches[c];
                if (b - d._lastModified > this.TOUCH_TIMEOUT) return this._removeUsedIndexBit(c),
                delete this._touchesIntegerDict[d.getID()],
                c
            } else return this._indexBitsUsed |= 1 << c,
            c;
            a >>= 1
        }
        return - 1
    },
    _removeUsedIndexBit: function(a) {
        0 > a || a >= this._maxTouches || (a = ~ (1 << a), this._indexBitsUsed &= a)
    },
    _glView: null,
    handleTouchesBegin: function(a) {
        for (var b, c, d, e = [], f = this._touchesIntegerDict, g = cc.sys.now(), h = 0, k = a.length; h < k; h++) if (b = a[h], d = b.getID(), c = f[d], null == c) {
            var m = this._getUnUsedIndex(); - 1 === m ? cc.log(cc._LogInfos.inputManager_handleTouchesBegin, m) : (c = this._touches[m] = new cc.Touch(b._point.x, b._point.y, b.getID()), c._lastModified = g, c._setPrevPoint(b._prevPoint), f[d] = m, e.push(c))
        }
        0 < e.length && (this._glView._convertTouchesWithScale(e), a = new cc.EventTouch(e), a._eventCode = cc.EventTouch.EventCode.BEGAN, cc.eventManager.dispatchEvent(a))
    },
    handleTouchesMove: function(a) {
        for (var b, c, d = [], e = this._touches, f = cc.sys.now(), g = 0, h = a.length; g < h; g++) b = a[g],
        c = b.getID(),
        c = this._touchesIntegerDict[c],
        null != c && e[c] && (e[c]._setPoint(b._point), e[c]._setPrevPoint(b._prevPoint), e[c]._lastModified = f, d.push(e[c]));
        0 < d.length && (this._glView._convertTouchesWithScale(d), a = new cc.EventTouch(d), a._eventCode = cc.EventTouch.EventCode.MOVED, cc.eventManager.dispatchEvent(a))
    },
    handleTouchesEnd: function(a) {
        a = this.getSetOfTouchesEndOrCancel(a);
        0 < a.length && (this._glView._convertTouchesWithScale(a), a = new cc.EventTouch(a), a._eventCode = cc.EventTouch.EventCode.ENDED, cc.eventManager.dispatchEvent(a))
    },
    handleTouchesCancel: function(a) {
        a = this.getSetOfTouchesEndOrCancel(a);
        0 < a.length && (this._glView._convertTouchesWithScale(a), a = new cc.EventTouch(a), a._eventCode = cc.EventTouch.EventCode.CANCELLED, cc.eventManager.dispatchEvent(a))
    },
    getSetOfTouchesEndOrCancel: function(a) {
        for (var b, c, d, e = [], f = this._touches, g = this._touchesIntegerDict, h = 0, k = a.length; h < k; h++) b = a[h],
        d = b.getID(),
        c = g[d],
        null != c && f[c] && (f[c]._setPoint(b._point), f[c]._setPrevPoint(b._prevPoint), e.push(f[c]), this._removeUsedIndexBit(c), delete g[d]);
        return e
    },
    getHTMLElementPosition: function(a) {
        var b = document.documentElement,
        c = window,
        d = null,
        d = cc.isFunction(a.getBoundingClientRect) ? a.getBoundingClientRect() : {
            left: 0,
            top: 0,
            width: parseInt(a.style.width),
            height: parseInt(a.style.height)
        };
        return {
            left: d.left + c.pageXOffset - b.clientLeft,
            top: d.top + c.pageYOffset - b.clientTop,
            width: d.width,
            height: d.height
        }
    },
    getPreTouch: function(a) {
        for (var b = null,
        c = this._preTouchPool,
        d = a.getID(), e = c.length - 1; 0 <= e; e--) if (c[e].getID() === d) {
            b = c[e];
            break
        }
        b || (b = a);
        return b
    },
    setPreTouch: function(a) {
        for (var b = !1,
        c = this._preTouchPool,
        d = a.getID(), e = c.length - 1; 0 <= e; e--) if (c[e].getID() === d) {
            c[e] = a;
            b = !0;
            break
        }
        b || (50 >= c.length ? c.push(a) : (c[this._preTouchPoolPointer] = a, this._preTouchPoolPointer = (this._preTouchPoolPointer + 1) % 50))
    },
    getTouchByXY: function(a, b, c) {
        var d = this._preTouchPoint;
        a = this._glView.convertToLocationInView(a, b, c);
        b = new cc.Touch(a.x, a.y);
        b._setPrevPoint(d.x, d.y);
        d.x = a.x;
        d.y = a.y;
        return b
    },
    getMouseEvent: function(a, b, c) {
        var d = this._prevMousePoint;
        this._glView._convertMouseToLocationInView(a, b);
        b = new cc.EventMouse(c);
        b.setLocation(a.x, a.y);
        b._setPrevCursor(d.x, d.y);
        d.x = a.x;
        d.y = a.y;
        return b
    },
    getPointByEvent: function(a, b) {
        if (null != a.pageX) return {
            x: a.pageX,
            y: a.pageY
        };
        b.left -= document.body.scrollLeft;
        b.top -= document.body.scrollTop;
        return {
            x: a.clientX,
            y: a.clientY
        }
    },
    getTouchesByEvent: function(a, b) {
        for (var c = [], d = this._glView, e, f, g = this._preTouchPoint, h = a.changedTouches.length, k = 0; k < h; k++) if (e = a.changedTouches[k]) {
            var m;
            m = cc.sys.BROWSER_TYPE_FIREFOX === cc.sys.browserType ? d.convertToLocationInView(e.pageX, e.pageY, b) : d.convertToLocationInView(e.clientX, e.clientY, b);
            null != e.identifier ? (e = new cc.Touch(m.x, m.y, e.identifier), f = this.getPreTouch(e).getLocation(), e._setPrevPoint(f.x, f.y), this.setPreTouch(e)) : (e = new cc.Touch(m.x, m.y), e._setPrevPoint(g.x, g.y));
            g.x = m.x;
            g.y = m.y;
            c.push(e)
        }
        return c
    },
    registerSystemEvent: function(a) {
        if (!this._isRegisterEvent) {
            this._glView = cc.view;
            var b = this,
            c = "mouse" in cc.sys.capabilities,
            d = "touches" in cc.sys.capabilities,
            e = !1;
            cc.sys.isMobile && (e = !0);
            c && (window.addEventListener("mousedown",
            function() {
                b._mousePressed = !0
            },
            !1), window.addEventListener("mouseup",
            function(c) {
                if (!e) {
                    var d = b._mousePressed;
                    b._mousePressed = !1;
                    if (d) {
                        var d = b.getHTMLElementPosition(a),
                        f = b.getPointByEvent(c, d);
                        cc.rectContainsPoint(new cc.Rect(d.left, d.top, d.width, d.height), f) || (b.handleTouchesEnd([b.getTouchByXY(f.x, f.y, d)]), d = b.getMouseEvent(f, d, cc.EventMouse.UP), d.setButton(c.button), cc.eventManager.dispatchEvent(d))
                    }
                }
            },
            !1), a.addEventListener("mousedown",
            function(c) {
                if (!e) {
                    b._mousePressed = !0;
                    var d = b.getHTMLElementPosition(a),
                    f = b.getPointByEvent(c, d);
                    b.handleTouchesBegin([b.getTouchByXY(f.x, f.y, d)]);
                    d = b.getMouseEvent(f, d, cc.EventMouse.DOWN);
                    d.setButton(c.button);
                    cc.eventManager.dispatchEvent(d);
                    c.stopPropagation();
                    c.preventDefault();
                    a.focus()
                }
            },
            !1), a.addEventListener("mouseup",
            function(c) {
                if (!e) {
                    b._mousePressed = !1;
                    var d = b.getHTMLElementPosition(a),
                    f = b.getPointByEvent(c, d);
                    b.handleTouchesEnd([b.getTouchByXY(f.x, f.y, d)]);
                    d = b.getMouseEvent(f, d, cc.EventMouse.UP);
                    d.setButton(c.button);
                    cc.eventManager.dispatchEvent(d);
                    c.stopPropagation();
                    c.preventDefault()
                }
            },
            !1), a.addEventListener("mousemove",
            function(c) {
                if (!e) {
                    var d = b.getHTMLElementPosition(a),
                    f = b.getPointByEvent(c, d);
                    b.handleTouchesMove([b.getTouchByXY(f.x, f.y, d)]);
                    d = b.getMouseEvent(f, d, cc.EventMouse.MOVE);
                    b._mousePressed ? d.setButton(c.button) : d.setButton(null);
                    cc.eventManager.dispatchEvent(d);
                    c.stopPropagation();
                    c.preventDefault()
                }
            },
            !1), a.addEventListener("mousewheel",
            function(c) {
                var d = b.getHTMLElementPosition(a),
                e = b.getPointByEvent(c, d),
                d = b.getMouseEvent(e, d, cc.EventMouse.SCROLL);
                d.setButton(c.button);
                d.setScrollData(0, c.wheelDelta);
                cc.eventManager.dispatchEvent(d);
                c.stopPropagation();
                c.preventDefault()
            },
            !1), a.addEventListener("DOMMouseScroll",
            function(c) {
                var d = b.getHTMLElementPosition(a),
                e = b.getPointByEvent(c, d),
                d = b.getMouseEvent(e, d, cc.EventMouse.SCROLL);
                d.setButton(c.button);
                d.setScrollData(0, -120 * c.detail);
                cc.eventManager.dispatchEvent(d);
                c.stopPropagation();
                c.preventDefault()
            },
            !1));
            if (window.navigator.msPointerEnabled) {
                var c = {
                    MSPointerDown: b.handleTouchesBegin,
                    MSPointerMove: b.handleTouchesMove,
                    MSPointerUp: b.handleTouchesEnd,
                    MSPointerCancel: b.handleTouchesCancel
                },
                f;
                for (f in c)(function(c, d) {
                    a.addEventListener(c,
                    function(c) {
                        var e = b.getHTMLElementPosition(a);
                        e.left -= document.documentElement.scrollLeft;
                        e.top -= document.documentElement.scrollTop;
                        d.call(b, [b.getTouchByXY(c.clientX, c.clientY, e)]);
                        c.stopPropagation()
                    },
                    !1)
                })(f, c[f])
            }
            d && (a.addEventListener("touchstart",
            function(c) {
                if (c.changedTouches) {
                    var d = b.getHTMLElementPosition(a);
                    d.left -= document.body.scrollLeft;
                    d.top -= document.body.scrollTop;
                    b.handleTouchesBegin(b.getTouchesByEvent(c, d));
                    c.stopPropagation();
                    c.preventDefault();
                    a.focus()
                }
            },
            !1), a.addEventListener("touchmove",
            function(c) {
                if (c.changedTouches) {
                    var d = b.getHTMLElementPosition(a);
                    d.left -= document.body.scrollLeft;
                    d.top -= document.body.scrollTop;
                    b.handleTouchesMove(b.getTouchesByEvent(c, d));
                    c.stopPropagation();
                    c.preventDefault()
                }
            },
            !1), a.addEventListener("touchend",
            function(c) {
                if (c.changedTouches) {
                    var d = b.getHTMLElementPosition(a);
                    d.left -= document.body.scrollLeft;
                    d.top -= document.body.scrollTop;
                    b.handleTouchesEnd(b.getTouchesByEvent(c, d));
                    c.stopPropagation();
                    c.preventDefault()
                }
            },
            !1), a.addEventListener("touchcancel",
            function(c) {
                if (c.changedTouches) {
                    var d = b.getHTMLElementPosition(a);
                    d.left -= document.body.scrollLeft;
                    d.top -= document.body.scrollTop;
                    b.handleTouchesCancel(b.getTouchesByEvent(c, d));
                    c.stopPropagation();
                    c.preventDefault()
                }
            },
            !1));
            this._registerKeyboardEvent();
            this._isRegisterEvent = !0
        }
    },
    _registerKeyboardEvent: function() {},
    _registerAccelerometerEvent: function() {},
    update: function(a) {
        this._accelCurTime > this._accelInterval && (this._accelCurTime -= this._accelInterval, cc.eventManager.dispatchEvent(new cc.EventAcceleration(this._acceleration)));
        this._accelCurTime += a
    }
};
_p = cc.inputManager;
_p.setAccelerometerEnabled = function(a) {
    this._accelEnabled !== a && (this._accelEnabled = a, a = cc.director.getScheduler(), this._accelEnabled ? (this._accelCurTime = 0, this._registerAccelerometerEvent(), a.scheduleUpdate(this)) : (this._accelCurTime = 0, this._unregisterAccelerometerEvent(), a.unscheduleUpdate(this)))
};
_p.setAccelerometerInterval = function(a) {
    this._accelInterval !== a && (this._accelInterval = a)
};
_p._registerKeyboardEvent = function() {
    cc._canvas.addEventListener("keydown",
    function(a) {
        cc.eventManager.dispatchEvent(new cc.EventKeyboard(a.keyCode, !0));
        a.stopPropagation();
        a.preventDefault()
    },
    !1);
    cc._canvas.addEventListener("keyup",
    function(a) {
        cc.eventManager.dispatchEvent(new cc.EventKeyboard(a.keyCode, !1));
        a.stopPropagation();
        a.preventDefault()
    },
    !1)
};
_p._registerAccelerometerEvent = function() {
    var a = window;
    this._acceleration = new cc.Acceleration;
    this._accelDeviceEvent = a.DeviceMotionEvent || a.DeviceOrientationEvent;
    cc.sys.browserType === cc.sys.BROWSER_TYPE_MOBILE_QQ && (this._accelDeviceEvent = window.DeviceOrientationEvent);
    var b = this._accelDeviceEvent === a.DeviceMotionEvent ? "devicemotion": "deviceorientation",
    c = navigator.userAgent;
    if (/Android/.test(c) || /Adr/.test(c) && cc.sys.browserType === cc.BROWSER_TYPE_UC) this._minus = -1;
    this.didAccelerateCallback = this.didAccelerate.bind(this);
    a.addEventListener(b, this.didAccelerateCallback, !1)
};
_p._unregisterAccelerometerEvent = function() {
    this._acceleration = null;
    window.removeEventListener(this._accelDeviceEvent === window.DeviceMotionEvent ? "devicemotion": "deviceorientation", this.didAccelerateCallback, !1)
};
_p.didAccelerate = function(a) {
    var b = window;
    if (this._accelEnabled) {
        var c = this._acceleration,
        d, e, f;
        this._accelDeviceEvent === window.DeviceMotionEvent ? (f = a.accelerationIncludingGravity, d = this._accelMinus * f.x * 0.1, e = this._accelMinus * f.y * 0.1, f = 0.1 * f.z) : (d = a.gamma / 90 * 0.981, e = 0.981 * -(a.beta / 90), f = a.alpha / 90 * 0.981);
        c.x = d;
        c.y = e;
        c.z = f;
        c.timestamp = a.timeStamp || Date.now();
        a = c.x;
        b.orientation === cc.UIInterfaceOrientationLandscapeRight ? (c.x = -c.y, c.y = a) : b.orientation === cc.UIInterfaceOrientationLandscapeLeft ? (c.x = c.y, c.y = -a) : b.orientation === cc.UIInterfaceOrientationPortraitUpsideDown && (c.x = -c.x, c.y = -c.y)
    }
};
delete _p;
cc.AffineTransform = function(a, b, c, d, e, f) {
    this.a = a;
    this.b = b;
    this.c = c;
    this.d = d;
    this.tx = e;
    this.ty = f
};
cc.affineTransformMake = function(a, b, c, d, e, f) {
    return {
        a: a,
        b: b,
        c: c,
        d: d,
        tx: e,
        ty: f
    }
};
cc.pointApplyAffineTransform = function(a, b, c) {
    var d;
    void 0 === c ? (c = b, d = a.x, a = a.y) : (d = a, a = b);
    return {
        x: c.a * d + c.c * a + c.tx,
        y: c.b * d + c.d * a + c.ty
    }
};
cc._pointApplyAffineTransform = function(a, b, c) {
    return cc.pointApplyAffineTransform(a, b, c)
};
cc.sizeApplyAffineTransform = function(a, b) {
    return {
        width: b.a * a.width + b.c * a.height,
        height: b.b * a.width + b.d * a.height
    }
};
cc.affineTransformMakeIdentity = function() {
    return {
        a: 1,
        b: 0,
        c: 0,
        d: 1,
        tx: 0,
        ty: 0
    }
};
cc.affineTransformIdentity = function() {
    return {
        a: 1,
        b: 0,
        c: 0,
        d: 1,
        tx: 0,
        ty: 0
    }
};
cc.rectApplyAffineTransform = function(a, b) {
    var c = cc.rectGetMinY(a),
    d = cc.rectGetMinX(a),
    e = cc.rectGetMaxX(a),
    f = cc.rectGetMaxY(a),
    g = cc.pointApplyAffineTransform(d, c, b),
    c = cc.pointApplyAffineTransform(e, c, b),
    d = cc.pointApplyAffineTransform(d, f, b),
    h = cc.pointApplyAffineTransform(e, f, b),
    e = Math.min(g.x, c.x, d.x, h.x),
    f = Math.max(g.x, c.x, d.x, h.x),
    k = Math.min(g.y, c.y, d.y, h.y),
    g = Math.max(g.y, c.y, d.y, h.y);
    return cc.rect(e, k, f - e, g - k)
};
cc._rectApplyAffineTransformIn = function(a, b) {
    var c = cc.rectGetMinY(a),
    d = cc.rectGetMinX(a),
    e = cc.rectGetMaxX(a),
    f = cc.rectGetMaxY(a),
    g = cc.pointApplyAffineTransform(d, c, b),
    c = cc.pointApplyAffineTransform(e, c, b),
    d = cc.pointApplyAffineTransform(d, f, b),
    h = cc.pointApplyAffineTransform(e, f, b),
    e = Math.min(g.x, c.x, d.x, h.x),
    f = Math.max(g.x, c.x, d.x, h.x),
    k = Math.min(g.y, c.y, d.y, h.y),
    g = Math.max(g.y, c.y, d.y, h.y);
    a.x = e;
    a.y = k;
    a.width = f - e;
    a.height = g - k;
    return a
};
cc.affineTransformTranslate = function(a, b, c) {
    return {
        a: a.a,
        b: a.b,
        c: a.c,
        d: a.d,
        tx: a.tx + a.a * b + a.c * c,
        ty: a.ty + a.b * b + a.d * c
    }
};
cc.affineTransformScale = function(a, b, c) {
    return {
        a: a.a * b,
        b: a.b * b,
        c: a.c * c,
        d: a.d * c,
        tx: a.tx,
        ty: a.ty
    }
};
cc.affineTransformRotate = function(a, b) {
    var c = Math.sin(b),
    d = Math.cos(b);
    return {
        a: a.a * d + a.c * c,
        b: a.b * d + a.d * c,
        c: a.c * d - a.a * c,
        d: a.d * d - a.b * c,
        tx: a.tx,
        ty: a.ty
    }
};
cc.affineTransformConcat = function(a, b) {
    return {
        a: a.a * b.a + a.b * b.c,
        b: a.a * b.b + a.b * b.d,
        c: a.c * b.a + a.d * b.c,
        d: a.c * b.b + a.d * b.d,
        tx: a.tx * b.a + a.ty * b.c + b.tx,
        ty: a.tx * b.b + a.ty * b.d + b.ty
    }
};
cc.affineTransformConcatIn = function(a, b) {
    var c = a.a,
    d = a.b,
    e = a.c,
    f = a.d,
    g = a.tx,
    h = a.ty;
    a.a = c * b.a + d * b.c;
    a.b = c * b.b + d * b.d;
    a.c = e * b.a + f * b.c;
    a.d = e * b.b + f * b.d;
    a.tx = g * b.a + h * b.c + b.tx;
    a.ty = g * b.b + h * b.d + b.ty;
    return a
};
cc.affineTransformEqualToTransform = function(a, b) {
    return a.a === b.a && a.b === b.b && a.c === b.c && a.d === b.d && a.tx === b.tx && a.ty === b.ty
};
cc.affineTransformInvert = function(a) {
    var b = 1 / (a.a * a.d - a.b * a.c);
    return {
        a: b * a.d,
        b: -b * a.b,
        c: -b * a.c,
        d: b * a.a,
        tx: b * (a.c * a.ty - a.d * a.tx),
        ty: b * (a.b * a.tx - a.a * a.ty)
    }
};
cc.affineTransformInvertOut = function(a, b) {
    var c = a.a,
    d = a.b,
    e = a.c,
    f = a.d,
    g = 1 / (c * f - d * e);
    b.a = g * f;
    b.b = -g * d;
    b.c = -g * e;
    b.d = g * c;
    b.tx = g * (e * a.ty - f * a.tx);
    b.ty = g * (d * a.tx - c * a.ty)
};
cc.POINT_EPSILON = parseFloat("1.192092896e-07F");
cc.pNeg = function(a) {
    return cc.p( - a.x, -a.y)
};
cc.pAdd = function(a, b) {
    return cc.p(a.x + b.x, a.y + b.y)
};
cc.pSub = function(a, b) {
    return cc.p(a.x - b.x, a.y - b.y)
};
cc.pMult = function(a, b) {
    return cc.p(a.x * b, a.y * b)
};
cc.pMidpoint = function(a, b) {
    return cc.pMult(cc.pAdd(a, b), 0.5)
};
cc.pDot = function(a, b) {
    return a.x * b.x + a.y * b.y
};
cc.pCross = function(a, b) {
    return a.x * b.y - a.y * b.x
};
cc.pPerp = function(a) {
    return cc.p( - a.y, a.x)
};
cc.pRPerp = function(a) {
    return cc.p(a.y, -a.x)
};
cc.pProject = function(a, b) {
    return cc.pMult(b, cc.pDot(a, b) / cc.pDot(b, b))
};
cc.pRotate = function(a, b) {
    return cc.p(a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x)
};
cc.pUnrotate = function(a, b) {
    return cc.p(a.x * b.x + a.y * b.y, a.y * b.x - a.x * b.y)
};
cc.pLengthSQ = function(a) {
    return cc.pDot(a, a)
};
cc.pDistanceSQ = function(a, b) {
    return cc.pLengthSQ(cc.pSub(a, b))
};
cc.pLength = function(a) {
    return Math.sqrt(cc.pLengthSQ(a))
};
cc.pDistance = function(a, b) {
    return cc.pLength(cc.pSub(a, b))
};
cc.pNormalize = function(a) {
    var b = cc.pLength(a);
    return 0 === b ? cc.p(a) : cc.pMult(a, 1 / b)
};
cc.pForAngle = function(a) {
    return cc.p(Math.cos(a), Math.sin(a))
};
cc.pToAngle = function(a) {
    return Math.atan2(a.y, a.x)
};
cc.clampf = function(a, b, c) {
    if (b > c) {
        var d = b;
        b = c;
        c = d
    }
    return a < b ? b: a < c ? a: c
};
cc.pClamp = function(a, b, c) {
    return cc.p(cc.clampf(a.x, b.x, c.x), cc.clampf(a.y, b.y, c.y))
};
cc.pFromSize = function(a) {
    return cc.p(a.width, a.height)
};
cc.pCompOp = function(a, b) {
    return cc.p(b(a.x), b(a.y))
};
cc.pLerp = function(a, b, c) {
    return cc.pAdd(cc.pMult(a, 1 - c), cc.pMult(b, c))
};
cc.pFuzzyEqual = function(a, b, c) {
    return a.x - c <= b.x && b.x <= a.x + c && a.y - c <= b.y && b.y <= a.y + c ? !0 : !1
};
cc.pCompMult = function(a, b) {
    return cc.p(a.x * b.x, a.y * b.y)
};
cc.pAngleSigned = function(a, b) {
    var c = cc.pNormalize(a),
    d = cc.pNormalize(b),
    c = Math.atan2(c.x * d.y - c.y * d.x, cc.pDot(c, d));
    return Math.abs(c) < cc.POINT_EPSILON ? 0 : c
};
cc.pAngle = function(a, b) {
    var c = Math.acos(cc.pDot(cc.pNormalize(a), cc.pNormalize(b)));
    return Math.abs(c) < cc.POINT_EPSILON ? 0 : c
};
cc.pRotateByAngle = function(a, b, c) {
    a = cc.pSub(a, b);
    var d = Math.cos(c);
    c = Math.sin(c);
    var e = a.x;
    a.x = e * d - a.y * c + b.x;
    a.y = e * c + a.y * d + b.y;
    return a
};
cc.pLineIntersect = function(a, b, c, d, e) {
    if (a.x === b.x && a.y === b.y || c.x === d.x && c.y === d.y) return ! 1;
    var f = b.x - a.x;
    b = b.y - a.y;
    var g = d.x - c.x;
    d = d.y - c.y;
    var h = a.x - c.x;
    a = a.y - c.y;
    c = d * f - g * b;
    e.x = g * a - d * h;
    e.y = f * a - b * h;
    if (0 === c) return 0 === e.x || 0 === e.y ? !0 : !1;
    e.x /= c;
    e.y /= c;
    return ! 0
};
cc.pSegmentIntersect = function(a, b, c, d) {
    var e = cc.p(0, 0);
    return cc.pLineIntersect(a, b, c, d, e) && 0 <= e.x && 1 >= e.x && 0 <= e.y && 1 >= e.y ? !0 : !1
};
cc.pIntersectPoint = function(a, b, c, d) {
    var e = cc.p(0, 0);
    return cc.pLineIntersect(a, b, c, d, e) ? (c = cc.p(0, 0), c.x = a.x + e.x * (b.x - a.x), c.y = a.y + e.x * (b.y - a.y), c) : cc.p(0, 0)
};
cc.pSameAs = function(a, b) {
    return null != a && null != b ? a.x === b.x && a.y === b.y: !1
};
cc.pZeroIn = function(a) {
    a.x = 0;
    a.y = 0
};
cc.pIn = function(a, b) {
    a.x = b.x;
    a.y = b.y
};
cc.pMultIn = function(a, b) {
    a.x *= b;
    a.y *= b
};
cc.pSubIn = function(a, b) {
    a.x -= b.x;
    a.y -= b.y
};
cc.pAddIn = function(a, b) {
    a.x += b.x;
    a.y += b.y
};
cc.pNormalizeIn = function(a) {
    var b = Math.sqrt(a.x * a.x + a.y * a.y);
    0 !== b && cc.pMultIn(a, 1 / b)
};
cc.vertexLineToPolygon = function(a, b, c, d, e) {
    e += d;
    if (! (1 >= e)) {
        b *= 0.5;
        for (var f, g = e - 1,
        h = d; h < e; h++) {
            f = 2 * h;
            var k = cc.p(a[2 * h], a[2 * h + 1]),
            m;
            if (0 === h) m = cc.pPerp(cc.pNormalize(cc.pSub(k, cc.p(a[2 * (h + 1)], a[2 * (h + 1) + 1]))));
            else if (h === g) m = cc.pPerp(cc.pNormalize(cc.pSub(cc.p(a[2 * (h - 1)], a[2 * (h - 1) + 1]), k)));
            else {
                m = cc.p(a[2 * (h - 1)], a[2 * (h - 1) + 1]);
                var r = cc.p(a[2 * (h + 1)], a[2 * (h + 1) + 1]),
                s = cc.pNormalize(cc.pSub(r, k)),
                t = cc.pNormalize(cc.pSub(m, k)),
                p = Math.acos(cc.pDot(s, t));
                m = p < cc.degreesToRadians(70) ? cc.pPerp(cc.pNormalize(cc.pMidpoint(s, t))) : p < cc.degreesToRadians(170) ? cc.pNormalize(cc.pMidpoint(s, t)) : cc.pPerp(cc.pNormalize(cc.pSub(r, m)))
            }
            m = cc.pMult(m, b);
            c[2 * f] = k.x + m.x;
            c[2 * f + 1] = k.y + m.y;
            c[2 * (f + 1)] = k.x - m.x;
            c[2 * (f + 1) + 1] = k.y - m.y
        }
        for (h = 0 === d ? 0 : d - 1; h < g; h++) f = 2 * h,
        a = f + 2,
        b = cc.vertex2(c[2 * f], c[2 * f + 1]),
        e = cc.vertex2(c[2 * (f + 1)], c[2 * (f + 1) + 1]),
        f = cc.vertex2(c[2 * a], c[2 * a]),
        d = cc.vertex2(c[2 * (a + 1)], c[2 * (a + 1) + 1]),
        b = !cc.vertexLineIntersect(b.x, b.y, d.x, d.y, e.x, e.y, f.x, f.y),
        !b.isSuccess && (0 > b.value || 1 < b.value) && (b.isSuccess = !0),
        b.isSuccess && (c[2 * a] = d.x, c[2 * a + 1] = d.y, c[2 * (a + 1)] = f.x, c[2 * (a + 1) + 1] = f.y)
    }
};
cc.vertexLineIntersect = function(a, b, c, d, e, f, g, h) {
    if (a === c && b === d || e === g && f === h) return {
        isSuccess: !1,
        value: 0
    };
    c -= a;
    d -= b;
    e -= a;
    f -= b;
    g -= a;
    h -= b;
    a = Math.sqrt(c * c + d * d);
    c /= a;
    d /= a;
    b = e * c + f * d;
    f = f * c - e * d;
    e = b;
    b = g * c + h * d;
    h = h * c - g * d;
    g = b;
    return f === h ? {
        isSuccess: !1,
        value: 0
    }: {
        isSuccess: !0,
        value: (g + (e - g) * h / (h - f)) / a
    }
};
cc.vertexListIsClockwise = function(a) {
    for (var b = 0,
    c = a.length; b < c; b++) {
        var d = a[(b + 1) % c],
        e = a[(b + 2) % c];
        if (0 < cc.pCross(cc.pSub(d, a[b]), cc.pSub(e, d))) return ! 1
    }
    return ! 0
};
cc.CGAffineToGL = function(a, b) {
    b[2] = b[3] = b[6] = b[7] = b[8] = b[9] = b[11] = b[14] = 0;
    b[10] = b[15] = 1;
    b[0] = a.a;
    b[4] = a.c;
    b[12] = a.tx;
    b[1] = a.b;
    b[5] = a.d;
    b[13] = a.ty
};
cc.GLToCGAffine = function(a, b) {
    b.a = a[0];
    b.c = a[4];
    b.tx = a[12];
    b.b = a[1];
    b.d = a[5];
    b.ty = a[13]
};
cc.Touch = cc.Class.extend({
    _lastModified: 0,
    _point: null,
    _prevPoint: null,
    _id: 0,
    _startPointCaptured: !1,
    _startPoint: null,
    ctor: function(a, b, c) {
        this.setTouchInfo(c, a, b)
    },
    getLocation: function() {
        return {
            x: this._point.x,
            y: this._point.y
        }
    },
    getLocationX: function() {
        return this._point.x
    },
    getLocationY: function() {
        return this._point.y
    },
    getPreviousLocation: function() {
        return {
            x: this._prevPoint.x,
            y: this._prevPoint.y
        }
    },
    getStartLocation: function() {
        return {
            x: this._startPoint.x,
            y: this._startPoint.y
        }
    },
    getDelta: function() {
        return cc.pSub(this._point, this._prevPoint)
    },
    getLocationInView: function() {
        return {
            x: this._point.x,
            y: this._point.y
        }
    },
    getPreviousLocationInView: function() {
        return {
            x: this._prevPoint.x,
            y: this._prevPoint.y
        }
    },
    getStartLocationInView: function() {
        return {
            x: this._startPoint.x,
            y: this._startPoint.y
        }
    },
    getID: function() {
        return this._id
    },
    getId: function() {
        cc.log("getId is deprecated. Please use getID instead.");
        return this._id
    },
    setTouchInfo: function(a, b, c) {
        this._prevPoint = this._point;
        this._point = cc.p(b || 0, c || 0);
        this._id = a;
        this._startPointCaptured || (this._startPoint = cc.p(this._point), cc.view._convertPointWithScale(this._startPoint), this._startPointCaptured = !0)
    },
    _setPoint: function(a, b) {
        void 0 === b ? (this._point.x = a.x, this._point.y = a.y) : (this._point.x = a, this._point.y = b)
    },
    _setPrevPoint: function(a, b) {
        this._prevPoint = void 0 === b ? cc.p(a.x, a.y) : cc.p(a || 0, b || 0)
    }
});
cc.Event = cc.Class.extend({
    _type: 0,
    _isStopped: !1,
    _currentTarget: null,
    _setCurrentTarget: function(a) {
        this._currentTarget = a
    },
    ctor: function(a) {
        this._type = a
    },
    getType: function() {
        return this._type
    },
    stopPropagation: function() {
        this._isStopped = !0
    },
    isStopped: function() {
        return this._isStopped
    },
    getCurrentTarget: function() {
        return this._currentTarget
    }
});
cc.Event.TOUCH = 0;
cc.Event.KEYBOARD = 1;
cc.Event.ACCELERATION = 2;
cc.Event.MOUSE = 3;
cc.Event.FOCUS = 4;
cc.Event.CUSTOM = 6;
cc.EventCustom = cc.Event.extend({
    _eventName: null,
    _userData: null,
    ctor: function(a) {
        cc.Event.prototype.ctor.call(this, cc.Event.CUSTOM);
        this._eventName = a
    },
    setUserData: function(a) {
        this._userData = a
    },
    getUserData: function() {
        return this._userData
    },
    getEventName: function() {
        return this._eventName
    }
});
cc.EventMouse = cc.Event.extend({
    _eventType: 0,
    _button: 0,
    _x: 0,
    _y: 0,
    _prevX: 0,
    _prevY: 0,
    _scrollX: 0,
    _scrollY: 0,
    ctor: function(a) {
        cc.Event.prototype.ctor.call(this, cc.Event.MOUSE);
        this._eventType = a
    },
    setScrollData: function(a, b) {
        this._scrollX = a;
        this._scrollY = b
    },
    getScrollX: function() {
        return this._scrollX
    },
    getScrollY: function() {
        return this._scrollY
    },
    setLocation: function(a, b) {
        this._x = a;
        this._y = b
    },
    getLocation: function() {
        return {
            x: this._x,
            y: this._y
        }
    },
    getLocationInView: function() {
        return {
            x: this._x,
            y: cc.view._designResolutionSize.height - this._y
        }
    },
    _setPrevCursor: function(a, b) {
        this._prevX = a;
        this._prevY = b
    },
    getDelta: function() {
        return {
            x: this._x - this._prevX,
            y: this._y - this._prevY
        }
    },
    getDeltaX: function() {
        return this._x - this._prevX
    },
    getDeltaY: function() {
        return this._y - this._prevY
    },
    setButton: function(a) {
        this._button = a
    },
    getButton: function() {
        return this._button
    },
    getLocationX: function() {
        return this._x
    },
    getLocationY: function() {
        return this._y
    }
});
cc.EventMouse.NONE = 0;
cc.EventMouse.DOWN = 1;
cc.EventMouse.UP = 2;
cc.EventMouse.MOVE = 3;
cc.EventMouse.SCROLL = 4;
cc.EventMouse.BUTTON_LEFT = 0;
cc.EventMouse.BUTTON_RIGHT = 2;
cc.EventMouse.BUTTON_MIDDLE = 1;
cc.EventMouse.BUTTON_4 = 3;
cc.EventMouse.BUTTON_5 = 4;
cc.EventMouse.BUTTON_6 = 5;
cc.EventMouse.BUTTON_7 = 6;
cc.EventMouse.BUTTON_8 = 7;
cc.EventTouch = cc.Event.extend({
    _eventCode: 0,
    _touches: null,
    ctor: function(a) {
        cc.Event.prototype.ctor.call(this, cc.Event.TOUCH);
        this._touches = a || []
    },
    getEventCode: function() {
        return this._eventCode
    },
    getTouches: function() {
        return this._touches
    },
    _setEventCode: function(a) {
        this._eventCode = a
    },
    _setTouches: function(a) {
        this._touches = a
    }
});
cc.EventTouch.MAX_TOUCHES = 5;
cc.EventTouch.EventCode = {
    BEGAN: 0,
    MOVED: 1,
    ENDED: 2,
    CANCELLED: 3
};
cc.EventFocus = cc.Event.extend({
    _widgetGetFocus: null,
    _widgetLoseFocus: null,
    ctor: function(a, b) {
        cc.Event.prototype.ctor.call(this, cc.Event.FOCUS);
        this._widgetGetFocus = b;
        this._widgetLoseFocus = a
    }
});
cc.EventListener = cc.Class.extend({
    _onEvent: null,
    _type: 0,
    _listenerID: null,
    _registered: !1,
    _fixedPriority: 0,
    _node: null,
    _paused: !0,
    _isEnabled: !0,
    ctor: function(a, b, c) {
        this._onEvent = c;
        this._type = a || 0;
        this._listenerID = b || ""
    },
    _setPaused: function(a) {
        this._paused = a
    },
    _isPaused: function() {
        return this._paused
    },
    _setRegistered: function(a) {
        this._registered = a
    },
    _isRegistered: function() {
        return this._registered
    },
    _getType: function() {
        return this._type
    },
    _getListenerID: function() {
        return this._listenerID
    },
    _setFixedPriority: function(a) {
        this._fixedPriority = a
    },
    _getFixedPriority: function() {
        return this._fixedPriority
    },
    _setSceneGraphPriority: function(a) {
        this._node = a
    },
    _getSceneGraphPriority: function() {
        return this._node
    },
    checkAvailable: function() {
        return null !== this._onEvent
    },
    clone: function() {
        return null
    },
    setEnabled: function(a) {
        this._isEnabled = a
    },
    isEnabled: function() {
        return this._isEnabled
    },
    retain: function() {},
    release: function() {}
});
cc.EventListener.UNKNOWN = 0;
cc.EventListener.TOUCH_ONE_BY_ONE = 1;
cc.EventListener.TOUCH_ALL_AT_ONCE = 2;
cc.EventListener.KEYBOARD = 3;
cc.EventListener.MOUSE = 4;
cc.EventListener.ACCELERATION = 6;
cc.EventListener.FOCUS = 7;
cc.EventListener.CUSTOM = 8;
cc._EventListenerCustom = cc.EventListener.extend({
    _onCustomEvent: null,
    ctor: function(a, b, c) {
        this._onCustomEvent = b;
        this._target = c;
        cc.EventListener.prototype.ctor.call(this, cc.EventListener.CUSTOM, a, this._callback)
    },
    _callback: function(a) {
        null !== this._onCustomEvent && this._onCustomEvent.call(this._target, a)
    },
    checkAvailable: function() {
        return cc.EventListener.prototype.checkAvailable.call(this) && null !== this._onCustomEvent
    },
    clone: function() {
        return new cc._EventListenerCustom(this._listenerID, this._onCustomEvent)
    }
});
cc._EventListenerCustom.create = function(a, b) {
    return new cc._EventListenerCustom(a, b)
};
cc._EventListenerMouse = cc.EventListener.extend({
    onMouseDown: null,
    onMouseUp: null,
    onMouseMove: null,
    onMouseScroll: null,
    ctor: function() {
        cc.EventListener.prototype.ctor.call(this, cc.EventListener.MOUSE, cc._EventListenerMouse.LISTENER_ID, this._callback)
    },
    _callback: function(a) {
        var b = cc.EventMouse;
        switch (a._eventType) {
        case b.DOWN:
            if (this.onMouseDown) this.onMouseDown(a);
            break;
        case b.UP:
            if (this.onMouseUp) this.onMouseUp(a);
            break;
        case b.MOVE:
            if (this.onMouseMove) this.onMouseMove(a);
            break;
        case b.SCROLL:
            if (this.onMouseScroll) this.onMouseScroll(a)
        }
    },
    clone: function() {
        var a = new cc._EventListenerMouse;
        a.onMouseDown = this.onMouseDown;
        a.onMouseUp = this.onMouseUp;
        a.onMouseMove = this.onMouseMove;
        a.onMouseScroll = this.onMouseScroll;
        return a
    },
    checkAvailable: function() {
        return ! 0
    }
});
cc._EventListenerMouse.LISTENER_ID = "__cc_mouse";
cc._EventListenerMouse.create = function() {
    return new cc._EventListenerMouse
};
cc._EventListenerTouchOneByOne = cc.EventListener.extend({
    _claimedTouches: null,
    swallowTouches: !1,
    onTouchBegan: null,
    onTouchMoved: null,
    onTouchEnded: null,
    onTouchCancelled: null,
    ctor: function() {
        cc.EventListener.prototype.ctor.call(this, cc.EventListener.TOUCH_ONE_BY_ONE, cc._EventListenerTouchOneByOne.LISTENER_ID, null);
        this._claimedTouches = []
    },
    setSwallowTouches: function(a) {
        this.swallowTouches = a
    },
    isSwallowTouches: function() {
        return this.swallowTouches
    },
    clone: function() {
        var a = new cc._EventListenerTouchOneByOne;
        a.onTouchBegan = this.onTouchBegan;
        a.onTouchMoved = this.onTouchMoved;
        a.onTouchEnded = this.onTouchEnded;
        a.onTouchCancelled = this.onTouchCancelled;
        a.swallowTouches = this.swallowTouches;
        return a
    },
    checkAvailable: function() {
        return this.onTouchBegan ? !0 : (cc.log(cc._LogInfos._EventListenerTouchOneByOne_checkAvailable), !1)
    }
});
cc._EventListenerTouchOneByOne.LISTENER_ID = "__cc_touch_one_by_one";
cc._EventListenerTouchOneByOne.create = function() {
    return new cc._EventListenerTouchOneByOne
};
cc._EventListenerTouchAllAtOnce = cc.EventListener.extend({
    onTouchesBegan: null,
    onTouchesMoved: null,
    onTouchesEnded: null,
    onTouchesCancelled: null,
    ctor: function() {
        cc.EventListener.prototype.ctor.call(this, cc.EventListener.TOUCH_ALL_AT_ONCE, cc._EventListenerTouchAllAtOnce.LISTENER_ID, null)
    },
    clone: function() {
        var a = new cc._EventListenerTouchAllAtOnce;
        a.onTouchesBegan = this.onTouchesBegan;
        a.onTouchesMoved = this.onTouchesMoved;
        a.onTouchesEnded = this.onTouchesEnded;
        a.onTouchesCancelled = this.onTouchesCancelled;
        return a
    },
    checkAvailable: function() {
        return null === this.onTouchesBegan && null === this.onTouchesMoved && null === this.onTouchesEnded && null === this.onTouchesCancelled ? (cc.log(cc._LogInfos._EventListenerTouchAllAtOnce_checkAvailable), !1) : !0
    }
});
cc._EventListenerTouchAllAtOnce.LISTENER_ID = "__cc_touch_all_at_once";
cc._EventListenerTouchAllAtOnce.create = function() {
    return new cc._EventListenerTouchAllAtOnce
};
cc.EventListener.create = function(a) {
    cc.assert(a && a.event, cc._LogInfos.EventListener_create);
    var b = a.event;
    delete a.event;
    var c = null;
    b === cc.EventListener.TOUCH_ONE_BY_ONE ? c = new cc._EventListenerTouchOneByOne: b === cc.EventListener.TOUCH_ALL_AT_ONCE ? c = new cc._EventListenerTouchAllAtOnce: b === cc.EventListener.MOUSE ? c = new cc._EventListenerMouse: b === cc.EventListener.CUSTOM ? (c = new cc._EventListenerCustom(a.eventName, a.callback), delete a.eventName, delete a.callback) : b === cc.EventListener.KEYBOARD ? c = new cc._EventListenerKeyboard: b === cc.EventListener.ACCELERATION ? (c = new cc._EventListenerAcceleration(a.callback), delete a.callback) : b === cc.EventListener.FOCUS && (c = new cc._EventListenerFocus);
    for (var d in a) c[d] = a[d];
    return c
};
cc._EventListenerFocus = cc.EventListener.extend({
    clone: function() {
        var a = new cc._EventListenerFocus;
        a.onFocusChanged = this.onFocusChanged;
        return a
    },
    checkAvailable: function() {
        return this.onFocusChanged ? !0 : (cc.log("Invalid EventListenerFocus!"), !1)
    },
    onFocusChanged: null,
    ctor: function() {
        cc.EventListener.prototype.ctor.call(this, cc.EventListener.FOCUS, cc._EventListenerFocus.LISTENER_ID, this._callback)
    },
    _callback: function(a) {
        if (this.onFocusChanged) this.onFocusChanged(a._widgetLoseFocus, a._widgetGetFocus)
    }
});
cc._EventListenerFocus.LISTENER_ID = "__cc_focus_event"; (function() {
    function a(a) {
        var c = cc.Event,
        d = a._type;
        if (d === c.ACCELERATION) return cc._EventListenerAcceleration.LISTENER_ID;
        if (d === c.CUSTOM) return a._eventName;
        if (d === c.KEYBOARD) return cc._EventListenerKeyboard.LISTENER_ID;
        if (d === c.MOUSE) return cc._EventListenerMouse.LISTENER_ID;
        if (d === c.FOCUS) return cc._EventListenerFocus.LISTENER_ID;
        d === c.TOUCH && cc.log(cc._LogInfos.__getListenerID);
        return ""
    }
    cc._EventListenerVector = cc.Class.extend({
        _fixedListeners: null,
        _sceneGraphListeners: null,
        gt0Index: 0,
        ctor: function() {
            this._fixedListeners = [];
            this._sceneGraphListeners = []
        },
        size: function() {
            return this._fixedListeners.length + this._sceneGraphListeners.length
        },
        empty: function() {
            return 0 === this._fixedListeners.length && 0 === this._sceneGraphListeners.length
        },
        push: function(a) {
            0 === a._getFixedPriority() ? this._sceneGraphListeners.push(a) : this._fixedListeners.push(a)
        },
        clearSceneGraphListeners: function() {
            this._sceneGraphListeners.length = 0
        },
        clearFixedListeners: function() {
            this._fixedListeners.length = 0
        },
        clear: function() {
            this._sceneGraphListeners.length = 0;
            this._fixedListeners.length = 0
        },
        getFixedPriorityListeners: function() {
            return this._fixedListeners
        },
        getSceneGraphPriorityListeners: function() {
            return this._sceneGraphListeners
        }
    });
    cc.eventManager = {
        DIRTY_NONE: 0,
        DIRTY_FIXED_PRIORITY: 1,
        DIRTY_SCENE_GRAPH_PRIORITY: 2,
        DIRTY_ALL: 3,
        _listenersMap: {},
        _priorityDirtyFlagMap: {},
        _nodeListenersMap: {},
        _nodePriorityMap: {},
        _globalZOrderNodeMap: {},
        _toAddedListeners: [],
        _toRemovedListeners: [],
        _dirtyNodes: [],
        _inDispatch: 0,
        _isEnabled: !1,
        _nodePriorityIndex: 0,
        _internalCustomListenerIDs: [cc.game.EVENT_HIDE, cc.game.EVENT_SHOW],
        _setDirtyForNode: function(a) {
            null != this._nodeListenersMap[a.__instanceId] && this._dirtyNodes.push(a);
            a = a.getChildren();
            for (var c = 0,
            d = a.length; c < d; c++) this._setDirtyForNode(a[c])
        },
        pauseTarget: function(a, c) {
            var d = this._nodeListenersMap[a.__instanceId],
            e,
            f;
            if (d) for (e = 0, f = d.length; e < f; e++) d[e]._setPaused(!0);
            if (!0 === c) for (d = a.getChildren(), e = 0, f = d.length; e < f; e++) this.pauseTarget(d[e], !0)
        },
        resumeTarget: function(a, c) {
            var d = this._nodeListenersMap[a.__instanceId],
            e,
            f;
            if (d) for (e = 0, f = d.length; e < f; e++) d[e]._setPaused(!1);
            this._setDirtyForNode(a);
            if (!0 === c) for (d = a.getChildren(), e = 0, f = d.length; e < f; e++) this.resumeTarget(d[e], !0)
        },
        _addListener: function(a) {
            0 === this._inDispatch ? this._forceAddEventListener(a) : this._toAddedListeners.push(a)
        },
        _forceAddEventListener: function(a) {
            var c = a._getListenerID(),
            d = this._listenersMap[c];
            d || (d = new cc._EventListenerVector, this._listenersMap[c] = d);
            d.push(a);
            0 === a._getFixedPriority() ? (this._setDirty(c, this.DIRTY_SCENE_GRAPH_PRIORITY), c = a._getSceneGraphPriority(), null === c && cc.log(cc._LogInfos.eventManager__forceAddEventListener), this._associateNodeAndEventListener(c, a), c.isRunning() && this.resumeTarget(c)) : this._setDirty(c, this.DIRTY_FIXED_PRIORITY)
        },
        _getListeners: function(a) {
            return this._listenersMap[a]
        },
        _updateDirtyFlagForSceneGraph: function() {
            if (0 !== this._dirtyNodes.length) {
                for (var a = this._dirtyNodes,
                c, d, e = this._nodeListenersMap,
                f = 0,
                g = a.length; f < g; f++) if (c = e[a[f].__instanceId]) for (var h = 0,
                k = c.length; h < k; h++)(d = c[h]) && this._setDirty(d._getListenerID(), this.DIRTY_SCENE_GRAPH_PRIORITY);
                this._dirtyNodes.length = 0
            }
        },
        _removeAllListenersInVector: function(a) {
            if (a) for (var c, d = 0; d < a.length;) c = a[d],
            c._setRegistered(!1),
            null != c._getSceneGraphPriority() && (this._dissociateNodeAndEventListener(c._getSceneGraphPriority(), c), c._setSceneGraphPriority(null)),
            0 === this._inDispatch ? cc.arrayRemoveObject(a, c) : ++d
        },
        _removeListenersForListenerID: function(a) {
            var c = this._listenersMap[a];
            if (c) {
                var d = c.getFixedPriorityListeners(),
                e = c.getSceneGraphPriorityListeners();
                this._removeAllListenersInVector(e);
                this._removeAllListenersInVector(d);
                delete this._priorityDirtyFlagMap[a];
                this._inDispatch || c.clear();
                delete this._listenersMap[a]
            }
            d = this._toAddedListeners;
            for (c = 0; c < d.length;)(e = d[c]) && e._getListenerID() === a ? cc.arrayRemoveObject(d, e) : ++c
        },
        _sortEventListeners: function(a) {
            var c = this.DIRTY_NONE,
            d = this._priorityDirtyFlagMap;
            d[a] && (c = d[a]);
            c !== this.DIRTY_NONE && (d[a] = this.DIRTY_NONE, c & this.DIRTY_FIXED_PRIORITY && this._sortListenersOfFixedPriority(a), c & this.DIRTY_SCENE_GRAPH_PRIORITY && ((c = cc.director.getRunningScene()) ? this._sortListenersOfSceneGraphPriority(a, c) : d[a] = this.DIRTY_SCENE_GRAPH_PRIORITY))
        },
        _sortListenersOfSceneGraphPriority: function(a, c) {
            var d = this._getListeners(a);
            if (d) {
                var e = d.getSceneGraphPriorityListeners();
                e && 0 !== e.length && (this._nodePriorityIndex = 0, this._nodePriorityMap = {},
                this._visitTarget(c, !0), d.getSceneGraphPriorityListeners().sort(this._sortEventListenersOfSceneGraphPriorityDes))
            }
        },
        _sortEventListenersOfSceneGraphPriorityDes: function(a, c) {
            var d = cc.eventManager._nodePriorityMap,
            e = a._getSceneGraphPriority(),
            f = c._getSceneGraphPriority();
            return c && f && d[f.__instanceId] ? a && e && d[e.__instanceId] ? d[c._getSceneGraphPriority().__instanceId] - d[a._getSceneGraphPriority().__instanceId] : 1 : -1
        },
        _sortListenersOfFixedPriority: function(a) {
            if (a = this._listenersMap[a]) {
                var c = a.getFixedPriorityListeners();
                if (c && 0 !== c.length) {
                    c.sort(this._sortListenersOfFixedPriorityAsc);
                    for (var d = 0,
                    e = c.length; d < e && !(0 <= c[d]._getFixedPriority());)++d;
                    a.gt0Index = d
                }
            }
        },
        _sortListenersOfFixedPriorityAsc: function(a, c) {
            return a._getFixedPriority() - c._getFixedPriority()
        },
        _onUpdateListeners: function(a) {
            var c = a.getFixedPriorityListeners(),
            d = a.getSceneGraphPriorityListeners(),
            e,
            f,
            g = this._toRemovedListeners;
            if (d) for (e = 0; e < d.length;) f = d[e],
            f._isRegistered() ? ++e: (cc.arrayRemoveObject(d, f), f = g.indexOf(f), -1 !== f && g.splice(f, 1));
            if (c) for (e = 0; e < c.length;) f = c[e],
            f._isRegistered() ? ++e: (cc.arrayRemoveObject(c, f), f = g.indexOf(f), -1 !== f && g.splice(f, 1));
            d && 0 === d.length && a.clearSceneGraphListeners();
            c && 0 === c.length && a.clearFixedListeners()
        },
        frameUpdateListeners: function() {
            var a = this._listenersMap,
            c = this._priorityDirtyFlagMap,
            d;
            for (d in a) a[d].empty() && (delete c[d], delete a[d]);
            a = this._toAddedListeners;
            if (0 !== a.length) {
                c = 0;
                for (d = a.length; c < d; c++) this._forceAddEventListener(a[c]);
                a.length = 0
            }
            0 !== this._toRemovedListeners.length && this._cleanToRemovedListeners()
        },
        _updateTouchListeners: function(a) {
            a = this._inDispatch;
            cc.assert(0 < a, cc._LogInfos.EventManager__updateListeners);
            if (! (1 < a)) {
                var c; (c = this._listenersMap[cc._EventListenerTouchOneByOne.LISTENER_ID]) && this._onUpdateListeners(c); (c = this._listenersMap[cc._EventListenerTouchAllAtOnce.LISTENER_ID]) && this._onUpdateListeners(c);
                cc.assert(1 === a, cc._LogInfos.EventManager__updateListeners_2);
                a = this._toAddedListeners;
                if (0 !== a.length) {
                    c = 0;
                    for (var d = a.length; c < d; c++) this._forceAddEventListener(a[c]);
                    a.length = 0
                }
                0 !== this._toRemovedListeners.length && this._cleanToRemovedListeners()
            }
        },
        _cleanToRemovedListeners: function() {
            for (var a = this._toRemovedListeners,
            c = 0; c < a.length; c++) {
                var d = a[c],
                e = this._listenersMap[d._getListenerID()];
                if (e) {
                    var f = e.getFixedPriorityListeners(),
                    g = e.getSceneGraphPriorityListeners();
                    g && (e = g.indexOf(d), -1 !== e && g.splice(e, 1));
                    f && (e = f.indexOf(d), -1 !== e && f.splice(e, 1))
                }
            }
            a.length = 0
        },
        _onTouchEventCallback: function(a, c) {
            if (!a._isRegistered) return ! 1;
            var d = c.event,
            e = c.selTouch;
            d._setCurrentTarget(a._node);
            var f = !1,
            g, h = d.getEventCode(),
            k = cc.EventTouch.EventCode;
            if (h === k.BEGAN) a.onTouchBegan && (f = a.onTouchBegan(e, d)) && a._registered && a._claimedTouches.push(e);
            else if (0 < a._claimedTouches.length && -1 !== (g = a._claimedTouches.indexOf(e))) if (f = !0, h === k.MOVED && a.onTouchMoved) a.onTouchMoved(e, d);
            else if (h === k.ENDED) {
                if (a.onTouchEnded) a.onTouchEnded(e, d);
                a._registered && a._claimedTouches.splice(g, 1)
            } else if (h === k.CANCELLED) {
                if (a.onTouchCancelled) a.onTouchCancelled(e, d);
                a._registered && a._claimedTouches.splice(g, 1)
            }
            return d.isStopped() ? (cc.eventManager._updateTouchListeners(d), !0) : f && a._registered && a.swallowTouches ? (c.needsMutableSet && c.touches.splice(e, 1), !0) : !1
        },
        _dispatchTouchEvent: function(a) {
            this._sortEventListeners(cc._EventListenerTouchOneByOne.LISTENER_ID);
            this._sortEventListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);
            var c = this._getListeners(cc._EventListenerTouchOneByOne.LISTENER_ID),
            d = this._getListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);
            if (null !== c || null !== d) {
                var e = a.getTouches(),
                f = cc.copyArray(e),
                g = {
                    event: a,
                    needsMutableSet: c && d,
                    touches: f,
                    selTouch: null
                };
                if (c) for (var h = 0; h < e.length; h++) if (g.selTouch = e[h], this._dispatchEventToListeners(c, this._onTouchEventCallback, g), a.isStopped()) return;
                if (d && 0 < f.length && (this._dispatchEventToListeners(d, this._onTouchesEventCallback, {
                    event: a,
                    touches: f
                }), a.isStopped())) return;
                this._updateTouchListeners(a)
            }
        },
        _onTouchesEventCallback: function(a, c) {
            if (!a._registered) return ! 1;
            var d = cc.EventTouch.EventCode,
            e = c.event,
            f = c.touches,
            g = e.getEventCode();
            e._setCurrentTarget(a._node);
            if (g === d.BEGAN && a.onTouchesBegan) a.onTouchesBegan(f, e);
            else if (g === d.MOVED && a.onTouchesMoved) a.onTouchesMoved(f, e);
            else if (g === d.ENDED && a.onTouchesEnded) a.onTouchesEnded(f, e);
            else if (g === d.CANCELLED && a.onTouchesCancelled) a.onTouchesCancelled(f, e);
            return e.isStopped() ? (cc.eventManager._updateTouchListeners(e), !0) : !1
        },
        _associateNodeAndEventListener: function(a, c) {
            var d = this._nodeListenersMap[a.__instanceId];
            d || (d = [], this._nodeListenersMap[a.__instanceId] = d);
            d.push(c)
        },
        _dissociateNodeAndEventListener: function(a, c) {
            var d = this._nodeListenersMap[a.__instanceId];
            d && (cc.arrayRemoveObject(d, c), 0 === d.length && delete this._nodeListenersMap[a.__instanceId])
        },
        _dispatchEventToListeners: function(a, c, d) {
            var e = !1,
            f = a.getFixedPriorityListeners(),
            g = a.getSceneGraphPriorityListeners(),
            h = 0,
            k;
            if (f && 0 !== f.length) for (; h < a.gt0Index; ++h) if (k = f[h], k.isEnabled() && !k._isPaused() && k._isRegistered() && c(k, d)) {
                e = !0;
                break
            }
            if (g && !e) for (a = 0; a < g.length; a++) if (k = g[a], k.isEnabled() && !k._isPaused() && k._isRegistered() && c(k, d)) {
                e = !0;
                break
            }
            if (f && !e) for (; h < f.length && (k = f[h], !k.isEnabled() || k._isPaused() || !k._isRegistered() || !c(k, d)); ++h);
        },
        _setDirty: function(a, c) {
            var d = this._priorityDirtyFlagMap;
            d[a] = null == d[a] ? c: c | d[a]
        },
        _visitTarget: function(a, c) {
            var d = a.getChildren(),
            e = 0,
            f = d.length,
            g = this._globalZOrderNodeMap,
            h = this._nodeListenersMap;
            if (0 < f) {
                for (var k; e < f; e++) if ((k = d[e]) && 0 > k.getLocalZOrder()) this._visitTarget(k, !1);
                else break;
                null != h[a.__instanceId] && (g[a.getGlobalZOrder()] || (g[a.getGlobalZOrder()] = []), g[a.getGlobalZOrder()].push(a.__instanceId));
                for (; e < f; e++)(k = d[e]) && this._visitTarget(k, !1)
            } else null != h[a.__instanceId] && (g[a.getGlobalZOrder()] || (g[a.getGlobalZOrder()] = []), g[a.getGlobalZOrder()].push(a.__instanceId));
            if (c) {
                var d = [],
                m;
                for (m in g) d.push(m);
                d.sort(this._sortNumberAsc);
                m = d.length;
                k = this._nodePriorityMap;
                for (e = 0; e < m; e++) for (f = g[d[e]], h = 0; h < f.length; h++) k[f[h]] = ++this._nodePriorityIndex;
                this._globalZOrderNodeMap = {}
            }
        },
        _sortNumberAsc: function(a, c) {
            return a - c
        },
        addListener: function(a, c) {
            cc.assert(a && c, cc._LogInfos.eventManager_addListener_2);
            if (! (a instanceof cc.EventListener)) cc.assert(!cc.isNumber(c), cc._LogInfos.eventManager_addListener_3),
            a = cc.EventListener.create(a);
            else if (a._isRegistered()) {
                cc.log(cc._LogInfos.eventManager_addListener_4);
                return
            }
            if (a.checkAvailable()) {
                if (cc.isNumber(c)) {
                    if (0 === c) {
                        cc.log(cc._LogInfos.eventManager_addListener);
                        return
                    }
                    a._setSceneGraphPriority(null);
                    a._setFixedPriority(c);
                    a._setRegistered(!0);
                    a._setPaused(!1)
                } else a._setSceneGraphPriority(c),
                a._setFixedPriority(0),
                a._setRegistered(!0);
                this._addListener(a);
                return a
            }
        },
        addCustomListener: function(a, c, d) {
            a = new cc._EventListenerCustom(a, c, d);
            this.addListener(a, 1);
            return a
        },
        removeListener: function(a) {
            if (null != a) {
                var c, d = this._listenersMap,
                e;
                for (e in d) {
                    var f = d[e],
                    g = f.getFixedPriorityListeners();
                    c = f.getSceneGraphPriorityListeners(); (c = this._removeListenerInVector(c, a)) ? this._setDirty(a._getListenerID(), this.DIRTY_SCENE_GRAPH_PRIORITY) : (c = this._removeListenerInVector(g, a)) && this._setDirty(a._getListenerID(), this.DIRTY_FIXED_PRIORITY);
                    f.empty() && (delete this._priorityDirtyFlagMap[a._getListenerID()], delete d[e]);
                    if (c) break
                }
                if (!c) for (d = this._toAddedListeners, e = 0, f = d.length; e < f; e++) if (g = d[e], g === a) {
                    cc.arrayRemoveObject(d, g);
                    g._setRegistered(!1);
                    break
                }
            }
        },
        _removeListenerInCallback: function(a, c) {
            if (null == a) return ! 1;
            for (var d = 0,
            e = a.length; d < e; d++) {
                var f = a[d];
                if (f._onCustomEvent === c || f._onEvent === c) return f._setRegistered(!1),
                null != f._getSceneGraphPriority() && (this._dissociateNodeAndEventListener(f._getSceneGraphPriority(), f), f._setSceneGraphPriority(null)),
                0 === this._inDispatch && cc.arrayRemoveObject(a, f),
                !0
            }
            return ! 1
        },
        _removeListenerInVector: function(a, c) {
            if (null == a) return ! 1;
            for (var d = 0,
            e = a.length; d < e; d++) {
                var f = a[d];
                if (f === c) return f._setRegistered(!1),
                null != f._getSceneGraphPriority() && (this._dissociateNodeAndEventListener(f._getSceneGraphPriority(), f), f._setSceneGraphPriority(null)),
                0 === this._inDispatch ? cc.arrayRemoveObject(a, f) : this._toRemovedListeners.push(f),
                !0
            }
            return ! 1
        },
        removeListeners: function(a, c) {
            if (a instanceof cc.Node) {
                delete this._nodePriorityMap[a.__instanceId];
                cc.arrayRemoveObject(this._dirtyNodes, a);
                var d = this._nodeListenersMap[a.__instanceId];
                if (d) {
                    for (var e = cc.copyArray(d), d = 0; d < e.length; d++) this.removeListener(e[d]);
                    e.length = 0
                }
                e = this._toAddedListeners;
                for (d = 0; d < e.length;) {
                    var f = e[d];
                    f._getSceneGraphPriority() === a ? (f._setSceneGraphPriority(null), f._setRegistered(!1), e.splice(d, 1)) : ++d
                }
                if (!0 === c) for (e = a.getChildren(), d = 0, f = e.length; d < f; d++) this.removeListeners(e[d], !0)
            } else a === cc.EventListener.TOUCH_ONE_BY_ONE ? this._removeListenersForListenerID(cc._EventListenerTouchOneByOne.LISTENER_ID) : a === cc.EventListener.TOUCH_ALL_AT_ONCE ? this._removeListenersForListenerID(cc._EventListenerTouchAllAtOnce.LISTENER_ID) : a === cc.EventListener.MOUSE ? this._removeListenersForListenerID(cc._EventListenerMouse.LISTENER_ID) : a === cc.EventListener.ACCELERATION ? this._removeListenersForListenerID(cc._EventListenerAcceleration.LISTENER_ID) : a === cc.EventListener.KEYBOARD ? this._removeListenersForListenerID(cc._EventListenerKeyboard.LISTENER_ID) : cc.log(cc._LogInfos.eventManager_removeListeners)
        },
        removeCustomListeners: function(a) {
            this._removeListenersForListenerID(a)
        },
        removeAllListeners: function() {
            var a = this._listenersMap,
            c = this._internalCustomListenerIDs,
            d;
            for (d in a) - 1 === c.indexOf(d) && this._removeListenersForListenerID(d)
        },
        setPriority: function(a, c) {
            if (null != a) {
                var d = this._listenersMap,
                e;
                for (e in d) {
                    var f = d[e].getFixedPriorityListeners();
                    if (f && -1 !== f.indexOf(a)) {
                        null != a._getSceneGraphPriority() && cc.log(cc._LogInfos.eventManager_setPriority);
                        a._getFixedPriority() !== c && (a._setFixedPriority(c), this._setDirty(a._getListenerID(), this.DIRTY_FIXED_PRIORITY));
                        break
                    }
                }
            }
        },
        setEnabled: function(a) {
            this._isEnabled = a
        },
        isEnabled: function() {
            return this._isEnabled
        },
        dispatchEvent: function(b) {
            if (this._isEnabled) {
                this._updateDirtyFlagForSceneGraph();
                this._inDispatch++;
                if (!b || !b.getType) throw Error("event is undefined");
                if (b._type === cc.Event.TOUCH) this._dispatchTouchEvent(b);
                else {
                    var c = a(b);
                    this._sortEventListeners(c);
                    if (c = this._listenersMap[c]) this._dispatchEventToListeners(c, this._onListenerCallback, b),
                    this._onUpdateListeners(c)
                }
                this._inDispatch--
            }
        },
        _onListenerCallback: function(a, c) {
            c._setCurrentTarget(a._getSceneGraphPriority());
            a._onEvent(c);
            return c.isStopped()
        },
        dispatchCustomEvent: function(a, c) {
            var d = new cc.EventCustom(a);
            d.setUserData(c);
            this.dispatchEvent(d)
        }
    }
})();
cc.EventAcceleration = cc.Event.extend({
    _acc: null,
    ctor: function(a) {
        cc.Event.prototype.ctor.call(this, cc.Event.ACCELERATION);
        this._acc = a
    }
});
cc.EventKeyboard = cc.Event.extend({
    _keyCode: 0,
    _isPressed: !1,
    ctor: function(a, b) {
        cc.Event.prototype.ctor.call(this, cc.Event.KEYBOARD);
        this._keyCode = a;
        this._isPressed = b
    }
});
cc._EventListenerAcceleration = cc.EventListener.extend({
    _onAccelerationEvent: null,
    ctor: function(a) {
        this._onAccelerationEvent = a;
        var b = this;
        cc.EventListener.prototype.ctor.call(this, cc.EventListener.ACCELERATION, cc._EventListenerAcceleration.LISTENER_ID,
        function(a) {
            b._onAccelerationEvent(a._acc, a)
        })
    },
    checkAvailable: function() {
        cc.assert(this._onAccelerationEvent, cc._LogInfos._EventListenerAcceleration_checkAvailable);
        return ! 0
    },
    clone: function() {
        return new cc._EventListenerAcceleration(this._onAccelerationEvent)
    }
});
cc._EventListenerAcceleration.LISTENER_ID = "__cc_acceleration";
cc._EventListenerAcceleration.create = function(a) {
    return new cc._EventListenerAcceleration(a)
};
cc._EventListenerKeyboard = cc.EventListener.extend({
    onKeyPressed: null,
    onKeyReleased: null,
    ctor: function() {
        var a = this;
        cc.EventListener.prototype.ctor.call(this, cc.EventListener.KEYBOARD, cc._EventListenerKeyboard.LISTENER_ID,
        function(b) {
            if (b._isPressed) {
                if (a.onKeyPressed) a.onKeyPressed(b._keyCode, b)
            } else if (a.onKeyReleased) a.onKeyReleased(b._keyCode, b)
        })
    },
    clone: function() {
        var a = new cc._EventListenerKeyboard;
        a.onKeyPressed = this.onKeyPressed;
        a.onKeyReleased = this.onKeyReleased;
        return a
    },
    checkAvailable: function() {
        return null === this.onKeyPressed && null === this.onKeyReleased ? (cc.log(cc._LogInfos._EventListenerKeyboard_checkAvailable), !1) : !0
    }
});
cc._EventListenerKeyboard.LISTENER_ID = "__cc_keyboard";
cc._EventListenerKeyboard.create = function() {
    return new cc._EventListenerKeyboard
};
var GlobalVertexBuffer = function() {
    var a = function(a, c) {
        this.gl = a;
        this.vertexBuffer = a.createBuffer();
        this.size = 888;
        this.byteLength = c || 3552 * cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;
        this.data = new ArrayBuffer(this.byteLength);
        this.dataArray = new Float32Array(this.data);
        a.bindBuffer(a.ARRAY_BUFFER, this.vertexBuffer);
        a.bufferData(a.ARRAY_BUFFER, this.dataArray, a.DYNAMIC_DRAW);
        this._dirty = !1;
        this._spaces = {
            0 : this.byteLength
        }
    };
    a.prototype = {
        constructor: a,
        allocBuffer: function(a, c) {
            var d = this._spaces[a];
            return d && d >= c ? (delete this._spaces[a], d > c && (this._spaces[a + c] = d - c), !0) : !1
        },
        requestBuffer: function(a) {
            var c, d, e;
            for (c in this._spaces) if (d = parseInt(c), e = this._spaces[c], e >= a && this.allocBuffer(d, a)) return d;
            return - 1
        },
        freeBuffer: function(a, c) {
            var d = this._spaces,
            e, f;
            for (f in d) {
                e = parseInt(f);
                if (e > a) break;
                if (e + d[f] >= a) {
                    c = c + a - e;
                    a = e;
                    break
                }
            }
            d = a + c;
            this._spaces[d] && (c += this._spaces[d], delete this._spaces[d]);
            this._spaces[a] = c
        },
        setDirty: function() {
            this._dirty = !0
        },
        update: function() {
            this._dirty && (this.gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer), this.gl.bufferSubData(gl.ARRAY_BUFFER, 0, this.dataArray), this._dirty = !1)
        },
        updateSubData: function(a, c) {
            this.gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);
            this.gl.bufferSubData(gl.ARRAY_BUFFER, a, c)
        },
        destroy: function() {
            this.gl.deleteBuffer(this.vertexBuffer);
            this.vertexBuffer = this.texCoords = this.colors = this.positions = this.data = null
        }
    };
    return a
} ();
cc.rendererCanvas = {
    childrenOrderDirty: !0,
    assignedZ: 0,
    assignedZStep: 1E-4,
    _transformNodePool: [],
    _renderCmds: [],
    _isCacheToCanvasOn: !1,
    _cacheToCanvasCmds: {},
    _cacheInstanceIds: [],
    _currentID: 0,
    _clearColor: cc.color(),
    _clearFillStyle: "rgb(0, 0, 0)",
    _dirtyRegion: null,
    _allNeedDraw: !0,
    _enableDirtyRegion: !1,
    _debugDirtyRegion: !1,
    _canUseDirtyRegion: !1,
    _dirtyRegionCountThreshold: 10,
    getRenderCmd: function(a) {
        return a._createRenderCmd()
    },
    enableDirtyRegion: function(a) {
        this._enableDirtyRegion = a
    },
    isDirtyRegionEnabled: function() {
        return this._enableDirtyRegion
    },
    setDirtyRegionCountThreshold: function(a) {
        this._dirtyRegionCountThreshold = a
    },
    _collectDirtyRegion: function() {
        var a = this._renderCmds,
        b, c, d = this._dirtyRegion,
        e = 0,
        f = !0,
        g = cc.Node.CanvasRenderCmd.RegionStatus;
        b = 0;
        for (c = a.length; b < c; b++) {
            var h = a[b],
            k = h._oldRegion,
            m = h._currentRegion;
            h._regionFlag > g.NotDirty && (++e, e > this._dirtyRegionCountThreshold && (f = !1), f && (!m.isEmpty() && d.addRegion(m), h._regionFlag > g.Dirty && !k.isEmpty() && d.addRegion(k)), h._regionFlag = g.NotDirty)
        }
        return f
    },
    _beginDrawDirtyRegion: function(a) {
        var b = a.getContext(),
        c = this._dirtyRegion.getDirtyRegions();
        b.save();
        a.setTransform({
            a: 1,
            b: 0,
            c: 0,
            d: 1,
            tx: 0,
            ty: 0
        },
        a._scaleX, a._scaleY);
        b.beginPath();
        a = 0;
        for (var d = c.length; a < d; ++a) {
            var e = c[a];
            b.rect(e._minX, -e._maxY, e._width, e._height)
        }
        b.clip()
    },
    _endDrawDirtyRegion: function(a) {
        a.restore()
    },
    _debugDrawDirtyRegion: function(a) {
        if (this._debugDirtyRegion) {
            var b = a.getContext(),
            c = this._dirtyRegion.getDirtyRegions();
            a.setTransform({
                a: 1,
                b: 0,
                c: 0,
                d: 1,
                tx: 0,
                ty: 0
            },
            a._scaleX, a._scaleY);
            b.beginPath();
            a = 0;
            for (var d = c.length; a < d; ++a) {
                var e = c[a];
                b.rect(e._minX, -e._maxY, e._width, e._height)
            }
            c = b.fillStyle;
            b.fillStyle = "green";
            b.fill();
            b.fillStyle = c
        }
    },
    rendering: function(a) {
        var b = this._dirtyRegion = this._dirtyRegion || new cc.DirtyRegion,
        c = cc._canvas;
        a = a || cc._renderContext;
        var d = a.getContext(),
        e = cc.view.getScaleX(),
        f = cc.view.getScaleY();
        a.setViewScale(e, f);
        a.computeRealOffsetY();
        var g = this._dirtyRegion.getDirtyRegions(),
        h = this._renderCmds,
        k,
        m = this._allNeedDraw || !this._enableDirtyRegion || !this._canUseDirtyRegion;
        k = !0;
        m || (k = this._collectDirtyRegion()); (m = m || !k) || this._beginDrawDirtyRegion(a);
        d.setTransform(1, 0, 0, 1, 0, 0);
        d.clearRect(0, 0, c.width, c.height);
        if (255 !== this._clearColor.r || 255 !== this._clearColor.g || 255 !== this._clearColor.b) a.setFillStyle(this._clearFillStyle),
        a.setGlobalAlpha(this._clearColor.a),
        d.fillRect(0, 0, c.width, c.height);
        c = 0;
        for (k = h.length; c < k; c++) {
            var r = h[c],
            s = !1,
            t = r._currentRegion;
            if (!t || m) s = !0;
            else for (var p = 0,
            v = g.length; p < v; ++p) if (g[p].intersects(t)) {
                s = !0;
                break
            }
            s && r.rendering(a, e, f)
        }
        m || (this._debugDrawDirtyRegion(a), this._endDrawDirtyRegion(d));
        b.clear();
        this._allNeedDraw = !1
    },
    _renderingToCacheCanvas: function(a, b, c, d) {
        a || cc.log("The context of RenderTexture is invalid.");
        c = cc.isUndefined(c) ? 1 : c;
        d = cc.isUndefined(d) ? 1 : d;
        b = b || this._currentID;
        var e, f = this._cacheToCanvasCmds[b],
        g;
        a.computeRealOffsetY();
        e = 0;
        for (g = f.length; e < g; e++) f[e].rendering(a, c, d);
        this._removeCache(b);
        a = this._cacheInstanceIds;
        0 === a.length ? this._isCacheToCanvasOn = !1 : this._currentID = a[a.length - 1]
    },
    _turnToCacheMode: function(a) {
        this._isCacheToCanvasOn = !0;
        a = a || 0;
        this._cacheToCanvasCmds[a] = []; - 1 === this._cacheInstanceIds.indexOf(a) && this._cacheInstanceIds.push(a);
        this._currentID = a
    },
    _turnToNormalMode: function() {
        this._isCacheToCanvasOn = !1
    },
    _removeCache: function(a) {
        a = a || this._currentID;
        var b = this._cacheToCanvasCmds[a];
        b && (b.length = 0, delete this._cacheToCanvasCmds[a]);
        cc.arrayRemoveObject(this._cacheInstanceIds, a)
    },
    resetFlag: function() {
        this.childrenOrderDirty = !1;
        this._transformNodePool.length = 0
    },
    transform: function() {
        var a = this._transformNodePool;
        a.sort(this._sortNodeByLevelAsc);
        for (var b = 0,
        c = a.length; b < c; b++) 0 !== a[b]._dirtyFlag && a[b].updateStatus();
        a.length = 0
    },
    transformDirty: function() {
        return 0 < this._transformNodePool.length
    },
    _sortNodeByLevelAsc: function(a, b) {
        return a._curLevel - b._curLevel
    },
    pushDirtyNode: function(a) {
        this._transformNodePool.push(a)
    },
    clear: function() {},
    clearRenderCommands: function() {
        this._renderCmds.length = 0;
        this._cacheInstanceIds.length = 0;
        this._isCacheToCanvasOn = !1;
        this._canUseDirtyRegion = this._allNeedDraw = !0
    },
    pushRenderCommand: function(a) {
        if (a.needDraw()) if (a._canUseDirtyRegion || (this._canUseDirtyRegion = !1), this._isCacheToCanvasOn) {
            var b = this._cacheToCanvasCmds[this._currentID]; - 1 === b.indexOf(a) && b.push(a)
        } else - 1 === this._renderCmds.indexOf(a) && this._renderCmds.push(a)
    }
}; (function() {
    cc.CanvasContextWrapper = function(a) {
        this._context = a;
        this._saveCount = 0;
        this._currentAlpha = a.globalAlpha;
        this._currentCompositeOperation = a.globalCompositeOperation;
        this._currentFillStyle = a.fillStyle;
        this._currentStrokeStyle = a.strokeStyle;
        this._offsetY = this._offsetX = 0;
        this._realOffsetY = this.height;
        this._armatureMode = 0
    };
    var a = cc.CanvasContextWrapper.prototype;
    a.resetCache = function() {
        var a = this._context;
        this._currentAlpha = a.globalAlpha;
        this._currentCompositeOperation = a.globalCompositeOperation;
        this._currentFillStyle = a.fillStyle;
        this._currentStrokeStyle = a.strokeStyle;
        this._realOffsetY = this._context.canvas.height + this._offsetY
    };
    a.setOffset = function(a, c) {
        this._offsetX = a;
        this._offsetY = c;
        this._realOffsetY = this._context.canvas.height + this._offsetY
    };
    a.computeRealOffsetY = function() {
        this._realOffsetY = this._context.canvas.height + this._offsetY
    };
    a.setViewScale = function(a, c) {
        this._scaleX = a;
        this._scaleY = c
    };
    a.getContext = function() {
        return this._context
    };
    a.save = function() {
        this._context.save();
        this._saveCount++
    };
    a.restore = function() {
        this._context.restore();
        this._saveCount--
    };
    a.setGlobalAlpha = function(a) {
        0 < this._saveCount ? this._context.globalAlpha = a: this._currentAlpha !== a && (this._currentAlpha = a, this._context.globalAlpha = a)
    };
    a.setCompositeOperation = function(a) {
        0 < this._saveCount ? this._context.globalCompositeOperation = a: this._currentCompositeOperation !== a && (this._currentCompositeOperation = a, this._context.globalCompositeOperation = a)
    };
    a.setFillStyle = function(a) {
        0 < this._saveCount ? this._context.fillStyle = a: this._currentFillStyle !== a && (this._currentFillStyle = a, this._context.fillStyle = a)
    };
    a.setStrokeStyle = function(a) {
        0 < this._saveCount ? this._context.strokeStyle = a: this._currentStrokeStyle !== a && (this._currentStrokeStyle = a, this._context.strokeStyle = a)
    };
    a.setTransform = function(a, c, d) {
        0 < this._armatureMode ? (this.restore(), this.save(), this._context.transform(a.a * c, -a.b * d, -a.c * c, a.d * d, a.tx * c, -(a.ty * d))) : this._context.setTransform(a.a * c, -a.b * d, -a.c * c, a.d * d, this._offsetX + a.tx * c, this._realOffsetY - a.ty * d)
    };
    a._switchToArmatureMode = function(a, c, d, e) {
        a ? (this._armatureMode++, this._context.setTransform(c.a, c.c, c.b, c.d, this._offsetX + c.tx * d, this._realOffsetY - c.ty * e), this.save()) : (this._armatureMode--, this.restore())
    }
})();
cc.rendererWebGL = function() {
    var a = {
        texture: null,
        blendSrc: null,
        blendDst: null,
        glProgramState: null
    },
    b = !1,
    c = null,
    d = null,
    e = 0,
    f = 0,
    g = 0,
    h = null,
    k = 0,
    m = null,
    r = null,
    s = null,
    t = 0,
    p = !0,
    v = {
        QUAD: 0,
        TRIANGLE: 1,
        CUSTOM: 2
    };
    return {
        mat4Identity: null,
        childrenOrderDirty: !0,
        assignedZ: 0,
        assignedZStep: 0.01,
        VertexType: v,
        _transformNodePool: [],
        _renderCmds: [],
        _isCacheToBufferOn: !1,
        _cacheToBufferCmds: {},
        _cacheInstanceIds: [],
        _currentID: 0,
        _clearColor: cc.color(0, 0, 0, 255),
        init: function() {
            var a = cc._renderContext;
            a.disable(a.CULL_FACE);
            a.disable(a.DEPTH_TEST);
            this.mat4Identity = new cc.math.Matrix4;
            this.mat4Identity.identity();
            var a = cc.BATCH_VERTEX_COUNT,
            b = cc._renderContext;
            null === c && (d = b.createBuffer(), c = b.createBuffer());
            b = cc._renderContext;
            if (c) {
                var f = 6 * Math.ceil(a / 4);
                b.bindBuffer(b.ELEMENT_ARRAY_BUFFER, c);
                s = new Uint16Array(f);
                for (var g = 0,
                p = 0; p < f; p += 6) s[p] = g + 0,
                s[p + 1] = g + 1,
                s[p + 2] = g + 2,
                s[p + 3] = g + 1,
                s[p + 4] = g + 2,
                s[p + 5] = g + 3,
                g += 4;
                b.bufferData(b.ELEMENT_ARRAY_BUFFER, s, b.DYNAMIC_DRAW)
            }
            d && (k = 6 * a, h = new ArrayBuffer(4 * k), m = new Float32Array(h), r = new Uint32Array(h), b.bindBuffer(b.ARRAY_BUFFER, d), b.bufferData(b.ARRAY_BUFFER, m, b.DYNAMIC_DRAW));
            e = a - 200
        },
        getVertexSize: function() {
            return e
        },
        getRenderCmd: function(a) {
            return a._createRenderCmd()
        },
        _turnToCacheMode: function(a) {
            this._isCacheToBufferOn = !0;
            a = a || 0;
            this._cacheToBufferCmds[a] ? this._cacheToBufferCmds[a].length = 0 : this._cacheToBufferCmds[a] = []; - 1 === this._cacheInstanceIds.indexOf(a) && this._cacheInstanceIds.push(a);
            this._currentID = a
        },
        _turnToNormalMode: function() {
            this._isCacheToBufferOn = !1
        },
        _removeCache: function(a) {
            a = a || this._currentID;
            var b = this._cacheToBufferCmds[a];
            b && (b.length = 0, delete this._cacheToBufferCmds[a]);
            cc.arrayRemoveObject(this._cacheInstanceIds, a)
        },
        _renderingToBuffer: function(a) {
            a = a || this._currentID;
            this.rendering(cc._renderContext, this._cacheToBufferCmds[a]);
            this._removeCache(a);
            a = this._cacheInstanceIds;
            0 === a.length ? this._isCacheToBufferOn = !1 : this._currentID = a[a.length - 1]
        },
        resetFlag: function() {
            this.childrenOrderDirty && (this.childrenOrderDirty = !1);
            this._transformNodePool.length = 0
        },
        transform: function() {
            var a = this._transformNodePool;
            a.sort(this._sortNodeByLevelAsc);
            var b, c, d;
            b = 0;
            for (c = a.length; b < c; b++) d = a[b],
            d.updateStatus();
            a.length = 0
        },
        transformDirty: function() {
            return 0 < this._transformNodePool.length
        },
        _sortNodeByLevelAsc: function(a, b) {
            return a._curLevel - b._curLevel
        },
        pushDirtyNode: function(a) {
            this._transformNodePool.push(a)
        },
        clearRenderCommands: function() {
            this._renderCmds.length = 0
        },
        clear: function() {
            var a = cc._renderContext;
            a.clearColor(this._clearColor.r / 255, this._clearColor.g / 255, this._clearColor.b / 255, this._clearColor.a / 255);
            a.clear(a.COLOR_BUFFER_BIT | a.DEPTH_BUFFER_BIT)
        },
        setDepthTest: function(a) {
            var b = cc._renderContext;
            a ? (b.clearDepth(1), b.enable(b.DEPTH_TEST), b.depthFunc(b.LEQUAL)) : b.disable(b.DEPTH_TEST)
        },
        pushRenderCommand: function(a) {
            if (a.rendering || a.uploadData) if (this._isCacheToBufferOn) {
                var b = this._cacheToBufferCmds[this._currentID]; - 1 === b.indexOf(a) && b.push(a)
            } else - 1 === this._renderCmds.indexOf(a) && this._renderCmds.push(a)
        },
        _increaseBatchingSize: function(a, b, c) {
            b = b || v.QUAD;
            switch (b) {
            case v.QUAD:
                for (b = 0; b < a; b += 4) c = f + b,
                s[g++] = c + 0,
                s[g++] = c + 1,
                s[g++] = c + 2,
                s[g++] = c + 1,
                s[g++] = c + 2,
                s[g++] = c + 3;
                break;
            case v.TRIANGLE:
                p = !1;
                for (b = 0; b < a; b += 3) c = f + b,
                s[g++] = c + 0,
                s[g++] = c + 1,
                s[g++] = c + 2;
                break;
            case v.CUSTOM:
                p = !1;
                var d = c.length;
                for (b = 0; b < d; b++) s[g++] = f + c[b];
                break;
            default:
                return
            }
            f += a
        },
        _updateBatchedInfo: function(b, c, d) {
            return b !== a.texture || c.src !== a.blendSrc || c.dst !== a.blendDst || d !== a.glProgramState ? (this._batchRendering(), a.texture = b, a.blendSrc = c.src, a.blendDst = c.dst, a.glProgramState = d, !0) : !1
        },
        _breakBatch: function() {
            b = !0
        },
        _uploadBufferData: function(c) {
            f >= e && this._batchRendering();
            var d = c._node,
            g = d._texture || d._spriteFrame && d._spriteFrame._texture,
            h = d._blendFunc.src,
            d = d._blendFunc.dst,
            k = c._glProgramState;
            if (b || a.texture !== g || a.blendSrc !== h || a.blendDst !== d || a.glProgramState !== k) this._batchRendering(),
            a.texture = g,
            a.blendSrc = h,
            a.blendDst = d,
            a.glProgramState = k,
            b = !1;
            g = c.uploadData(m, r, 6 * f);
            0 < g && this._increaseBatchingSize(g, c.vertexType)
        },
        _batchRendering: function() {
            if (0 !== f && a.texture) {
                var b = cc._renderContext,
                h = a.texture,
                k = a.glProgramState,
                r = f > 0.5 * e;
                k && (k.apply(), k.getGLProgram()._updateProjectionUniform());
                cc.glBlendFunc(a.blendSrc, a.blendDst);
                cc.glBindTexture2DN(0, h);
                b.bindBuffer(b.ARRAY_BUFFER, d);
                r ? b.bufferData(b.ARRAY_BUFFER, m, b.DYNAMIC_DRAW) : (h = m.subarray(0, 6 * f), b.bufferData(b.ARRAY_BUFFER, h, b.DYNAMIC_DRAW));
                b.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);
                b.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR);
                b.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS);
                b.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 3, b.FLOAT, !1, 24, 0);
                b.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR, 4, b.UNSIGNED_BYTE, !0, 24, 12);
                b.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS, 2, b.FLOAT, !1, 24, 16);
                b.bindBuffer(b.ELEMENT_ARRAY_BUFFER, c);
                if (!t || !p || g > t) r ? b.bufferData(b.ELEMENT_ARRAY_BUFFER, s, b.DYNAMIC_DRAW) : b.bufferData(b.ELEMENT_ARRAY_BUFFER, s.subarray(0, g), b.DYNAMIC_DRAW);
                b.drawElements(b.TRIANGLES, g, b.UNSIGNED_SHORT, 0);
                cc.g_NumberOfDraws++;
                p ? t = g: (t = 0, p = !0);
                g = f = 0
            }
        },
        rendering: function(b, c) {
            var d = c || this._renderCmds,
            e, g, h, k = b || cc._renderContext;
            k.bindBuffer(gl.ARRAY_BUFFER, null);
            e = 0;
            for (g = d.length; e < g; ++e) h = d[e],
            h.needDraw() && (h.uploadData ? this._uploadBufferData(h) : (0 < f && this._batchRendering(), h.rendering(k)));
            this._batchRendering();
            a.texture = null
        }
    }
} ();
var Region = function() {
    this._area = this._height = this._width = this._maxY = this._maxX = this._minY = this._minX = 0
},
regionProto = Region.prototype,
regionPool = [];
function regionCreate() {
    var a = regionPool.pop();
    a || (a = new Region);
    return a
}
function regionRelease(a) {
    regionPool.push(a)
}
regionProto.setTo = function(a, b, c, d) {
    this._minX = a;
    this._minY = b;
    this._maxX = c;
    this._maxY = d;
    this.updateArea();
    return this
};
regionProto.intValues = function() {
    this._minX = Math.floor(this._minX);
    this._minY = Math.floor(this._minY);
    this._maxX = Math.ceil(this._maxX);
    this._maxY = Math.ceil(this._maxY);
    this.updateArea()
};
regionProto.updateArea = function() {
    this._width = this._maxX - this._minX;
    this._height = this._maxY - this._minY;
    this._area = this._width * this._height
};
regionProto.union = function(a) {
    0 >= this._width || 0 >= this._height ? this.setTo(a._minX, a._minY, a._maxX, a._maxY) : (this._minX > a._minX && (this._minX = a._minX), this._minY > a._minY && (this._minY = a._minY), this._maxX < a._maxX && (this._maxX = a._maxX), this._maxY < a._maxY && (this._maxY = a._maxY), this.updateArea())
};
regionProto.setEmpty = function() {
    this._area = this._height = this._width = this._maxY = this._maxX = this._minY = this._minX = 0
};
regionProto.isEmpty = function() {
    return 0 >= this._width || 0 >= this._height
};
regionProto.intersects = function(a) {
    if (0 >= this._width || 0 >= this._height || 0 >= a._width || 0 >= a._height) return ! 1;
    var b = this._minX > a._minX ? this._minX: a._minX,
    c = this._maxX < a._maxX ? this._maxX: a._maxX;
    if (b > c) return ! 1;
    b = this._minY > a._minY ? this._minY: a._minY;
    c = this._maxY < a._maxY ? this._maxY: a._maxY;
    return b <= c
};
regionProto.updateRegion = function(a, b) {
    if (0 == a.width || 0 == a.height) this.setEmpty();
    else {
        var c = b.a,
        d = b.b,
        e = b.c,
        f = b.d,
        g = b.tx,
        h = b.ty,
        k = a.x,
        m = a.y,
        r = k + a.width,
        s = m + a.height,
        t, p, v;
        if (1 == c && 0 == d && 0 == e && 1 == f) t = k + g - 1,
        p = m + h - 1,
        v = r + g + 1,
        m = s + h + 1;
        else {
            t = c * k + e * m + g;
            p = d * k + f * m + h;
            v = c * r + e * m + g;
            var m = d * r + f * m + h,
            u = c * r + e * s + g,
            r = d * r + f * s + h,
            g = c * k + e * s + g,
            h = d * k + f * s + h,
            s = 0;
            t > v && (s = t, t = v, v = s);
            u > g && (s = u, u = g, g = s);
            t = (t < u ? t: u) - 1;
            v = (v > g ? v: g) + 1;
            p > m && (s = p, p = m, m = s);
            r > h && (s = r, r = h, h = s);
            p = (p < r ? p: r) - 1;
            m = (m > h ? m: h) + 1
        }
        this._minX = t;
        this._minY = p;
        this._maxX = v;
        this._maxY = m;
        this._width = v - t;
        this._height = m - p;
        this._area = this._width * this._height
    }
};
function unionArea(a, b) {
    return ((a._maxX > b._maxX ? a._maxX: b._maxX) - (a._minX < b._minX ? a._minX: b._minX)) * ((a._maxY > b._maxY ? a._maxY: b._maxY) - (a._minY < b._minY ? a._minY: b._minY))
}
var DirtyRegion = function() {
    this.dirtyList = [];
    this.hasClipRect = !1;
    this.clipArea = this.clipHeight = this.clipWidth = 0;
    this.clipRectChanged = !1
},
dirtyRegionProto = DirtyRegion.prototype;
dirtyRegionProto.setClipRect = function(a, b) {
    this.clipRectChanged = this.hasClipRect = !0;
    this.clipWidth = Math.ceil(a);
    this.clipHeight = Math.ceil(b);
    this.clipArea = this.clipWidth * this.clipHeight
};
dirtyRegionProto.addRegion = function(a) {
    var b = a._minX,
    c = a._minY,
    d = a._maxX;
    a = a._maxY;
    this.hasClipRect && (0 > b && (b = 0), 0 > c && (c = 0), d > this.clipWidth && (d = this.clipWidth), a > this.clipHeight && (a = this.clipHeight));
    if (b >= d || c >= a) return ! 1;
    if (this.clipRectChanged) return ! 0;
    var e = this.dirtyList,
    f = regionCreate();
    e.push(f.setTo(b, c, d, a));
    this.mergeDirtyList(e);
    return ! 0
};
dirtyRegionProto.clear = function() {
    for (var a = this.dirtyList,
    b = a.length,
    c = 0; c < b; c++) regionRelease(a[c]);
    a.length = 0
};
dirtyRegionProto.getDirtyRegions = function() {
    var a = this.dirtyList;
    if (this.clipRectChanged) {
        this.clipRectChanged = !1;
        this.clear();
        var b = regionCreate();
        a.push(b.setTo(0, 0, this.clipWidth, this.clipHeight))
    } else for (; this.mergeDirtyList(a););
    a = this.dirtyList.length;
    if (0 < a) for (b = 0; b < a; b++) this.dirtyList[b].intValues();
    return this.dirtyList
};
dirtyRegionProto.mergeDirtyList = function(a) {
    var b = a.length;
    if (2 > b) return ! 1;
    for (var c = this.hasClipRect,
    d = 3 < b ? Number.POSITIVE_INFINITY: 0, e = 0, f = 0, g = 0, h = 0; h < b - 1; h++) {
        var k = a[h];
        c && (g += k.area);
        for (var m = h + 1; m < b; m++) {
            var r = a[m],
            r = unionArea(k, r) - k.area - r.area;
            d > r && (e = h, f = m, d = r)
        }
    }
    c && 0.95 < g / this.clipArea && (this.clipRectChanged = !0);
    return e != f ? (b = a[f], a[e].union(b), regionRelease(b), a.splice(f, 1), !0) : !1
};
cc.Region = Region;
cc.DirtyRegion = DirtyRegion;
cc._tmp.PrototypeCCNode = function() {
    var a = cc.Node.prototype;
    cc.defineGetterSetter(a, "x", a.getPositionX, a.setPositionX);
    cc.defineGetterSetter(a, "y", a.getPositionY, a.setPositionY);
    cc.defineGetterSetter(a, "width", a._getWidth, a._setWidth);
    cc.defineGetterSetter(a, "height", a._getHeight, a._setHeight);
    cc.defineGetterSetter(a, "anchorX", a._getAnchorX, a._setAnchorX);
    cc.defineGetterSetter(a, "anchorY", a._getAnchorY, a._setAnchorY);
    cc.defineGetterSetter(a, "skewX", a.getSkewX, a.setSkewX);
    cc.defineGetterSetter(a, "skewY", a.getSkewY, a.setSkewY);
    cc.defineGetterSetter(a, "zIndex", a.getLocalZOrder, a.setLocalZOrder);
    cc.defineGetterSetter(a, "vertexZ", a.getVertexZ, a.setVertexZ);
    cc.defineGetterSetter(a, "rotation", a.getRotation, a.setRotation);
    cc.defineGetterSetter(a, "rotationX", a.getRotationX, a.setRotationX);
    cc.defineGetterSetter(a, "rotationY", a.getRotationY, a.setRotationY);
    cc.defineGetterSetter(a, "scale", a.getScale, a.setScale);
    cc.defineGetterSetter(a, "scaleX", a.getScaleX, a.setScaleX);
    cc.defineGetterSetter(a, "scaleY", a.getScaleY, a.setScaleY);
    cc.defineGetterSetter(a, "children", a.getChildren);
    cc.defineGetterSetter(a, "childrenCount", a.getChildrenCount);
    cc.defineGetterSetter(a, "parent", a.getParent, a.setParent);
    cc.defineGetterSetter(a, "visible", a.isVisible, a.setVisible);
    cc.defineGetterSetter(a, "running", a.isRunning);
    cc.defineGetterSetter(a, "ignoreAnchor", a.isIgnoreAnchorPointForPosition, a.ignoreAnchorPointForPosition);
    cc.defineGetterSetter(a, "actionManager", a.getActionManager, a.setActionManager);
    cc.defineGetterSetter(a, "scheduler", a.getScheduler, a.setScheduler);
    cc.defineGetterSetter(a, "shaderProgram", a.getShaderProgram, a.setShaderProgram);
    cc.defineGetterSetter(a, "opacity", a.getOpacity, a.setOpacity);
    cc.defineGetterSetter(a, "opacityModifyRGB", a.isOpacityModifyRGB);
    cc.defineGetterSetter(a, "cascadeOpacity", a.isCascadeOpacityEnabled, a.setCascadeOpacityEnabled);
    cc.defineGetterSetter(a, "color", a.getColor, a.setColor);
    cc.defineGetterSetter(a, "cascadeColor", a.isCascadeColorEnabled, a.setCascadeColorEnabled)
};
cc.NODE_TAG_INVALID = -1;
cc.s_globalOrderOfArrival = 1;
cc.Node = cc.Class.extend({
    _localZOrder: 0,
    _globalZOrder: 0,
    _vertexZ: 0,
    _customZ: NaN,
    _rotationX: 0,
    _rotationY: 0,
    _scaleX: 1,
    _scaleY: 1,
    _position: null,
    _normalizedPosition: null,
    _usingNormalizedPosition: !1,
    _normalizedPositionDirty: !1,
    _skewX: 0,
    _skewY: 0,
    _children: null,
    _visible: !0,
    _anchorPoint: null,
    _contentSize: null,
    _running: !1,
    _parent: null,
    _ignoreAnchorPointForPosition: !1,
    tag: cc.NODE_TAG_INVALID,
    userData: null,
    userObject: null,
    _reorderChildDirty: !1,
    arrivalOrder: 0,
    _actionManager: null,
    _scheduler: null,
    _additionalTransformDirty: !1,
    _additionalTransform: null,
    _componentContainer: null,
    _isTransitionFinished: !1,
    _className: "Node",
    _showNode: !1,
    _name: "",
    _realOpacity: 255,
    _realColor: null,
    _cascadeColorEnabled: !1,
    _cascadeOpacityEnabled: !1,
    _renderCmd: null,
    ctor: function() {
        this._anchorPoint = cc.p(0, 0);
        this._contentSize = cc.size(0, 0);
        this._position = cc.p(0, 0);
        this._normalizedPosition = cc.p(0, 0);
        this._children = [];
        this._additionalTransform = cc.affineTransformMakeIdentity();
        cc.ComponentContainer && (this._componentContainer = new cc.ComponentContainer(this));
        this._realColor = cc.color(255, 255, 255, 255);
        this._renderCmd = this._createRenderCmd()
    },
    init: function() {
        return ! 0
    },
    attr: function(a) {
        for (var b in a) this[b] = a[b]
    },
    getSkewX: function() {
        return this._skewX
    },
    setSkewX: function(a) {
        this._skewX = a;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    getSkewY: function() {
        return this._skewY
    },
    setSkewY: function(a) {
        this._skewY = a;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    setLocalZOrder: function(a) {
        a !== this._localZOrder && (this._parent ? this._parent.reorderChild(this, a) : this._localZOrder = a, cc.eventManager._setDirtyForNode(this))
    },
    _setLocalZOrder: function(a) {
        this._localZOrder = a
    },
    getLocalZOrder: function() {
        return this._localZOrder
    },
    getZOrder: function() {
        cc.log(cc._LogInfos.Node_getZOrder);
        return this.getLocalZOrder()
    },
    setZOrder: function(a) {
        cc.log(cc._LogInfos.Node_setZOrder);
        this.setLocalZOrder(a)
    },
    setGlobalZOrder: function(a) {
        this._globalZOrder !== a && (this._globalZOrder = a, cc.eventManager._setDirtyForNode(this))
    },
    getGlobalZOrder: function() {
        return this._globalZOrder
    },
    getVertexZ: function() {
        return this._vertexZ
    },
    setVertexZ: function(a) {
        this._customZ = this._vertexZ = a
    },
    getRotation: function() {
        this._rotationX !== this._rotationY && cc.log(cc._LogInfos.Node_getRotation);
        return this._rotationX
    },
    setRotation: function(a) {
        this._rotationX = this._rotationY = a;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    getRotationX: function() {
        return this._rotationX
    },
    setRotationX: function(a) {
        this._rotationX = a;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    getRotationY: function() {
        return this._rotationY
    },
    setRotationY: function(a) {
        this._rotationY = a;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    getScale: function() {
        this._scaleX !== this._scaleY && cc.log(cc._LogInfos.Node_getScale);
        return this._scaleX
    },
    setScale: function(a, b) {
        this._scaleX = a;
        this._scaleY = b || 0 === b ? b: a;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    getScaleX: function() {
        return this._scaleX
    },
    setScaleX: function(a) {
        this._scaleX = a;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    getScaleY: function() {
        return this._scaleY
    },
    setScaleY: function(a) {
        this._scaleY = a;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    setPosition: function(a, b) {
        var c = this._position;
        if (void 0 === b) {
            if (c.x === a.x && c.y === a.y) return;
            c.x = a.x;
            c.y = a.y
        } else {
            if (c.x === a && c.y === b) return;
            c.x = a;
            c.y = b
        }
        this._usingNormalizedPosition = !1;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    setNormalizedPosition: function(a, b) {
        var c = this._normalizedPosition;
        void 0 === b ? (c.x = a.x, c.y = a.y) : (c.x = a, c.y = b);
        this._normalizedPositionDirty = this._usingNormalizedPosition = !0;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    getPosition: function() {
        return cc.p(this._position)
    },
    getNormalizedPosition: function() {
        return cc.p(this._normalizedPosition)
    },
    getPositionX: function() {
        return this._position.x
    },
    setPositionX: function(a) {
        this._position.x = a;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    getPositionY: function() {
        return this._position.y
    },
    setPositionY: function(a) {
        this._position.y = a;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    getChildrenCount: function() {
        return this._children.length
    },
    getChildren: function() {
        return this._children
    },
    isVisible: function() {
        return this._visible
    },
    setVisible: function(a) {
        this._visible !== a && (this._visible = a, this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty), cc.renderer.childrenOrderDirty = !0)
    },
    getAnchorPoint: function() {
        return cc.p(this._anchorPoint)
    },
    setAnchorPoint: function(a, b) {
        var c = this._anchorPoint;
        if (void 0 === b) {
            if (a.x === c.x && a.y === c.y) return;
            c.x = a.x;
            c.y = a.y
        } else {
            if (a === c.x && b === c.y) return;
            c.x = a;
            c.y = b
        }
        this._renderCmd._updateAnchorPointInPoint()
    },
    _getAnchorX: function() {
        return this._anchorPoint.x
    },
    _setAnchorX: function(a) {
        this._anchorPoint.x !== a && (this._anchorPoint.x = a, this._renderCmd._updateAnchorPointInPoint())
    },
    _getAnchorY: function() {
        return this._anchorPoint.y
    },
    _setAnchorY: function(a) {
        this._anchorPoint.y !== a && (this._anchorPoint.y = a, this._renderCmd._updateAnchorPointInPoint())
    },
    getAnchorPointInPoints: function() {
        return this._renderCmd.getAnchorPointInPoints()
    },
    _getWidth: function() {
        return this._contentSize.width
    },
    _setWidth: function(a) {
        this._contentSize.width = a;
        this._renderCmd._updateAnchorPointInPoint()
    },
    _getHeight: function() {
        return this._contentSize.height
    },
    _setHeight: function(a) {
        this._contentSize.height = a;
        this._renderCmd._updateAnchorPointInPoint()
    },
    getContentSize: function() {
        return cc.size(this._contentSize)
    },
    setContentSize: function(a, b) {
        var c = this._contentSize;
        if (void 0 === b) {
            if (a.width === c.width && a.height === c.height) return;
            c.width = a.width;
            c.height = a.height
        } else {
            if (a === c.width && b === c.height) return;
            c.width = a;
            c.height = b
        }
        this._renderCmd._updateAnchorPointInPoint()
    },
    isRunning: function() {
        return this._running
    },
    getParent: function() {
        return this._parent
    },
    setParent: function(a) {
        this._parent = a;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    isIgnoreAnchorPointForPosition: function() {
        return this._ignoreAnchorPointForPosition
    },
    ignoreAnchorPointForPosition: function(a) {
        a !== this._ignoreAnchorPointForPosition && (this._ignoreAnchorPointForPosition = a, this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty))
    },
    getTag: function() {
        return this.tag
    },
    setTag: function(a) {
        this.tag = a
    },
    setName: function(a) {
        this._name = a
    },
    getName: function() {
        return this._name
    },
    getUserData: function() {
        return this.userData
    },
    setUserData: function(a) {
        this.userData = a
    },
    getUserObject: function() {
        return this.userObject
    },
    setUserObject: function(a) {
        this.userObject !== a && (this.userObject = a)
    },
    getOrderOfArrival: function() {
        return this.arrivalOrder
    },
    setOrderOfArrival: function(a) {
        this.arrivalOrder = a
    },
    getActionManager: function() {
        return this._actionManager || cc.director.getActionManager()
    },
    setActionManager: function(a) {
        this._actionManager !== a && (this.stopAllActions(), this._actionManager = a)
    },
    getScheduler: function() {
        return this._scheduler || cc.director.getScheduler()
    },
    setScheduler: function(a) {
        this._scheduler !== a && (this.unscheduleAllCallbacks(), this._scheduler = a)
    },
    boundingBox: function() {
        cc.log(cc._LogInfos.Node_boundingBox);
        return this.getBoundingBox()
    },
    getBoundingBox: function() {
        var a = cc.rect(0, 0, this._contentSize.width, this._contentSize.height);
        return cc._rectApplyAffineTransformIn(a, this.getNodeToParentTransform())
    },
    cleanup: function() {
        this.stopAllActions();
        this.unscheduleAllCallbacks();
        cc.eventManager.removeListeners(this)
    },
    getChildByTag: function(a) {
        var b = this._children;
        if (null !== b) for (var c = 0; c < b.length; c++) {
            var d = b[c];
            if (d && d.tag === a) return d
        }
        return null
    },
    getChildByName: function(a) {
        if (!a) return cc.log("Invalid name"),
        null;
        for (var b = this._children,
        c = 0,
        d = b.length; c < d; c++) if (b[c]._name === a) return b[c];
        return null
    },
    addChild: function(a, b, c) {
        b = void 0 === b ? a._localZOrder: b;
        var d, e = !1;
        void 0 === c ? d = a._name: "string" === typeof c ? (d = c, c = void 0) : "number" === typeof c && (e = !0, d = "");
        cc.assert(a, cc._LogInfos.Node_addChild_3);
        cc.assert(null === a._parent, "child already added. It can't be added again");
        this._addChildHelper(a, b, c, d, e)
    },
    _addChildHelper: function(a, b, c, d, e) {
        this._children || (this._children = []);
        this._insertChild(a, b);
        e ? a.setTag(c) : a.setName(d);
        a.setParent(this);
        a.setOrderOfArrival(cc.s_globalOrderOfArrival++);
        this._running && (a._performRecursive(cc.Node._stateCallbackType.onEnter), this._isTransitionFinished && a._performRecursive(cc.Node._stateCallbackType.onEnterTransitionDidFinish));
        a._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);
        this._cascadeColorEnabled && a._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty);
        this._cascadeOpacityEnabled && a._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)
    },
    removeFromParent: function(a) {
        this._parent && (void 0 === a && (a = !0), this._parent.removeChild(this, a))
    },
    removeFromParentAndCleanup: function(a) {
        cc.log(cc._LogInfos.Node_removeFromParentAndCleanup);
        this.removeFromParent(a)
    },
    removeChild: function(a, b) {
        0 !== this._children.length && (void 0 === b && (b = !0), -1 < this._children.indexOf(a) && this._detachChild(a, b), cc.renderer.childrenOrderDirty = !0)
    },
    removeChildByTag: function(a, b) {
        a === cc.NODE_TAG_INVALID && cc.log(cc._LogInfos.Node_removeChildByTag);
        var c = this.getChildByTag(a);
        c ? this.removeChild(c, b) : cc.log(cc._LogInfos.Node_removeChildByTag_2, a)
    },
    removeAllChildrenWithCleanup: function(a) {
        this.removeAllChildren(a)
    },
    removeAllChildren: function(a) {
        var b = this._children;
        if (null !== b) {
            void 0 === a && (a = !0);
            for (var c = 0; c < b.length; c++) {
                var d = b[c];
                d && (this._running && (d._performRecursive(cc.Node._stateCallbackType.onExitTransitionDidStart), d._performRecursive(cc.Node._stateCallbackType.onExit)), a && d._performRecursive(cc.Node._stateCallbackType.cleanup), d.parent = null, d._renderCmd.detachFromParent())
            }
            this._children.length = 0;
            cc.renderer.childrenOrderDirty = !0
        }
    },
    _detachChild: function(a, b) {
        this._running && (a._performRecursive(cc.Node._stateCallbackType.onExitTransitionDidStart), a._performRecursive(cc.Node._stateCallbackType.onExit));
        b && a._performRecursive(cc.Node._stateCallbackType.cleanup);
        a.parent = null;
        a._renderCmd.detachFromParent();
        cc.arrayRemoveObject(this._children, a)
    },
    _insertChild: function(a, b) {
        cc.renderer.childrenOrderDirty = this._reorderChildDirty = !0;
        this._children.push(a);
        a._setLocalZOrder(b)
    },
    setNodeDirty: function() {
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    reorderChild: function(a, b) {
        cc.assert(a, cc._LogInfos.Node_reorderChild); - 1 === this._children.indexOf(a) ? cc.log(cc._LogInfos.Node_reorderChild_2) : (cc.renderer.childrenOrderDirty = this._reorderChildDirty = !0, a.arrivalOrder = cc.s_globalOrderOfArrival, cc.s_globalOrderOfArrival++, a._setLocalZOrder(b), this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.orderDirty))
    },
    sortAllChildren: function() {
        if (this._reorderChildDirty) {
            var a = this._children,
            b = a.length,
            c, d, e;
            for (c = 1; c < b; c++) {
                e = a[c];
                for (d = c - 1; 0 <= d;) {
                    if (e._localZOrder < a[d]._localZOrder) a[d + 1] = a[d];
                    else if (e._localZOrder === a[d]._localZOrder && e.arrivalOrder < a[d].arrivalOrder) a[d + 1] = a[d];
                    else break;
                    d--
                }
                a[d + 1] = e
            }
            this._reorderChildDirty = !1
        }
    },
    draw: function(a) {},
    transformAncestors: function() {
        null !== this._parent && (this._parent.transformAncestors(), this._parent.transform())
    },
    onEnter: function() {
        this._isTransitionFinished = !1;
        this._running = !0;
        this.resume()
    },
    _performRecursive: function(a) {
        var b = cc.Node._stateCallbackType;
        if (! (a >= b.max)) {
            var c = 0,
            d, e, f, g, h, k = cc.Node._performStacks[cc.Node._performing];
            k || (k = [], cc.Node._performStacks.push(k));
            k.length = 0;
            cc.Node._performing++;
            for (f = k[0] = this; f;) {
                if ((d = f._children) && 0 < d.length) for (g = 0, h = d.length; g < h; ++g) e = d[g],
                k.push(e);
                if ((d = f._protectedChildren) && 0 < d.length) for (g = 0, h = d.length; g < h; ++g) e = d[g],
                k.push(e);
                c++;
                f = k[c]
            }
            for (g = k.length - 1; 0 <= g; --g) if (f = k[g], k[g] = null, f) switch (a) {
            case b.onEnter:
                f.onEnter();
                break;
            case b.onExit:
                f.onExit();
                break;
            case b.onEnterTransitionDidFinish:
                f.onEnterTransitionDidFinish();
                break;
            case b.cleanup:
                f.cleanup();
                break;
            case b.onExitTransitionDidStart:
                f.onExitTransitionDidStart()
            }
            cc.Node._performing--
        }
    },
    onEnterTransitionDidFinish: function() {
        this._isTransitionFinished = !0
    },
    onExitTransitionDidStart: function() {},
    onExit: function() {
        this.x = -1E8;
        this.y = -1E7;
        this.setVisible(!1);
        this._running = !1;
        this.pause();
        this.removeAllComponents()
    },
    runAction: function(a) {
        cc.assert(a, cc._LogInfos.Node_runAction);
        this.actionManager.addAction(a, this, !this._running);
        return a
    },
    stopAllActions: function() {
        this.actionManager && this.actionManager.removeAllActionsFromTarget(this)
    },
    stopAction: function(a) {
        this.actionManager.removeAction(a)
    },
    stopActionByTag: function(a) {
        a === cc.ACTION_TAG_INVALID ? cc.log(cc._LogInfos.Node_stopActionByTag) : this.actionManager.removeActionByTag(a, this)
    },
    getActionByTag: function(a) {
        return a === cc.ACTION_TAG_INVALID ? (cc.log(cc._LogInfos.Node_getActionByTag), null) : this.actionManager.getActionByTag(a, this)
    },
    getNumberOfRunningActions: function() {
        return this.actionManager.numberOfRunningActionsInTarget(this)
    },
    scheduleUpdate: function() {
        this.scheduleUpdateWithPriority(0)
    },
    scheduleUpdateWithPriority: function(a) {
        this.scheduler.scheduleUpdate(this, a, !this._running)
    },
    unscheduleUpdate: function() {
        this.scheduler.unscheduleUpdate(this)
    },
    schedule: function(a, b, c, d, e) {
        var f = arguments.length;
        "function" === typeof a ? 1 === f ? (b = 0, c = cc.REPEAT_FOREVER, d = 0, e = this.__instanceId) : 2 === f ? "number" === typeof b ? (c = cc.REPEAT_FOREVER, d = 0, e = this.__instanceId) : (e = b, b = 0, c = cc.REPEAT_FOREVER, d = 0) : 3 === f ? ("string" === typeof c ? (e = c, c = cc.REPEAT_FOREVER) : e = this.__instanceId, d = 0) : 4 === f && (e = this.__instanceId) : 1 === f ? (b = 0, c = cc.REPEAT_FOREVER, d = 0) : 2 === f && (c = cc.REPEAT_FOREVER, d = 0);
        cc.assert(a, cc._LogInfos.Node_schedule);
        cc.assert(0 <= b, cc._LogInfos.Node_schedule_2);
        b = b || 0;
        c = isNaN(c) ? cc.REPEAT_FOREVER: c;
        this.scheduler.schedule(a, this, b, c, d || 0, !this._running, e)
    },
    scheduleOnce: function(a, b, c) {
        void 0 === c && (c = this.__instanceId);
        this.schedule(a, 0, 0, b, c)
    },
    unschedule: function(a) {
        a && this.scheduler.unschedule(a, this)
    },
    unscheduleAllCallbacks: function() {
        this.scheduler.unscheduleAllForTarget(this)
    },
    resumeSchedulerAndActions: function() {
        cc.log(cc._LogInfos.Node_resumeSchedulerAndActions);
        this.resume()
    },
    resume: function() {
        this.scheduler.resumeTarget(this);
        this.actionManager && this.actionManager.resumeTarget(this);
        cc.eventManager.resumeTarget(this)
    },
    pauseSchedulerAndActions: function() {
        cc.log(cc._LogInfos.Node_pauseSchedulerAndActions);
        this.pause()
    },
    pause: function() {
        this.scheduler.pauseTarget(this);
        this.actionManager && this.actionManager.pauseTarget(this);
        cc.eventManager.pauseTarget(this)
    },
    setAdditionalTransform: function(a) {
        if (void 0 === a) return this._additionalTransformDirty = !1;
        this._additionalTransform = a;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);
        this._additionalTransformDirty = !0
    },
    getParentToNodeTransform: function() {
        return this._renderCmd.getParentToNodeTransform()
    },
    parentToNodeTransform: function() {
        return this.getParentToNodeTransform()
    },
    getNodeToWorldTransform: function() {
        for (var a = this.getNodeToParentTransform(), b = this._parent; null !== b; b = b.parent) a = cc.affineTransformConcat(a, b.getNodeToParentTransform());
        return a
    },
    nodeToWorldTransform: function() {
        return this.getNodeToWorldTransform()
    },
    getWorldToNodeTransform: function() {
        return cc.affineTransformInvert(this.getNodeToWorldTransform())
    },
    worldToNodeTransform: function() {
        return this.getWorldToNodeTransform()
    },
    convertToNodeSpace: function(a) {
        return cc.pointApplyAffineTransform(a, this.getWorldToNodeTransform())
    },
    convertToWorldSpace: function(a) {
        a = a || cc.p(0, 0);
        return cc.pointApplyAffineTransform(a, this.getNodeToWorldTransform())
    },
    convertToNodeSpaceAR: function(a) {
        return cc.pSub(this.convertToNodeSpace(a), this._renderCmd.getAnchorPointInPoints())
    },
    convertToWorldSpaceAR: function(a) {
        a = a || cc.p(0, 0);
        a = cc.pAdd(a, this._renderCmd.getAnchorPointInPoints());
        return this.convertToWorldSpace(a)
    },
    _convertToWindowSpace: function(a) {
        a = this.convertToWorldSpace(a);
        return cc.director.convertToUI(a)
    },
    convertTouchToNodeSpace: function(a) {
        a = a.getLocation();
        return this.convertToNodeSpace(a)
    },
    convertTouchToNodeSpaceAR: function(a) {
        a = cc.director.convertToGL(a.getLocation());
        return this.convertToNodeSpaceAR(a)
    },
    update: function(a) {
        this._componentContainer && !this._componentContainer.isEmpty() && this._componentContainer.visit(a)
    },
    updateTransform: function() {
        for (var a = this._children,
        b, c = 0; c < a.length; c++)(b = a[c]) && b.updateTransform()
    },
    retain: function() {},
    release: function() {},
    getComponent: function(a) {
        return this._componentContainer ? this._componentContainer.getComponent(a) : null
    },
    addComponent: function(a) {
        this._componentContainer && this._componentContainer.add(a)
    },
    removeComponent: function(a) {
        return this._componentContainer ? this._componentContainer.remove(a) : !1
    },
    removeAllComponents: function() {
        this._componentContainer && this._componentContainer.removeAll()
    },
    grid: null,
    visit: function(a) {
        var b = this._renderCmd,
        c = a ? a._renderCmd: null;
        if (this._visible) {
            a = cc.renderer;
            b.visit(c);
            var d = this._children,
            e = d.length,
            f;
            if (0 < e) {
                this._reorderChildDirty && this.sortAllChildren();
                for (c = 0; c < e; c++) if (f = d[c], 0 > f._localZOrder) f.visit(this);
                else break;
                for (a.pushRenderCommand(b); c < e; c++) d[c].visit(this)
            } else a.pushRenderCommand(b);
            b._dirtyFlag = 0
        } else b._propagateFlagsDown(c)
    },
    transform: function(a, b) {
        this._renderCmd.transform(a, b)
    },
    nodeToParentTransform: function() {
        return this.getNodeToParentTransform()
    },
    getNodeToParentTransform: function(a) {
        var b = this._renderCmd.getNodeToParentTransform();
        if (a) for (var b = {
            a: b.a,
            b: b.b,
            c: b.c,
            d: b.d,
            tx: b.tx,
            ty: b.ty
        },
        c = this._parent; null != c && c != a; c = c.getParent()) cc.affineTransformConcatIn(b, c.getNodeToParentTransform());
        return b
    },
    getNodeToParentAffineTransform: function(a) {
        return this.getNodeToParentTransform(a)
    },
    getCamera: function() {
        return null
    },
    getGrid: function() {
        return this.grid
    },
    setGrid: function(a) {
        this.grid = a
    },
    getShaderProgram: function() {
        return this._renderCmd.getShaderProgram()
    },
    setShaderProgram: function(a) {
        this._renderCmd.setShaderProgram(a)
    },
    setGLProgramState: function(a) {
        this._renderCmd.setGLProgramState(a)
    },
    getGLProgramState: function() {
        return this._renderCmd.getGLProgramState()
    },
    getGLServerState: function() {
        return 0
    },
    setGLServerState: function(a) {},
    getBoundingBoxToWorld: function() {
        var a = cc.rect(0, 0, this._contentSize.width, this._contentSize.height),
        b = this.getNodeToWorldTransform(),
        a = cc.rectApplyAffineTransform(a, b);
        if (!this._children) return a;
        for (var c = this._children,
        d = 0; d < c.length; d++) {
            var e = c[d];
            e && e._visible && (e = e._getBoundingBoxToCurrentNode(b)) && (a = cc.rectUnion(a, e))
        }
        return a
    },
    _getBoundingBoxToCurrentNode: function(a) {
        var b = cc.rect(0, 0, this._contentSize.width, this._contentSize.height);
        a = void 0 === a ? this.getNodeToParentTransform() : cc.affineTransformConcat(this.getNodeToParentTransform(), a);
        b = cc.rectApplyAffineTransform(b, a);
        if (!this._children) return b;
        for (var c = this._children,
        d = 0; d < c.length; d++) {
            var e = c[d];
            e && e._visible && (e = e._getBoundingBoxToCurrentNode(a)) && (b = cc.rectUnion(b, e))
        }
        return b
    },
    getOpacity: function() {
        return this._realOpacity
    },
    getDisplayedOpacity: function() {
        return this._renderCmd.getDisplayedOpacity()
    },
    setOpacity: function(a) {
        this._realOpacity = a;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)
    },
    updateDisplayedOpacity: function(a) {
        this._renderCmd._updateDisplayOpacity(a)
    },
    isCascadeOpacityEnabled: function() {
        return this._cascadeOpacityEnabled
    },
    setCascadeOpacityEnabled: function(a) {
        this._cascadeOpacityEnabled !== a && (this._cascadeOpacityEnabled = a, this._renderCmd.setCascadeOpacityEnabledDirty())
    },
    getColor: function() {
        var a = this._realColor;
        return cc.color(a.r, a.g, a.b, a.a)
    },
    getDisplayedColor: function() {
        return this._renderCmd.getDisplayedColor()
    },
    setColor: function(a) {
        var b = this._realColor;
        b.r = a.r;
        b.g = a.g;
        b.b = a.b;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)
    },
    updateDisplayedColor: function(a) {
        this._renderCmd._updateDisplayColor(a)
    },
    isCascadeColorEnabled: function() {
        return this._cascadeColorEnabled
    },
    setCascadeColorEnabled: function(a) {
        this._cascadeColorEnabled !== a && (this._cascadeColorEnabled = a, this._renderCmd.setCascadeColorEnabledDirty())
    },
    setOpacityModifyRGB: function(a) {},
    isOpacityModifyRGB: function() {
        return ! 1
    },
    _createRenderCmd: function() {
        return cc._renderType === cc.game.RENDER_TYPE_CANVAS ? new cc.Node.CanvasRenderCmd(this) : new cc.Node.WebGLRenderCmd(this)
    },
    enumerateChildren: function(a, b) {
        cc.assert(a && 0 != a.length, "Invalid name");
        cc.assert(null != b, "Invalid callback function");
        var c = a.length,
        d = 0,
        e = c,
        f = !1;
        2 < c && "/" === a[0] && "/" === a[1] && (f = !0, d = 2, e -= 2);
        var g = !1;
        3 < c && "/" === a[c - 3] && "." === a[c - 2] && "." === a[c - 1] && (g = !0, e -= 3);
        c = a.substr(d, e);
        g && (c = "[[:alnum:]]+/" + c);
        f ? this.doEnumerateRecursive(this, c, b) : this.doEnumerate(c, b)
    },
    doEnumerateRecursive: function(a, b, c) {
        var d = !1;
        if (a.doEnumerate(b, c)) d = !0;
        else for (var e = a.getChildren(), f = e.length, g = 0; g < f; g++) if (a = e[g], this.doEnumerateRecursive(a, b, c)) {
            d = !0;
            break
        }
        return d
    },
    doEnumerate: function(a, b) {
        var c = a.indexOf("/"),
        d = a,
        e = !1; - 1 !== c && (d = a.substr(0, c), e = !0);
        for (var c = !1,
        f, g = this._children,
        h = g.length,
        k = 0; k < h; k++) if (f = g[k], -1 !== f._name.indexOf(d)) if (e) {
            if (c = f.doEnumerate(a, b)) break
        } else if (b(f)) {
            c = !0;
            break
        }
        return c
    }
});
cc.Node.create = function() {
    return new cc.Node
};
cc.Node._stateCallbackType = {
    onEnter: 1,
    onExit: 2,
    cleanup: 3,
    onEnterTransitionDidFinish: 4,
    onExitTransitionDidStart: 5,
    max: 6
};
cc.Node._performStacks = [[]];
cc.Node._performing = 0;
cc.assert(cc.isFunction(cc._tmp.PrototypeCCNode), cc._LogInfos.MissingFile, "BaseNodesPropertyDefine.js");
cc._tmp.PrototypeCCNode();
delete cc._tmp.PrototypeCCNode;
cc.CustomRenderCmd = function(a, b) {
    this._needDraw = !0;
    this._target = a;
    this._callback = b
};
cc.CustomRenderCmd.prototype.rendering = function(a, b, c) {
    this._callback && this._callback.call(this._target, a, b, c)
};
cc.CustomRenderCmd.prototype.needDraw = function() {
    return this._needDraw
};
var dirtyFlags = cc.Node._dirtyFlags = {
    transformDirty: 1,
    visibleDirty: 2,
    colorDirty: 4,
    opacityDirty: 8,
    cacheDirty: 16,
    orderDirty: 32,
    textDirty: 64,
    gradientDirty: 128,
    textureDirty: 256,
    contentDirty: 512,
    COUNT: 10,
    all: 1023
},
ONE_DEGREE = Math.PI / 180;
function transformChildTree(a) {
    var b = 1,
    c, d, e, f, g, h = cc.Node._performStacks[cc.Node._performing];
    h || (h = [], cc.Node._performStacks.push(h));
    h.length = 0;
    cc.Node._performing++;
    for (h[0] = a; b;) if (b--, d = h[b], h[b] = null, d) {
        if ((c = d._children) && 0 < c.length) for (e = d._renderCmd, f = 0, g = c.length; f < g; ++f) a = c[f],
        h[b] = a,
        b++,
        a._renderCmd.transform(e);
        if ((c = d._protectedChildren) && 0 < c.length) for (e = d._renderCmd, f = 0, g = c.length; f < g; ++f) a = c[f],
        h[b] = a,
        b++,
        a._renderCmd.transform(e)
    }
    cc.Node._performing--
}
cc.Node.RenderCmd = function(a) {
    this._node = a;
    this._anchorPointInPoints = {
        x: 0,
        y: 0
    };
    this._displayedColor = cc.color(255, 255, 255, 255)
};
cc.Node.RenderCmd.prototype = {
    constructor: cc.Node.RenderCmd,
    _needDraw: !1,
    _dirtyFlag: 1,
    _curLevel: -1,
    _displayedOpacity: 255,
    _cascadeColorEnabledDirty: !1,
    _cascadeOpacityEnabledDirty: !1,
    _transform: null,
    _worldTransform: null,
    _inverse: null,
    needDraw: function() {
        return this._needDraw
    },
    getAnchorPointInPoints: function() {
        return cc.p(this._anchorPointInPoints)
    },
    getDisplayedColor: function() {
        var a = this._displayedColor;
        return cc.color(a.r, a.g, a.b, a.a)
    },
    getDisplayedOpacity: function() {
        return this._displayedOpacity
    },
    setCascadeColorEnabledDirty: function() {
        this._cascadeColorEnabledDirty = !0;
        this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)
    },
    setCascadeOpacityEnabledDirty: function() {
        this._cascadeOpacityEnabledDirty = !0;
        this.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)
    },
    getParentToNodeTransform: function() {
        this._inverse || (this._inverse = {
            a: 1,
            b: 0,
            c: 0,
            d: 1,
            tx: 0,
            ty: 0
        });
        this._dirtyFlag & cc.Node._dirtyFlags.transformDirty && cc.affineTransformInvertOut(this.getNodeToParentTransform(), this._inverse);
        return this._inverse
    },
    detachFromParent: function() {},
    _updateAnchorPointInPoint: function() {
        var a = this._anchorPointInPoints,
        b = this._node._contentSize,
        c = this._node._anchorPoint;
        a.x = b.width * c.x;
        a.y = b.height * c.y;
        this.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    setDirtyFlag: function(a) {
        0 === this._dirtyFlag && 0 !== a && cc.renderer.pushDirtyNode(this);
        this._dirtyFlag |= a
    },
    getParentRenderCmd: function() {
        return this._node && this._node._parent && this._node._parent._renderCmd ? this._node._parent._renderCmd: null
    },
    transform: function(a, b) {
        this._transform || (this._transform = {
            a: 1,
            b: 0,
            c: 0,
            d: 1,
            tx: 0,
            ty: 0
        },
        this._worldTransform = {
            a: 1,
            b: 0,
            c: 0,
            d: 1,
            tx: 0,
            ty: 0
        });
        var c = this._node,
        d = a ? a._worldTransform: null,
        e = this._transform,
        f = this._worldTransform;
        if (c._usingNormalizedPosition && c._parent) {
            var g = c._parent._contentSize;
            c._position.x = c._normalizedPosition.x * g.width;
            c._position.y = c._normalizedPosition.y * g.height;
            c._normalizedPositionDirty = !1
        }
        var h = c._rotationX || c._rotationY,
        k = c._skewX || c._skewY,
        m = c._scaleX,
        r = c._scaleY,
        g = this._anchorPointInPoints.x,
        s = this._anchorPointInPoints.y,
        t = 1,
        p = 0,
        v = 0,
        u = 1;
        if (h || k) {
            e.tx = c._position.x;
            e.ty = c._position.y;
            h && (t = c._rotationX * ONE_DEGREE, v = Math.sin(t), u = Math.cos(t), c._rotationY === c._rotationX ? (t = u, p = -v) : (p = c._rotationY * ONE_DEGREE, t = Math.cos(p), p = -Math.sin(p)));
            e.a = t *= m;
            e.b = p *= m;
            e.c = v *= r;
            e.d = u *= r;
            k && (k = Math.tan(c._skewX * ONE_DEGREE), m = Math.tan(c._skewY * ONE_DEGREE), Infinity === k && (k = 99999999), Infinity === m && (m = 99999999), e.a = t + v * m, e.b = p + u * m, e.c = v + t * k, e.d = u + p * k);
            if (g || s) e.tx -= e.a * g + e.c * s,
            e.ty -= e.b * g + e.d * s,
            c._ignoreAnchorPointForPosition && (e.tx += g, e.ty += s);
            c._additionalTransformDirty && cc.affineTransformConcatIn(e, c._additionalTransform);
            d ? (f.a = e.a * d.a + e.b * d.c, f.b = e.a * d.b + e.b * d.d, f.c = e.c * d.a + e.d * d.c, f.d = e.c * d.b + e.d * d.d, f.tx = d.a * e.tx + d.c * e.ty + d.tx, f.ty = d.d * e.ty + d.ty + d.b * e.tx) : (f.a = e.a, f.b = e.b, f.c = e.c, f.d = e.d, f.tx = e.tx, f.ty = e.ty)
        } else {
            e.a = m;
            e.b = 0;
            e.c = 0;
            e.d = r;
            e.tx = c._position.x;
            e.ty = c._position.y;
            if (g || s) e.tx -= e.a * g,
            e.ty -= e.d * s,
            c._ignoreAnchorPointForPosition && (e.tx += g, e.ty += s);
            c._additionalTransformDirty && cc.affineTransformConcatIn(e, c._additionalTransform);
            d ? (f.a = e.a * d.a + e.b * d.c, f.b = e.a * d.b + e.b * d.d, f.c = e.c * d.a + e.d * d.c, f.d = e.c * d.b + e.d * d.d, f.tx = e.tx * d.a + e.ty * d.c + d.tx, f.ty = e.tx * d.b + e.ty * d.d + d.ty) : (f.a = e.a, f.b = e.b, f.c = e.c, f.d = e.d, f.tx = e.tx, f.ty = e.ty)
        }
        this._updateCurrentRegions && (this._updateCurrentRegions(), this._notifyRegionStatus && this._notifyRegionStatus(cc.Node.CanvasRenderCmd.RegionStatus.DirtyDouble));
        b && transformChildTree(c);
        this._cacheDirty = !0
    },
    getNodeToParentTransform: function() { (!this._transform || this._dirtyFlag & cc.Node._dirtyFlags.transformDirty) && this.transform();
        return this._transform
    },
    visit: function(a) {
        var b = this._node,
        c = cc.renderer;
        if (a = a || this.getParentRenderCmd()) this._curLevel = a._curLevel + 1;
        isNaN(b._customZ) && (b._vertexZ = c.assignedZ, c.assignedZ += c.assignedZStep);
        this._syncStatus(a)
    },
    _updateDisplayColor: function(a) {
        var b = this._node,
        c = this._displayedColor,
        d = b._realColor,
        e;
        this._notifyRegionStatus && this._notifyRegionStatus(cc.Node.CanvasRenderCmd.RegionStatus.Dirty);
        if (this._cascadeColorEnabledDirty && !b._cascadeColorEnabled) {
            c.r = d.r;
            c.g = d.g;
            c.b = d.b;
            c = new cc.Color(255, 255, 255, 255);
            a = b._children;
            b = 0;
            for (d = a.length; b < d; b++)(e = a[b]) && e._renderCmd && e._renderCmd._updateDisplayColor(c);
            this._cascadeColorEnabledDirty = !1
        } else if (void 0 === a && (a = (a = b._parent) && a._cascadeColorEnabled ? a.getDisplayedColor() : cc.color.WHITE), c.r = 0 | d.r * a.r / 255, c.g = 0 | d.g * a.g / 255, c.b = 0 | d.b * a.b / 255, b._cascadeColorEnabled) for (a = b._children, b = 0, d = a.length; b < d; b++)(e = a[b]) && e._renderCmd && (e._renderCmd._updateDisplayColor(c), e._renderCmd._updateColor());
        this._dirtyFlag &= ~dirtyFlags.colorDirty
    },
    _updateDisplayOpacity: function(a) {
        var b = this._node,
        c, d;
        this._notifyRegionStatus && this._notifyRegionStatus(cc.Node.CanvasRenderCmd.RegionStatus.Dirty);
        if (this._cascadeOpacityEnabledDirty && !b._cascadeOpacityEnabled) {
            this._displayedOpacity = b._realOpacity;
            c = b._children;
            a = 0;
            for (b = c.length; a < b; a++)(d = c[a]) && d._renderCmd && d._renderCmd._updateDisplayOpacity(255);
            this._cascadeOpacityEnabledDirty = !1
        } else if (void 0 === a && (c = b._parent, a = 255, c && c._cascadeOpacityEnabled && (a = c.getDisplayedOpacity())), this._displayedOpacity = b._realOpacity * a / 255, b._cascadeOpacityEnabled) for (c = b._children, a = 0, b = c.length; a < b; a++)(d = c[a]) && d._renderCmd && (d._renderCmd._updateDisplayOpacity(this._displayedOpacity), d._renderCmd._updateColor());
        this._dirtyFlag &= ~dirtyFlags.opacityDirty
    },
    _syncDisplayColor: function(a) {
        var b = this._node,
        c = this._displayedColor,
        d = b._realColor;
        void 0 === a && (a = (a = b._parent) && a._cascadeColorEnabled ? a.getDisplayedColor() : cc.color.WHITE);
        c.r = 0 | d.r * a.r / 255;
        c.g = 0 | d.g * a.g / 255;
        c.b = 0 | d.b * a.b / 255
    },
    _syncDisplayOpacity: function(a) {
        var b = this._node;
        if (void 0 === a) {
            var c = b._parent;
            a = 255;
            c && c._cascadeOpacityEnabled && (a = c.getDisplayedOpacity())
        }
        this._displayedOpacity = b._realOpacity * a / 255
    },
    _updateColor: function() {},
    _propagateFlagsDown: function(a) {
        var b = this._dirtyFlag,
        c = a ? a._node: null;
        c && c._cascadeColorEnabled && a._dirtyFlag & dirtyFlags.colorDirty && (b |= dirtyFlags.colorDirty);
        c && c._cascadeOpacityEnabled && a._dirtyFlag & dirtyFlags.opacityDirty && (b |= dirtyFlags.opacityDirty);
        a && a._dirtyFlag & dirtyFlags.transformDirty && (b |= dirtyFlags.transformDirty);
        this._dirtyFlag = b
    },
    updateStatus: function() {
        var a = this._dirtyFlag,
        b = a & dirtyFlags.colorDirty,
        c = a & dirtyFlags.opacityDirty;
        a & dirtyFlags.contentDirty && (this._notifyRegionStatus && this._notifyRegionStatus(cc.Node.CanvasRenderCmd.RegionStatus.Dirty), this._dirtyFlag &= ~dirtyFlags.contentDirty);
        b && this._updateDisplayColor();
        c && this._updateDisplayOpacity(); (b || c) && this._updateColor();
        a & dirtyFlags.transformDirty && (this.transform(this.getParentRenderCmd(), !0), this._dirtyFlag &= ~dirtyFlags.transformDirty);
        a & dirtyFlags.orderDirty && (this._dirtyFlag &= ~dirtyFlags.orderDirty)
    },
    _syncStatus: function(a) {
        var b = this._dirtyFlag,
        c = a ? a._node: null;
        c && c._cascadeColorEnabled && a._dirtyFlag & dirtyFlags.colorDirty && (b |= dirtyFlags.colorDirty);
        c && c._cascadeOpacityEnabled && a._dirtyFlag & dirtyFlags.opacityDirty && (b |= dirtyFlags.opacityDirty);
        a && a._dirtyFlag & dirtyFlags.transformDirty && (b |= dirtyFlags.transformDirty);
        this._dirtyFlag = b;
        var c = b & dirtyFlags.colorDirty,
        d = b & dirtyFlags.opacityDirty;
        c && this._syncDisplayColor();
        d && this._syncDisplayOpacity(); (c || d) && this._updateColor();
        b & dirtyFlags.transformDirty && this.transform(a);
        b & dirtyFlags.orderDirty && (this._dirtyFlag &= ~dirtyFlags.orderDirty)
    },
    setShaderProgram: function(a) {},
    getShaderProgram: function() {
        return null
    },
    getGLProgramState: function() {
        return null
    },
    setGLProgramState: function(a) {}
};
cc.Node.RenderCmd.prototype.originTransform = cc.Node.RenderCmd.prototype.transform;
cc.Node.RenderCmd.prototype.originUpdateStatus = cc.Node.RenderCmd.prototype.updateStatus;
cc.Node.RenderCmd.prototype._originSyncStatus = cc.Node.RenderCmd.prototype._syncStatus; (function() {
    cc.Node.CanvasRenderCmd = function(a) {
        this._node = a;
        this._anchorPointInPoints = {
            x: 0,
            y: 0
        };
        this._displayedColor = cc.color(255, 255, 255, 255);
        this._cachedParent = null;
        this._cacheDirty = !1;
        this._currentRegion = new cc.Region;
        this._oldRegion = new cc.Region;
        this._regionFlag = 0;
        this._canUseDirtyRegion = !1
    };
    cc.Node.CanvasRenderCmd.RegionStatus = {
        NotDirty: 0,
        Dirty: 1,
        DirtyDouble: 2
    };
    var a = cc.Node.CanvasRenderCmd.prototype = Object.create(cc.Node.RenderCmd.prototype);
    a.constructor = cc.Node.CanvasRenderCmd;
    a._rootCtor = cc.Node.CanvasRenderCmd;
    a._notifyRegionStatus = function(a) {
        this._needDraw && this._regionFlag < a && (this._regionFlag = a)
    };
    var b = new cc.Rect;
    a.getLocalBB = function() {
        var a = this._node;
        b.x = b.y = 0;
        b.width = a._contentSize.width;
        b.height = a._contentSize.height;
        return b
    };
    a._updateCurrentRegions = function() {
        var a = this._currentRegion;
        this._currentRegion = this._oldRegion;
        this._oldRegion = a;
        cc.Node.CanvasRenderCmd.RegionStatus.DirtyDouble !== this._regionFlag || this._currentRegion.isEmpty() || this._oldRegion.union(this._currentRegion);
        this._currentRegion.updateRegion(this.getLocalBB(), this._worldTransform)
    };
    a.setDirtyFlag = function(a, b) {
        cc.Node.RenderCmd.prototype.setDirtyFlag.call(this, a, b);
        this._setCacheDirty(b);
        this._cachedParent && this._cachedParent.setDirtyFlag(a, !0)
    };
    a._setCacheDirty = function() {
        if (!1 === this._cacheDirty) {
            this._cacheDirty = !0;
            var a = this._cachedParent;
            a && a !== this && a._setNodeDirtyForCache && a._setNodeDirtyForCache()
        }
    };
    a._setCachedParent = function(a) {
        if (this._cachedParent !== a) {
            this._cachedParent = a;
            for (var b = this._node._children,
            e = 0,
            f = b.length; e < f; e++) b[e]._renderCmd._setCachedParent(a)
        }
    };
    a.detachFromParent = function() {
        this._cachedParent = null;
        for (var a = this._node._children,
        b, e = 0,
        f = a.length; e < f; e++)(b = a[e]) && b._renderCmd && b._renderCmd.detachFromParent()
    };
    cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc = function(a) {
        return a ? a.src === cc.SRC_ALPHA && a.dst === cc.ONE || a.src === cc.ONE && a.dst === cc.ONE ? "lighter": a.src === cc.ZERO && a.dst === cc.SRC_ALPHA ? "destination-in": a.src === cc.ZERO && a.dst === cc.ONE_MINUS_SRC_ALPHA ? "destination-out": "source-over": "source-over"
    }
})(); (function() {
    cc.Node.WebGLRenderCmd = function(a) {
        this._node = a;
        this._anchorPointInPoints = {
            x: 0,
            y: 0
        };
        this._displayedColor = cc.color(255, 255, 255, 255);
        this._glProgramState = null
    };
    var a = cc.Node.WebGLRenderCmd.prototype = Object.create(cc.Node.RenderCmd.prototype);
    a.constructor = cc.Node.WebGLRenderCmd;
    a._rootCtor = cc.Node.WebGLRenderCmd;
    a._updateColor = function() {};
    a.setShaderProgram = function(a) {
        this._glProgramState = cc.GLProgramState.getOrCreateWithGLProgram(a)
    };
    a.getShaderProgram = function() {
        return this._glProgramState ? this._glProgramState.getGLProgram() : null
    };
    a.getGLProgramState = function() {
        return this._glProgramState
    };
    a.setGLProgramState = function(a) {
        this._glProgramState = a
    };
    Object.defineProperty(a, "_shaderProgram", {
        set: function(a) {
            this.setShaderProgram(a)
        },
        get: function() {
            return this.getShaderProgram()
        }
    })
})();
cc.AtlasNode = cc.Node.extend({
    textureAtlas: null,
    quadsToDraw: 0,
    _itemsPerRow: 0,
    _itemsPerColumn: 0,
    _itemWidth: 0,
    _itemHeight: 0,
    _opacityModifyRGB: !1,
    _blendFunc: null,
    _ignoreContentScaleFactor: !1,
    _className: "AtlasNode",
    _texture: null,
    _textureForCanvas: null,
    ctor: function(a, b, c, d) {
        cc.Node.prototype.ctor.call(this);
        this._blendFunc = {
            src: cc.BLEND_SRC,
            dst: cc.BLEND_DST
        };
        this._ignoreContentScaleFactor = !1;
        void 0 !== d && this.initWithTileFile(a, b, c, d)
    },
    _createRenderCmd: function() {
        this._renderCmd = cc._renderType === cc.game.RENDER_TYPE_CANVAS ? new cc.AtlasNode.CanvasRenderCmd(this) : new cc.AtlasNode.WebGLRenderCmd(this)
    },
    updateAtlasValues: function() {
        cc.log(cc._LogInfos.AtlasNode_updateAtlasValues)
    },
    getColor: function() {
        return this._opacityModifyRGB ? this._renderCmd._colorUnmodified: cc.Node.prototype.getColor.call(this)
    },
    setOpacityModifyRGB: function(a) {
        var b = this.color;
        this._opacityModifyRGB = a;
        this.setColor(b)
    },
    isOpacityModifyRGB: function() {
        return this._opacityModifyRGB
    },
    getBlendFunc: function() {
        return this._blendFunc
    },
    setBlendFunc: function(a, b) {
        this._blendFunc = void 0 === b ? a: {
            src: a,
            dst: b
        }
    },
    setTextureAtlas: function(a) {
        this.textureAtlas = a
    },
    getTextureAtlas: function() {
        return this.textureAtlas
    },
    getQuadsToDraw: function() {
        return this.quadsToDraw
    },
    setQuadsToDraw: function(a) {
        this.quadsToDraw = a
    },
    initWithTileFile: function(a, b, c, d) {
        if (!a) throw Error("cc.AtlasNode.initWithTileFile(): title should not be null");
        a = cc.textureCache.addImage(a);
        return this.initWithTexture(a, b, c, d)
    },
    initWithTexture: function(a, b, c, d) {
        return this._renderCmd.initWithTexture(a, b, c, d)
    },
    setColor: function(a) {
        this._renderCmd.setColor(a)
    },
    setOpacity: function(a) {
        this._renderCmd.setOpacity(a)
    },
    getTexture: function() {
        return this._texture
    },
    setTexture: function(a) {
        this._texture = a
    },
    _setIgnoreContentScaleFactor: function(a) {
        this._ignoreContentScaleFactor = a
    }
});
_p = cc.AtlasNode.prototype;
cc.defineGetterSetter(_p, "opacity", _p.getOpacity, _p.setOpacity);
cc.defineGetterSetter(_p, "color", _p.getColor, _p.setColor);
cc.defineGetterSetter(_p, "texture", _p.getTexture, _p.setTexture);
cc.EventHelper.prototype.apply(_p);
cc.AtlasNode.create = function(a, b, c, d) {
    return new cc.AtlasNode(a, b, c, d)
}; (function() {
    cc.AtlasNode.CanvasRenderCmd = function(a) {
        this._rootCtor(a);
        this._needDraw = !1;
        this._colorUnmodified = cc.color.WHITE;
        this._textureToRender = null
    };
    var a = cc.AtlasNode.CanvasRenderCmd.prototype = Object.create(cc.Node.CanvasRenderCmd.prototype);
    a.constructor = cc.AtlasNode.CanvasRenderCmd;
    a.initWithTexture = function(a, c, d, e) {
        var f = this._node;
        f._itemWidth = c;
        f._itemHeight = d;
        f._opacityModifyRGB = !0;
        f._texture = a;
        if (!f._texture) return cc.log(cc._LogInfos.AtlasNode__initWithTexture),
        !1;
        this._textureToRender = a;
        this._calculateMaxItems();
        f.quadsToDraw = e;
        return ! 0
    };
    a.setColor = function(a) {
        var c = this._node._realColor;
        if (c.r !== a.r || c.g !== a.g || c.b !== a.b) this._colorUnmodified = a,
        this._changeTextureColor()
    };
    a._changeTextureColor = function() {
        var a = this._node._texture,
        c = this._colorUnmodified,
        d = a.getHtmlElementObj(),
        d = cc.rect(0, 0, d.width, d.height);
        a === this._textureToRender ? this._textureToRender = a._generateColorTexture(c.r, c.g, c.b, d) : a._generateColorTexture(c.r, c.g, c.b, d, this._textureToRender.getHtmlElementObj())
    };
    a.setOpacity = function(a) {
        cc.Node.prototype.setOpacity.call(this._node, a)
    };
    a._calculateMaxItems = function() {
        var a = this._node,
        c = a._texture.getContentSize();
        a._itemsPerColumn = 0 | c.height / a._itemHeight;
        a._itemsPerRow = 0 | c.width / a._itemWidth
    }
})(); (function() {
    cc.AtlasNode.WebGLRenderCmd = function(a) {
        this._rootCtor(a);
        this._needDraw = !0;
        this._textureAtlas = null;
        this._colorUnmodified = cc.color.WHITE;
        this._uniformColor = this._colorF32Array = null;
        this._matrix = new cc.math.Matrix4;
        this._matrix.identity();
        this._shaderProgram = cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE_UCOLOR);
        this._uniformColor = cc._renderContext.getUniformLocation(this._shaderProgram.getProgram(), "u_color")
    };
    var a = cc.AtlasNode.WebGLRenderCmd.prototype = Object.create(cc.Node.WebGLRenderCmd.prototype);
    a.constructor = cc.AtlasNode.WebGLRenderCmd;
    a._updateBlendFunc = function() {
        var a = this._node;
        this._textureAtlas.texture.hasPremultipliedAlpha() || (a._blendFunc.src = cc.SRC_ALPHA, a._blendFunc.dst = cc.ONE_MINUS_SRC_ALPHA)
    };
    a._updateOpacityModifyRGB = function() {
        this._node._opacityModifyRGB = this._textureAtlas.texture.hasPremultipliedAlpha()
    };
    a.rendering = function(a) {
        a = a || cc._renderContext;
        var c = this._node,
        d = this._worldTransform;
        this._matrix.mat[0] = d.a;
        this._matrix.mat[4] = d.c;
        this._matrix.mat[12] = d.tx;
        this._matrix.mat[1] = d.b;
        this._matrix.mat[5] = d.d;
        this._matrix.mat[13] = d.ty;
        this._glProgramState.apply(this._matrix);
        cc.glBlendFunc(c._blendFunc.src, c._blendFunc.dst);
        this._uniformColor && this._colorF32Array && (a.uniform4fv(this._uniformColor, this._colorF32Array), this._textureAtlas.drawNumberOfQuads(c.quadsToDraw, 0))
    };
    a.initWithTexture = function(a, c, d, e) {
        var f = this._node;
        f._itemWidth = c;
        f._itemHeight = d;
        this._colorUnmodified = cc.color.WHITE;
        f._opacityModifyRGB = !0;
        f._blendFunc.src = cc.BLEND_SRC;
        f._blendFunc.dst = cc.BLEND_DST;
        c = f._realColor;
        this._colorF32Array = new Float32Array([c.r / 255, c.g / 255, c.b / 255, f._realOpacity / 255]);
        this._textureAtlas = new cc.TextureAtlas;
        this._textureAtlas.initWithTexture(a, e);
        if (!this._textureAtlas) return cc.log(cc._LogInfos.AtlasNode__initWithTexture),
        !1;
        this._updateBlendFunc();
        this._updateOpacityModifyRGB();
        this._calculateMaxItems();
        f.quadsToDraw = e;
        return ! 0
    };
    a.setColor = function(a) {
        var c = cc.color(a.r, a.g, a.b),
        d = this._node;
        this._colorUnmodified = a;
        a = this._displayedOpacity;
        d._opacityModifyRGB && (c.r = c.r * a / 255, c.g = c.g * a / 255, c.b = c.b * a / 255);
        cc.Node.prototype.setColor.call(d, c)
    };
    a.setOpacity = function(a) {
        var c = this._node;
        cc.Node.prototype.setOpacity.call(c, a);
        c._opacityModifyRGB && (c.color = this._colorUnmodified)
    };
    a._updateColor = function() {
        if (this._colorF32Array) {
            var a = this._displayedColor;
            this._colorF32Array[0] = a.r / 255;
            this._colorF32Array[1] = a.g / 255;
            this._colorF32Array[2] = a.b / 255;
            this._colorF32Array[3] = this._displayedOpacity / 255
        }
    };
    a.getTexture = function() {
        return this._textureAtlas.texture
    };
    a.setTexture = function(a) {
        this._textureAtlas.texture = a;
        this._updateBlendFunc();
        this._updateOpacityModifyRGB()
    };
    a._calculateMaxItems = function() {
        var a = this._node,
        c = this._textureAtlas.texture,
        d = c.getContentSize();
        a._ignoreContentScaleFactor && (d = c.getContentSizeInPixels());
        a._itemsPerColumn = 0 | d.height / a._itemHeight;
        a._itemsPerRow = 0 | d.width / a._itemWidth
    }
})();
cc._tmp.WebGLTexture2D = function() {
    cc.Texture2D = cc.Class.extend({
        _pVRHaveAlphaPremultiplied: !0,
        _pixelFormat: null,
        _pixelsWide: 0,
        _pixelsHigh: 0,
        _name: "",
        _contentSize: null,
        maxS: 0,
        maxT: 0,
        _hasPremultipliedAlpha: !1,
        _hasMipmaps: !1,
        shaderProgram: null,
        _textureLoaded: !1,
        _htmlElementObj: null,
        _webTextureObj: null,
        url: null,
        ctor: function() {
            this._contentSize = cc.size(0, 0);
            this._pixelFormat = cc.Texture2D.defaultPixelFormat
        },
        releaseTexture: function() {
            this._webTextureObj && cc._renderContext.deleteTexture(this._webTextureObj);
            this._htmlElementObj = null;
            cc.loader.release(this.url)
        },
        getPixelFormat: function() {
            return this._pixelFormat
        },
        getPixelsWide: function() {
            return this._pixelsWide
        },
        getPixelsHigh: function() {
            return this._pixelsHigh
        },
        getName: function() {
            return this._webTextureObj
        },
        getContentSize: function() {
            return cc.size(this._contentSize.width / cc.contentScaleFactor(), this._contentSize.height / cc.contentScaleFactor())
        },
        _getWidth: function() {
            return this._contentSize.width / cc.contentScaleFactor()
        },
        _getHeight: function() {
            return this._contentSize.height / cc.contentScaleFactor()
        },
        getContentSizeInPixels: function() {
            return this._contentSize
        },
        getMaxS: function() {
            return this.maxS
        },
        setMaxS: function(a) {
            this.maxS = a
        },
        getMaxT: function() {
            return this.maxT
        },
        setMaxT: function(a) {
            this.maxT = a
        },
        getShaderProgram: function() {
            return this.shaderProgram
        },
        setShaderProgram: function(a) {
            this.shaderProgram = a
        },
        hasPremultipliedAlpha: function() {
            return this._hasPremultipliedAlpha
        },
        hasMipmaps: function() {
            return this._hasMipmaps
        },
        description: function() {
            return "\x3ccc.Texture2D | Name \x3d " + this._name + " | Dimensions \x3d " + this._pixelsWide + " x " + this._pixelsHigh + " | Coordinates \x3d (" + this.maxS + ", " + this.maxT + ")\x3e"
        },
        releaseData: function(a) {},
        keepData: function(a, b) {
            return a
        },
        initWithData: function(a, b, c, d, e) {
            var f = cc.Texture2D,
            g = cc._renderContext,
            h = g.RGBA,
            k = g.UNSIGNED_BYTE,
            m = c * cc.Texture2D._B[b] / 8;
            0 === m % 8 ? g.pixelStorei(g.UNPACK_ALIGNMENT, 8) : 0 === m % 4 ? g.pixelStorei(g.UNPACK_ALIGNMENT, 4) : 0 === m % 2 ? g.pixelStorei(g.UNPACK_ALIGNMENT, 2) : g.pixelStorei(g.UNPACK_ALIGNMENT, 1);
            this._webTextureObj = g.createTexture();
            cc.glBindTexture2D(this);
            g.texParameteri(g.TEXTURE_2D, g.TEXTURE_MIN_FILTER, g.LINEAR);
            g.texParameteri(g.TEXTURE_2D, g.TEXTURE_MAG_FILTER, g.LINEAR);
            g.texParameteri(g.TEXTURE_2D, g.TEXTURE_WRAP_S, g.CLAMP_TO_EDGE);
            g.texParameteri(g.TEXTURE_2D, g.TEXTURE_WRAP_T, g.CLAMP_TO_EDGE);
            switch (b) {
            case f.PIXEL_FORMAT_RGBA8888:
                h = g.RGBA;
                break;
            case f.PIXEL_FORMAT_RGB888:
                h = g.RGB;
                break;
            case f.PIXEL_FORMAT_RGBA4444:
                k = g.UNSIGNED_SHORT_4_4_4_4;
                break;
            case f.PIXEL_FORMAT_RGB5A1:
                k = g.UNSIGNED_SHORT_5_5_5_1;
                break;
            case f.PIXEL_FORMAT_RGB565:
                k = g.UNSIGNED_SHORT_5_6_5;
                break;
            case f.PIXEL_FORMAT_AI88:
                h = g.LUMINANCE_ALPHA;
                break;
            case f.PIXEL_FORMAT_A8:
                h = g.ALPHA;
                break;
            case f.PIXEL_FORMAT_I8:
                h = g.LUMINANCE;
                break;
            default:
                cc.assert(0, cc._LogInfos.Texture2D_initWithData)
            }
            g.texImage2D(g.TEXTURE_2D, 0, h, c, d, 0, h, k, a);
            this._contentSize.width = e.width;
            this._contentSize.height = e.height;
            this._pixelsWide = c;
            this._pixelsHigh = d;
            this._pixelFormat = b;
            this.maxS = e.width / c;
            this.maxT = e.height / d;
            this._hasMipmaps = this._hasPremultipliedAlpha = !1;
            this.shaderProgram = cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE);
            return this._textureLoaded = !0
        },
        drawAtPoint: function(a) {
            var b = [0, this.maxT, this.maxS, this.maxT, 0, 0, this.maxS, 0],
            c = cc._renderContext,
            d = this._pixelsWide * this.maxS,
            e = this._pixelsHigh * this.maxT;
            a = [a.x, a.y, 0, d + a.x, a.y, 0, a.x, e + a.y, 0, d + a.x, e + a.y, 0];
            this._glProgramState.apply();
            this._glProgramState._glprogram.setUniformsForBuiltins();
            cc.glBindTexture2D(this);
            c.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);
            c.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS);
            c.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, c.FLOAT, !1, 0, a);
            c.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS, 2, c.FLOAT, !1, 0, b);
            c.drawArrays(c.TRIANGLE_STRIP, 0, 4)
        },
        drawInRect: function(a) {
            var b = [0, this.maxT, this.maxS, this.maxT, 0, 0, this.maxS, 0];
            a = [a.x, a.y, a.x + a.width, a.y, a.x, a.y + a.height, a.x + a.width, a.y + a.height];
            this._glProgramState.apply();
            this._glProgramState._glprogram.setUniformsForBuiltins();
            cc.glBindTexture2D(this);
            var c = cc._renderContext;
            c.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);
            c.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS);
            c.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, c.FLOAT, !1, 0, a);
            c.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS, 2, c.FLOAT, !1, 0, b);
            c.drawArrays(c.TRIANGLE_STRIP, 0, 4)
        },
        initWithImage: function(a) {
            if (null == a) return cc.log(cc._LogInfos.Texture2D_initWithImage),
            !1;
            var b = a.getWidth(),
            c = a.getHeight(),
            d = cc.configuration.getMaxTextureSize();
            if (b > d || c > d) return cc.log(cc._LogInfos.Texture2D_initWithImage_2, b, c, d, d),
            !1;
            this._textureLoaded = !0;
            return this._initPremultipliedATextureWithImage(a, b, c)
        },
        initWithElement: function(a) {
            a && (this._webTextureObj = cc._renderContext.createTexture(), this._htmlElementObj = a, this._hasPremultipliedAlpha = this._textureLoaded = !0)
        },
        getHtmlElementObj: function() {
            return this._htmlElementObj
        },
        isLoaded: function() {
            return this._textureLoaded
        },
        handleLoadedTexture: function(a) {
            a = void 0 !== a ? a: this._hasPremultipliedAlpha;
            if (cc.game._rendererInitialized && this._htmlElementObj && this._htmlElementObj.width && this._htmlElementObj.height) {
                var b = cc._renderContext;
                cc.glBindTexture2D(this);
                b.pixelStorei(b.UNPACK_ALIGNMENT, 4);
                a && b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL, 1);
                b.texImage2D(b.TEXTURE_2D, 0, b.RGBA, b.RGBA, b.UNSIGNED_BYTE, this._htmlElementObj);
                b.texParameteri(b.TEXTURE_2D, b.TEXTURE_MIN_FILTER, b.LINEAR);
                b.texParameteri(b.TEXTURE_2D, b.TEXTURE_MAG_FILTER, b.LINEAR);
                b.texParameteri(b.TEXTURE_2D, b.TEXTURE_WRAP_S, b.CLAMP_TO_EDGE);
                b.texParameteri(b.TEXTURE_2D, b.TEXTURE_WRAP_T, b.CLAMP_TO_EDGE);
                this.shaderProgram = cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE);
                cc.glBindTexture2D(null);
                a && b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL, 0);
                b = this._htmlElementObj.height;
                this._pixelsWide = this._contentSize.width = this._htmlElementObj.width;
                this._pixelsHigh = this._contentSize.height = b;
                this._pixelFormat = cc.Texture2D.PIXEL_FORMAT_RGBA8888;
                this.maxT = this.maxS = 1;
                this._hasPremultipliedAlpha = a;
                this._hasMipmaps = !1;
                window.ENABLE_IMAEG_POOL && (this._htmlElementObj = null);
                this.dispatchEvent("load")
            }
        },
        initWithString: function(a, b, c, d, e, f) {
            cc.log(cc._LogInfos.Texture2D_initWithString);
            return null
        },
        initWithETCFile: function(a) {
            cc.log(cc._LogInfos.Texture2D_initWithETCFile_2);
            return ! 1
        },
        initWithPVRFile: function(a) {
            cc.log(cc._LogInfos.Texture2D_initWithPVRFile_2);
            return ! 1
        },
        initWithPVRTCData: function(a, b, c, d, e, f) {
            cc.log(cc._LogInfos.Texture2D_initWithPVRTCData_2);
            return ! 1
        },
        setTexParameters: function(a, b, c, d) {
            var e = cc._renderContext;
            void 0 !== b && (a = {
                minFilter: a,
                magFilter: b,
                wrapS: c,
                wrapT: d
            });
            cc.assert(this._pixelsWide === cc.NextPOT(this._pixelsWide) && this._pixelsHigh === cc.NextPOT(this._pixelsHigh) || a.wrapS === e.CLAMP_TO_EDGE && a.wrapT === e.CLAMP_TO_EDGE, "WebGLRenderingContext.CLAMP_TO_EDGE should be used in NPOT textures");
            cc.glBindTexture2D(this);
            e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, a.minFilter);
            e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, a.magFilter);
            e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, a.wrapS);
            e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, a.wrapT)
        },
        setAntiAliasTexParameters: function() {
            var a = cc._renderContext;
            cc.glBindTexture2D(this);
            this._hasMipmaps ? a.texParameteri(a.TEXTURE_2D, a.TEXTURE_MIN_FILTER, a.LINEAR_MIPMAP_NEAREST) : a.texParameteri(a.TEXTURE_2D, a.TEXTURE_MIN_FILTER, a.LINEAR);
            a.texParameteri(a.TEXTURE_2D, a.TEXTURE_MAG_FILTER, a.LINEAR)
        },
        setAliasTexParameters: function() {
            var a = cc._renderContext;
            cc.glBindTexture2D(this);
            this._hasMipmaps ? a.texParameteri(a.TEXTURE_2D, a.TEXTURE_MIN_FILTER, a.NEAREST_MIPMAP_NEAREST) : a.texParameteri(a.TEXTURE_2D, a.TEXTURE_MIN_FILTER, a.NEAREST);
            a.texParameteri(a.TEXTURE_2D, a.TEXTURE_MAG_FILTER, a.NEAREST)
        },
        generateMipmap: function() {
            cc.assert(this._pixelsWide === cc.NextPOT(this._pixelsWide) && this._pixelsHigh === cc.NextPOT(this._pixelsHigh), "Mimpap texture only works in POT textures");
            cc.glBindTexture2D(this);
            cc._renderContext.generateMipmap(cc._renderContext.TEXTURE_2D);
            this._hasMipmaps = !0
        },
        stringForFormat: function() {
            return cc.Texture2D._M[this._pixelFormat]
        },
        bitsPerPixelForFormat: function(a) {
            a = a || this._pixelFormat;
            var b = cc.Texture2D._B[a];
            if (null != b) return b;
            cc.log(cc._LogInfos.Texture2D_bitsPerPixelForFormat, a);
            return - 1
        },
        _initPremultipliedATextureWithImage: function(a, b, c) {
            var d = cc.Texture2D,
            e = a.getData(),
            f = null,
            f = null,
            g = a.hasAlpha(),
            h = cc.size(a.getWidth(), a.getHeight()),
            k = d.defaultPixelFormat,
            m = a.getBitsPerComponent();
            g || (8 <= m ? k = d.PIXEL_FORMAT_RGB888: (cc.log(cc._LogInfos.Texture2D__initPremultipliedATextureWithImage), k = d.PIXEL_FORMAT_RGB565));
            var r = b * c;
            if (k === d.PIXEL_FORMAT_RGB565) if (g) for (e = new Uint16Array(b * c), f = a.getData(), m = 0; m < r; ++m) e[m] = (f[m] >> 0 & 255) >> 3 << 11 | (f[m] >> 8 & 255) >> 2 << 5 | (f[m] >> 16 & 255) >> 3 << 0;
            else for (e = new Uint16Array(b * c), f = a.getData(), m = 0; m < r; ++m) e[m] = (f[m] & 255) >> 3 << 11 | (f[m] & 255) >> 2 << 5 | (f[m] & 255) >> 3 << 0;
            else if (k === d.PIXEL_FORMAT_RGBA4444) for (e = new Uint16Array(b * c), f = a.getData(), m = 0; m < r; ++m) e[m] = (f[m] >> 0 & 255) >> 4 << 12 | (f[m] >> 8 & 255) >> 4 << 8 | (f[m] >> 16 & 255) >> 4 << 4 | (f[m] >> 24 & 255) >> 4 << 0;
            else if (k === d.PIXEL_FORMAT_RGB5A1) for (e = new Uint16Array(b * c), f = a.getData(), m = 0; m < r; ++m) e[m] = (f[m] >> 0 & 255) >> 3 << 11 | (f[m] >> 8 & 255) >> 3 << 6 | (f[m] >> 16 & 255) >> 3 << 1 | (f[m] >> 24 & 255) >> 7 << 0;
            else if (k === d.PIXEL_FORMAT_A8) for (e = new Uint8Array(b * c), f = a.getData(), m = 0; m < r; ++m) e[m] = f >> 24 & 255;
            if (g && k === d.PIXEL_FORMAT_RGB888) for (f = a.getData(), e = new Uint8Array(b * c * 3), m = 0; m < r; ++m) e[3 * m] = f >> 0 & 255,
            e[3 * m + 1] = f >> 8 & 255,
            e[3 * m + 2] = f >> 16 & 255;
            this.initWithData(e, k, b, c, h);
            a.getData();
            this._hasPremultipliedAlpha = a.isPremultipliedAlpha();
            return ! 0
        },
        addLoadedEventListener: function(a, b) {
            this.addEventListener("load", a, b)
        },
        removeLoadedEventListener: function(a) {
            this.removeEventTarget("load", a)
        }
    })
};
cc._tmp.WebGLTextureAtlas = function() {
    var a = cc.TextureAtlas.prototype;
    a._setupVBO = function() {
        var a = cc._renderContext;
        this._buffersVBO[0] = a.createBuffer();
        this._buffersVBO[1] = a.createBuffer();
        this._quadsWebBuffer = a.createBuffer();
        this._mapBuffers()
    };
    a._mapBuffers = function() {
        var a = cc._renderContext;
        a.bindBuffer(a.ARRAY_BUFFER, this._quadsWebBuffer);
        a.bufferData(a.ARRAY_BUFFER, this._quadsArrayBuffer, a.DYNAMIC_DRAW);
        a.bindBuffer(a.ELEMENT_ARRAY_BUFFER, this._buffersVBO[1]);
        a.bufferData(a.ELEMENT_ARRAY_BUFFER, this._indices, a.STATIC_DRAW)
    };
    a.drawNumberOfQuads = function(a, c) {
        c = c || 0;
        if (0 !== a && this.texture && this.texture.isLoaded()) {
            var d = cc._renderContext;
            cc.glBindTexture2D(this.texture);
            d.bindBuffer(d.ARRAY_BUFFER, this._quadsWebBuffer);
            this.dirty && (d.bufferData(d.ARRAY_BUFFER, this._quadsArrayBuffer, d.DYNAMIC_DRAW), this.dirty = !1);
            d.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);
            d.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR);
            d.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS);
            d.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 3, d.FLOAT, !1, 24, 0);
            d.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR, 4, d.UNSIGNED_BYTE, !0, 24, 12);
            d.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS, 2, d.FLOAT, !1, 24, 16);
            d.bindBuffer(d.ELEMENT_ARRAY_BUFFER, this._buffersVBO[1]);
            cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP ? d.drawElements(d.TRIANGLE_STRIP, 6 * a, d.UNSIGNED_SHORT, 6 * c * this._indices.BYTES_PER_ELEMENT) : d.drawElements(d.TRIANGLES, 6 * a, d.UNSIGNED_SHORT, 6 * c * this._indices.BYTES_PER_ELEMENT);
            cc.g_NumberOfDraws++
        }
    }
};
cc._tmp.WebGLTextureCache = function() {
    var a = cc.textureCache;
    a.handleLoadedTexture = function(a, c) {
        var d = this._textures,
        e;
        cc.game._rendererInitialized || (d = this._loadedTexturesBefore);
        e = d[a];
        e || (e = d[a] = new cc.Texture2D, e.url = a);
        e.initWithElement(c);
        ".png" === cc.path.extname(a) ? e.handleLoadedTexture(!0) : e.handleLoadedTexture();
        return e
    };
    a.addImage = function(a, c, d) {
        cc.assert(a, cc._LogInfos.Texture2D_addImage_2);
        var e = this._textures;
        cc.game._rendererInitialized || (e = this._loadedTexturesBefore);
        var f = e[a] || e[cc.loader._getAliase(a)];
        if (f) return f.isLoaded() ? c && c.call(d, f) : f.addEventListener("load",
        function() {
            c && c.call(d, f)
        },
        d),
        f;
        f = e[a] = new cc.Texture2D;
        f.url = a;
        e = cc.loader.getBasePath ? cc.loader.getBasePath() : cc.loader.resPath;
        cc.loader.loadImg(cc.path.join(e || "", a),
        function(e, f) {
            if (e) return c && c.call(d, e);
            var k = cc.textureCache.handleLoadedTexture(a, f);
            c && c.call(d, k)
        });
        return f
    };
    a.addImageAsync = a.addImage;
    a = null
};
cc._tmp.PrototypeTexture2D = function() {
    var a = cc.Texture2D;
    a.PVRImagesHavePremultipliedAlpha = function(a) {
        cc.PVRHaveAlphaPremultiplied_ = a
    };
    a.PIXEL_FORMAT_RGBA8888 = 2;
    a.PIXEL_FORMAT_RGB888 = 3;
    a.PIXEL_FORMAT_RGB565 = 4;
    a.PIXEL_FORMAT_A8 = 5;
    a.PIXEL_FORMAT_I8 = 6;
    a.PIXEL_FORMAT_AI88 = 7;
    a.PIXEL_FORMAT_RGBA4444 = 8;
    a.PIXEL_FORMAT_RGB5A1 = 7;
    a.PIXEL_FORMAT_PVRTC4 = 9;
    a.PIXEL_FORMAT_PVRTC2 = 10;
    a.PIXEL_FORMAT_DEFAULT = a.PIXEL_FORMAT_RGBA8888;
    a.defaultPixelFormat = a.PIXEL_FORMAT_DEFAULT;
    var b = cc.Texture2D._M = {};
    b[a.PIXEL_FORMAT_RGBA8888] = "RGBA8888";
    b[a.PIXEL_FORMAT_RGB888] = "RGB888";
    b[a.PIXEL_FORMAT_RGB565] = "RGB565";
    b[a.PIXEL_FORMAT_A8] = "A8";
    b[a.PIXEL_FORMAT_I8] = "I8";
    b[a.PIXEL_FORMAT_AI88] = "AI88";
    b[a.PIXEL_FORMAT_RGBA4444] = "RGBA4444";
    b[a.PIXEL_FORMAT_RGB5A1] = "RGB5A1";
    b[a.PIXEL_FORMAT_PVRTC4] = "PVRTC4";
    b[a.PIXEL_FORMAT_PVRTC2] = "PVRTC2";
    b = cc.Texture2D._B = {};
    b[a.PIXEL_FORMAT_RGBA8888] = 32;
    b[a.PIXEL_FORMAT_RGB888] = 24;
    b[a.PIXEL_FORMAT_RGB565] = 16;
    b[a.PIXEL_FORMAT_A8] = 8;
    b[a.PIXEL_FORMAT_I8] = 8;
    b[a.PIXEL_FORMAT_AI88] = 16;
    b[a.PIXEL_FORMAT_RGBA4444] = 16;
    b[a.PIXEL_FORMAT_RGB5A1] = 16;
    b[a.PIXEL_FORMAT_PVRTC4] = 4;
    b[a.PIXEL_FORMAT_PVRTC2] = 3;
    a = cc.Texture2D.prototype;
    cc.defineGetterSetter(a, "name", a.getName);
    cc.defineGetterSetter(a, "pixelFormat", a.getPixelFormat);
    cc.defineGetterSetter(a, "pixelsWidth", a.getPixelsWide);
    cc.defineGetterSetter(a, "pixelsHeight", a.getPixelsHigh);
    cc.defineGetterSetter(a, "width", a._getWidth);
    cc.defineGetterSetter(a, "height", a._getHeight)
};
cc._tmp.PrototypeTextureAtlas = function() {
    var a = cc.TextureAtlas.prototype;
    cc.defineGetterSetter(a, "totalQuads", a.getTotalQuads);
    cc.defineGetterSetter(a, "capacity", a.getCapacity);
    cc.defineGetterSetter(a, "quads", a.getQuads, a.setQuads)
};
cc.ALIGN_CENTER = 51;
cc.ALIGN_TOP = 19;
cc.ALIGN_TOP_RIGHT = 18;
cc.ALIGN_RIGHT = 50;
cc.ALIGN_BOTTOM_RIGHT = 34;
cc.ALIGN_BOTTOM = 35;
cc.ALIGN_BOTTOM_LEFT = 33;
cc.ALIGN_LEFT = 49;
cc.ALIGN_TOP_LEFT = 17;
cc.PVRHaveAlphaPremultiplied_ = !1;
cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,
function() {
    if (cc._renderType === cc.game.RENDER_TYPE_CANVAS) {
        var a = {
            _contentSize: null,
            _textureLoaded: !1,
            _htmlElementObj: null,
            url: null,
            _pattern: null,
            ctor: function() {
                this._contentSize = cc.size(0, 0);
                this._textureLoaded = !1;
                this._htmlElementObj = null;
                this._pattern = "";
                this._pixelsHigh = this._pixelsWide = 0
            },
            getPixelsWide: function() {
                return this._pixelsWide
            },
            getPixelsHigh: function() {
                return this._pixelsHigh
            },
            getContentSize: function() {
                var a = cc.contentScaleFactor();
                return cc.size(this._contentSize.width / a, this._contentSize.height / a)
            },
            _getWidth: function() {
                return this._contentSize.width / cc.contentScaleFactor()
            },
            _getHeight: function() {
                return this._contentSize.height / cc.contentScaleFactor()
            },
            getContentSizeInPixels: function() {
                return this._contentSize
            },
            initWithElement: function(a) {
                a && (this._htmlElementObj = a, this._pixelsWide = this._contentSize.width = a.width, this._pixelsHigh = this._contentSize.height = a.height, this._textureLoaded = !0)
            },
            getHtmlElementObj: function() {
                return this._htmlElementObj
            },
            isLoaded: function() {
                return this._textureLoaded
            },
            handleLoadedTexture: function() {
                if (this._htmlElementObj) {
                    var a = this._htmlElementObj;
                    this._pixelsWide = this._contentSize.width = a.width;
                    this._pixelsHigh = this._contentSize.height = a.height;
                    this.dispatchEvent("load")
                }
            },
            description: function() {
                return "\x3ccc.Texture2D | width \x3d " + this._contentSize.width + " height " + this._contentSize.height + "\x3e"
            },
            initWithData: function(a, c, d, e, f) {
                return ! 1
            },
            initWithImage: function(a) {
                return ! 1
            },
            initWithString: function(a, c, d, e, f, g) {
                return ! 1
            },
            releaseTexture: function() {
                this._htmlElementObj = null;
                cc.loader.release(this.url)
            },
            getName: function() {
                return null
            },
            getMaxS: function() {
                return 1
            },
            setMaxS: function(a) {},
            getMaxT: function() {
                return 1
            },
            setMaxT: function(a) {},
            getPixelFormat: function() {
                return null
            },
            getShaderProgram: function() {
                return null
            },
            setShaderProgram: function(a) {},
            hasPremultipliedAlpha: function() {
                return ! 1
            },
            hasMipmaps: function() {
                return ! 1
            },
            releaseData: function(a) {},
            keepData: function(a, c) {
                return a
            },
            drawAtPoint: function(a) {},
            drawInRect: function(a) {},
            initWithETCFile: function(a) {
                cc.log(cc._LogInfos.Texture2D_initWithETCFile);
                return ! 1
            },
            initWithPVRFile: function(a) {
                cc.log(cc._LogInfos.Texture2D_initWithPVRFile);
                return ! 1
            },
            initWithPVRTCData: function(a, c, d, e, f, g) {
                cc.log(cc._LogInfos.Texture2D_initWithPVRTCData);
                return ! 1
            },
            setTexParameters: function(a, c, d, e) {
                void 0 !== c && (a = {
                    minFilter: a,
                    magFilter: c,
                    wrapS: d,
                    wrapT: e
                });
                this._pattern = a.wrapS === cc.REPEAT && a.wrapT === cc.REPEAT ? "repeat": a.wrapS === cc.REPEAT ? "repeat-x": a.wrapT === cc.REPEAT ? "repeat-y": ""
            },
            setAntiAliasTexParameters: function() {},
            setAliasTexParameters: function() {},
            generateMipmap: function() {},
            stringForFormat: function() {
                return ""
            },
            bitsPerPixelForFormat: function(a) {
                return - 1
            },
            addLoadedEventListener: function(a, c) {
                this.addEventListener("load", a, c)
            },
            removeLoadedEventListener: function(a) {
                this.removeEventTarget("load", a)
            },
            _generateColorTexture: function() {},
            _generateTextureCacheForColor: function() {
                if (this.channelCache) return this.channelCache;
                var a = [document.createElement("canvas"), document.createElement("canvas"), document.createElement("canvas"), document.createElement("canvas")],
                c = this._htmlElementObj,
                d = c.width,
                e = c.height;
                a[0].width = d;
                a[0].height = e;
                a[1].width = d;
                a[1].height = e;
                a[2].width = d;
                a[2].height = e;
                a[3].width = d;
                a[3].height = e;
                var f = a[3].getContext("2d");
                f.drawImage(c, 0, 0);
                for (var f = f.getImageData(0, 0, d, e).data, g, h = 0; 4 > h; h++) {
                    g = a[h].getContext("2d");
                    for (var k = g.getImageData(0, 0, d, e), m = k.data, r = 0; r < f.length; r += 4) m[r] = 0 === h ? f[r] : 0,
                    m[r + 1] = 1 === h ? f[r + 1] : 0,
                    m[r + 2] = 2 === h ? f[r + 2] : 0,
                    m[r + 3] = f[r + 3];
                    g.putImageData(k, 0, 0)
                }
                c.onload = null;
                return this.channelCache = a
            },
            _grayElementObj: null,
            _backupElement: null,
            _isGray: !1,
            _switchToGray: function(a) {
                this._textureLoaded && this._isGray !== a && ((this._isGray = a) ? (this._backupElement = this._htmlElementObj, this._grayElementObj || (this._grayElementObj = cc.Texture2D._generateGrayTexture(this._htmlElementObj)), this._htmlElementObj = this._grayElementObj) : null !== this._backupElement && (this._htmlElementObj = this._backupElement))
            },
            _generateGrayTexture: function() {
                if (!this._textureLoaded) return null;
                var a = cc.Texture2D._generateGrayTexture(this._htmlElementObj),
                c = new cc.Texture2D;
                c.initWithElement(a);
                c.handleLoadedTexture();
                return c
            }
        };
        a._generateColorTexture = cc.sys._supportCanvasNewBlendModes ?
        function(a, c, d, e, f) {
            var g = !1;
            f ? g = !0 : f = document.createElement("canvas");
            var h = this._htmlElementObj;
            e || (e = cc.rect(0, 0, h.width, h.height));
            f.width = e.width;
            f.height = e.height;
            var k = f.getContext("2d");
            k.globalCompositeOperation = "source-over";
            k.fillStyle = "rgb(" + (a | 0) + "," + (c | 0) + "," + (d | 0) + ")";
            k.fillRect(0, 0, e.width, e.height);
            k.globalCompositeOperation = "multiply";
            k.drawImage(h, e.x, e.y, e.width, e.height, 0, 0, e.width, e.height);
            k.globalCompositeOperation = "destination-atop";
            k.drawImage(h, e.x, e.y, e.width, e.height, 0, 0, e.width, e.height);
            if (g) return f;
            a = new cc.Texture2D;
            a.initWithElement(f);
            a.handleLoadedTexture();
            return a
        }: function(a, c, d, e, f) {
            var g = !1;
            f ? g = !0 : f = document.createElement("canvas");
            var h = this._htmlElementObj;
            e || (e = cc.rect(0, 0, h.width, h.height));
            var k, m, h = e.x;
            k = e.y;
            m = e.width;
            e = e.height;
            if (m && e) {
                f.width = m;
                f.height = e;
                var r = f.getContext("2d"),
                s = cc.textureCache.getTextureColors(this);
                r.globalCompositeOperation = "lighter";
                r.drawImage(s[3], h, k, m, e, 0, 0, m, e);
                0 < a && (r.globalAlpha = a / 255, r.drawImage(s[0], h, k, m, e, 0, 0, m, e));
                0 < c && (r.globalAlpha = c / 255, r.drawImage(s[1], h, k, m, e, 0, 0, m, e));
                0 < d && (r.globalAlpha = d / 255, r.drawImage(s[2], h, k, m, e, 0, 0, m, e));
                if (g) return f;
                a = new cc.Texture2D;
                a.initWithElement(f);
                a.handleLoadedTexture();
                return a
            }
        };
        cc.Texture2D = cc.Class.extend(a);
        cc.Texture2D._generateGrayTexture = function(a, c, d) {
            if (null === a) return null;
            d = d || document.createElement("canvas");
            c = c || cc.rect(0, 0, a.width, a.height);
            d.width = c.width;
            d.height = c.height;
            var e = d.getContext("2d");
            e.drawImage(a, c.x, c.y, c.width, c.height, 0, 0, c.width, c.height);
            a = e.getImageData(0, 0, c.width, c.height);
            c = a.data;
            for (var f = 0,
            g = c.length; f < g; f += 4) c[f] = c[f + 1] = c[f + 2] = 0.34 * c[f] + 0.5 * c[f + 1] + 0.16 * c[f + 2];
            e.putImageData(a, 0, 0);
            return d
        }
    } else cc._renderType === cc.game.RENDER_TYPE_WEBGL && (cc.assert(cc.isFunction(cc._tmp.WebGLTexture2D), cc._LogInfos.MissingFile, "TexturesWebGL.js"), cc._tmp.WebGLTexture2D(), delete cc._tmp.WebGLTexture2D);
    cc.EventHelper.prototype.apply(cc.Texture2D.prototype);
    cc.assert(cc.isFunction(cc._tmp.PrototypeTexture2D), cc._LogInfos.MissingFile, "TexturesPropertyDefine.js");
    cc._tmp.PrototypeTexture2D();
    delete cc._tmp.PrototypeTexture2D
});
cc.textureCache = {
    _textures: {},
    _textureColorsCache: {},
    _textureKeySeq: 0 | 1E3 * Math.random(),
    _loadedTexturesBefore: {},
    _initializingRenderer: function() {
        var a, b = this._loadedTexturesBefore,
        c = this._textures;
        for (a in b) {
            var d = b[a];
            d.handleLoadedTexture();
            c[a] = d
        }
        this._loadedTexturesBefore = {}
    },
    addPVRTCImage: function(a) {
        cc.log(cc._LogInfos.textureCache_addPVRTCImage)
    },
    addETCImage: function(a) {
        cc.log(cc._LogInfos.textureCache_addETCImage)
    },
    description: function() {
        return "\x3cTextureCache | Number of textures \x3d " + this._textures.length + "\x3e"
    },
    textureForKey: function(a) {
        cc.log(cc._LogInfos.textureCache_textureForKey);
        return this.getTextureForKey(a)
    },
    getTextureForKey: function(a) {
        return this._textures[a] || this._textures[cc.loader._getAliase(a)]
    },
    getKeyByTexture: function(a) {
        for (var b in this._textures) if (this._textures[b] === a) return b;
        return null
    },
    _generalTextureKey: function(a) {
        return "_textureKey_" + a
    },
    getTextureColors: function(a) {
        var b = a._htmlElementObj,
        c = this.getKeyByTexture(b);
        c || (c = b instanceof HTMLImageElement ? b.src: this._generalTextureKey(a.__instanceId));
        this._textureColorsCache[c] || (this._textureColorsCache[c] = a._generateTextureCacheForColor());
        return this._textureColorsCache[c]
    },
    addPVRImage: function(a) {
        cc.log(cc._LogInfos.textureCache_addPVRImage)
    },
    removeAllTextures: function() {
        var a = this._textures,
        b;
        for (b in a) a[b] && a[b].releaseTexture();
        this._textures = {}
    },
    removeTexture: function(a) {
        if (a) {
            var b = this._textures,
            c;
            for (c in b) b[c] === a && (b[c].releaseTexture(), delete b[c])
        }
    },
    removeTextureForKey: function(a) {
        if (null != a) {
            var b = this._textures[a];
            b && (b.releaseTexture(), delete this._textures[a])
        }
    },
    cacheImage: function(a, b) {
        if (b instanceof cc.Texture2D) this._textures[a] = b;
        else {
            var c = new cc.Texture2D;
            c.initWithElement(b);
            c.handleLoadedTexture();
            this._textures[a] = c
        }
    },
    addUIImage: function(a, b) {
        cc.assert(a, cc._LogInfos.textureCache_addUIImage_2);
        if (b && this._textures[b]) return this._textures[b];
        var c = new cc.Texture2D;
        c.initWithImage(a);
        null != b ? this._textures[b] = c: cc.log(cc._LogInfos.textureCache_addUIImage);
        return c
    },
    dumpCachedTextureInfo: function() {
        var a = 0,
        b = 0,
        c = this._textures,
        d;
        for (d in c) {
            var e = c[d];
            a++;
            e.getHtmlElementObj() instanceof HTMLImageElement ? cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo, d, e.getHtmlElementObj().src, e.getPixelsWide(), e.getPixelsHigh()) : cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_2, d, e.getPixelsWide(), e.getPixelsHigh());
            b += e.getPixelsWide() * e.getPixelsHigh() * 4
        }
        c = this._textureColorsCache;
        for (d in c) {
            var e = c[d],
            f;
            for (f in e) {
                var g = e[f];
                a++;
                cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_2, d, g.width, g.height);
                b += g.width * g.height * 4
            }
        }
        cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_3, a, b / 1024, (b / 1048576).toFixed(2))
    },
    _clear: function() {
        this._textures = {};
        this._textureColorsCache = {};
        this._textureKeySeq = 0 | 1E3 * Math.random();
        this._loadedTexturesBefore = {}
    }
};
cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,
function() {
    if (cc._renderType === cc.game.RENDER_TYPE_CANVAS) {
        var a = cc.textureCache;
        a.handleLoadedTexture = function(a, c) {
            var d = this._textures,
            e = d[a];
            e || (e = d[a] = new cc.Texture2D, e.url = a);
            e.initWithElement(c);
            e.handleLoadedTexture();
            return e
        };
        a.addImage = function(a, c, d) {
            cc.assert(a, cc._LogInfos.Texture2D_addImage);
            var e = this._textures,
            f = e[a] || e[cc.loader._getAliase(a)];
            if (f) return f.isLoaded() ? c && c.call(d, f) : f.addEventListener("load",
            function() {
                c && c.call(d, f)
            },
            d),
            f;
            f = e[a] = new cc.Texture2D;
            f.url = a;
            e = cc.loader.getBasePath ? cc.loader.getBasePath() : cc.loader.resPath;
            cc.loader.loadImg(cc.path.join(e || "", a),
            function(e, f) {
                if (e) return c && c.call(d, e);
                var k = cc.textureCache.handleLoadedTexture(a, f);
                c && c.call(d, k)
            });
            return f
        };
        a.addImageAsync = a.addImage;
        a = null
    } else cc._renderType === cc.game.RENDER_TYPE_WEBGL && (cc.assert(cc.isFunction(cc._tmp.WebGLTextureCache), cc._LogInfos.MissingFile, "TexturesWebGL.js"), cc._tmp.WebGLTextureCache(), delete cc._tmp.WebGLTextureCache)
});
cc.TextureAtlas = cc.Class.extend({
    dirty: !1,
    texture: null,
    _indices: null,
    _buffersVBO: null,
    _capacity: 0,
    _quads: null,
    _quadsArrayBuffer: null,
    _quadsWebBuffer: null,
    _quadsReader: null,
    ctor: function(a, b) {
        this._buffersVBO = [];
        cc.isString(a) ? this.initWithFile(a, b) : a instanceof cc.Texture2D && this.initWithTexture(a, b)
    },
    getTotalQuads: function() {
        return this._totalQuads
    },
    getCapacity: function() {
        return this._capacity
    },
    getTexture: function() {
        return this.texture
    },
    setTexture: function(a) {
        this.texture = a
    },
    setDirty: function(a) {
        this.dirty = a
    },
    isDirty: function() {
        return this.dirty
    },
    getQuads: function() {
        return this._quads
    },
    setQuads: function(a) {
        this._quads = a
    },
    _copyQuadsToTextureAtlas: function(a, b) {
        if (a) for (var c = 0; c < a.length; c++) this._setQuadToArray(a[c], b + c)
    },
    _setQuadToArray: function(a, b) {
        var c = this._quads;
        c[b] ? (c[b].bl = a.bl, c[b].br = a.br, c[b].tl = a.tl, c[b].tr = a.tr) : c[b] = new cc.V3F_C4B_T2F_Quad(a.tl, a.bl, a.tr, a.br, this._quadsArrayBuffer, b * cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT)
    },
    description: function() {
        return "\x3ccc.TextureAtlas | totalQuads \x3d" + this._totalQuads + "\x3e"
    },
    _setupIndices: function() {
        if (0 !== this._capacity) for (var a = this._indices,
        b = this._capacity,
        c = 0; c < b; c++) cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP ? (a[6 * c + 0] = 4 * c + 0, a[6 * c + 1] = 4 * c + 0, a[6 * c + 2] = 4 * c + 2, a[6 * c + 3] = 4 * c + 1, a[6 * c + 4] = 4 * c + 3, a[6 * c + 5] = 4 * c + 3) : (a[6 * c + 0] = 4 * c + 0, a[6 * c + 1] = 4 * c + 1, a[6 * c + 2] = 4 * c + 2, a[6 * c + 3] = 4 * c + 3, a[6 * c + 4] = 4 * c + 2, a[6 * c + 5] = 4 * c + 1)
    },
    _setupVBO: function() {
        var a = cc._renderContext;
        this._buffersVBO[0] = a.createBuffer();
        this._buffersVBO[1] = a.createBuffer();
        this._quadsWebBuffer = a.createBuffer();
        this._mapBuffers()
    },
    _mapBuffers: function() {
        var a = cc._renderContext;
        a.bindBuffer(a.ARRAY_BUFFER, this._quadsWebBuffer);
        a.bufferData(a.ARRAY_BUFFER, this._quadsArrayBuffer, a.DYNAMIC_DRAW);
        a.bindBuffer(a.ELEMENT_ARRAY_BUFFER, this._buffersVBO[1]);
        a.bufferData(a.ELEMENT_ARRAY_BUFFER, this._indices, a.STATIC_DRAW)
    },
    initWithFile: function(a, b) {
        var c = cc.textureCache.addImage(a);
        if (c) return this.initWithTexture(c, b);
        cc.log(cc._LogInfos.TextureAtlas_initWithFile, a);
        return ! 1
    },
    initWithTexture: function(a, b) {
        cc.assert(a, cc._LogInfos.TextureAtlas_initWithTexture);
        this._capacity = b |= 0;
        this._totalQuads = 0;
        this.texture = a;
        this._quads = [];
        this._indices = new Uint16Array(6 * b);
        var c = cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;
        this._quadsArrayBuffer = new ArrayBuffer(c * b);
        this._quadsReader = new Uint8Array(this._quadsArrayBuffer);
        if ((!this._quads || !this._indices) && 0 < b) return ! 1;
        for (var d = this._quads,
        e = 0; e < b; e++) d[e] = new cc.V3F_C4B_T2F_Quad(null, null, null, null, this._quadsArrayBuffer, e * c);
        this._setupIndices();
        this._setupVBO();
        return this.dirty = !0
    },
    updateQuad: function(a, b) {
        cc.assert(a, cc._LogInfos.TextureAtlas_updateQuad);
        cc.assert(0 <= b && b < this._capacity, cc._LogInfos.TextureAtlas_updateQuad_2);
        this._totalQuads = Math.max(b + 1, this._totalQuads);
        this._setQuadToArray(a, b);
        this.dirty = !0
    },
    insertQuad: function(a, b) {
        cc.assert(b < this._capacity, cc._LogInfos.TextureAtlas_insertQuad_2);
        this._totalQuads++;
        if (this._totalQuads > this._capacity) cc.log(cc._LogInfos.TextureAtlas_insertQuad);
        else {
            var c = cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,
            d = b * c,
            e = (this._totalQuads - 1 - b) * c;
            this._quads[this._totalQuads - 1] = new cc.V3F_C4B_T2F_Quad(null, null, null, null, this._quadsArrayBuffer, (this._totalQuads - 1) * c);
            this._quadsReader.set(this._quadsReader.subarray(d, d + e), d + c);
            this._setQuadToArray(a, b);
            this.dirty = !0
        }
    },
    insertQuads: function(a, b, c) {
        c = c || a.length;
        cc.assert(b + c <= this._capacity, cc._LogInfos.TextureAtlas_insertQuads);
        var d = cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;
        this._totalQuads += c;
        if (this._totalQuads > this._capacity) cc.log(cc._LogInfos.TextureAtlas_insertQuad);
        else {
            var e = b * d,
            f = (this._totalQuads - 1 - b - c) * d,
            g = this._totalQuads - 1 - c,
            h;
            for (h = 0; h < c; h++) this._quads[g + h] = new cc.V3F_C4B_T2F_Quad(null, null, null, null, this._quadsArrayBuffer, (this._totalQuads - 1) * d);
            this._quadsReader.set(this._quadsReader.subarray(e, e + f), e + d * c);
            for (h = 0; h < c; h++) this._setQuadToArray(a[h], b + h);
            this.dirty = !0
        }
    },
    insertQuadFromIndex: function(a, b) {
        if (a !== b) {
            cc.assert(0 <= b || b < this._totalQuads, cc._LogInfos.TextureAtlas_insertQuadFromIndex);
            cc.assert(0 <= a || a < this._totalQuads, cc._LogInfos.TextureAtlas_insertQuadFromIndex_2);
            var c = cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,
            d = this._quadsReader,
            e = d.subarray(a * c, c),
            f;
            a > b ? (f = b * c, d.set(d.subarray(f, f + (a - b) * c), f + c), d.set(e, f)) : (f = (a + 1) * c, d.set(d.subarray(f, f + (b - a) * c), f - c), d.set(e, b * c));
            this.dirty = !0
        }
    },
    removeQuadAtIndex: function(a) {
        cc.assert(a < this._totalQuads, cc._LogInfos.TextureAtlas_removeQuadAtIndex);
        var b = cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;
        this._totalQuads--;
        this._quads.length = this._totalQuads;
        if (a !== this._totalQuads) {
            var c = (a + 1) * b;
            this._quadsReader.set(this._quadsReader.subarray(c, c + (this._totalQuads - a) * b), c - b)
        }
        this.dirty = !0
    },
    removeQuadsAtIndex: function(a, b) {
        cc.assert(a + b <= this._totalQuads, cc._LogInfos.TextureAtlas_removeQuadsAtIndex);
        this._totalQuads -= b;
        if (a !== this._totalQuads) {
            var c = cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,
            d = (a + b) * c,
            e = a * c;
            this._quadsReader.set(this._quadsReader.subarray(d, d + (this._totalQuads - a) * c), e)
        }
        this.dirty = !0
    },
    removeAllQuads: function() {
        this._totalQuads = this._quads.length = 0
    },
    _setDirty: function(a) {
        this.dirty = a
    },
    resizeCapacity: function(a) {
        if (a === this._capacity) return ! 0;
        var b = cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,
        c = this._capacity;
        this._totalQuads = Math.min(this._totalQuads, a);
        var d = this._capacity = 0 | a,
        e = this._totalQuads;
        if (null === this._quads) for (this._quads = [], this._quadsArrayBuffer = new ArrayBuffer(b * d), this._quadsReader = new Uint8Array(this._quadsArrayBuffer), a = 0; a < d; a++) this._quads = new cc.V3F_C4B_T2F_Quad(null, null, null, null, this._quadsArrayBuffer, a * b);
        else {
            var f, g, h = this._quads;
            if (d > c) {
                f = [];
                g = new ArrayBuffer(b * d);
                for (a = 0; a < e; a++) f[a] = new cc.V3F_C4B_T2F_Quad(h[a].tl, h[a].bl, h[a].tr, h[a].br, g, a * b);
                for (; a < d; a++) f[a] = new cc.V3F_C4B_T2F_Quad(null, null, null, null, g, a * b)
            } else for (e = Math.max(e, d), f = [], g = new ArrayBuffer(b * d), a = 0; a < e; a++) f[a] = new cc.V3F_C4B_T2F_Quad(h[a].tl, h[a].bl, h[a].tr, h[a].br, g, a * b);
            this._quadsReader = new Uint8Array(g);
            this._quads = f;
            this._quadsArrayBuffer = g
        }
        null === this._indices ? this._indices = new Uint16Array(6 * d) : d > c ? (b = new Uint16Array(6 * d), b.set(this._indices, 0), this._indices = b) : this._indices = this._indices.subarray(0, 6 * d);
        this._setupIndices();
        this._mapBuffers();
        return this.dirty = !0
    },
    increaseTotalQuadsWith: function(a) {
        this._totalQuads += a
    },
    moveQuadsFromIndex: function(a, b, c) {
        if (void 0 === c) {
            if (c = b, b = this._totalQuads - a, cc.assert(c + (this._totalQuads - a) <= this._capacity, cc._LogInfos.TextureAtlas_moveQuadsFromIndex), 0 === b) return
        } else if (cc.assert(c + b <= this._totalQuads, cc._LogInfos.TextureAtlas_moveQuadsFromIndex_2), cc.assert(a < this._totalQuads, cc._LogInfos.TextureAtlas_moveQuadsFromIndex_3), a === c) return;
        var d = cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,
        e = a * d,
        f = b * d,
        g = this._quadsReader,
        h = g.subarray(e, e + f),
        k = c * d;
        c < a ? (b = c * d, g.set(g.subarray(b, b + (a - c) * d), b + f)) : (b = (a + b) * d, g.set(g.subarray(b, b + (c - a) * d), e));
        g.set(h, k);
        this.dirty = !0
    },
    fillWithEmptyQuadsFromIndex: function(a, b) {
        for (var c = b * cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,
        d = new Uint8Array(this._quadsArrayBuffer, a * cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT, c), e = 0; e < c; e++) d[e] = 0
    },
    drawQuads: function() {
        this.drawNumberOfQuads(this._totalQuads, 0)
    },
    _releaseBuffer: function() {
        var a = cc._renderContext;
        this._buffersVBO && (this._buffersVBO[0] && a.deleteBuffer(this._buffersVBO[0]), this._buffersVBO[1] && a.deleteBuffer(this._buffersVBO[1]));
        this._quadsWebBuffer && a.deleteBuffer(this._quadsWebBuffer)
    }
});
_p = cc.TextureAtlas.prototype;
cc.defineGetterSetter(_p, "totalQuads", _p.getTotalQuads);
cc.defineGetterSetter(_p, "capacity", _p.getCapacity);
cc.defineGetterSetter(_p, "quads", _p.getQuads, _p.setQuads);
cc.TextureAtlas.create = function(a, b) {
    return new cc.TextureAtlas(a, b)
};
cc.TextureAtlas.createWithTexture = cc.TextureAtlas.create;
cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,
function() {
    cc._renderType === cc.game.RENDER_TYPE_WEBGL && (cc.assert(cc.isFunction(cc._tmp.WebGLTextureAtlas), cc._LogInfos.MissingFile, "TexturesWebGL.js"), cc._tmp.WebGLTextureAtlas(), delete cc._tmp.WebGLTextureAtlas)
});
cc.assert(cc.isFunction(cc._tmp.PrototypeTextureAtlas), cc._LogInfos.MissingFile, "TexturesPropertyDefine.js");
cc._tmp.PrototypeTextureAtlas();
delete cc._tmp.PrototypeTextureAtlas;
cc.Scene = cc.Node.extend({
    _className: "Scene",
    ctor: function() {
        cc.Node.prototype.ctor.call(this);
        this._ignoreAnchorPointForPosition = !0;
        this.setAnchorPoint(0.5, 0.5);
        this.setContentSize(cc.director.getWinSize())
    }
});
cc.Scene.create = function() {
    return new cc.Scene
};
cc.LoaderScene = cc.Scene.extend({
    _interval: null,
    _label: null,
    _logo: null,
    _className: "LoaderScene",
    cb: null,
    target: null,
    init: function() {
        var a = this,
        b = 200,
        c = a._bgLayer = new cc.LayerColor(cc.color(32, 32, 32, 255));
        a.addChild(c, 0);
        var d = 24,
        e = -b / 2 + 100;
        cc._loaderImage && (cc.loader.loadImg(cc._loaderImage, {
            isCrossOrigin: !1
        },
        function(c, d) {
            b = d.height;
            a._initStage(d, cc.visibleRect.center)
        }), d = 14, e = -b / 2 - 10);
        d = a._label = new cc.LabelTTF("Loading... 0%", "Arial", d);
        d.setPosition(cc.pAdd(cc.visibleRect.center, cc.p(0, e)));
        d.setColor(cc.color(180, 180, 180));
        c.addChild(this._label, 10);
        return ! 0
    },
    _initStage: function(a, b) {
        var c = this._texture2d = new cc.Texture2D;
        c.initWithElement(a);
        c.handleLoadedTexture();
        c = this._logo = new cc.Sprite(c);
        c.setScale(cc.contentScaleFactor());
        c.x = b.x;
        c.y = b.y;
        this._bgLayer.addChild(c, 10)
    },
    onEnter: function() {
        cc.Node.prototype.onEnter.call(this);
        this.schedule(this._startLoading, 0.3)
    },
    onExit: function() {
        cc.Node.prototype.onExit.call(this);
        this._label.setString("Loading... 0%")
    },
    initWithResources: function(a, b, c) {
        cc.isString(a) && (a = [a]);
        this.resources = a || [];
        this.cb = b;
        this.target = c
    },
    _startLoading: function() {
        var a = this;
        a.unschedule(a._startLoading);
        cc.loader.load(a.resources,
        function(b, c, d) {
            b = Math.min(d / c * 100 | 0, 100);
            a._label.setString("Loading... " + b + "%")
        },
        function() {
            a.cb && a.cb.call(a.target)
        })
    },
    _updateTransform: function() {
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);
        this._bgLayer._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);
        this._label._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);
        this._logo && this._logo._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    }
});
cc.LoaderScene.preload = function(a, b, c) {
    var d = cc;
    d.loaderScene || (d.loaderScene = new cc.LoaderScene, d.loaderScene.init(), cc.eventManager.addCustomListener(cc.Director.EVENT_PROJECTION_CHANGED,
    function() {
        d.loaderScene._updateTransform()
    }));
    d.loaderScene.initWithResources(a, b, c);
    cc.director.runScene(d.loaderScene);
    return d.loaderScene
};
cc.Layer = cc.Node.extend({
    _className: "Layer",
    ctor: function() {
        cc.Node.prototype.ctor.call(this);
        this._ignoreAnchorPointForPosition = !0;
        this.setAnchorPoint(0.5, 0.5);
        this.setContentSize(cc.winSize);
        this._cascadeOpacityEnabled = this._cascadeColorEnabled = !1
    },
    bake: function() {
        this._renderCmd.bake()
    },
    unbake: function() {
        this._renderCmd.unbake()
    },
    isBaked: function() {
        return this._renderCmd._isBaked
    },
    visit: function(a) {
        var b = this._renderCmd,
        c = a ? a._renderCmd: null;
        if (this._visible) {
            a = cc.renderer;
            b.visit(c);
            if (b._isBaked) a.pushRenderCommand(b),
            b._bakeSprite.visit(this);
            else {
                var d = this._children,
                e = d.length,
                f;
                if (0 < e) {
                    this._reorderChildDirty && this.sortAllChildren();
                    for (c = 0; c < e; c++) if (f = d[c], 0 > f._localZOrder) f.visit(this);
                    else break;
                    for (a.pushRenderCommand(b); c < e; c++) d[c].visit(this)
                } else a.pushRenderCommand(b)
            }
            b._dirtyFlag = 0
        } else b._propagateFlagsDown(c)
    },
    addChild: function(a, b, c) {
        cc.Node.prototype.addChild.call(this, a, b, c);
        this._renderCmd._bakeForAddChild(a)
    },
    _createRenderCmd: function() {
        return cc._renderType === cc.game.RENDER_TYPE_CANVAS ? new cc.Layer.CanvasRenderCmd(this) : new cc.Layer.WebGLRenderCmd(this)
    }
});
cc.Layer.create = function() {
    return new cc.Layer
};
cc.LayerColor = cc.Layer.extend({
    _blendFunc: null,
    _className: "LayerColor",
    getBlendFunc: function() {
        return this._blendFunc
    },
    changeWidthAndHeight: function(a, b) {
        this.width = a;
        this.height = b
    },
    changeWidth: function(a) {
        this.width = a
    },
    changeHeight: function(a) {
        this.height = a
    },
    setOpacityModifyRGB: function(a) {},
    isOpacityModifyRGB: function() {
        return ! 1
    },
    ctor: function(a, b, c) {
        cc.Layer.prototype.ctor.call(this);
        this._blendFunc = cc.BlendFunc._alphaNonPremultiplied();
        cc.LayerColor.prototype.init.call(this, a, b, c)
    },
    init: function(a, b, c) {
        var d = cc.director.getWinSize();
        a = a || cc.color(0, 0, 0, 255);
        b = void 0 === b ? d.width: b;
        c = void 0 === c ? d.height: c;
        d = this._realColor;
        d.r = a.r;
        d.g = a.g;
        d.b = a.b;
        this._realOpacity = a.a;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty | cc.Node._dirtyFlags.opacityDirty);
        cc.LayerColor.prototype.setContentSize.call(this, b, c);
        return ! 0
    },
    visit: function(a) {
        var b = this._renderCmd,
        c = a ? a._renderCmd: null;
        if (this._visible) {
            a = cc.renderer;
            b.visit(c);
            if (b._isBaked) a.pushRenderCommand(b._bakeRenderCmd),
            b._bakeSprite._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),
            b._bakeSprite.visit(this);
            else {
                var d = this._children,
                e = d.length;
                if (0 < e) {
                    this._reorderChildDirty && this.sortAllChildren();
                    for (c = 0; c < e; c++) if (child = d[c], 0 > child._localZOrder) child.visit(this);
                    else break;
                    for (a.pushRenderCommand(b); c < e; c++) d[c].visit(this)
                } else a.pushRenderCommand(b)
            }
            b._dirtyFlag = 0
        } else b._propagateFlagsDown(c)
    },
    setBlendFunc: function(a, b) {
        var c = this._blendFunc;
        void 0 === b ? (c.src = a.src, c.dst = a.dst) : (c.src = a, c.dst = b);
        this._renderCmd.updateBlendFunc(c)
    },
    _createRenderCmd: function() {
        return cc._renderType === cc.game.RENDER_TYPE_CANVAS ? new cc.LayerColor.CanvasRenderCmd(this) : new cc.LayerColor.WebGLRenderCmd(this)
    }
});
cc.LayerColor.create = function(a, b, c) {
    return new cc.LayerColor(a, b, c)
}; (function() {
    var a = cc.LayerColor.prototype;
    cc.defineGetterSetter(a, "width", a._getWidth, a._setWidth);
    cc.defineGetterSetter(a, "height", a._getHeight, a._setHeight)
})();
cc.LayerGradient = cc.LayerColor.extend({
    _endColor: null,
    _startOpacity: 255,
    _endOpacity: 255,
    _alongVector: null,
    _compressedInterpolation: !1,
    _className: "LayerGradient",
    _colorStops: [],
    ctor: function(a, b, c, d) {
        cc.LayerColor.prototype.ctor.call(this);
        this._endColor = cc.color(0, 0, 0, 255);
        this._alongVector = cc.p(0, -1);
        this._endOpacity = this._startOpacity = 255;
        d && d instanceof Array ? (this._colorStops = d, d.splice(0, 0, {
            p: 0,
            color: a || cc.color.BLACK
        }), d.push({
            p: 1,
            color: b || cc.color.BLACK
        })) : this._colorStops = [{
            p: 0,
            color: a || cc.color.BLACK
        },
        {
            p: 1,
            color: b || cc.color.BLACK
        }];
        cc.LayerGradient.prototype.init.call(this, a, b, c, d)
    },
    init: function(a, b, c, d) {
        a = a || cc.color(0, 0, 0, 255);
        b = b || cc.color(0, 0, 0, 255);
        c = c || cc.p(0, -1);
        d = this._endColor;
        this._startOpacity = a.a;
        d.r = b.r;
        d.g = b.g;
        d.b = b.b;
        this._endOpacity = b.a;
        this._alongVector = c;
        this._compressedInterpolation = !0;
        cc.LayerColor.prototype.init.call(this, cc.color(a.r, a.g, a.b, 255));
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty | cc.Node._dirtyFlags.opacityDirty | cc.Node._dirtyFlags.gradientDirty);
        return ! 0
    },
    setContentSize: function(a, b) {
        cc.LayerColor.prototype.setContentSize.call(this, a, b);
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)
    },
    _setWidth: function(a) {
        cc.LayerColor.prototype._setWidth.call(this, a);
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)
    },
    _setHeight: function(a) {
        cc.LayerColor.prototype._setHeight.call(this, a);
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)
    },
    getStartColor: function() {
        return cc.color(this._realColor)
    },
    setStartColor: function(a) {
        this.color = a;
        var b = this._colorStops;
        b && 0 < b.length && (b = b[0].color, b.r = a.r, b.g = a.g, b.b = a.b)
    },
    setEndColor: function(a) {
        var b = this._endColor;
        b.r = a.r;
        b.g = a.g;
        b.b = a.b; (b = this._colorStops) && 0 < b.length && (b = b[b.length - 1].color, b.r = a.r, b.g = a.g, b.b = a.b);
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)
    },
    getEndColor: function() {
        return cc.color(this._endColor)
    },
    setStartOpacity: function(a) {
        this._startOpacity = a;
        var b = this._colorStops;
        b && 0 < b.length && (b[0].color.a = a);
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)
    },
    getStartOpacity: function() {
        return this._startOpacity
    },
    setEndOpacity: function(a) {
        this._endOpacity = a;
        var b = this._colorStops;
        b && 0 < b.length && (b[b.length - 1].color.a = a);
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)
    },
    getEndOpacity: function() {
        return this._endOpacity
    },
    setVector: function(a) {
        this._alongVector.x = a.x;
        this._alongVector.y = a.y;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)
    },
    getVector: function() {
        return cc.p(this._alongVector.x, this._alongVector.y)
    },
    isCompressedInterpolation: function() {
        return this._compressedInterpolation
    },
    setCompressedInterpolation: function(a) {
        this._compressedInterpolation = a;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)
    },
    getColorStops: function() {
        return this._colorStops
    },
    setColorStops: function(a) {
        this._colorStops = a;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty | cc.Node._dirtyFlags.opacityDirty | cc.Node._dirtyFlags.gradientDirty)
    },
    _createRenderCmd: function() {
        return cc._renderType === cc.game.RENDER_TYPE_CANVAS ? new cc.LayerGradient.CanvasRenderCmd(this) : new cc.LayerGradient.WebGLRenderCmd(this)
    }
});
cc.LayerGradient.create = function(a, b, c, d) {
    return new cc.LayerGradient(a, b, c, d)
}; (function() {
    var a = cc.LayerGradient.prototype;
    cc.defineGetterSetter(a, "startColor", a.getStartColor, a.setStartColor);
    cc.defineGetterSetter(a, "endColor", a.getEndColor, a.setEndColor);
    cc.defineGetterSetter(a, "startOpacity", a.getStartOpacity, a.setStartOpacity);
    cc.defineGetterSetter(a, "endOpacity", a.getEndOpacity, a.setEndOpacity);
    cc.defineGetterSetter(a, "vector", a.getVector, a.setVector);
    cc.defineGetterSetter(a, "colorStops", a.getColorStops, a.setColorStops)
})();
cc.LayerMultiplex = cc.Layer.extend({
    _enabledLayer: 0,
    _layers: null,
    _className: "LayerMultiplex",
    ctor: function(a) {
        cc.Layer.prototype.ctor.call(this);
        a instanceof Array ? cc.LayerMultiplex.prototype.initWithLayers.call(this, a) : cc.LayerMultiplex.prototype.initWithLayers.call(this, Array.prototype.slice.call(arguments))
    },
    initWithLayers: function(a) {
        0 < a.length && null == a[a.length - 1] && cc.log(cc._LogInfos.LayerMultiplex_initWithLayers);
        this._layers = a;
        this._enabledLayer = 0;
        this.addChild(this._layers[this._enabledLayer]);
        return ! 0
    },
    switchTo: function(a) {
        a >= this._layers.length ? cc.log(cc._LogInfos.LayerMultiplex_switchTo) : (this.removeChild(this._layers[this._enabledLayer], !0), this._enabledLayer = a, this.addChild(this._layers[a]))
    },
    switchToAndReleaseMe: function(a) {
        a >= this._layers.length ? cc.log(cc._LogInfos.LayerMultiplex_switchToAndReleaseMe) : (this.removeChild(this._layers[this._enabledLayer], !0), this._layers[this._enabledLayer] = null, this._enabledLayer = a, this.addChild(this._layers[a]))
    },
    addLayer: function(a) {
        a ? this._layers.push(a) : cc.log(cc._LogInfos.LayerMultiplex_addLayer)
    }
});
cc.LayerMultiplex.create = function() {
    return new cc.LayerMultiplex(Array.prototype.slice.call(arguments))
}; (function() {
    cc.Layer.CanvasRenderCmd = function(a) {
        this._rootCtor(a);
        this._isBaked = !1;
        this._bakeSprite = null;
        this._canUseDirtyRegion = !0;
        this._updateCache = 2
    };
    var a = cc.Layer.CanvasRenderCmd.prototype = Object.create(cc.Node.CanvasRenderCmd.prototype);
    a.constructor = cc.Layer.CanvasRenderCmd;
    a._layerCmdCtor = cc.Layer.CanvasRenderCmd;
    a._setCacheDirty = function(a) {
        a && 0 === this._updateCache && (this._updateCache = 2); ! 1 === this._cacheDirty && (this._cacheDirty = !0, (a = this._cachedParent) && a !== this && a._setNodeDirtyForCache && a._setNodeDirtyForCache())
    };
    a.updateStatus = function() {
        var a = cc.Node._dirtyFlags;
        this._dirtyFlag & a.orderDirty && (this._cacheDirty = !0, 0 === this._updateCache && (this._updateCache = 2), this._dirtyFlag &= ~a.orderDirty);
        this.originUpdateStatus()
    };
    a._syncStatus = function(a) {
        var c = cc.Node._dirtyFlags,
        d = this._dirtyFlag;
        if (this._isBaked || d & c.orderDirty) this._cacheDirty = !0,
        0 === this._updateCache && (this._updateCache = 2),
        this._dirtyFlag &= ~c.orderDirty;
        this._originSyncStatus(a)
    };
    a.transform = function(a, c) {
        this._worldTransform || (this._worldTransform = {
            a: 1,
            b: 0,
            c: 0,
            d: 1,
            tx: 0,
            ty: 0
        });
        var d = this._worldTransform,
        e = d.a,
        f = d.b,
        g = d.c,
        h = d.d;
        this.originTransform(a, c);
        d.a === e && d.b === f && d.c === g && d.d === h || 0 !== this._updateCache || (this._updateCache = 2)
    };
    a.bake = function() {
        if (!this._isBaked) {
            this._needDraw = !0;
            this._isBaked = this._cacheDirty = cc.renderer.childrenOrderDirty = !0;
            0 === this._updateCache && (this._updateCache = 2);
            for (var a = this._node._children,
            c = 0,
            d = a.length; c < d; c++) a[c]._renderCmd._setCachedParent(this);
            this._bakeSprite || (this._bakeSprite = new cc.BakeSprite, this._bakeSprite.setAnchorPoint(0, 0))
        }
    };
    a.unbake = function() {
        if (this._isBaked) {
            cc.renderer.childrenOrderDirty = !0;
            this._isBaked = this._needDraw = !1;
            this._cacheDirty = !0;
            0 === this._updateCache && (this._updateCache = 2);
            for (var a = this._node._children,
            c = 0,
            d = a.length; c < d; c++) a[c]._renderCmd._setCachedParent(null)
        }
    };
    a.isBaked = function() {
        return this._isBaked
    };
    a.rendering = function() {
        if (this._cacheDirty) {
            var a = this._node,
            c = a._children,
            d = this._bakeSprite;
            this.transform(this.getParentRenderCmd(), !0);
            var e = this._getBoundingBoxForBake();
            e.width = 0 | e.width + 0.5;
            e.height = 0 | e.height + 0.5;
            var f = d.getCacheContext(),
            g = f.getContext();
            d.setPosition(e.x, e.y);
            if (0 < this._updateCache) {
                d.resetCanvasSize(e.width, e.height);
                f.setOffset(0 - e.x, g.canvas.height - e.height + e.y);
                a.sortAllChildren();
                cc.renderer._turnToCacheMode(this.__instanceId);
                a = 0;
                for (e = c.length; a < e; a++) c[a].visit(this);
                cc.renderer._renderingToCacheCanvas(f, this.__instanceId);
                d.transform();
                this._updateCache--
            }
            this._cacheDirty = !1
        }
    };
    a._bakeForAddChild = function(a) {
        a._parent === this._node && this._isBaked && a._renderCmd._setCachedParent(this)
    };
    a._getBoundingBoxForBake = function() {
        var a = null,
        c = this._node;
        if (!c._children || 0 === c._children.length) return cc.rect(0, 0, 10, 10);
        for (var d = c.getNodeToWorldTransform(), c = c._children, e = 0, f = c.length; e < f; e++) {
            var g = c[e];
            g && g._visible && (a ? (g = g._getBoundingBoxToCurrentNode(d)) && (a = cc.rectUnion(a, g)) : a = g._getBoundingBoxToCurrentNode(d))
        }
        return a
    }
})(); (function() {
    cc.LayerColor.CanvasRenderCmd = function(a) {
        this._layerCmdCtor(a);
        this._needDraw = !0;
        this._blendFuncStr = "source-over";
        this._bakeRenderCmd = new cc.CustomRenderCmd(this, this._bakeRendering)
    };
    var a = cc.LayerColor.CanvasRenderCmd.prototype = Object.create(cc.Layer.CanvasRenderCmd.prototype);
    a.constructor = cc.LayerColor.CanvasRenderCmd;
    a.unbake = function() {
        cc.Layer.CanvasRenderCmd.prototype.unbake.call(this);
        this._needDraw = !0
    };
    a.rendering = function(a, c, d) {
        a = a || cc._renderContext;
        var e = a.getContext(),
        f = this._node,
        g = this._displayedColor,
        h = this._displayedOpacity / 255,
        k = f._contentSize.width,
        f = f._contentSize.height;
        0 !== h && (a.setCompositeOperation(this._blendFuncStr), a.setGlobalAlpha(h), a.setFillStyle("rgba(" + (0 | g.r) + "," + (0 | g.g) + "," + (0 | g.b) + ", 1)"), a.setTransform(this._worldTransform, c, d), e.fillRect(0, 0, k, -f), cc.g_NumberOfDraws++)
    };
    a.updateBlendFunc = function(a) {
        this._blendFuncStr = cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(a)
    };
    a._updateSquareVertices = a._updateSquareVerticesWidth = a._updateSquareVerticesHeight = function() {};
    a._bakeRendering = function() {
        if (this._cacheDirty) {
            var a = this._node,
            c = this._bakeSprite,
            d = a._children,
            e, f = d.length;
            this.transform(this.getParentRenderCmd(), !0);
            e = this._getBoundingBoxForBake();
            e.width = 0 | e.width + 0.5;
            e.height = 0 | e.height + 0.5;
            var g = c.getCacheContext(),
            h = g.getContext();
            c.setPosition(e.x, e.y);
            if (0 < this._updateCache) {
                h.fillStyle = g._currentFillStyle;
                c.resetCanvasSize(e.width, e.height);
                g.setOffset(0 - e.x, h.canvas.height - e.height + e.y);
                cc.renderer._turnToCacheMode(this.__instanceId);
                if (0 < f) {
                    a.sortAllChildren();
                    for (e = 0; e < f; e++) if (h = d[e], 0 > h._localZOrder) h.visit(a);
                    else break;
                    for (cc.renderer.pushRenderCommand(this); e < f; e++) d[e].visit(a)
                } else cc.renderer.pushRenderCommand(this);
                cc.renderer._renderingToCacheCanvas(g, this.__instanceId);
                c.transform();
                this._updateCache--
            }
            this._cacheDirty = !1
        }
    };
    a._getBoundingBoxForBake = function() {
        var a = this._node,
        c = cc.rect(0, 0, a._contentSize.width, a._contentSize.height),
        d = a.getNodeToWorldTransform(),
        c = cc.rectApplyAffineTransform(c, a.getNodeToWorldTransform());
        if (!a._children || 0 === a._children.length) return c;
        for (var a = a._children,
        e = 0; e < a.length; e++) {
            var f = a[e];
            f && f._visible && (f = f._getBoundingBoxToCurrentNode(d), c = cc.rectUnion(c, f))
        }
        return c
    }
})(); (function() {
    cc.LayerGradient.CanvasRenderCmd = function(a) {
        cc.LayerColor.CanvasRenderCmd.call(this, a);
        this._needDraw = !0;
        this._startPoint = cc.p(0, 0);
        this._endPoint = cc.p(0, 0);
        this._endStopStr = this._startStopStr = null
    };
    var a = cc.LayerGradient.CanvasRenderCmd.prototype = Object.create(cc.LayerColor.CanvasRenderCmd.prototype);
    a.constructor = cc.LayerGradient.CanvasRenderCmd;
    a.rendering = function(a, c, d) {
        a = a || cc._renderContext;
        var e = a.getContext(),
        f = this._node,
        g = this._displayedOpacity / 255;
        if (0 !== g) {
            var h = f._contentSize.width,
            k = f._contentSize.height;
            a.setCompositeOperation(this._blendFuncStr);
            a.setGlobalAlpha(g);
            g = e.createLinearGradient(this._startPoint.x, this._startPoint.y, this._endPoint.x, this._endPoint.y);
            if (f._colorStops) for (var m = 0; m < f._colorStops.length; m++) g.addColorStop(f._colorStops[m].p, this._colorStopsStr[m]);
            else g.addColorStop(0, this._startStopStr),
            g.addColorStop(1, this._endStopStr);
            a.setFillStyle(g);
            a.setTransform(this._worldTransform, c, d);
            e.fillRect(0, 0, h, -k);
            cc.g_NumberOfDraws++
        }
    };
    a.updateStatus = function() {
        var a = cc.Node._dirtyFlags;
        this._dirtyFlag & a.gradientDirty && (this._dirtyFlag |= a.colorDirty, this._dirtyFlag &= ~a.gradientDirty);
        this.originUpdateStatus()
    };
    a._syncStatus = function(a) {
        var c = cc.Node._dirtyFlags;
        this._dirtyFlag & c.gradientDirty && (this._dirtyFlag |= c.colorDirty, this._dirtyFlag &= ~c.gradientDirty);
        this._originSyncStatus(a)
    };
    a._updateColor = function() {
        var a = this._node,
        c = a._contentSize,
        d = 0.5 * c.width,
        c = 0.5 * c.height,
        e = cc.pAngleSigned(cc.p(0, -1), a._alongVector),
        e = cc.pRotateByAngle(cc.p(0, -1), cc.p(0, 0), e),
        f = Math.min(Math.abs(1 / e.x), Math.abs(1 / e.y));
        this._startPoint.x = d * -e.x * f + d;
        this._startPoint.y = c * e.y * f - c;
        this._endPoint.x = d * e.x * f + d;
        this._endPoint.y = c * -e.y * f - c;
        d = this._displayedColor;
        c = a._endColor;
        e = a._startOpacity / 255;
        f = a._endOpacity / 255;
        this._startStopStr = "rgba(" + Math.round(d.r) + "," + Math.round(d.g) + "," + Math.round(d.b) + "," + e.toFixed(4) + ")";
        this._endStopStr = "rgba(" + Math.round(c.r) + "," + Math.round(c.g) + "," + Math.round(c.b) + "," + f.toFixed(4) + ")";
        if (a._colorStops) for (this._endOpacity = this._startOpacity = 0, this._colorStopsStr = [], d = 0; d < a._colorStops.length; d++) c = a._colorStops[d].color,
        e = null == c.a ? 1 : c.a / 255,
        this._colorStopsStr.push("rgba(" + Math.round(c.r) + "," + Math.round(c.g) + "," + Math.round(c.b) + "," + e.toFixed(4) + ")")
    }
})(); (function() {
    cc.Layer.WebGLRenderCmd = function(a) {
        this._rootCtor(a);
        this._isBaked = !1
    };
    var a = cc.Layer.WebGLRenderCmd.prototype = Object.create(cc.Node.WebGLRenderCmd.prototype);
    a.constructor = cc.Layer.WebGLRenderCmd;
    a._layerCmdCtor = cc.Layer.WebGLRenderCmd;
    a.bake = function() {};
    a.unbake = function() {};
    a._bakeForAddChild = function() {}
})(); (function() {
    cc.LayerColor.WebGLRenderCmd = function(a) {
        this._layerCmdCtor(a);
        this._needDraw = !0;
        this._matrix = null;
        this.initData(4);
        this._color = new Uint32Array(1);
        this._vertexBuffer = null;
        this._shaderProgram = cc.shaderCache.programForKey(cc.SHADER_POSITION_COLOR)
    };
    var a = cc.LayerColor.WebGLRenderCmd.prototype = Object.create(cc.Layer.WebGLRenderCmd.prototype);
    a.constructor = cc.LayerColor.WebGLRenderCmd;
    a.initData = function(a) {
        this._data = new ArrayBuffer(16 * a);
        this._positionView = new Float32Array(this._data);
        this._colorView = new Uint32Array(this._data);
        this._dataDirty = !0
    };
    a.transform = function(a, c) {
        this.originTransform(a, c);
        var d = this._node,
        e = d._contentSize.width,
        f = d._contentSize.height,
        g = this._positionView;
        g[4] = e;
        g[9] = f;
        g[12] = e;
        g[13] = f;
        g[2].z = g[6] = g[10] = g[14] = d._vertexZ;
        this._dataDirty = !0
    };
    a._updateColor = function() {
        var a = this._displayedColor;
        this._color[0] = this._displayedOpacity << 24 | a.b << 16 | a.g << 8 | a.r;
        for (var a = this._colorView,
        c = 0; 4 > c; c++) a[4 * c + 3] = this._color[0];
        this._dataDirty = !0
    };
    a.rendering = function(a) {
        a = a || cc._renderContext;
        var c = this._node;
        this._matrix || (this._matrix = new cc.math.Matrix4, this._matrix.identity());
        var d = this._worldTransform;
        this._matrix.mat[0] = d.a;
        this._matrix.mat[4] = d.c;
        this._matrix.mat[12] = d.tx;
        this._matrix.mat[1] = d.b;
        this._matrix.mat[5] = d.d;
        this._matrix.mat[13] = d.ty;
        this._dataDirty && (this._vertexBuffer || (this._vertexBuffer = a.createBuffer()), a.bindBuffer(a.ARRAY_BUFFER, this._vertexBuffer), a.bufferData(a.ARRAY_BUFFER, this._data, a.DYNAMIC_DRAW), this._dataDirty = !1);
        this._glProgramState.apply(this._matrix);
        cc.glBlendFunc(c._blendFunc.src, c._blendFunc.dst);
        a.bindBuffer(a.ARRAY_BUFFER, this._vertexBuffer);
        a.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);
        a.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR);
        a.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 3, a.FLOAT, !1, 16, 0);
        a.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR, 4, a.UNSIGNED_BYTE, !0, 16, 12);
        a.drawArrays(a.TRIANGLE_STRIP, 0, 4)
    };
    a.updateBlendFunc = function(a) {}
})(); (function() {
    cc.LayerGradient.WebGLRenderCmd = function(a) {
        cc.LayerColor.WebGLRenderCmd.call(this, a);
        this._needDraw = !0;
        this._clipRect = new cc.Rect;
        this._clippingRectDirty = !1
    };
    var a = cc.LayerGradient.WebGLRenderCmd.prototype = Object.create(cc.LayerColor.WebGLRenderCmd.prototype);
    a.constructor = cc.LayerGradient.WebGLRenderCmd;
    a.updateStatus = function() {
        var a = cc.Node._dirtyFlags;
        this._dirtyFlag & a.gradientDirty && (this._dirtyFlag |= a.colorDirty, this._updateVertex(), this._dirtyFlag &= ~a.gradientDirty);
        this.originUpdateStatus()
    };
    a._syncStatus = function(a) {
        var c = cc.Node._dirtyFlags;
        this._dirtyFlag & c.gradientDirty && (this._dirtyFlag |= c.colorDirty, this._updateVertex(), this._dirtyFlag &= ~c.gradientDirty);
        this._originSyncStatus(a)
    };
    a.transform = function(a, c) {
        this.originTransform(a, c);
        this._updateVertex()
    };
    a._updateVertex = function() {
        var a = this._node,
        c = a._colorStops;
        if (c && !(2 > c.length)) {
            this._clippingRectDirty = !0;
            var d, e = c.length,
            f = 2 * e,
            g = a._contentSize;
            this._positionView.length / 4 < f && this.initData(f);
            var h = Math.PI + cc.pAngleSigned(cc.p(0, -1), a._alongVector),
            f = cc.p(g.width / 2, g.height / 2);
            d = Math.round(cc.radiansToDegrees(h));
            var k = cc.affineTransformMake(1, 0, 0, 1, f.x, f.y),
            k = cc.affineTransformRotate(k, h),
            m;
            90 > d ? (m = cc.p( - f.x, f.y), d = cc.p(f.x, f.y)) : 180 > d ? (m = cc.p(f.x, f.y), d = cc.p(f.x, -f.y)) : 270 > d ? (m = cc.p(f.x, -f.y), d = cc.p( - f.x, -f.y)) : (m = cc.p( - f.x, -f.y), d = cc.p( - f.x, f.y));
            var r = Math.sin(h),
            h = Math.cos(h);
            m = Math.abs((m.x * h - m.y * r) / f.x);
            d = Math.abs((d.x * r + d.y * h) / f.y);
            k = cc.affineTransformScale(k, m, d);
            r = this._positionView;
            for (d = 0; d < e; d++) {
                m = c[d].p * g.height;
                var s = cc.pointApplyAffineTransform( - f.x, m - f.y, k),
                h = 8 * d;
                r[h] = s.x;
                r[h + 1] = s.y;
                r[h + 2] = a._vertexZ;
                m = cc.pointApplyAffineTransform(g.width - f.x, m - f.y, k);
                h += 4;
                r[h] = m.x;
                r[h + 1] = m.y;
                r[h + 2] = a._vertexZ
            }
            this._dataDirty = !0
        }
    };
    a._updateColor = function() {
        var a = this._node._colorStops;
        if (a && !(2 > a.length)) {
            var c = a.length,
            d, e = this._colorView,
            f = this._displayedOpacity / 255;
            for (i = 0; i < c; i++) d = a[i].color,
            this._color[0] = d.a * f << 24 | d.b << 16 | d.g << 8 | d.r,
            d = 8 * i,
            e[d + 3] = this._color[0],
            d += 4,
            e[d + 3] = this._color[0];
            this._dataDirty = !0
        }
    };
    a.rendering = function(a) {
        a = a || cc._renderContext;
        var c = this._node;
        this._matrix || (this._matrix = new cc.math.Matrix4, this._matrix.identity());
        var d = this._getClippingRect();
        a.enable(a.SCISSOR_TEST);
        cc.view.setScissorInPoints(d.x, d.y, d.width, d.height);
        d = this._worldTransform;
        this._matrix.mat[0] = d.a;
        this._matrix.mat[4] = d.c;
        this._matrix.mat[12] = d.tx;
        this._matrix.mat[1] = d.b;
        this._matrix.mat[5] = d.d;
        this._matrix.mat[13] = d.ty;
        this._dataDirty && (this._vertexBuffer || (this._vertexBuffer = gl.createBuffer()), gl.bindBuffer(gl.ARRAY_BUFFER, this._vertexBuffer), gl.bufferData(gl.ARRAY_BUFFER, this._data, gl.DYNAMIC_DRAW), this._dataDirty = !1);
        this._glProgramState.apply(this._matrix);
        cc.glBlendFunc(c._blendFunc.src, c._blendFunc.dst);
        gl.bindBuffer(gl.ARRAY_BUFFER, this._vertexBuffer);
        gl.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);
        gl.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR);
        gl.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 3, gl.FLOAT, !1, 16, 0);
        gl.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR, 4, gl.UNSIGNED_BYTE, !0, 16, 12);
        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);
        a.disable(a.SCISSOR_TEST)
    };
    a._getClippingRect = function() {
        if (this._clippingRectDirty) {
            var a = this._node,
            c = cc.rect(0, 0, a._contentSize.width, a._contentSize.height),
            a = a.getNodeToWorldTransform();
            this._clipRect = cc._rectApplyAffineTransformIn(c, a)
        }
        return this._clipRect
    }
})();
cc._tmp.PrototypeSprite = function() {
    var a = cc.Sprite.prototype;
    cc.defineGetterSetter(a, "opacityModifyRGB", a.isOpacityModifyRGB, a.setOpacityModifyRGB);
    cc.defineGetterSetter(a, "opacity", a.getOpacity, a.setOpacity);
    cc.defineGetterSetter(a, "color", a.getColor, a.setColor);
    cc.defineGetterSetter(a, "flippedX", a.isFlippedX, a.setFlippedX);
    cc.defineGetterSetter(a, "flippedY", a.isFlippedY, a.setFlippedY);
    cc.defineGetterSetter(a, "offsetX", a._getOffsetX);
    cc.defineGetterSetter(a, "offsetY", a._getOffsetY);
    cc.defineGetterSetter(a, "texture", a.getTexture, a.setTexture);
    cc.defineGetterSetter(a, "textureRectRotated", a.isTextureRectRotated);
    cc.defineGetterSetter(a, "batchNode", a.getBatchNode, a.setBatchNode);
    cc.defineGetterSetter(a, "quad", a.getQuad)
};
cc.Sprite = cc.Node.extend({
    dirty: !1,
    atlasIndex: 0,
    textureAtlas: null,
    _batchNode: null,
    _recursiveDirty: null,
    _hasChildren: null,
    _shouldBeHidden: !1,
    _transformToBatch: null,
    _blendFunc: null,
    _texture: null,
    _rect: null,
    _rectRotated: !1,
    _offsetPosition: null,
    _unflippedOffsetPositionFromCenter: null,
    _opacityModifyRGB: !1,
    _flippedX: !1,
    _flippedY: !1,
    _textureLoaded: !1,
    _className: "Sprite",
    ctor: function(a, b, c) {
        cc.Node.prototype.ctor.call(this);
        this.setAnchorPoint(0.5, 0.5);
        this._loader = new cc.Sprite.LoadManager;
        this._shouldBeHidden = !1;
        this._offsetPosition = cc.p(0, 0);
        this._unflippedOffsetPositionFromCenter = cc.p(0, 0);
        this._blendFunc = {
            src: cc.BLEND_SRC,
            dst: cc.BLEND_DST
        };
        this._rect = cc.rect(0, 0, 0, 0);
        this._softInit(a, b, c)
    },
    textureLoaded: function() {
        return this._textureLoaded
    },
    addLoadedEventListener: function(a, b) {
        this.addEventListener("load", a, b)
    },
    isDirty: function() {
        return this.dirty
    },
    setDirty: function(a) {
        this.dirty = a
    },
    isTextureRectRotated: function() {
        return this._rectRotated
    },
    getAtlasIndex: function() {
        return this.atlasIndex
    },
    setAtlasIndex: function(a) {
        this.atlasIndex = a
    },
    getTextureRect: function() {
        return cc.rect(this._rect)
    },
    getTextureAtlas: function() {
        return this.textureAtlas
    },
    setTextureAtlas: function(a) {
        this.textureAtlas = a
    },
    getOffsetPosition: function() {
        return cc.p(this._offsetPosition)
    },
    _getOffsetX: function() {
        return this._offsetPosition.x
    },
    _getOffsetY: function() {
        return this._offsetPosition.y
    },
    getBlendFunc: function() {
        return this._blendFunc
    },
    initWithSpriteFrame: function(a) {
        cc.assert(a, cc._LogInfos.Sprite_initWithSpriteFrame);
        return this.setSpriteFrame(a)
    },
    initWithSpriteFrameName: function(a) {
        cc.assert(a, cc._LogInfos.Sprite_initWithSpriteFrameName);
        var b = cc.spriteFrameCache.getSpriteFrame(a);
        cc.assert(b, a + cc._LogInfos.Sprite_initWithSpriteFrameName1);
        return this.initWithSpriteFrame(b)
    },
    useBatchNode: function(a) {},
    setVertexRect: function(a) {
        var b = this._rect;
        b.x = a.x;
        b.y = a.y;
        b.width = a.width;
        b.height = a.height;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    setFlippedX: function(a) {
        this._flippedX !== a && (this._flippedX = a, this.setTextureRect(this._rect, this._rectRotated, this._contentSize), this.setNodeDirty(!0))
    },
    setFlippedY: function(a) {
        this._flippedY !== a && (this._flippedY = a, this.setTextureRect(this._rect, this._rectRotated, this._contentSize), this.setNodeDirty(!0))
    },
    isFlippedX: function() {
        return this._flippedX
    },
    isFlippedY: function() {
        return this._flippedY
    },
    setOpacityModifyRGB: function(a) {
        this._opacityModifyRGB !== a && (this._opacityModifyRGB = a, this._renderCmd._setColorDirty())
    },
    isOpacityModifyRGB: function() {
        return this._opacityModifyRGB
    },
    setDisplayFrameWithAnimationName: function(a, b) {
        cc.assert(a, cc._LogInfos.Sprite_setDisplayFrameWithAnimationName_3);
        var c = cc.animationCache.getAnimation(a);
        c ? (c = c.getFrames()[b]) ? this.setSpriteFrame(c.getSpriteFrame()) : cc.log(cc._LogInfos.Sprite_setDisplayFrameWithAnimationName_2) : cc.log(cc._LogInfos.Sprite_setDisplayFrameWithAnimationName)
    },
    getBatchNode: function() {
        return this._batchNode
    },
    getTexture: function() {
        return this._texture
    },
    _softInit: function(a, b, c) {
        if (void 0 === a) cc.Sprite.prototype.init.call(this);
        else if ("string" === typeof a)"#" === a[0] ? (b = a.substr(1, a.length - 1), (b = cc.spriteFrameCache.getSpriteFrame(b)) ? this.initWithSpriteFrame(b) : cc.log("%s does not exist", a)) : cc.Sprite.prototype.init.call(this, a, b);
        else if ("object" === typeof a) if (a instanceof cc.Texture2D) this.initWithTexture(a, b, c);
        else if (a instanceof cc.SpriteFrame) this.initWithSpriteFrame(a);
        else if (a instanceof HTMLImageElement || a instanceof HTMLCanvasElement) b = new cc.Texture2D,
        b.initWithElement(a),
        b.handleLoadedTexture(),
        this.initWithTexture(b)
    },
    getQuad: function() {
        return null
    },
    setBlendFunc: function(a, b) {
        var c = this._blendFunc;
        void 0 === b ? (c.src = a.src, c.dst = a.dst) : (c.src = a, c.dst = b);
        this._renderCmd.updateBlendFunc(c)
    },
    init: function() {
        if (0 < arguments.length) return this.initWithFile(arguments[0], arguments[1]);
        cc.Node.prototype.init.call(this);
        this.dirty = this._recursiveDirty = !1;
        this._blendFunc.src = cc.BLEND_SRC;
        this._blendFunc.dst = cc.BLEND_DST;
        this.texture = null;
        this._flippedX = this._flippedY = !1;
        this.anchorY = this.anchorX = 0.5;
        this._offsetPosition.x = 0;
        this._offsetPosition.y = 0;
        this._hasChildren = !1;
        this.setTextureRect(cc.rect(0, 0, 0, 0), !1, cc.size(0, 0));
        return ! 0
    },
    initWithFile: function(a, b) {
        cc.assert(a, cc._LogInfos.Sprite_initWithFile);
        var c = cc.textureCache.getTextureForKey(a);
        c || (c = cc.textureCache.addImage(a));
        if (!c.isLoaded()) return this._loader.clear(),
        this._loader.once(c,
        function() {
            this.initWithFile(a, b);
            this.dispatchEvent("load")
        },
        this),
        !1;
        if (!b) {
            var d = c.getContentSize();
            b = cc.rect(0, 0, d.width, d.height)
        }
        return this.initWithTexture(c, b)
    },
    initWithTexture: function(a, b, c, d) {
        cc.assert(0 !== arguments.length, cc._LogInfos.CCSpriteBatchNode_initWithTexture);
        this._loader.clear();
        this._textureLoaded = a.isLoaded();
        if (!this._textureLoaded) return this._loader.once(a,
        function() {
            this.initWithTexture(a, b, c, d);
            this.dispatchEvent("load")
        },
        this),
        !1;
        c = c || !1;
        a = this._renderCmd._handleTextureForRotatedTexture(a, b, c, d);
        if (!cc.Node.prototype.init.call(this)) return ! 1;
        this._batchNode = null;
        this.dirty = this._recursiveDirty = !1;
        this._opacityModifyRGB = !0;
        this._blendFunc.src = cc.BLEND_SRC;
        this._blendFunc.dst = cc.BLEND_DST;
        this._flippedX = this._flippedY = !1;
        this._offsetPosition.x = 0;
        this._offsetPosition.y = 0;
        this._hasChildren = !1;
        this._rectRotated = c;
        b && (this._rect.x = b.x, this._rect.y = b.y, this._rect.width = b.width, this._rect.height = b.height);
        b || (b = cc.rect(0, 0, a.width, a.height));
        this._renderCmd._checkTextureBoundary(a, b, c);
        this.setTexture(a);
        this.setTextureRect(b, c);
        this.setBatchNode(null);
        return ! 0
    },
    setTextureRect: function(a, b, c, d) {
        this._rectRotated = b || !1;
        this.setContentSize(c || a);
        this.setVertexRect(a);
        this._renderCmd._setTextureCoords(a, d);
        a = this._unflippedOffsetPositionFromCenter.x;
        b = this._unflippedOffsetPositionFromCenter.y;
        this._flippedX && (a = -a);
        this._flippedY && (b = -b);
        c = this._rect;
        this._offsetPosition.x = a + (this._contentSize.width - c.width) / 2;
        this._offsetPosition.y = b + (this._contentSize.height - c.height) / 2
    },
    addChild: function(a, b, c) {
        cc.assert(a, cc._LogInfos.CCSpriteBatchNode_addChild_2);
        null == b && (b = a._localZOrder);
        null == c && (c = a.tag);
        this._renderCmd._setBatchNodeForAddChild(a) && (cc.Node.prototype.addChild.call(this, a, b, c), this._hasChildren = !0)
    },
    setSpriteFrame: function(a) {
        var b = a;
        if ("string" === typeof a) {
            a = cc.spriteFrameCache.getSpriteFrame(a);
            if (null == a) {
                cc.log("setSpriteFrame............" + b);
                return
            }
            cc.assert(a, cc._LogInfos.Sprite_setSpriteFrame)
        }
        this._loader.clear();
        this.setNodeDirty(!0);
        b = a.getTexture();
        this._textureLoaded = a.textureLoaded();
        this._loader.clear();
        if (!this._textureLoaded) return this._loader.once(b,
        function() {
            this.setSpriteFrame(a);
            this.dispatchEvent("load")
        },
        this),
        !1;
        var c = a.getOffset();
        this._unflippedOffsetPositionFromCenter.x = c.x;
        this._unflippedOffsetPositionFromCenter.y = c.y;
        b !== this._texture && (this._renderCmd._setTexture(b), this.setColor(this._realColor));
        this.setTextureRect(a.getRect(), a.isRotated(), a.getOriginalSize())
    },
    setDisplayFrame: function(a) {
        cc.log(cc._LogInfos.Sprite_setDisplayFrame);
        this.setSpriteFrame(a)
    },
    isFrameDisplayed: function(a) {
        return this._renderCmd.isFrameDisplayed(a)
    },
    displayFrame: function() {
        return this.getSpriteFrame()
    },
    getSpriteFrame: function() {
        return new cc.SpriteFrame(this._texture, cc.rectPointsToPixels(this._rect), this._rectRotated, cc.pointPointsToPixels(this._unflippedOffsetPositionFromCenter), cc.sizePointsToPixels(this._contentSize))
    },
    setBatchNode: function(a) {},
    setTexture: function(a) {
        if (!a) return this._renderCmd._setTexture(null);
        var b = "string" === typeof a;
        b && (a = cc.textureCache.addImage(a));
        this._loader.clear();
        if (!a._textureLoaded) return this._loader.once(a,
        function() {
            this.setTexture(a);
            this.dispatchEvent("load")
        },
        this),
        !1;
        this._renderCmd._setTexture(a);
        b && this._changeRectWithTexture(a);
        this.setColor(this._realColor);
        this._textureLoaded = !0
    },
    _changeRectWithTexture: function(a) {
        a = a._contentSize;
        a = cc.rect(0, 0, a.width, a.height);
        this.setTextureRect(a)
    },
    _createRenderCmd: function() {
        return cc._renderType === cc.game.RENDER_TYPE_CANVAS ? new cc.Sprite.CanvasRenderCmd(this) : new cc.Sprite.WebGLRenderCmd(this)
    }
});
cc.Sprite.create = function(a, b, c) {
    return new cc.Sprite(a, b, c)
};
cc.Sprite.createWithTexture = cc.Sprite.create;
cc.Sprite.createWithSpriteFrameName = cc.Sprite.create;
cc.Sprite.createWithSpriteFrame = cc.Sprite.create;
cc.Sprite.INDEX_NOT_INITIALIZED = -1;
cc.EventHelper.prototype.apply(cc.Sprite.prototype);
cc.assert(cc.isFunction(cc._tmp.PrototypeSprite), cc._LogInfos.MissingFile, "SpritesPropertyDefine.js");
cc._tmp.PrototypeSprite();
delete cc._tmp.PrototypeSprite; (function() {
    var a = cc.Sprite.LoadManager = function() {
        this.list = []
    };
    a.prototype.add = function(a, c, d) {
        a && a.addEventListener && (a.addEventListener("load", c, d), this.list.push({
            source: a,
            listener: c,
            target: d
        }))
    };
    a.prototype.once = function(a, c, d) {
        if (a && a.addEventListener) {
            var e = function(f) {
                a.removeEventListener("load", e, d);
                c.call(d, f)
            };
            a.addEventListener("load", e, d);
            this.list.push({
                source: a,
                listener: e,
                target: d
            })
        }
    };
    a.prototype.clear = function() {
        for (; 0 < this.list.length;) {
            var a = this.list.pop();
            a.source.removeEventListener("load", a.listener, a.target)
        }
    }
})(); (function() {
    cc.Sprite.CanvasRenderCmd = function(a) {
        this._rootCtor(a);
        this._needDraw = !0;
        this._textureCoord = {
            renderX: 0,
            renderY: 0,
            x: 0,
            y: 0,
            width: 0,
            height: 0,
            validRect: !1
        };
        this._blendFuncStr = "source-over";
        this._colorized = !1;
        this._canUseDirtyRegion = !0;
        this._textureToRender = null
    };
    var a = cc.Sprite.CanvasRenderCmd.prototype = Object.create(cc.Node.CanvasRenderCmd.prototype);
    a.constructor = cc.Sprite.CanvasRenderCmd;
    a._spriteCmdCtor = cc.Sprite.CanvasRenderCmd;
    a.setDirtyRecursively = function(a) {};
    a._setTexture = function(a) {
        var c = this._node;
        c._texture !== a && (c._textureLoaded = a ? a._textureLoaded: !1, c._texture = a, a = a._contentSize, a = cc.rect(0, 0, a.width, a.height), c.setTextureRect(a), this._updateColor())
    };
    a._setColorDirty = function() {
        this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty | cc.Node._dirtyFlags.opacityDirty)
    };
    a.isFrameDisplayed = function(a) {
        var c = this._node;
        return a.getTexture() !== c._texture ? !1 : cc.rectEqualToRect(a.getRect(), c._rect)
    };
    a.updateBlendFunc = function(a) {
        this._blendFuncStr = cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(a)
    };
    a._setBatchNodeForAddChild = function(a) {
        return ! 0
    };
    a._handleTextureForRotatedTexture = function(a, c, d, e) {
        d && a.isLoaded() && (a = a.getHtmlElementObj(), a = cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(a, c, e), e = new cc.Texture2D, e.initWithElement(a), e.handleLoadedTexture(), a = e, c.x = c.y = 0, this._node._rect = cc.rect(0, 0, c.width, c.height));
        return a
    };
    a._checkTextureBoundary = function(a, c, d) {
        a && a.url && (d = c.y + c.height, c.x + c.width > a.width && cc.error(cc._LogInfos.RectWidth, a.url), d > a.height && cc.error(cc._LogInfos.RectHeight, a.url))
    };
    a.rendering = function(a, c, d) {
        var e = this._node,
        f = this._textureCoord,
        g = this._displayedOpacity / 255,
        h = this._textureToRender || e._texture;
        if ((!h || 0 !== f.width && 0 !== f.height && h._textureLoaded) && 0 !== g) {
            a = a || cc._renderContext;
            var k = a.getContext(),
            m = e._offsetPosition.x,
            r = e._rect.height,
            s = e._rect.width,
            t = -e._offsetPosition.y - r;
            a.setTransform(this._worldTransform, c, d);
            a.setCompositeOperation(this._blendFuncStr);
            a.setGlobalAlpha(g); (e._flippedX || e._flippedY) && a.save();
            e._flippedX && (m = -m - s, k.scale( - 1, 1));
            e._flippedY && (t = e._offsetPosition.y, k.scale(1, -1));
            var p, v, u;
            this._colorized ? p = g = 0 : (g = f.renderX, p = f.renderY);
            v = f.width;
            u = f.height;
            h && h._htmlElementObj ? (c = h._htmlElementObj, "" !== h._pattern ? (a.setFillStyle(k.createPattern(c, h._pattern)), k.fillRect(m, t, s, r)) : k.drawImage(c, g, p, v, u, m, t, s, r)) : (h = e._contentSize, f.validRect && (f = this._displayedColor, a.setFillStyle("rgba(" + f.r + "," + f.g + "," + f.b + ",1)"), k.fillRect(m, t, h.width * c, h.height * d))); (e._flippedX || e._flippedY) && a.restore();
            cc.g_NumberOfDraws++
        }
    };
    a._updateColor = function() {
        var a = this._node._texture,
        c = this._textureCoord,
        d = this._displayedColor;
        a && (255 !== d.r || 255 !== d.g || 255 !== d.b ? (this._textureToRender = a._generateColorTexture(d.r, d.g, d.b, c), this._colorized = !0) : a && (this._textureToRender = a, this._colorized = !1))
    };
    a._textureLoadedCallback = function(a) {
        if (!this._textureLoaded) {
            this._textureLoaded = !0;
            var c = this._rect,
            d = this._renderCmd;
            c ? cc._rectEqualToZero(c) && (c.width = a.width, c.height = a.height) : c = cc.rect(0, 0, a.width, a.height);
            this.texture = a;
            this.setTextureRect(c, this._rectRotated);
            a = d._displayedColor;
            255 === a.r && 255 === a.g && 255 === a.b || d._updateColor();
            this.setBatchNode(this._batchNode);
            this.dispatchEvent("load")
        }
    };
    a._setTextureCoords = function(a, c) {
        void 0 === c && (c = !0);
        var d = this._textureCoord,
        e = c ? cc.contentScaleFactor() : 1;
        d.renderX = d.x = 0 | a.x * e;
        d.renderY = d.y = 0 | a.y * e;
        d.width = 0 | a.width * e;
        d.height = 0 | a.height * e;
        d.validRect = !(0 === d.width || 0 === d.height || 0 > d.x || 0 > d.y)
    };
    cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas = function(a, c, d) {
        if (!a) return null;
        if (!c) return a;
        d = null == d ? !0 : d;
        var e = document.createElement("canvas");
        e.width = c.width;
        e.height = c.height;
        var f = e.getContext("2d");
        f.translate(e.width / 2, e.height / 2);
        d ? f.rotate( - 1.5707963267948966) : f.rotate(1.5707963267948966);
        f.drawImage(a, c.x, c.y, c.height, c.width, -c.height / 2, -c.width / 2, c.height, c.width);
        return e
    }
})(); (function() {
    cc.Sprite.WebGLRenderCmd = function(a) {
        this._rootCtor(a);
        this._needDraw = !0;
        this._vertices = [{
            x: 0,
            y: 0,
            u: 0,
            v: 0
        },
        {
            x: 0,
            y: 0,
            u: 0,
            v: 0
        },
        {
            x: 0,
            y: 0,
            u: 0,
            v: 0
        },
        {
            x: 0,
            y: 0,
            u: 0,
            v: 0
        }];
        this._color = new Uint32Array(1);
        this._recursiveDirty = this._dirty = !1;
        this._shaderProgram = cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR)
    };
    var a = cc.Sprite.WebGLRenderCmd.prototype = Object.create(cc.Node.WebGLRenderCmd.prototype);
    a.constructor = cc.Sprite.WebGLRenderCmd;
    a._spriteCmdCtor = cc.Sprite.WebGLRenderCmd;
    a.updateBlendFunc = function(a) {};
    a.setDirtyFlag = function(a) {
        cc.Node.WebGLRenderCmd.prototype.setDirtyFlag.call(this, a);
        this._dirty = !0
    };
    a.setDirtyRecursively = function(a) {
        this._dirty = this._recursiveDirty = a;
        for (var c = this._node._children,
        d, e = c ? c.length: 0, f = 0; f < e; f++) d = c[f],
        d instanceof cc.Sprite && d._renderCmd.setDirtyRecursively(a)
    };
    a._setBatchNodeForAddChild = function(a) {
        var c = this._node;
        if (c._batchNode) {
            if (! (a instanceof cc.Sprite)) return cc.log(cc._LogInfos.Sprite_addChild),
            !1;
            a.texture._webTextureObj !== c.textureAtlas.texture._webTextureObj && cc.log(cc._LogInfos.Sprite_addChild_2);
            c._batchNode.appendChild(a);
            c._reorderChildDirty || c._setReorderChildDirtyRecursively()
        }
        return ! 0
    };
    a._handleTextureForRotatedTexture = function(a) {
        return a
    };
    a.isFrameDisplayed = function(a) {
        var c = this._node;
        return cc.rectEqualToRect(a.getRect(), c._rect) && a.getTexture().getName() === c._texture.getName() && cc.pointEqualToPoint(a.getOffset(), c._unflippedOffsetPositionFromCenter)
    };
    a._textureLoadedCallback = function(a) {
        if (!this._textureLoaded) {
            this._textureLoaded = !0;
            var c = this._rect;
            c ? cc._rectEqualToZero(c) && (c.width = a.width, c.height = a.height) : c = cc.rect(0, 0, a.width, a.height);
            this.texture = a;
            this.setTextureRect(c, this._rectRotated);
            this.setBatchNode(this._batchNode);
            this.dispatchEvent("load");
            cc.renderer.childrenOrderDirty = !0
        }
    };
    a._setTextureCoords = function(a, c) {
        void 0 === c && (c = !0);
        c && (a = cc.rectPointsToPixels(a));
        var d = this._node,
        e = d._batchNode ? d.textureAtlas.texture: d._texture,
        f = this._vertices;
        if (e) {
            var g = e.pixelsWidth,
            h = e.pixelsHeight,
            k, m;
            d._rectRotated ? (cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL ? (e = (2 * a.x + 1) / (2 * g), g = e + (2 * a.height - 2) / (2 * g), k = (2 * a.y + 1) / (2 * h), h = k + (2 * a.width - 2) / (2 * h)) : (e = a.x / g, g = (a.x + a.height) / g, k = a.y / h, h = (a.y + a.width) / h), d._flippedX && (m = k, k = h, h = m), d._flippedY && (m = e, e = g, g = m), f[0].u = g, f[0].v = k, f[1].u = e, f[1].v = k, f[2].u = g, f[2].v = h, f[3].u = e) : (cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL ? (e = (2 * a.x + 1) / (2 * g), g = e + (2 * a.width - 2) / (2 * g), k = (2 * a.y + 1) / (2 * h), h = k + (2 * a.height - 2) / (2 * h)) : (e = a.x / g, g = (a.x + a.width) / g, k = a.y / h, h = (a.y + a.height) / h), d._flippedX && (m = e, e = g, g = m), d._flippedY && (m = k, k = h, h = m), f[0].u = e, f[0].v = k, f[1].u = e, f[1].v = h, f[2].u = g, f[2].v = k, f[3].u = g);
            f[3].v = h
        }
    };
    a._setColorDirty = function() {};
    a._updateBlendFunc = function() {
        if (this._batchNode) cc.log(cc._LogInfos.Sprite__updateBlendFunc);
        else {
            var a = this._node,
            c = a._blendFunc;
            a._texture && a._texture.hasPremultipliedAlpha() ? (c.src === cc.SRC_ALPHA && c.dst === cc.BLEND_DST && (c.src = cc.ONE), a.opacityModifyRGB = !0) : (c.src === cc.ONE && c.dst === cc.BLEND_DST && (c.src = cc.SRC_ALPHA), a.opacityModifyRGB = !1)
        }
    };
    a._setTexture = function(a) {
        var c = this._node;
        if (c._texture !== a) {
            c._textureLoaded = a ? a._textureLoaded: !1;
            if (c._texture = a) a = a._contentSize,
            a = cc.rect(0, 0, a.width, a.height),
            c.setTextureRect(a),
            this._updateBlendFunc();
            c._textureLoaded && (cc.renderer.childrenOrderDirty = !0)
        }
    };
    a._checkTextureBoundary = function(a, c, d) {
        a && a.url && (d ? (d = c.x + c.height, c = c.y + c.width) : (d = c.x + c.width, c = c.y + c.height), d > a.width && cc.error(cc._LogInfos.RectWidth, a.url), c > a.height && cc.error(cc._LogInfos.RectHeight, a.url))
    };
    a.transform = function(a, c) {
        this.originTransform(a, c);
        var d = this._node,
        e = d._offsetPosition.x,
        f = e + d._rect.width,
        g = d._offsetPosition.y,
        h = g + d._rect.height,
        k = this._worldTransform,
        d = k.tx,
        m = k.ty,
        r = e * k.a,
        e = e * k.b,
        s = f * k.a,
        f = f * k.b,
        t = h * k.c,
        h = h * k.d,
        p = g * k.c,
        g = g * k.d,
        k = this._vertices;
        k[0].x = r + t + d;
        k[0].y = e + h + m;
        k[1].x = r + p + d;
        k[1].y = e + g + m;
        k[2].x = s + t + d;
        k[2].y = f + h + m;
        k[3].x = s + p + d;
        k[3].y = f + g + m
    };
    a.needDraw = function() {
        var a = this._node._texture;
        return this._needDraw && a
    };
    a.uploadData = function(a, c, d) {
        var e = this._node,
        f = e._texture;
        if (! (f && f._textureLoaded && e._rect.width && e._rect.height && this._displayedOpacity)) return 0;
        var f = this._displayedOpacity,
        g = this._displayedColor.r,
        h = this._displayedColor.g,
        k = this._displayedColor.b;
        if (e._opacityModifyRGB) var m = f / 255,
        g = g * m,
        h = h * m,
        k = k * m;
        this._color[0] = f << 24 | k << 16 | h << 8 | g;
        e = e._vertexZ;
        f = this._vertices;
        g = f.length;
        k = d;
        for (d = 0; d < g; ++d) h = f[d],
        a[k] = h.x,
        a[k + 1] = h.y,
        a[k + 2] = e,
        c[k + 3] = this._color[0],
        a[k + 4] = h.u,
        a[k + 5] = h.v,
        k += 6;
        return g
    }
})();
cc.SpriteBatchNode = cc.Node.extend({
    _blendFunc: null,
    _texture: null,
    _className: "SpriteBatchNode",
    ctor: function(a) {
        cc.Node.prototype.ctor.call(this);
        this._blendFunc = new cc.BlendFunc(cc.BLEND_SRC, cc.BLEND_DST);
        var b;
        cc.isString(a) ? (b = cc.textureCache.getTextureForKey(a)) || (b = cc.textureCache.addImage(a)) : a instanceof cc.Texture2D && (b = a);
        b && this.initWithTexture(b)
    },
    addSpriteWithoutQuad: function(a, b, c) {
        this.addChild(a, b, c);
        return this
    },
    getTextureAtlas: function() {
        return null
    },
    setTextureAtlas: function(a) {},
    getDescendants: function() {
        return this._children
    },
    initWithFile: function(a, b) {
        var c = cc.textureCache.getTextureForKey(a);
        c || (c = cc.textureCache.addImage(a));
        return this.initWithTexture(c, b)
    },
    init: function(a, b) {
        var c = cc.textureCache.getTextureForKey(a);
        c || (c = cc.textureCache.addImage(a));
        return this.initWithTexture(c, b)
    },
    increaseAtlasCapacity: function() {},
    removeChildAtIndex: function(a, b) {
        this.removeChild(this._children[a], b)
    },
    rebuildIndexInOrder: function(a, b) {
        return b
    },
    highestAtlasIndexInChild: function(a) {
        var b = a.children;
        return b && 0 !== b.length ? this.highestAtlasIndexInChild(b[b.length - 1]) : a.zIndex
    },
    lowestAtlasIndexInChild: function(a) {
        var b = a.children;
        return b && 0 !== b.length ? this.lowestAtlasIndexInChild(b[b.length - 1]) : a.zIndex
    },
    atlasIndexForChild: function(a) {
        return a.zIndex
    },
    reorderBatch: function(a) {
        this._reorderChildDirty = a
    },
    setBlendFunc: function(a, b) {
        this._blendFunc = void 0 === b ? a: {
            src: a,
            dst: b
        }
    },
    getBlendFunc: function() {
        return new cc.BlendFunc(this._blendFunc.src, this._blendFunc.dst)
    },
    updateQuadFromSprite: function(a, b) {
        cc.assert(a, cc._LogInfos.CCSpriteBatchNode_updateQuadFromSprite_2);
        a instanceof cc.Sprite ? (a.dirty = !0, a._renderCmd.transform(this._renderCmd, !0)) : cc.log(cc._LogInfos.CCSpriteBatchNode_updateQuadFromSprite)
    },
    insertQuadFromSprite: function(a, b) {
        this.addChild(a, b)
    },
    insertChild: function(a, b) {
        this.addChild(a, b)
    },
    appendChild: function(a) {
        this.sortAllChildren();
        this.addChild(a.lastLocalZOrder + 1)
    },
    removeSpriteFromAtlas: function(a, b) {
        this.removeChild(a, b)
    },
    initWithTexture: function(a) {
        this.setTexture(a);
        return ! 0
    },
    getTexture: function() {
        return this._texture
    },
    setTexture: function(a) {
        this._texture = a;
        if (a._textureLoaded) {
            var b, c = this._children,
            d = c.length;
            for (b = 0; b < d; ++b) c[b].setTexture(a)
        } else a.addEventListener("load",
        function() {
            var b, c = this._children,
            d = c.length;
            for (b = 0; b < d; ++b) c[b].setTexture(a)
        },
        this)
    },
    setShaderProgram: function(a) {
        this._renderCmd.setShaderProgram(a);
        var b, c = this._children,
        d = c.length;
        for (b = 0; b < d; ++b) c[b].setShaderProgram(a)
    },
    addChild: function(a, b, c) {
        cc.assert(void 0 !== a, cc._LogInfos.CCSpriteBatchNode_addChild_3);
        this._isValidChild(a) && (b = void 0 === b ? a.zIndex: b, c = void 0 === c ? a.tag: c, cc.Node.prototype.addChild.call(this, a, b, c), this._renderCmd._shaderProgram && (a.shaderProgram = this._renderCmd._shaderProgram))
    },
    _isValidChild: function(a) {
        return a instanceof cc.Sprite ? a.texture !== this._texture ? (cc.log(cc._LogInfos.Sprite_addChild_5), !1) : !0 : (cc.log(cc._LogInfos.Sprite_addChild_4), !1)
    }
});
_p = cc.SpriteBatchNode.prototype;
cc.defineGetterSetter(_p, "texture", _p.getTexture, _p.setTexture);
cc.defineGetterSetter(_p, "shaderProgram", _p.getShaderProgram, _p.setShaderProgram);
cc.SpriteBatchNode.create = function(a) {
    return new cc.SpriteBatchNode(a)
};
cc.SpriteBatchNode.createWithTexture = cc.SpriteBatchNode.create;
cc.BakeSprite = cc.Sprite.extend({
    _cacheCanvas: null,
    _cacheContext: null,
    ctor: function() {
        cc.Sprite.prototype.ctor.call(this);
        var a = document.createElement("canvas");
        a.width = a.height = 10;
        this._cacheCanvas = a;
        this._cacheContext = new cc.CanvasContextWrapper(a.getContext("2d"));
        var b = new cc.Texture2D;
        b.initWithElement(a);
        b.handleLoadedTexture();
        this.setTexture(b)
    },
    getCacheContext: function() {
        return this._cacheContext
    },
    getCacheCanvas: function() {
        return this._cacheCanvas
    },
    resetCanvasSize: function(a, b) {
        var c = this._cacheCanvas,
        d = this._cacheContext,
        e = d._context.strokeStyle,
        f = d._context.fillStyle;
        void 0 === b && (b = a.height, a = a.width);
        c.width = a;
        c.height = b;
        e !== d._context.strokeStyle && (d._context.strokeStyle = e);
        f !== d._context.fillStyle && (d._context.fillStyle = f);
        this.getTexture().handleLoadedTexture();
        this.setTextureRect(cc.rect(0, 0, a, b), !1, null, !1)
    }
});
cc.AnimationFrame = cc.Class.extend({
    _spriteFrame: null,
    _delayPerUnit: 0,
    _userInfo: null,
    ctor: function(a, b, c) {
        this._spriteFrame = a || null;
        this._delayPerUnit = b || 0;
        this._userInfo = c || null
    },
    clone: function() {
        var a = new cc.AnimationFrame;
        a.initWithSpriteFrame(this._spriteFrame.clone(), this._delayPerUnit, this._userInfo);
        return a
    },
    copyWithZone: function(a) {
        return cc.clone(this)
    },
    copy: function(a) {
        a = new cc.AnimationFrame;
        a.initWithSpriteFrame(this._spriteFrame.clone(), this._delayPerUnit, this._userInfo);
        return a
    },
    initWithSpriteFrame: function(a, b, c) {
        this._spriteFrame = a;
        this._delayPerUnit = b;
        this._userInfo = c;
        return ! 0
    },
    getSpriteFrame: function() {
        return this._spriteFrame
    },
    setSpriteFrame: function(a) {
        this._spriteFrame = a
    },
    getDelayUnits: function() {
        return this._delayPerUnit
    },
    setDelayUnits: function(a) {
        this._delayPerUnit = a
    },
    getUserInfo: function() {
        return this._userInfo
    },
    setUserInfo: function(a) {
        this._userInfo = a
    }
});
cc.AnimationFrame.create = function(a, b, c) {
    return new cc.AnimationFrame(a, b, c)
};
cc.Animation = cc.Class.extend({
    _frames: null,
    _loops: 0,
    _restoreOriginalFrame: !1,
    _duration: 0,
    _delayPerUnit: 0,
    _totalDelayUnits: 0,
    ctor: function(a, b, c) {
        this._frames = [];
        if (void 0 === a) this.initWithSpriteFrames(null, 0);
        else {
            var d = a[0];
            d && (d instanceof cc.SpriteFrame ? this.initWithSpriteFrames(a, b, c) : d instanceof cc.AnimationFrame && this.initWithAnimationFrames(a, b, c))
        }
    },
    getFrames: function() {
        return this._frames
    },
    setFrames: function(a) {
        this._frames = a
    },
    addSpriteFrame: function(a) {
        var b = new cc.AnimationFrame;
        b.initWithSpriteFrame(a, 1, null);
        this._frames.push(b);
        this._totalDelayUnits++
    },
    addSpriteFrameWithFile: function(a) {
        a = cc.textureCache.addImage(a);
        var b = cc.rect(0, 0, 0, 0);
        b.width = a.width;
        b.height = a.height;
        a = new cc.SpriteFrame(a, b);
        this.addSpriteFrame(a)
    },
    addSpriteFrameWithTexture: function(a, b) {
        var c = new cc.SpriteFrame(a, b);
        this.addSpriteFrame(c)
    },
    initWithAnimationFrames: function(a, b, c) {
        cc.arrayVerifyType(a, cc.AnimationFrame);
        this._delayPerUnit = b;
        this._loops = void 0 === c ? 1 : c;
        this._totalDelayUnits = 0;
        b = this._frames;
        for (c = b.length = 0; c < a.length; c++) {
            var d = a[c];
            b.push(d);
            this._totalDelayUnits += d.getDelayUnits()
        }
        return ! 0
    },
    clone: function() {
        var a = new cc.Animation;
        a.initWithAnimationFrames(this._copyFrames(), this._delayPerUnit, this._loops);
        a.setRestoreOriginalFrame(this._restoreOriginalFrame);
        return a
    },
    copyWithZone: function(a) {
        a = new cc.Animation;
        a.initWithAnimationFrames(this._copyFrames(), this._delayPerUnit, this._loops);
        a.setRestoreOriginalFrame(this._restoreOriginalFrame);
        return a
    },
    _copyFrames: function() {
        for (var a = [], b = 0; b < this._frames.length; b++) a.push(this._frames[b].clone());
        return a
    },
    copy: function(a) {
        return this.copyWithZone(null)
    },
    getLoops: function() {
        return this._loops
    },
    setLoops: function(a) {
        this._loops = a
    },
    setRestoreOriginalFrame: function(a) {
        this._restoreOriginalFrame = a
    },
    getRestoreOriginalFrame: function() {
        return this._restoreOriginalFrame
    },
    getDuration: function() {
        return this._totalDelayUnits * this._delayPerUnit
    },
    getDelayPerUnit: function() {
        return this._delayPerUnit
    },
    setDelayPerUnit: function(a) {
        this._delayPerUnit = a
    },
    getTotalDelayUnits: function() {
        return this._totalDelayUnits
    },
    initWithSpriteFrames: function(a, b, c) {
        cc.arrayVerifyType(a, cc.SpriteFrame);
        this._loops = void 0 === c ? 1 : c;
        this._delayPerUnit = b || 0;
        this._totalDelayUnits = 0;
        b = this._frames;
        b.length = 0;
        if (a) {
            for (c = 0; c < a.length; c++) {
                var d = a[c],
                e = new cc.AnimationFrame;
                e.initWithSpriteFrame(d, 1, null);
                b.push(e)
            }
            this._totalDelayUnits += a.length
        }
        return ! 0
    },
    retain: function() {},
    release: function() {}
});
cc.Animation.create = function(a, b, c) {
    return new cc.Animation(a, b, c)
};
cc.Animation.createWithAnimationFrames = cc.Animation.create;
cc.animationCache = {
    _animations: {},
    addAnimation: function(a, b) {
        this._animations[b] = a
    },
    removeAnimation: function(a) {
        a && this._animations[a] && delete this._animations[a]
    },
    getAnimation: function(a) {
        return this._animations[a] ? this._animations[a] : null
    },
    _addAnimationsWithDictionary: function(a, b) {
        var c = a.animations;
        if (c) {
            var d = 1,
            e = a.properties;
            if (e) for (var d = null != e.format ? parseInt(e.format) : d, e = e.spritesheets, f = cc.spriteFrameCache, g = cc.path, h = 0; h < e.length; h++) f.addSpriteFrames(g.changeBasename(b, e[h]));
            switch (d) {
            case 1:
                this._parseVersion1(c);
                break;
            case 2:
                this._parseVersion2(c);
                break;
            default:
                cc.log(cc._LogInfos.animationCache__addAnimationsWithDictionary_2)
            }
        } else cc.log(cc._LogInfos.animationCache__addAnimationsWithDictionary)
    },
    addAnimations: function(a) {
        cc.assert(a, cc._LogInfos.animationCache_addAnimations_2);
        var b = cc.loader.getRes(a);
        b ? this._addAnimationsWithDictionary(b, a) : cc.log(cc._LogInfos.animationCache_addAnimations)
    },
    _parseVersion1: function(a) {
        var b = cc.spriteFrameCache,
        c;
        for (c in a) {
            var d = a[c],
            e = d.frames,
            d = parseFloat(d.delay) || 0,
            f = null;
            if (e) {
                for (var f = [], g = 0; g < e.length; g++) {
                    var h = b.getSpriteFrame(e[g]);
                    if (h) {
                        var k = new cc.AnimationFrame;
                        k.initWithSpriteFrame(h, 1, null);
                        f.push(k)
                    } else cc.log(cc._LogInfos.animationCache__parseVersion1_2, c, e[g])
                }
                0 === f.length ? cc.log(cc._LogInfos.animationCache__parseVersion1_3, c) : (f.length !== e.length && cc.log(cc._LogInfos.animationCache__parseVersion1_4, c), f = new cc.Animation(f, d, 1), cc.animationCache.addAnimation(f, c))
            } else cc.log(cc._LogInfos.animationCache__parseVersion1, c)
        }
    },
    _parseVersion2: function(a) {
        var b = cc.spriteFrameCache,
        c;
        for (c in a) {
            var d = a[c],
            e = d.loop,
            f = parseInt(d.loops),
            e = e ? cc.REPEAT_FOREVER: isNaN(f) ? 1 : f,
            f = d.restoreOriginalFrame && !0 == d.restoreOriginalFrame ? !0 : !1,
            g = d.frames;
            if (g) {
                for (var h = [], k = 0; k < g.length; k++) {
                    var m = g[k],
                    r = m.spriteframe,
                    s = b.getSpriteFrame(r);
                    if (s) {
                        var r = parseFloat(m.delayUnits) || 0,
                        m = m.notification,
                        t = new cc.AnimationFrame;
                        t.initWithSpriteFrame(s, r, m);
                        h.push(t)
                    } else cc.log(cc._LogInfos.animationCache__parseVersion2_2, c, r)
                }
                d = parseFloat(d.delayPerUnit) || 0;
                g = new cc.Animation;
                g.initWithAnimationFrames(h, d, e);
                g.setRestoreOriginalFrame(f);
                cc.animationCache.addAnimation(g, c)
            } else cc.log(cc._LogInfos.animationCache__parseVersion2, c)
        }
    },
    _clear: function() {
        this._animations = {}
    }
};
cc.SpriteFrame = cc.Class.extend({
    _offset: null,
    _originalSize: null,
    _rectInPixels: null,
    _rotated: !1,
    _rect: null,
    _offsetInPixels: null,
    _originalSizeInPixels: null,
    _texture: null,
    _textureFilename: "",
    _textureLoaded: !1,
    ctor: function(a, b, c, d, e) {
        this._offset = cc.p(0, 0);
        this._offsetInPixels = cc.p(0, 0);
        this._originalSize = cc.size(0, 0);
        this._rotated = !1;
        this._originalSizeInPixels = cc.size(0, 0);
        this._textureFilename = "";
        this._texture = null;
        this._textureLoaded = !1;
        void 0 !== a && void 0 !== b && (void 0 === c || void 0 === d || void 0 === e ? this.initWithTexture(a, b) : this.initWithTexture(a, b, c, d, e))
    },
    textureLoaded: function() {
        return this._textureLoaded
    },
    addLoadedEventListener: function(a, b) {
        this.addEventListener("load", a, b)
    },
    getRectInPixels: function() {
        var a = this._rectInPixels;
        return cc.rect(a.x, a.y, a.width, a.height)
    },
    setRectInPixels: function(a) {
        this._rectInPixels || (this._rectInPixels = cc.rect(0, 0, 0, 0));
        this._rectInPixels.x = a.x;
        this._rectInPixels.y = a.y;
        this._rectInPixels.width = a.width;
        this._rectInPixels.height = a.height;
        this._rect = cc.rectPixelsToPoints(a)
    },
    isRotated: function() {
        return this._rotated
    },
    setRotated: function(a) {
        this._rotated = a
    },
    getRect: function() {
        var a = this._rect;
        return cc.rect(a.x, a.y, a.width, a.height)
    },
    setRect: function(a) {
        this._rect || (this._rect = cc.rect(0, 0, 0, 0));
        this._rect.x = a.x;
        this._rect.y = a.y;
        this._rect.width = a.width;
        this._rect.height = a.height;
        this._rectInPixels = cc.rectPointsToPixels(this._rect)
    },
    getOffsetInPixels: function() {
        return cc.p(this._offsetInPixels)
    },
    setOffsetInPixels: function(a) {
        this._offsetInPixels.x = a.x;
        this._offsetInPixels.y = a.y;
        cc._pointPixelsToPointsOut(this._offsetInPixels, this._offset)
    },
    getOriginalSizeInPixels: function() {
        return cc.size(this._originalSizeInPixels)
    },
    setOriginalSizeInPixels: function(a) {
        this._originalSizeInPixels.width = a.width;
        this._originalSizeInPixels.height = a.height
    },
    getOriginalSize: function() {
        return cc.size(this._originalSize)
    },
    setOriginalSize: function(a) {
        this._originalSize.width = a.width;
        this._originalSize.height = a.height
    },
    getTexture: function() {
        if (this._texture) return this._texture;
        if ("" !== this._textureFilename) {
            var a = cc.textureCache.addImage(this._textureFilename);
            a && (this._textureLoaded = a.isLoaded());
            return a
        }
        return null
    },
    setTexture: function(a) {
        if (this._texture !== a) {
            var b = a.isLoaded();
            this._textureLoaded = b;
            this._texture = a;
            b || a.addEventListener("load",
            function(a) {
                this._textureLoaded = !0;
                if (this._rotated && cc._renderType === cc.game.RENDER_TYPE_CANVAS) {
                    var b = a.getHtmlElementObj(),
                    b = cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(b, this.getRect()),
                    e = new cc.Texture2D;
                    e.initWithElement(b);
                    e.handleLoadedTexture();
                    this.setTexture(e);
                    b = this.getRect();
                    this.setRect(cc.rect(0, 0, b.width, b.height))
                }
                b = this._rect;
                0 === b.width && 0 === b.height && (b = a.width, a = a.height, this._rect.width = b, this._rect.height = a, this._rectInPixels = cc.rectPointsToPixels(this._rect), this._originalSizeInPixels.width = this._rectInPixels.width, this._originalSizeInPixels.height = this._rectInPixels.height, this._originalSize.width = b, this._originalSize.height = a);
                this.dispatchEvent("load")
            },
            this)
        }
    },
    getOffset: function() {
        return cc.p(this._offset)
    },
    setOffset: function(a) {
        this._offset.x = a.x;
        this._offset.y = a.y
    },
    clone: function() {
        var a = new cc.SpriteFrame;
        a.initWithTexture(this._textureFilename, this._rectInPixels, this._rotated, this._offsetInPixels, this._originalSizeInPixels);
        a.setTexture(this._texture);
        return a
    },
    copyWithZone: function() {
        var a = new cc.SpriteFrame;
        a.initWithTexture(this._textureFilename, this._rectInPixels, this._rotated, this._offsetInPixels, this._originalSizeInPixels);
        a.setTexture(this._texture);
        return a
    },
    copy: function() {
        return this.copyWithZone()
    },
    initWithTexture: function(a, b, c, d, e) {
        2 === arguments.length && (b = cc.rectPointsToPixels(b));
        d = d || cc.p(0, 0);
        e = e || b;
        c = c || !1;
        "string" === typeof a ? (this._texture = null, this._textureFilename = a) : a instanceof cc.Texture2D && this.setTexture(a);
        a = this.getTexture();
        this._rectInPixels = b;
        this._rect = cc.rectPixelsToPoints(b);
        if (a && a.url && a.isLoaded()) {
            var f, g;
            c ? (f = b.x + b.height, g = b.y + b.width) : (f = b.x + b.width, g = b.y + b.height);
            f > a.getPixelsWide() && cc.error(cc._LogInfos.RectWidth, a.url);
            g > a.getPixelsHigh() && cc.error(cc._LogInfos.RectHeight, a.url)
        }
        this._offsetInPixels.x = d.x;
        this._offsetInPixels.y = d.y;
        cc._pointPixelsToPointsOut(d, this._offset);
        this._originalSizeInPixels.width = e.width;
        this._originalSizeInPixels.height = e.height;
        cc._sizePixelsToPointsOut(e, this._originalSize);
        this._rotated = c;
        return ! 0
    }
});
cc.EventHelper.prototype.apply(cc.SpriteFrame.prototype);
cc.SpriteFrame.create = function(a, b, c, d, e) {
    return new cc.SpriteFrame(a, b, c, d, e)
};
cc.SpriteFrame.createWithTexture = cc.SpriteFrame.create;
cc.SpriteFrame._frameWithTextureForCanvas = function(a, b, c, d, e) {
    var f = new cc.SpriteFrame;
    f._texture = a;
    f._rectInPixels = b;
    f._rect = cc.rectPixelsToPoints(b);
    f._offsetInPixels.x = d.x;
    f._offsetInPixels.y = d.y;
    cc._pointPixelsToPointsOut(f._offsetInPixels, f._offset);
    f._originalSizeInPixels.width = e.width;
    f._originalSizeInPixels.height = e.height;
    cc._sizePixelsToPointsOut(f._originalSizeInPixels, f._originalSize);
    f._rotated = c;
    return f
};
cc.spriteFrameCache = {
    _CCNS_REG1: /^\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*$/,
    _CCNS_REG2: /^\s*\{\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*,\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*\}\s*$/,
    _spriteFrames: {},
    _spriteFramesAliases: {},
    _frameConfigCache: {},
    _rectFromString: function(a) {
        return (a = this._CCNS_REG2.exec(a)) ? cc.rect(parseFloat(a[1]), parseFloat(a[2]), parseFloat(a[3]), parseFloat(a[4])) : cc.rect(0, 0, 0, 0)
    },
    _pointFromString: function(a) {
        return (a = this._CCNS_REG1.exec(a)) ? cc.p(parseFloat(a[1]), parseFloat(a[2])) : cc.p(0, 0)
    },
    _sizeFromString: function(a) {
        return (a = this._CCNS_REG1.exec(a)) ? cc.size(parseFloat(a[1]), parseFloat(a[2])) : cc.size(0, 0)
    },
    _getFrameConfig: function(a) {
        var b = cc.loader.getRes(a);
        cc.assert(b, cc._LogInfos.spriteFrameCache__getFrameConfig_2, a);
        cc.loader.release(a);
        if (b._inited) return this._frameConfigCache[a] = b;
        this._frameConfigCache[a] = this._parseFrameConfig(b);
        return this._frameConfigCache[a]
    },
    _getFrameConfigByJsonObject: function(a, b) {
        cc.assert(b, cc._LogInfos.spriteFrameCache__getFrameConfig_2, a);
        this._frameConfigCache[a] = this._parseFrameConfig(b);
        return this._frameConfigCache[a]
    },
    _parseFrameConfig: function(a) {
        var b = a.frames,
        c = a.metadata || a.meta;
        a = {};
        var d = {},
        e = 0;
        c && (e = c.format, e = 1 >= e.length ? parseInt(e) : e, d.image = c.textureFileName || c.textureFileName || c.image);
        for (var f in b) {
            var g = b[f];
            if (g) {
                c = {};
                if (0 == e) {
                    c.rect = cc.rect(g.x, g.y, g.width, g.height);
                    c.rotated = !1;
                    c.offset = cc.p(g.offsetX, g.offsetY);
                    var h = g.originalWidth,
                    g = g.originalHeight;
                    h && g || cc.log(cc._LogInfos.spriteFrameCache__getFrameConfig);
                    h = Math.abs(h);
                    g = Math.abs(g);
                    c.size = cc.size(h, g)
                } else if (1 == e || 2 == e) c.rect = this._rectFromString(g.frame),
                c.rotated = g.rotated || !1,
                c.offset = this._pointFromString(g.offset),
                c.size = this._sizeFromString(g.sourceSize);
                else if (3 == e) {
                    var h = this._sizeFromString(g.spriteSize),
                    k = this._rectFromString(g.textureRect);
                    h && (k = cc.rect(k.x, k.y, h.width, h.height));
                    c.rect = k;
                    c.rotated = g.textureRotated || !1;
                    c.offset = this._pointFromString(g.spriteOffset);
                    c.size = this._sizeFromString(g.spriteSourceSize);
                    c.aliases = g.aliases
                } else h = g.frame,
                k = g.sourceSize,
                f = g.filename || f,
                c.rect = cc.rect(h.x, h.y, h.w, h.h),
                c.rotated = g.rotated || !1,
                c.offset = cc.p(0, 0),
                c.size = cc.size(k.w, k.h);
                a[f] = c
            }
        }
        return {
            _inited: !0,
            frames: a,
            meta: d
        }
    },
    _addSpriteFramesByObject: function(a, b, c) {
        cc.assert(a, cc._LogInfos.spriteFrameCache_addSpriteFrames_2);
        b && b.frames && (b = this._frameConfigCache[a] || this._getFrameConfigByJsonObject(a, b), this._createSpriteFrames(a, b, c))
    },
    _createSpriteFrames: function(a, b, c) {
        var d = b.frames;
        b = b.meta;
        c ? c instanceof cc.Texture2D || (cc.isString(c) ? c = cc.textureCache.addImage(c) : cc.assert(0, cc._LogInfos.spriteFrameCache_addSpriteFrames_3)) : (c = cc.path.changeBasename(a, b.image || ".png"), c = cc.textureCache.addImage(c));
        a = this._spriteFramesAliases;
        b = this._spriteFrames;
        for (var e in d) {
            var f = d[e],
            g = b[e];
            if (!g) {
                g = new cc.SpriteFrame(c, cc.rect(f.rect), f.rotated, f.offset, f.size);
                if (f = f.aliases) for (var h = 0,
                k = f.length; h < k; h++) {
                    var m = f[h];
                    a[m] && cc.log(cc._LogInfos.spriteFrameCache_addSpriteFrames, m);
                    a[m] = e
                }
                cc._renderType === cc.game.RENDER_TYPE_CANVAS && g.isRotated() && g.getTexture().isLoaded() && (f = g.getTexture().getHtmlElementObj(), f = cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(f, g.getRectInPixels()), h = new cc.Texture2D, h.initWithElement(f), h.handleLoadedTexture(), g.setTexture(h), g.setRotated(!1), f = g._rect, g.setRect(cc.rect(0, 0, f.width, f.height)));
                b[e] = g
            }
        }
    },
    addSpriteFrames: function(a, b) {
        cc.assert(a, cc._LogInfos.spriteFrameCache_addSpriteFrames_2);
        var c = this._frameConfigCache[a] || cc.loader.getRes(a);
        c && c.frames && (c = this._frameConfigCache[a] || this._getFrameConfig(a), this._createSpriteFrames(a, c, b))
    },
    _checkConflict: function(a) {
        a = a.frames;
        for (var b in a) this._spriteFrames[b] && cc.log(cc._LogInfos.spriteFrameCache__checkConflict, b)
    },
    addSpriteFrame: function(a, b) {
        this._spriteFrames[b] = a
    },
    removeSpriteFrames: function() {
        this._spriteFrames = {};
        this._spriteFramesAliases = {}
    },
    removeSpriteFrameByName: function(a) {
        a && (this._spriteFramesAliases[a] && delete this._spriteFramesAliases[a], this._spriteFrames[a] && delete this._spriteFrames[a])
    },
    removeSpriteFramesFromFile: function(a) {
        var b = this._spriteFrames,
        c = this._spriteFramesAliases;
        if (a = this._frameConfigCache[a]) {
            a = a.frames;
            for (var d in a) if (b[d]) {
                delete b[d];
                for (var e in c) c[e] === d && delete c[e]
            }
        }
    },
    removeSpriteFramesFromTexture: function(a) {
        var b = this._spriteFrames,
        c = this._spriteFramesAliases,
        d;
        for (d in b) {
            var e = b[d];
            if (e && e.getTexture() === a) {
                delete b[d];
                for (var f in c) c[f] === d && delete c[f]
            }
        }
    },
    getSpriteFrame: function(a) {
        var b = this._spriteFrames[a];
        if (!b) {
            var c = this._spriteFramesAliases[a];
            c && ((b = this._spriteFrames[c.toString()]) || delete this._spriteFramesAliases[a])
        }
        return b
    },
    _clear: function() {
        this._spriteFrames = {};
        this._spriteFramesAliases = {};
        this._frameConfigCache = {}
    }
};
cc.configuration = {
    ERROR: 0,
    STRING: 1,
    INT: 2,
    DOUBLE: 3,
    BOOLEAN: 4,
    _maxTextureSize: 0,
    _maxModelviewStackDepth: 0,
    _supportsPVRTC: !1,
    _supportsNPOT: !1,
    _supportsBGRA8888: !1,
    _supportsDiscardFramebuffer: !1,
    _supportsShareableVAO: !1,
    _maxSamplesAllowed: 0,
    _maxTextureUnits: 0,
    _GlExtensions: "",
    _valueDict: {},
    _inited: !1,
    _init: function() {
        var a = this._valueDict;
        a["cocos2d.x.version"] = cc.ENGINE_VERSION;
        a["cocos2d.x.compiled_with_profiler"] = !1;
        a["cocos2d.x.compiled_with_gl_state_cache"] = cc.ENABLE_GL_STATE_CACHE;
        this._inited = !0
    },
    getMaxTextureSize: function() {
        return this._maxTextureSize
    },
    getMaxModelviewStackDepth: function() {
        return this._maxModelviewStackDepth
    },
    getMaxTextureUnits: function() {
        return this._maxTextureUnits
    },
    supportsNPOT: function() {
        return this._supportsNPOT
    },
    supportsPVRTC: function() {
        return this._supportsPVRTC
    },
    supportsETC: function() {
        return ! 1
    },
    supportsS3TC: function() {
        return ! 1
    },
    supportsATITC: function() {
        return ! 1
    },
    supportsBGRA8888: function() {
        return this._supportsBGRA8888
    },
    supportsDiscardFramebuffer: function() {
        return this._supportsDiscardFramebuffer
    },
    supportsShareableVAO: function() {
        return this._supportsShareableVAO
    },
    checkForGLExtension: function(a) {
        return - 1 < this._GlExtensions.indexOf(a)
    },
    getValue: function(a, b) {
        this._inited || this._init();
        var c = this._valueDict;
        return c[a] ? c[a] : b
    },
    setValue: function(a, b) {
        this._valueDict[a] = b
    },
    dumpInfo: function() {
        0 === cc.ENABLE_GL_STATE_CACHE && (cc.log(""), cc.log(cc._LogInfos.configuration_dumpInfo), cc.log(""))
    },
    gatherGPUInfo: function() {
        if (cc._renderType !== cc.game.RENDER_TYPE_CANVAS) {
            this._inited || this._init();
            var a = cc._renderContext,
            b = this._valueDict;
            b["gl.vendor"] = a.getParameter(a.VENDOR);
            b["gl.renderer"] = a.getParameter(a.RENDERER);
            b["gl.version"] = a.getParameter(a.VERSION);
            this._GlExtensions = "";
            for (var c = a.getSupportedExtensions(), d = 0; d < c.length; d++) this._GlExtensions += c[d] + " ";
            this._maxTextureSize = a.getParameter(a.MAX_TEXTURE_SIZE);
            b["gl.max_texture_size"] = this._maxTextureSize;
            this._maxTextureUnits = a.getParameter(a.MAX_COMBINED_TEXTURE_IMAGE_UNITS);
            b["gl.max_texture_units"] = this._maxTextureUnits;
            this._supportsPVRTC = this.checkForGLExtension("GL_IMG_texture_compression_pvrtc");
            b["gl.supports_PVRTC"] = this._supportsPVRTC;
            this._supportsNPOT = !1;
            b["gl.supports_NPOT"] = this._supportsNPOT;
            this._supportsBGRA8888 = this.checkForGLExtension("GL_IMG_texture_format_BGRA888");
            b["gl.supports_BGRA8888"] = this._supportsBGRA8888;
            this._supportsDiscardFramebuffer = this.checkForGLExtension("GL_EXT_discard_framebuffer");
            b["gl.supports_discard_framebuffer"] = this._supportsDiscardFramebuffer;
            this._supportsShareableVAO = this.checkForGLExtension("vertex_array_object");
            b["gl.supports_vertex_array_object"] = this._supportsShareableVAO;
            cc.checkGLErrorDebug()
        }
    },
    loadConfigFile: function(a) {
        this._inited || this._init();
        var b = cc.loader.getRes(a);
        if (!b) throw Error("Please load the resource first : " + a);
        cc.assert(b, cc._LogInfos.configuration_loadConfigFile_2, a);
        if (b = b.data) for (var c in b) this._valueDict[c] = b[c];
        else cc.log(cc._LogInfos.configuration_loadConfigFile, a)
    }
};
cc.g_NumberOfDraws = 0;
cc.Director = cc.Class.extend({
    _landscape: !1,
    _nextDeltaTimeZero: !1,
    _paused: !1,
    _purgeDirectorInNextLoop: !1,
    _sendCleanupToScene: !1,
    _animationInterval: 0,
    _oldAnimationInterval: 0,
    _projection: 0,
    _contentScaleFactor: 1,
    _deltaTime: 0,
    _winSizeInPoints: null,
    _lastUpdate: null,
    _nextScene: null,
    _notificationNode: null,
    _openGLView: null,
    _scenesStack: null,
    _projectionDelegate: null,
    _runningScene: null,
    _totalFrames: 0,
    _secondsPerFrame: 0,
    _dirtyRegion: null,
    _scheduler: null,
    _actionManager: null,
    _eventProjectionChanged: null,
    _eventAfterUpdate: null,
    _eventAfterVisit: null,
    _eventAfterDraw: null,
    ctor: function() {
        var a = this;
        a._lastUpdate = Date.now();
        cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,
        function() {
            a._lastUpdate = Date.now()
        })
    },
    init: function() {
        this._oldAnimationInterval = this._animationInterval = 1 / cc.defaultFPS;
        this._scenesStack = [];
        this._projection = cc.Director.PROJECTION_DEFAULT;
        this._projectionDelegate = null;
        this._totalFrames = 0;
        this._lastUpdate = Date.now();
        this._purgeDirectorInNextLoop = this._paused = !1;
        this._winSizeInPoints = cc.size(0, 0);
        this._openGLView = null;
        this._contentScaleFactor = 1;
        this._scheduler = new cc.Scheduler;
        cc.ActionManager ? (this._actionManager = new cc.ActionManager, this._scheduler.scheduleUpdate(this._actionManager, cc.Scheduler.PRIORITY_SYSTEM, !1)) : this._actionManager = null;
        this._eventAfterUpdate = new cc.EventCustom(cc.Director.EVENT_AFTER_UPDATE);
        this._eventAfterUpdate.setUserData(this);
        this._eventAfterVisit = new cc.EventCustom(cc.Director.EVENT_AFTER_VISIT);
        this._eventAfterVisit.setUserData(this);
        this._eventAfterDraw = new cc.EventCustom(cc.Director.EVENT_AFTER_DRAW);
        this._eventAfterDraw.setUserData(this);
        this._eventProjectionChanged = new cc.EventCustom(cc.Director.EVENT_PROJECTION_CHANGED);
        this._eventProjectionChanged.setUserData(this);
        return ! 0
    },
    calculateDeltaTime: function() {
        var a = Date.now();
        this._nextDeltaTimeZero ? (this._deltaTime = 0, this._nextDeltaTimeZero = !1) : this._deltaTime = (a - this._lastUpdate) / 1E3;
        0 < cc.game.config[cc.game.CONFIG_KEY.debugMode] && 0.2 < this._deltaTime && (this._deltaTime = 1 / 60);
        this._lastUpdate = a
    },
    convertToGL: function(a) {
        var b = document.documentElement,
        c = cc.view,
        d = b.getBoundingClientRect();
        d.left += window.pageXOffset - b.clientLeft;
        d.top += window.pageYOffset - b.clientTop;
        b = c._devicePixelRatio * (a.x - d.left);
        a = c._devicePixelRatio * (d.top + d.height - a.y);
        return c._isRotated ? {
            x: c._viewPortRect.width - a,
            y: b
        }: {
            x: b,
            y: a
        }
    },
    convertToUI: function(a) {
        var b = document.documentElement,
        c = cc.view,
        d = b.getBoundingClientRect();
        d.left += window.pageXOffset - b.clientLeft;
        d.top += window.pageYOffset - b.clientTop;
        b = {
            x: 0,
            y: 0
        };
        c._isRotated ? (b.x = d.left + a.y / c._devicePixelRatio, b.y = d.top + d.height - (c._viewPortRect.width - a.x) / c._devicePixelRatio) : (b.x = d.left + a.x / c._devicePixelRatio, b.y = d.top + d.height - a.y / c._devicePixelRatio);
        return b
    },
    drawScene: function() {
        var a = cc.renderer;
        this.calculateDeltaTime();
        this._paused || (this._scheduler.update(this._deltaTime), cc.eventManager.dispatchEvent(this._eventAfterUpdate));
        this._nextScene && this.setNextScene();
        this._runningScene && (a.childrenOrderDirty ? (cc.renderer.clearRenderCommands(), cc.renderer.assignedZ = 0, this._runningScene._renderCmd._curLevel = 0, this._runningScene.visit(), a.resetFlag()) : a.transformDirty() && a.transform());
        a.clear();
        this._notificationNode && this._notificationNode.visit();
        cc.eventManager.dispatchEvent(this._eventAfterVisit);
        cc.g_NumberOfDraws = 0;
        a.rendering(cc._renderContext);
        this._totalFrames++;
        cc.eventManager.dispatchEvent(this._eventAfterDraw);
        cc.eventManager.frameUpdateListeners();
        this._calculateMPF()
    },
    end: function() {
        this._purgeDirectorInNextLoop = !0
    },
    getContentScaleFactor: function() {
        return this._contentScaleFactor
    },
    getNotificationNode: function() {
        return this._notificationNode
    },
    getWinSize: function() {
        return cc.size(this._winSizeInPoints)
    },
    getWinSizeInPixels: function() {
        return cc.size(this._winSizeInPoints.width * this._contentScaleFactor, this._winSizeInPoints.height * this._contentScaleFactor)
    },
    getVisibleSize: null,
    getVisibleOrigin: null,
    getZEye: null,
    pause: function() {
        this._paused || (this._oldAnimationInterval = this._animationInterval, this.setAnimationInterval(0.25), this._paused = !0)
    },
    popScene: function() {
        cc.assert(this._runningScene, cc._LogInfos.Director_popScene);
        this._scenesStack.pop();
        var a = this._scenesStack.length;
        0 === a ? this.end() : (this._sendCleanupToScene = !0, this._nextScene = this._scenesStack[a - 1])
    },
    purgeCachedData: function() {
        cc.animationCache._clear();
        cc.spriteFrameCache._clear();
        cc.textureCache._clear()
    },
    purgeDirector: function() {
        this.getScheduler().unscheduleAll();
        cc.eventManager && cc.eventManager.setEnabled(!1);
        this._runningScene && (this._runningScene._performRecursive(cc.Node._stateCallbackType.onExitTransitionDidStart), this._runningScene._performRecursive(cc.Node._stateCallbackType.onExit), this._runningScene._performRecursive(cc.Node._stateCallbackType.cleanup));
        this._nextScene = this._runningScene = null;
        this._scenesStack.length = 0;
        this.stopAnimation();
        this.purgeCachedData();
        cc.checkGLErrorDebug()
    },
    pushScene: function(a) {
        cc.assert(a, cc._LogInfos.Director_pushScene);
        this._sendCleanupToScene = !1;
        this._scenesStack.push(a);
        this._nextScene = a
    },
    runScene: function(a) {
        cc.assert(a, cc._LogInfos.Director_pushScene);
        if (this._runningScene) {
            var b = this._scenesStack.length;
            0 === b ? (this._sendCleanupToScene = !0, this._scenesStack[b] = a) : (this._sendCleanupToScene = !0, this._scenesStack[b - 1] = a);
            this._nextScene = a
        } else this.pushScene(a),
        this.startAnimation()
    },
    resume: function() {
        this._paused && (this.setAnimationInterval(this._oldAnimationInterval), (this._lastUpdate = Date.now()) || cc.log(cc._LogInfos.Director_resume), this._paused = !1, this._deltaTime = 0)
    },
    setContentScaleFactor: function(a) {
        a !== this._contentScaleFactor && (this._contentScaleFactor = a)
    },
    setDepthTest: null,
    setClearColor: null,
    setDefaultValues: function() {},
    setNextDeltaTimeZero: function(a) {
        this._nextDeltaTimeZero = a
    },
    setNextScene: function() {
        var a = !1,
        b = !1;
        cc.TransitionScene && (a = this._runningScene ? this._runningScene instanceof cc.TransitionScene: !1, b = this._nextScene ? this._nextScene instanceof cc.TransitionScene: !1);
        if (!b) {
            if (b = this._runningScene) b._performRecursive(cc.Node._stateCallbackType.onExitTransitionDidStart),
            b._performRecursive(cc.Node._stateCallbackType.onExit);
            this._sendCleanupToScene && b && b._performRecursive(cc.Node._stateCallbackType.cleanup)
        }
        this._runningScene = this._nextScene;
        cc.renderer.childrenOrderDirty = !0;
        this._nextScene = null;
        a || null === this._runningScene || (this._runningScene._performRecursive(cc.Node._stateCallbackType.onEnter), this._runningScene._performRecursive(cc.Node._stateCallbackType.onEnterTransitionDidFinish))
    },
    setNotificationNode: function(a) {
        cc.renderer.childrenOrderDirty = !0;
        this._notificationNode && (this._notificationNode._performRecursive(cc.Node._stateCallbackType.onExitTransitionDidStart), this._notificationNode._performRecursive(cc.Node._stateCallbackType.onExit), this._notificationNode._performRecursive(cc.Node._stateCallbackType.cleanup));
        if (this._notificationNode = a) this._notificationNode._performRecursive(cc.Node._stateCallbackType.onEnter),
        this._notificationNode._performRecursive(cc.Node._stateCallbackType.onEnterTransitionDidFinish)
    },
    getDelegate: function() {
        return this._projectionDelegate
    },
    setDelegate: function(a) {
        this._projectionDelegate = a
    },
    setOpenGLView: null,
    setProjection: null,
    setViewport: null,
    getOpenGLView: null,
    getProjection: null,
    setAlphaBlending: null,
    isSendCleanupToScene: function() {
        return this._sendCleanupToScene
    },
    getRunningScene: function() {
        return this._runningScene
    },
    getAnimationInterval: function() {
        return this._animationInterval
    },
    isDisplayStats: function() {
        return cc.profiler ? cc.profiler.isShowingStats() : !1
    },
    setDisplayStats: function(a) {
        cc.profiler && (a ? cc.profiler.showStats() : cc.profiler.hideStats())
    },
    getSecondsPerFrame: function() {
        return this._secondsPerFrame
    },
    isNextDeltaTimeZero: function() {
        return this._nextDeltaTimeZero
    },
    isPaused: function() {
        return this._paused
    },
    getTotalFrames: function() {
        return this._totalFrames
    },
    popToRootScene: function() {
        this.popToSceneStackLevel(1)
    },
    popToSceneStackLevel: function(a) {
        cc.assert(this._runningScene, cc._LogInfos.Director_popToSceneStackLevel_2);
        var b = this._scenesStack,
        c = b.length;
        if (0 === a) this.end();
        else if (! (a >= c)) {
            for (; c > a;) {
                var d = b.pop();
                d.running && (d._performRecursive(cc.Node._stateCallbackType.onExitTransitionDidStart), d._performRecursive(cc.Node._stateCallbackType.onExit));
                d._performRecursive(cc.Node._stateCallbackType.cleanup);
                c--
            }
            this._nextScene = b[b.length - 1];
            this._sendCleanupToScene = !0
        }
    },
    getScheduler: function() {
        return this._scheduler
    },
    setScheduler: function(a) {
        this._scheduler !== a && (this._scheduler = a)
    },
    getActionManager: function() {
        return this._actionManager
    },
    setActionManager: function(a) {
        this._actionManager !== a && (this._actionManager = a)
    },
    getDeltaTime: function() {
        return this._deltaTime
    },
    _calculateMPF: function() {
        this._secondsPerFrame = (Date.now() - this._lastUpdate) / 1E3
    }
});
cc.Director.EVENT_PROJECTION_CHANGED = "director_projection_changed";
cc.Director.EVENT_AFTER_UPDATE = "director_after_update";
cc.Director.EVENT_AFTER_VISIT = "director_after_visit";
cc.Director.EVENT_AFTER_DRAW = "director_after_draw";
cc.DisplayLinkDirector = cc.Director.extend({
    invalid: !1,
    startAnimation: function() {
        this._nextDeltaTimeZero = !0;
        this.invalid = !1
    },
    mainLoop: function() {
        this._purgeDirectorInNextLoop ? (this._purgeDirectorInNextLoop = !1, this.purgeDirector()) : this.invalid || this.drawScene()
    },
    stopAnimation: function() {
        this.invalid = !0
    },
    setAnimationInterval: function(a) {
        this._animationInterval = a;
        this.invalid || (this.stopAnimation(), this.startAnimation())
    }
});
cc.Director.sharedDirector = null;
cc.Director.firstUseDirector = !0;
cc.Director._getInstance = function() {
    cc.Director.firstUseDirector && (cc.Director.firstUseDirector = !1, cc.Director.sharedDirector = new cc.DisplayLinkDirector, cc.Director.sharedDirector.init());
    return cc.Director.sharedDirector
};
cc.defaultFPS = 60;
cc.Director.PROJECTION_2D = 0;
cc.Director.PROJECTION_3D = 1;
cc.Director.PROJECTION_CUSTOM = 3;
cc.Director.PROJECTION_DEFAULT = cc.Director.PROJECTION_3D;
cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,
function() {
    if (cc._renderType === cc.game.RENDER_TYPE_CANVAS) {
        var a = cc.Director.prototype;
        a.getProjection = function(a) {
            return this._projection
        };
        a.setProjection = function(a) {
            this._projection = a;
            cc.eventManager.dispatchEvent(this._eventProjectionChanged)
        };
        a.setDepthTest = function() {};
        a.setClearColor = function(a) {
            cc.renderer._clearColor = a;
            cc.renderer._clearFillStyle = "rgb(" + a.r + "," + a.g + "," + a.b + ")"
        };
        a.setOpenGLView = function(a) {
            this._winSizeInPoints.width = cc._canvas.width;
            this._winSizeInPoints.height = cc._canvas.height;
            this._openGLView = a || cc.view;
            cc.eventManager && cc.eventManager.setEnabled(!0)
        };
        a.getVisibleSize = function() {
            return this.getWinSize()
        };
        a.getVisibleOrigin = function() {
            return cc.p(0, 0)
        }
    } else cc.Director._fpsImage = new Image,
    cc.Director._fpsImage.addEventListener("load",
    function() {
        cc.Director._fpsImageLoaded = !0
    }),
    cc._fpsImage && (cc.Director._fpsImage.src = cc._fpsImage)
});
cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,
function() {
    if (cc._renderType === cc.game.RENDER_TYPE_WEBGL) {
        cc.DirectorDelegate = cc.Class.extend({
            updateProjection: function() {}
        });
        var a = cc.Director.prototype,
        b = function(a) {
            if (a && a._renderCmd) {
                a._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);
                var d = a._children;
                for (a = 0; a < d.length; a++) b(d[a])
            }
        };
        cc.eventManager.addCustomListener(cc.Director.EVENT_PROJECTION_CHANGED,
        function() {
            for (var a = cc.director._scenesStack,
            d = 0; d < a.length; d++) b(a[d])
        });
        a.setProjection = function(a) {
            var b = this._winSizeInPoints;
            this.setViewport();
            var e = this._openGLView,
            f = e._viewPortRect.x / e._scaleX,
            g = e._viewPortRect.y / e._scaleY;
            switch (a) {
            case cc.Director.PROJECTION_2D:
                cc.kmGLMatrixMode(cc.KM_GL_PROJECTION);
                cc.kmGLLoadIdentity();
                e = cc.math.Matrix4.createOrthographicProjection(0, b.width, 0, b.height, -1024, 1024);
                cc.kmGLMultMatrix(e);
                cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW);
                cc.kmGLLoadIdentity();
                break;
            case cc.Director.PROJECTION_3D:
                var h = this.getZEye(),
                k = new cc.math.Matrix4,
                e = new cc.math.Matrix4;
                cc.kmGLMatrixMode(cc.KM_GL_PROJECTION);
                cc.kmGLLoadIdentity();
                k = cc.math.Matrix4.createPerspectiveProjection(60, b.width / b.height, 0.1, 2 * h);
                cc.kmGLMultMatrix(k);
                h = new cc.math.Vec3( - f + b.width / 2, -g + b.height / 2, h);
                b = new cc.math.Vec3( - f + b.width / 2, -g + b.height / 2, 0);
                f = new cc.math.Vec3(0, 1, 0);
                e.lookAt(h, b, f);
                cc.kmGLMultMatrix(e);
                cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW);
                cc.kmGLLoadIdentity();
                break;
            case cc.Director.PROJECTION_CUSTOM:
                this._projectionDelegate && this._projectionDelegate.updateProjection();
                break;
            default:
                cc.log(cc._LogInfos.Director_setProjection)
            }
            this._projection = a;
            cc.eventManager.dispatchEvent(this._eventProjectionChanged);
            cc.setProjectionMatrixDirty();
            cc.renderer.childrenOrderDirty = !0
        };
        a.setDepthTest = function(a) {
            cc.renderer.setDepthTest(a)
        };
        a.setClearColor = function(a) {
            cc.renderer._clearColor = a
        };
        a.setOpenGLView = function(a) {
            this._winSizeInPoints.width = cc._canvas.width;
            this._winSizeInPoints.height = cc._canvas.height;
            this._openGLView = a || cc.view;
            a = cc.configuration;
            a.gatherGPUInfo();
            a.dumpInfo();
            this.setGLDefaultValues();
            cc.eventManager && cc.eventManager.setEnabled(!0)
        };
        a.getVisibleSize = function() {
            return this._openGLView.getVisibleSize()
        };
        a.getVisibleOrigin = function() {
            return this._openGLView.getVisibleOrigin()
        };
        a.getZEye = function() {
            return this._winSizeInPoints.height / 1.1546999375
        };
        a.setViewport = function() {
            var a = this._openGLView;
            if (a) {
                var b = this._winSizeInPoints;
                a.setViewPortInPoints( - a._viewPortRect.x / a._scaleX, -a._viewPortRect.y / a._scaleY, b.width, b.height)
            }
        };
        a.getOpenGLView = function() {
            return this._openGLView
        };
        a.getProjection = function() {
            return this._projection
        };
        a.setAlphaBlending = function(a) {
            a ? cc.glBlendFunc(cc.BLEND_SRC, cc.BLEND_DST) : cc.glBlendFunc(cc._renderContext.ONE, cc._renderContext.ZERO)
        };
        a.setGLDefaultValues = function() {
            this.setAlphaBlending(!0);
            this.setProjection(this._projection);
            cc._renderContext.clearColor(0, 0, 0, 0)
        }
    }
}); (function() {
    var a = function(a, b, c, d, e, f, g) {
        this.prev = a;
        this.next = b;
        this.callback = c;
        this.target = d;
        this.priority = e;
        this.paused = f;
        this.markedForDeletion = g
    },
    b = [];
    a.get = function(c, d, e, f, g, h, v) {
        var u = b.pop();
        u ? (u.prev = c, u.next = d, u.callback = e, u.target = f, u.priority = g, u.paused = h, u.markedForDeletion = v) : u = new a(c, d, e, f, g, h, v);
        return u
    };
    a.put = function(a) {
        a.prev = null;
        a.next = null;
        a.callback = null;
        a.target = null;
        a.priority = 0;
        a.paused = !1;
        a.markedForDeletion = !1;
        20 > b.length && b.push(a)
    };
    var c = function(a, b, c, d) {
        this.list = a;
        this.entry = b;
        this.target = c;
        this.callback = d
    },
    d = [];
    c.get = function(a, b, e, f) {
        var g = d.pop();
        g ? (g.list = a, g.entry = b, g.target = e, g.callback = f) : g = new c(a, b, e, f);
        return g
    };
    c.put = function(a) {
        a.list = null;
        a.entry = null;
        a.target = null;
        a.callback = null;
        20 > d.length && d.push(a)
    };
    var e = function(a, b, c, d, e, f) {
        this.timers = a;
        this.target = b;
        this.timerIndex = c;
        this.currentTimer = d;
        this.currentTimerSalvaged = e;
        this.paused = f
    },
    f = [];
    e.get = function(a, b, c, d, g, h) {
        var v = f.pop();
        v ? (v.timers = a, v.target = b, v.timerIndex = c, v.currentTimer = d, v.currentTimerSalvaged = g, v.paused = h) : v = new e(a, b, c, d, g, h);
        return v
    };
    e.put = function(a) {
        a.timers = null;
        a.target = null;
        a.timerIndex = 0;
        a.currentTimer = null;
        a.currentTimerSalvaged = !1;
        a.paused = !1;
        20 > f.length && f.push(a)
    };
    var g = function() {
        this._scheduler = null;
        this._elapsed = -1;
        this._useDelay = this._runForever = !1;
        this._interval = this._delay = this._repeat = this._timesExecuted = 0;
        this._key = this._callback = this._target = null
    };
    cc.inject({
        initWithCallback: function(a, b, c, d, e, f, g) {
            this._scheduler = a;
            this._target = c;
            this._callback = b;
            g && (this._key = g);
            this._elapsed = -1;
            this._interval = d;
            this._delay = f;
            this._useDelay = 0 < this._delay;
            this._repeat = e;
            this._runForever = this._repeat === cc.REPEAT_FOREVER;
            return ! 0
        },
        getInterval: function() {
            return this._interval
        },
        setInterval: function(a) {
            this._interval = a
        },
        update: function(a) { - 1 === this._elapsed ? this._timesExecuted = this._elapsed = 0 : (this._elapsed += a, this._runForever && !this._useDelay ? this._elapsed >= this._interval && (this.trigger(), this._elapsed = 0) : (this._useDelay ? this._elapsed >= this._delay && (this.trigger(), this._elapsed -= this._delay, this._timesExecuted += 1, this._useDelay = !1) : this._elapsed >= this._interval && (this.trigger(), this._elapsed = 0, this._timesExecuted += 1), this._callback && !this._runForever && this._timesExecuted > this._repeat && this.cancel()))
        },
        getCallback: function() {
            return this._callback
        },
        getKey: function() {
            return this._key
        },
        trigger: function() {
            this._target && this._callback && this._callback.call(this._target, this._elapsed)
        },
        cancel: function() {
            this._scheduler.unschedule(this._callback, this._target)
        }
    },
    g.prototype);
    var h = [];
    g.get = function() {
        return h.pop() || new g
    };
    g.put = function(a) {
        a._scheduler = null;
        a._elapsed = -1;
        a._runForever = !1;
        a._useDelay = !1;
        a._timesExecuted = 0;
        a._repeat = 0;
        a._delay = 0;
        a._interval = 0;
        a._target = null;
        a._callback = null;
        a._key = null;
        20 > h.length && h.push(a)
    };
    cc.Scheduler = cc.Class.extend({
        _timeScale: 1,
        _updatesNegList: null,
        _updates0List: null,
        _updatesPosList: null,
        _hashForTimers: null,
        _arrayForTimers: null,
        _hashForUpdates: null,
        _currentTarget: null,
        _currentTargetSalvaged: !1,
        _updateHashLocked: !1,
        ctor: function() {
            this._timeScale = 1;
            this._updatesNegList = [];
            this._updates0List = [];
            this._updatesPosList = [];
            this._hashForUpdates = {};
            this._hashForTimers = {};
            this._currentTarget = null;
            this._updateHashLocked = this._currentTargetSalvaged = !1;
            this._arrayForTimers = []
        },
        _schedulePerFrame: function(a, b, c, d) {
            var e = this._hashForUpdates[b.__instanceId];
            if (e && e.entry) if (e.entry.priority !== c) {
                if (this._updateHashLocked) {
                    cc.log("warning: you CANNOT change update priority in scheduled function");
                    e.entry.markedForDeletion = !1;
                    e.entry.paused = d;
                    return
                }
                this.unscheduleUpdate(b)
            } else {
                e.entry.markedForDeletion = !1;
                e.entry.paused = d;
                return
            }
            0 === c ? this._appendIn(this._updates0List, a, b, d) : 0 > c ? this._priorityIn(this._updatesNegList, a, b, c, d) : this._priorityIn(this._updatesPosList, a, b, c, d)
        },
        _removeHashElement: function(a) {
            delete this._hashForTimers[a.target.__instanceId];
            for (var b = this._arrayForTimers,
            c = 0,
            d = b.length; c < d; c++) if (b[c] === a) {
                b.splice(c, 1);
                break
            }
            e.put(a)
        },
        _removeUpdateFromHash: function(b) {
            if (b = this._hashForUpdates[b.target.__instanceId]) {
                for (var d = b.list,
                e = b.entry,
                f = 0,
                g = d.length; f < g; f++) if (d[f] === e) {
                    d.splice(f, 1);
                    break
                }
                delete this._hashForUpdates[b.target.__instanceId];
                a.put(e);
                c.put(b)
            }
        },
        _priorityIn: function(b, d, e, f, g) {
            d = a.get(null, null, d, e, f, g, !1);
            if (b) {
                g = b.length - 1;
                for (var h = 0; h <= g && !(f < b[h].priority); h++);
                b.splice(h, 0, d)
            } else b = [],
            b.push(d);
            this._hashForUpdates[e.__instanceId] = c.get(b, d, e, null);
            return b
        },
        _appendIn: function(b, d, e, f) {
            d = a.get(null, null, d, e, 0, f, !1);
            b.push(d);
            this._hashForUpdates[e.__instanceId] = c.get(b, d, e, null, null)
        },
        setTimeScale: function(a) {
            this._timeScale = a
        },
        getTimeScale: function() {
            return this._timeScale
        },
        update: function(a) {
            this._updateHashLocked = !0;
            1 !== this._timeScale && (a *= this._timeScale);
            var b, c, d, e;
            b = 0;
            c = this._updatesNegList;
            for (d = c.length; b < d; b++) e = c[b],
            e.paused || e.markedForDeletion || e.callback(a);
            b = 0;
            c = this._updates0List;
            for (d = c.length; b < d; b++) e = c[b],
            e.paused || e.markedForDeletion || e.callback(a);
            b = 0;
            c = this._updatesPosList;
            for (d = c.length; b < d; b++) e = c[b],
            e.paused || e.markedForDeletion || e.callback(a);
            d = this._arrayForTimers;
            for (b = 0; b < d.length; b++) {
                this._currentTarget = c = d[b];
                this._currentTargetSalvaged = !1;
                if (!c.paused) for (c.timerIndex = 0; c.timerIndex < c.timers.length; ++c.timerIndex) c.currentTimer = c.timers[c.timerIndex],
                c.currentTimerSalvaged = !1,
                c.currentTimer.update(a),
                c.currentTimer = null;
                this._currentTargetSalvaged && 0 === this._currentTarget.timers.length && this._removeHashElement(this._currentTarget)
            }
            b = 0;
            for (c = this._updatesNegList; b < c.length;) e = c[b],
            e.markedForDeletion ? this._removeUpdateFromHash(e) : b++;
            b = 0;
            for (c = this._updates0List; b < c.length;) e = c[b],
            e.markedForDeletion ? this._removeUpdateFromHash(e) : b++;
            b = 0;
            for (c = this._updatesPosList; b < c.length;) e = c[b],
            e.markedForDeletion ? this._removeUpdateFromHash(e) : b++;
            this._updateHashLocked = !1;
            this._currentTarget = null
        },
        scheduleCallbackForTarget: function(a, b, c, d, e, f) {
            this.schedule(b, a, c, d, e, f, a.__instanceId + "")
        },
        schedule: function(a, b, c, d, f, h, v) {
            if ("function" !== typeof a) {
                var u = a;
                a = b;
                b = u
            }
            if (4 === arguments.length || 5 === arguments.length) v = f,
            h = d,
            d = cc.REPEAT_FOREVER,
            f = 0;
            void 0 === v && (v = b.__instanceId + "");
            cc.assert(b, cc._LogInfos.Scheduler_scheduleCallbackForTarget_3); (u = this._hashForTimers[b.__instanceId]) ? cc.assert(u.paused === h, "") : (u = e.get(null, b, 0, null, null, h), this._arrayForTimers.push(u), this._hashForTimers[b.__instanceId] = u);
            var x, y;
            if (null == u.timers) u.timers = [];
            else for (y = 0; y < u.timers.length; y++) if (x = u.timers[y], a === x._callback) {
                cc.log(cc._LogInfos.Scheduler_scheduleCallbackForTarget, x.getInterval().toFixed(4), c.toFixed(4));
                x._interval = c;
                return
            }
            x = g.get();
            x.initWithCallback(this, a, b, c, d, f, v);
            u.timers.push(x)
        },
        scheduleUpdate: function(a, b, c) {
            this._schedulePerFrame(function(b) {
                a.update(b)
            },
            a, b, c)
        },
        _getUnscheduleMark: function(a, b) {
            switch (typeof a) {
            case "number":
            case "string":
                return a === b._key;
            case "function":
                return a === b._callback
            }
        },
        unschedule: function(a, b) {
            if (b && a) {
                var c = this._hashForTimers[b.__instanceId];
                if (c) for (var d = c.timers,
                e = 0,
                f = d.length; e < f; e++) {
                    var h = d[e];
                    if (this._getUnscheduleMark(a, h)) {
                        h !== c.currentTimer || c.currentTimerSalvaged || (c.currentTimerSalvaged = !0);
                        d.splice(e, 1);
                        g.put(h);
                        c.timerIndex >= e && c.timerIndex--;
                        0 === d.length && (this._currentTarget === c ? this._currentTargetSalvaged = !0 : this._removeHashElement(c));
                        break
                    }
                }
            }
        },
        unscheduleUpdate: function(a) {
            a && (a = this._hashForUpdates[a.__instanceId]) && (this._updateHashLocked ? a.entry.markedForDeletion = !0 : this._removeUpdateFromHash(a.entry))
        },
        unscheduleAllForTarget: function(a) {
            if (a) {
                var b = this._hashForTimers[a.__instanceId];
                if (b) {
                    var c = b.timers; - 1 < c.indexOf(b.currentTimer) && !b.currentTimerSalvaged && (b.currentTimerSalvaged = !0);
                    for (var d = 0,
                    e = c.length; d < e; d++) g.put(c[d]);
                    c.length = 0;
                    this._currentTarget === b ? this._currentTargetSalvaged = !0 : this._removeHashElement(b)
                }
                this.unscheduleUpdate(a)
            }
        },
        unscheduleAll: function() {
            this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)
        },
        unscheduleAllWithMinPriority: function(a) {
            var b, c, d = this._arrayForTimers;
            for (b = d.length - 1; 0 <= b; b--) c = d[b],
            this.unscheduleAllForTarget(c.target);
            d = 0;
            if (0 > a) for (b = 0; b < this._updatesNegList.length;) d = this._updatesNegList.length,
            (c = this._updatesNegList[b]) && c.priority >= a && this.unscheduleUpdate(c.target),
            d == this._updatesNegList.length && b++;
            if (0 >= a) for (b = 0; b < this._updates0List.length;) d = this._updates0List.length,
            (c = this._updates0List[b]) && this.unscheduleUpdate(c.target),
            d == this._updates0List.length && b++;
            for (b = 0; b < this._updatesPosList.length;) d = this._updatesPosList.length,
            (c = this._updatesPosList[b]) && c.priority >= a && this.unscheduleUpdate(c.target),
            d == this._updatesPosList.length && b++
        },
        isScheduled: function(a, b) {
            cc.assert(a, "Argument callback must not be empty");
            cc.assert(b, "Argument target must be non-nullptr");
            var c = this._hashForTimers[b.__instanceId];
            if (!c) return ! 1;
            if (null != c.timers) for (var c = c.timers,
            d = 0; d < c.length; ++d) if (a === c[d]._callback) return ! 0;
            return ! 1
        },
        pauseAllTargets: function() {
            return this.pauseAllTargetsWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)
        },
        pauseAllTargetsWithMinPriority: function(a) {
            var b = [],
            c,
            d = this._arrayForTimers,
            e,
            f;
            e = 0;
            for (f = d.length; e < f; e++) if (c = d[e]) c.paused = !0,
            b.push(c.target);
            if (0 > a) for (e = 0; e < this._updatesNegList.length; e++)(c = this._updatesNegList[e]) && c.priority >= a && (c.paused = !0, b.push(c.target));
            if (0 >= a) for (e = 0; e < this._updates0List.length; e++) if (c = this._updates0List[e]) c.paused = !0,
            b.push(c.target);
            for (e = 0; e < this._updatesPosList.length; e++)(c = this._updatesPosList[e]) && c.priority >= a && (c.paused = !0, b.push(c.target));
            return b
        },
        resumeTargets: function(a) {
            if (a) for (var b = 0; b < a.length; b++) this.resumeTarget(a[b])
        },
        pauseTarget: function(a) {
            cc.assert(a, cc._LogInfos.Scheduler_pauseTarget);
            var b = this._hashForTimers[a.__instanceId];
            b && (b.paused = !0);
            if (a = this._hashForUpdates[a.__instanceId]) a.entry.paused = !0
        },
        resumeTarget: function(a) {
            cc.assert(a, cc._LogInfos.Scheduler_resumeTarget);
            var b = this._hashForTimers[a.__instanceId];
            b && (b.paused = !1);
            if (a = this._hashForUpdates[a.__instanceId]) a.entry.paused = !1
        },
        isTargetPaused: function(a) {
            cc.assert(a, cc._LogInfos.Scheduler_isTargetPaused);
            var b = this._hashForTimers[a.__instanceId];
            return b ? b.paused: (a = this._hashForUpdates[a.__instanceId]) ? a.entry.paused: !1
        },
        scheduleUpdateForTarget: function(a, b, c) {
            this.scheduleUpdate(a, b, c)
        },
        unscheduleCallbackForTarget: function(a, b) {
            this.unschedule(b, a)
        },
        unscheduleUpdateForTarget: function(a) {
            this.unscheduleUpdate(a)
        },
        unscheduleAllCallbacksForTarget: function(a) {
            this.unschedule(a.__instanceId + "", a)
        },
        unscheduleAllCallbacks: function() {
            this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)
        },
        unscheduleAllCallbacksWithMinPriority: function(a) {
            this.unscheduleAllWithMinPriority(a)
        }
    });
    cc.Scheduler.PRIORITY_SYSTEM = -2147483648;
    cc.Scheduler.PRIORITY_NON_SYSTEM = cc.Scheduler.PRIORITY_SYSTEM + 1
})();
cc.PI2 = 2 * Math.PI;
cc.DrawingPrimitiveCanvas = cc.Class.extend({
    _cacheArray: [],
    _renderContext: null,
    ctor: function(a) {
        this._renderContext = a
    },
    drawPoint: function(a, b) {
        b || (b = 1);
        var c = cc.view.getScaleX(),
        d = cc.view.getScaleY(),
        d = cc.p(a.x * c, a.y * d),
        e = this._renderContext.getContext();
        e.beginPath();
        e.arc(d.x, -d.y, b * c, 0, 2 * Math.PI, !1);
        e.closePath();
        e.fill()
    },
    drawPoints: function(a, b, c) {
        if (null != a) {
            c || (c = 1);
            b = this._renderContext.getContext();
            var d = cc.view.getScaleX(),
            e = cc.view.getScaleY();
            b.beginPath();
            for (var f = 0,
            g = a.length; f < g; f++) b.arc(a[f].x * d, -a[f].y * e, c * d, 0, 2 * Math.PI, !1);
            b.closePath();
            b.fill()
        }
    },
    drawLine: function(a, b) {
        var c = this._renderContext.getContext();
        cc.view.getScaleX();
        cc.view.getScaleY();
        c.beginPath();
        c.moveTo(a.x, -a.y);
        c.lineTo(b.x, -b.y);
        c.closePath();
        c.stroke()
    },
    drawRect: function(a, b) {
        this.drawLine(cc.p(a.x, a.y), cc.p(b.x, a.y));
        this.drawLine(cc.p(b.x, a.y), cc.p(b.x, b.y));
        this.drawLine(cc.p(b.x, b.y), cc.p(a.x, b.y));
        this.drawLine(cc.p(a.x, b.y), cc.p(a.x, a.y))
    },
    drawSolidRect: function(a, b, c) {
        a = [a, cc.p(b.x, a.y), b, cc.p(a.x, b.y)];
        this.drawSolidPoly(a, 4, c)
    },
    drawPoly: function(a, b, c, d) {
        d = d || !1;
        if (null != a) {
            if (3 > a.length) throw Error("Polygon's point must greater than 2");
            var e = a[0];
            b = this._renderContext.getContext();
            cc.view.getScaleX();
            cc.view.getScaleY();
            b.beginPath();
            b.moveTo(e.x, -e.y);
            for (var e = 1,
            f = a.length; e < f; e++) b.lineTo(a[e].x, -a[e].y);
            c && b.closePath();
            d ? b.fill() : b.stroke()
        }
    },
    drawSolidPoly: function(a, b, c) {
        this.setDrawColor(c.r, c.g, c.b, c.a);
        this.drawPoly(a, b, !0, !0)
    },
    drawCircle: function(a, b, c, d, e) {
        e = e || !1;
        d = this._renderContext.getContext();
        cc.view.getScaleX();
        cc.view.getScaleY();
        d.beginPath();
        d.arc(0 | a.x, 0 | -a.y, b, -c, -(c - 2 * Math.PI), !1);
        e && d.lineTo(0 | a.x, 0 | -a.y);
        d.stroke()
    },
    drawQuadBezier: function(a, b, c, d) {
        for (var e = this._cacheArray,
        f = e.length = 0,
        g = 0; g < d; g++) {
            var h = Math.pow(1 - f, 2) * a.x + 2 * (1 - f) * f * b.x + f * f * c.x,
            k = Math.pow(1 - f, 2) * a.y + 2 * (1 - f) * f * b.y + f * f * c.y;
            e.push(cc.p(h, k));
            f += 1 / d
        }
        e.push(cc.p(c.x, c.y));
        this.drawPoly(e, d + 1, !1, !1)
    },
    drawCubicBezier: function(a, b, c, d, e) {
        for (var f = this._cacheArray,
        g = f.length = 0,
        h = 0; h < e; h++) {
            var k = Math.pow(1 - g, 3) * a.x + 3 * Math.pow(1 - g, 2) * g * b.x + 3 * (1 - g) * g * g * c.x + g * g * g * d.x,
            m = Math.pow(1 - g, 3) * a.y + 3 * Math.pow(1 - g, 2) * g * b.y + 3 * (1 - g) * g * g * c.y + g * g * g * d.y;
            f.push(cc.p(k, m));
            g += 1 / e
        }
        f.push(cc.p(d.x, d.y));
        this.drawPoly(f, e + 1, !1, !1)
    },
    drawCatmullRom: function(a, b) {
        this.drawCardinalSpline(a, 0.5, b)
    },
    drawCardinalSpline: function(a, b, c) {
        cc._renderContext.setStrokeStyle("rgba(255,255,255,1)");
        var d = this._cacheArray;
        d.length = 0;
        for (var e, f, g = 1 / a.length,
        h = 0; h < c + 1; h++) f = h / c,
        1 === f ? (e = a.length - 1, f = 1) : (e = 0 | f / g, f = (f - g * e) / g),
        e = cc.CardinalSplineAt(cc.getControlPointAt(a, e - 1), cc.getControlPointAt(a, e - 0), cc.getControlPointAt(a, e + 1), cc.getControlPointAt(a, e + 2), b, f),
        d.push(e);
        this.drawPoly(d, c + 1, !1, !1)
    },
    drawImage: function(a, b, c, d, e) {
        var f = arguments.length,
        g = this._renderContext.getContext();
        switch (f) {
        case 2:
            g.drawImage(a, b.x, -(b.y + a.height));
            break;
        case 3:
            g.drawImage(a, b.x, -(b.y + c.height), c.width, c.height);
            break;
        case 5:
            g.drawImage(a, b.x, b.y, c.width, c.height, d.x, -(d.y + e.height), e.width, e.height);
            break;
        default:
            throw Error("Argument must be non-nil");
        }
    },
    drawStar: function(a, b, c) {
        a = a || this._renderContext;
        var d = a.getContext();
        c = "rgba(" + (0 | c.r) + "," + (0 | c.g) + "," + (0 | c.b);
        a.setFillStyle(c + ",1)");
        var e = b / 10;
        d.beginPath();
        d.moveTo( - b, b);
        d.lineTo(0, e);
        d.lineTo(b, b);
        d.lineTo(e, 0);
        d.lineTo(b, -b);
        d.lineTo(0, -e);
        d.lineTo( - b, -b);
        d.lineTo( - e, 0);
        d.lineTo( - b, b);
        d.closePath();
        d.fill();
        var f = d.createRadialGradient(0, 0, e, 0, 0, b);
        f.addColorStop(0, c + ", 1)");
        f.addColorStop(0.3, c + ", 0.8)");
        f.addColorStop(1, c + ", 0.0)");
        a.setFillStyle(f);
        d.beginPath();
        d.arc(0, 0, b - e, 0, cc.PI2, !1);
        d.closePath();
        d.fill()
    },
    drawColorBall: function(a, b, c) {
        a = a || this._renderContext;
        var d = a.getContext();
        b *= cc.view.getScaleX();
        c = "rgba(" + (0 | c.r) + "," + (0 | c.g) + "," + (0 | c.b);
        var e = d.createRadialGradient(0, 0, b / 10, 0, 0, b);
        e.addColorStop(0, c + ", 1)");
        e.addColorStop(0.3, c + ", 0.8)");
        e.addColorStop(0.6, c + ", 0.4)");
        e.addColorStop(1, c + ", 0.0)");
        a.setFillStyle(e);
        d.beginPath();
        d.arc(0, 0, b, 0, cc.PI2, !1);
        d.closePath();
        d.fill()
    },
    fillText: function(a, b, c) {
        this._renderContext.getContext().fillText(a, b, -c)
    },
    setDrawColor: function(a, b, c, d) {
        this._renderContext.setFillStyle("rgba(" + a + "," + b + "," + c + "," + d / 255 + ")");
        this._renderContext.setStrokeStyle("rgba(" + a + "," + b + "," + c + "," + d / 255 + ")")
    },
    setPointSize: function(a) {},
    setLineWidth: function(a) {
        this._renderContext.getContext().lineWidth = a * cc.view.getScaleX()
    }
});
cc.DrawingPrimitiveWebGL = cc.Class.extend({
    _renderContext: null,
    _initialized: !1,
    _shader: null,
    _colorLocation: "u_color",
    _colorArray: null,
    _pointSizeLocation: "u_pointSize",
    _pointSize: -1,
    ctor: function(a) {
        null == a && (a = cc._renderContext);
        if (!a instanceof WebGLRenderingContext) throw Error("Can't initialise DrawingPrimitiveWebGL. context need is WebGLRenderingContext");
        this._renderContext = a;
        this._colorArray = new Float32Array([1, 1, 1, 1])
    },
    lazy_init: function() {
        this._initialized || (this._shader = cc.shaderCache.programForKey(cc.SHADER_POSITION_UCOLOR), this._shader._addUniformLocation(this._colorLocation), this._shader._addUniformLocation(this._pointSizeLocation), this._glProgramState = cc.GLProgramState.getOrCreateWithGLProgram(this._shader), this._initialized = !0)
    },
    drawInit: function() {
        this._initialized = !1
    },
    drawPoint: function(a) {
        this.lazy_init();
        var b = this._renderContext;
        this._glProgramState.apply();
        this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();
        b.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);
        this._shader.setUniformLocationWith4fv(this._colorLocation, this._colorArray);
        this._shader.setUniformLocationWith1f(this._pointSizeLocation, this._pointSize);
        var c = b.createBuffer();
        b.bindBuffer(b.ARRAY_BUFFER, c);
        b.bufferData(b.ARRAY_BUFFER, new Float32Array([a.x, a.y]), b.STATIC_DRAW);
        b.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, b.FLOAT, !1, 0, 0);
        b.drawArrays(b.POINTS, 0, 1);
        b.deleteBuffer(c);
        cc.incrementGLDraws(1)
    },
    drawPoints: function(a, b) {
        if (a && 0 !== a.length) {
            this.lazy_init();
            var c = this._renderContext;
            this._glProgramState.apply();
            this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();
            c.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);
            this._shader.setUniformLocationWith4fv(this._colorLocation, this._colorArray);
            this._shader.setUniformLocationWith1f(this._pointSizeLocation, this._pointSize);
            var d = c.createBuffer();
            c.bindBuffer(c.ARRAY_BUFFER, d);
            c.bufferData(c.ARRAY_BUFFER, this._pointsToTypeArray(a), c.STATIC_DRAW);
            c.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, c.FLOAT, !1, 0, 0);
            c.drawArrays(c.POINTS, 0, a.length);
            c.deleteBuffer(d);
            cc.incrementGLDraws(1)
        }
    },
    _pointsToTypeArray: function(a) {
        for (var b = new Float32Array(2 * a.length), c = 0; c < a.length; c++) b[2 * c] = a[c].x,
        b[2 * c + 1] = a[c].y;
        return b
    },
    drawLine: function(a, b) {
        this.lazy_init();
        var c = this._renderContext;
        this._glProgramState.apply();
        this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();
        c.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);
        this._shader.setUniformLocationWith4fv(this._colorLocation, this._colorArray);
        var d = c.createBuffer();
        c.bindBuffer(c.ARRAY_BUFFER, d);
        c.bufferData(c.ARRAY_BUFFER, this._pointsToTypeArray([a, b]), c.STATIC_DRAW);
        c.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, c.FLOAT, !1, 0, 0);
        c.drawArrays(c.LINES, 0, 2);
        c.deleteBuffer(d);
        cc.incrementGLDraws(1)
    },
    drawRect: function(a, b) {
        this.drawLine(cc.p(a.x, a.y), cc.p(b.x, a.y));
        this.drawLine(cc.p(b.x, a.y), cc.p(b.x, b.y));
        this.drawLine(cc.p(b.x, b.y), cc.p(a.x, b.y));
        this.drawLine(cc.p(a.x, b.y), cc.p(a.x, a.y))
    },
    drawSolidRect: function(a, b, c) {
        a = [a, cc.p(b.x, a.y), b, cc.p(a.x, b.y)];
        this.drawSolidPoly(a, 4, c)
    },
    drawPoly: function(a, b, c) {
        this.lazy_init();
        b = this._renderContext;
        this._glProgramState.apply();
        this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();
        b.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);
        this._shader.setUniformLocationWith4fv(this._colorLocation, this._colorArray);
        var d = b.createBuffer();
        b.bindBuffer(b.ARRAY_BUFFER, d);
        b.bufferData(b.ARRAY_BUFFER, this._pointsToTypeArray(a), b.STATIC_DRAW);
        b.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, b.FLOAT, !1, 0, 0);
        c ? b.drawArrays(b.LINE_LOOP, 0, a.length) : b.drawArrays(b.LINE_STRIP, 0, a.length);
        b.deleteBuffer(d);
        cc.incrementGLDraws(1)
    },
    drawSolidPoly: function(a, b, c) {
        this.lazy_init();
        c && this.setDrawColor(c.r, c.g, c.b, c.a);
        b = this._renderContext;
        this._glProgramState.apply();
        this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();
        b.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);
        this._shader.setUniformLocationWith4fv(this._colorLocation, this._colorArray);
        c = b.createBuffer();
        b.bindBuffer(b.ARRAY_BUFFER, c);
        b.bufferData(b.ARRAY_BUFFER, this._pointsToTypeArray(a), b.STATIC_DRAW);
        b.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, b.FLOAT, !1, 0, 0);
        b.drawArrays(b.TRIANGLE_FAN, 0, a.length);
        b.deleteBuffer(c);
        cc.incrementGLDraws(1)
    },
    drawCircle: function(a, b, c, d, e) {
        this.lazy_init();
        var f = 1;
        e && f++;
        var g = 2 * Math.PI / d;
        if (e = new Float32Array(2 * (d + 2))) {
            for (var h = 0; h <= d; h++) {
                var k = h * g,
                m = b * Math.cos(k + c) + a.x,
                k = b * Math.sin(k + c) + a.y;
                e[2 * h] = m;
                e[2 * h + 1] = k
            }
            e[2 * (d + 1)] = a.x;
            e[2 * (d + 1) + 1] = a.y;
            a = this._renderContext;
            this._glProgramState.apply();
            this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();
            a.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);
            this._shader.setUniformLocationWith4fv(this._colorLocation, this._colorArray);
            b = a.createBuffer();
            a.bindBuffer(a.ARRAY_BUFFER, b);
            a.bufferData(a.ARRAY_BUFFER, e, a.STATIC_DRAW);
            a.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, a.FLOAT, !1, 0, 0);
            a.drawArrays(a.LINE_STRIP, 0, d + f);
            a.deleteBuffer(b);
            cc.incrementGLDraws(1)
        }
    },
    drawQuadBezier: function(a, b, c, d) {
        this.lazy_init();
        for (var e = new Float32Array(2 * (d + 1)), f = 0, g = 0; g < d; g++) e[2 * g] = Math.pow(1 - f, 2) * a.x + 2 * (1 - f) * f * b.x + f * f * c.x,
        e[2 * g + 1] = Math.pow(1 - f, 2) * a.y + 2 * (1 - f) * f * b.y + f * f * c.y,
        f += 1 / d;
        e[2 * d] = c.x;
        e[2 * d + 1] = c.y;
        a = this._renderContext;
        this._glProgramState.apply();
        this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();
        a.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);
        this._shader.setUniformLocationWith4fv(this._colorLocation, this._colorArray);
        b = a.createBuffer();
        a.bindBuffer(a.ARRAY_BUFFER, b);
        a.bufferData(a.ARRAY_BUFFER, e, a.STATIC_DRAW);
        a.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, a.FLOAT, !1, 0, 0);
        a.drawArrays(a.LINE_STRIP, 0, d + 1);
        a.deleteBuffer(b);
        cc.incrementGLDraws(1)
    },
    drawCubicBezier: function(a, b, c, d, e) {
        this.lazy_init();
        for (var f = new Float32Array(2 * (e + 1)), g = 0, h = 0; h < e; h++) f[2 * h] = Math.pow(1 - g, 3) * a.x + 3 * Math.pow(1 - g, 2) * g * b.x + 3 * (1 - g) * g * g * c.x + g * g * g * d.x,
        f[2 * h + 1] = Math.pow(1 - g, 3) * a.y + 3 * Math.pow(1 - g, 2) * g * b.y + 3 * (1 - g) * g * g * c.y + g * g * g * d.y,
        g += 1 / e;
        f[2 * e] = d.x;
        f[2 * e + 1] = d.y;
        a = this._renderContext;
        this._glProgramState.apply();
        this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();
        a.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);
        this._shader.setUniformLocationWith4fv(this._colorLocation, this._colorArray);
        b = a.createBuffer();
        a.bindBuffer(a.ARRAY_BUFFER, b);
        a.bufferData(a.ARRAY_BUFFER, f, a.STATIC_DRAW);
        a.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, a.FLOAT, !1, 0, 0);
        a.drawArrays(a.LINE_STRIP, 0, e + 1);
        a.deleteBuffer(b);
        cc.incrementGLDraws(1)
    },
    drawCatmullRom: function(a, b) {
        this.drawCardinalSpline(a, 0.5, b)
    },
    drawCardinalSpline: function(a, b, c) {
        this.lazy_init();
        for (var d = new Float32Array(2 * (c + 1)), e, f, g = 1 / a.length, h = 0; h < c + 1; h++) f = h / c,
        1 === f ? (e = a.length - 1, f = 1) : (e = 0 | f / g, f = (f - g * e) / g),
        e = cc.cardinalSplineAt(cc.getControlPointAt(a, e - 1), cc.getControlPointAt(a, e), cc.getControlPointAt(a, e + 1), cc.getControlPointAt(a, e + 2), b, f),
        d[2 * h] = e.x,
        d[2 * h + 1] = e.y;
        a = this._renderContext;
        this._glProgramState.apply();
        this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();
        a.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION);
        this._shader.setUniformLocationWith4fv(this._colorLocation, this._colorArray);
        b = a.createBuffer();
        a.bindBuffer(a.ARRAY_BUFFER, b);
        a.bufferData(a.ARRAY_BUFFER, d, a.STATIC_DRAW);
        a.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, a.FLOAT, !1, 0, 0);
        a.drawArrays(a.LINE_STRIP, 0, c + 1);
        a.deleteBuffer(b);
        cc.incrementGLDraws(1)
    },
    setDrawColor: function(a, b, c, d) {
        this._colorArray[0] = a / 255;
        this._colorArray[1] = b / 255;
        this._colorArray[2] = c / 255;
        this._colorArray[3] = d / 255
    },
    setPointSize: function(a) {
        this._pointSize = a * cc.contentScaleFactor()
    },
    setLineWidth: function(a) {
        this._renderContext.lineWidth && this._renderContext.lineWidth(a)
    }
});
cc._tmp.PrototypeLabelTTF = function() {
    var a = cc.LabelTTF.prototype;
    cc.defineGetterSetter(a, "color", a.getColor, a.setColor);
    cc.defineGetterSetter(a, "opacity", a.getOpacity, a.setOpacity);
    cc.defineGetterSetter(a, "string", a.getString, a.setString);
    cc.defineGetterSetter(a, "textAlign", a.getHorizontalAlignment, a.setHorizontalAlignment);
    cc.defineGetterSetter(a, "verticalAlign", a.getVerticalAlignment, a.setVerticalAlignment);
    cc.defineGetterSetter(a, "fontSize", a.getFontSize, a.setFontSize);
    cc.defineGetterSetter(a, "fontName", a.getFontName, a.setFontName);
    cc.defineGetterSetter(a, "font", a._getFont, a._setFont);
    cc.defineGetterSetter(a, "boundingWidth", a._getBoundingWidth, a._setBoundingWidth);
    cc.defineGetterSetter(a, "boundingHeight", a._getBoundingHeight, a._setBoundingHeight);
    cc.defineGetterSetter(a, "fillStyle", a._getFillStyle, a.setFontFillColor);
    cc.defineGetterSetter(a, "strokeStyle", a._getStrokeStyle, a._setStrokeStyle);
    cc.defineGetterSetter(a, "lineWidth", a._getLineWidth, a._setLineWidth);
    cc.defineGetterSetter(a, "shadowOffsetX", a._getShadowOffsetX, a._setShadowOffsetX);
    cc.defineGetterSetter(a, "shadowOffsetY", a._getShadowOffsetY, a._setShadowOffsetY);
    cc.defineGetterSetter(a, "shadowOpacity", a._getShadowOpacity, a._setShadowOpacity);
    cc.defineGetterSetter(a, "shadowBlur", a._getShadowBlur, a._setShadowBlur)
};
cc.LabelTTF = cc.Sprite.extend({
    _dimensions: null,
    _hAlignment: cc.TEXT_ALIGNMENT_CENTER,
    _vAlignment: cc.VERTICAL_TEXT_ALIGNMENT_TOP,
    _fontName: null,
    _fontSize: 0,
    _string: "",
    _originalText: null,
    _onCacheCanvasMode: !0,
    _shadowEnabled: !1,
    _shadowOffset: null,
    _shadowOpacity: 0,
    _shadowBlur: 0,
    _shadowColor: null,
    _strokeEnabled: !1,
    _strokeColor: null,
    _strokeSize: 0,
    _textFillColor: null,
    _strokeShadowOffsetX: 0,
    _strokeShadowOffsetY: 0,
    _needUpdateTexture: !1,
    _lineWidths: null,
    _className: "LabelTTF",
    _fontStyle: "normal",
    _fontWeight: "normal",
    _lineHeight: "normal",
    initWithString: function(a, b, c, d, e, f) {
        a = a ? a + "": "";
        c = c || 16;
        d = d || cc.size(0, 0);
        e = e || cc.TEXT_ALIGNMENT_LEFT;
        f = f || cc.VERTICAL_TEXT_ALIGNMENT_TOP;
        this._opacityModifyRGB = !1;
        this._dimensions = cc.size(d.width, d.height);
        this._fontName = b || "Arial";
        this._hAlignment = e;
        this._vAlignment = f;
        this._fontSize = c;
        this._renderCmd._setFontStyle(this._fontName, c, this._fontStyle, this._fontWeight);
        this.string = a;
        this._renderCmd._setColorsString();
        this._renderCmd._updateTexture();
        this._setUpdateTextureDirty();
        this._scaleX = this._scaleY = 1 / cc.view.getDevicePixelRatio();
        return ! 0
    },
    _setUpdateTextureDirty: function() {
        this._needUpdateTexture = !0;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.textDirty)
    },
    ctor: function(a, b, c, d, e, f) {
        cc.Sprite.prototype.ctor.call(this);
        this._dimensions = cc.size(0, 0);
        this._hAlignment = cc.TEXT_ALIGNMENT_LEFT;
        this._vAlignment = cc.VERTICAL_TEXT_ALIGNMENT_TOP;
        this._opacityModifyRGB = !1;
        this._fontName = "Arial";
        this._shadowEnabled = !1;
        this._shadowOffset = cc.p(0, 0);
        this._shadowBlur = this._shadowOpacity = 0;
        this._strokeEnabled = !1;
        this._strokeColor = cc.color(255, 255, 255, 255);
        this._strokeSize = 0;
        this._textFillColor = cc.color(255, 255, 255, 255);
        this._strokeShadowOffsetY = this._strokeShadowOffsetX = 0;
        this._needUpdateTexture = !1;
        this._lineWidths = [];
        this._renderCmd._setColorsString();
        this._textureLoaded = !0;
        b && b instanceof cc.FontDefinition ? this.initWithStringAndTextDefinition(a, b) : cc.LabelTTF.prototype.initWithString.call(this, a, b, c, d, e, f)
    },
    init: function() {
        return this.initWithString(" ", this._fontName, this._fontSize)
    },
    description: function() {
        return "\x3ccc.LabelTTF | FontName \x3d" + this._fontName + " FontSize \x3d " + this._fontSize.toFixed(1) + "\x3e"
    },
    getLineHeight: function() {
        return ! this._lineHeight || this._lineHeight.charAt ? this._renderCmd._getFontClientHeight() : this._lineHeight || this._renderCmd._getFontClientHeight()
    },
    setLineHeight: function(a) {
        this._lineHeight = a
    },
    getString: function() {
        return this._string
    },
    getHorizontalAlignment: function() {
        return this._hAlignment
    },
    getVerticalAlignment: function() {
        return this._vAlignment
    },
    getDimensions: function() {
        return cc.size(this._dimensions)
    },
    getFontSize: function() {
        return this._fontSize
    },
    getFontName: function() {
        return this._fontName
    },
    initWithStringAndTextDefinition: function(a, b) {
        this._updateWithTextDefinition(b, !1);
        this.string = a;
        return ! 0
    },
    setTextDefinition: function(a) {
        a && this._updateWithTextDefinition(a, !0)
    },
    getTextDefinition: function() {
        return this._prepareTextDefinition(!1)
    },
    enableShadow: function(a, b, c, d) {
        null != a.r && null != a.g && null != a.b && null != a.a ? this._enableShadow(a, b, c) : this._enableShadowNoneColor(a, b, c, d)
    },
    _enableShadowNoneColor: function(a, b, c, d) {
        c = c || 0.5; ! 1 === this._shadowEnabled && (this._shadowEnabled = !0);
        var e = this._shadowOffset;
        if (e && e.x !== a || e._y !== b) e.x = a,
        e.y = b;
        this._shadowOpacity !== c && (this._shadowOpacity = c);
        this._renderCmd._setColorsString();
        this._shadowBlur !== d && (this._shadowBlur = d);
        this._setUpdateTextureDirty()
    },
    _enableShadow: function(a, b, c) {
        this._shadowColor || (this._shadowColor = cc.color(255, 255, 255, 128));
        this._shadowColor.r = a.r;
        this._shadowColor.g = a.g;
        this._shadowColor.b = a.b;
        this._enableShadowNoneColor(b.width || b.x || 0, b.height || b.y || 0, null != a.a ? a.a / 255 : 0.5, c)
    },
    _getShadowOffsetX: function() {
        return this._shadowOffset.x
    },
    _setShadowOffsetX: function(a) { ! 1 === this._shadowEnabled && (this._shadowEnabled = !0);
        this._shadowOffset.x !== a && (this._shadowOffset.x = a, this._setUpdateTextureDirty())
    },
    _getShadowOffsetY: function() {
        return this._shadowOffset._y
    },
    _setShadowOffsetY: function(a) { ! 1 === this._shadowEnabled && (this._shadowEnabled = !0);
        this._shadowOffset._y !== a && (this._shadowOffset._y = a, this._setUpdateTextureDirty())
    },
    _getShadowOffset: function() {
        return cc.p(this._shadowOffset.x, this._shadowOffset.y)
    },
    _setShadowOffset: function(a) { ! 1 === this._shadowEnabled && (this._shadowEnabled = !0);
        if (this._shadowOffset.x !== a.x || this._shadowOffset.y !== a.y) this._shadowOffset.x = a.x,
        this._shadowOffset.y = a.y,
        this._setUpdateTextureDirty()
    },
    _getShadowOpacity: function() {
        return this._shadowOpacity
    },
    _setShadowOpacity: function(a) { ! 1 === this._shadowEnabled && (this._shadowEnabled = !0);
        this._shadowOpacity !== a && (this._shadowOpacity = a, this._renderCmd._setColorsString(), this._setUpdateTextureDirty())
    },
    _getShadowBlur: function() {
        return this._shadowBlur
    },
    _setShadowBlur: function(a) { ! 1 === this._shadowEnabled && (this._shadowEnabled = !0);
        this._shadowBlur !== a && (this._shadowBlur = a, this._setUpdateTextureDirty())
    },
    disableShadow: function() {
        this._shadowEnabled && (this._shadowEnabled = !1, this._setUpdateTextureDirty())
    },
    enableStroke: function(a, b) { ! 1 === this._strokeEnabled && (this._strokeEnabled = !0);
        var c = this._strokeColor;
        if (c.r !== a.r || c.g !== a.g || c.b !== a.b) c.r = a.r,
        c.g = a.g,
        c.b = a.b,
        this._renderCmd._setColorsString();
        this._strokeSize !== b && (this._strokeSize = b || 0);
        this._setUpdateTextureDirty()
    },
    _getStrokeStyle: function() {
        return this._strokeColor
    },
    _setStrokeStyle: function(a) { ! 1 === this._strokeEnabled && (this._strokeEnabled = !0);
        var b = this._strokeColor;
        if (b.r !== a.r || b.g !== a.g || b.b !== a.b) b.r = a.r,
        b.g = a.g,
        b.b = a.b,
        this._renderCmd._setColorsString(),
        this._setUpdateTextureDirty()
    },
    _getLineWidth: function() {
        return this._strokeSize
    },
    _setLineWidth: function(a) { ! 1 === this._strokeEnabled && (this._strokeEnabled = !0);
        this._strokeSize !== a && (this._strokeSize = a || 0, this._setUpdateTextureDirty())
    },
    disableStroke: function() {
        this._strokeEnabled && (this._strokeEnabled = !1, this._setUpdateTextureDirty())
    },
    setFontFillColor: function(a) {
        var b = this._textFillColor;
        if (b.r !== a.r || b.g !== a.g || b.b !== a.b) b.r = a.r,
        b.g = a.g,
        b.b = a.b,
        this._renderCmd._setColorsString(),
        this._needUpdateTexture = !0
    },
    _getFillStyle: function() {
        return this._textFillColor
    },
    _updateWithTextDefinition: function(a, b) {
        a.fontDimensions ? (this._dimensions.width = a.boundingWidth, this._dimensions.height = a.boundingHeight) : (this._dimensions.width = 0, this._dimensions.height = 0);
        this._hAlignment = a.textAlign;
        this._vAlignment = a.verticalAlign;
        this._fontName = a.fontName;
        this._fontSize = a.fontSize || 12;
        this._lineHeight = a.lineHeight ? a.lineHeight: this._fontSize;
        this._renderCmd._setFontStyle(a);
        a.shadowEnabled && this.enableShadow(a.shadowOffsetX, a.shadowOffsetY, a.shadowOpacity, a.shadowBlur);
        a.strokeEnabled && this.enableStroke(a.strokeStyle, a.lineWidth);
        this.setFontFillColor(a.fillStyle);
        b && this._renderCmd._updateTexture();
        var c = cc.Node._dirtyFlags;
        this._renderCmd.setDirtyFlag(c.colorDirty | c.opacityDirty | c.textDirty)
    },
    _prepareTextDefinition: function(a) {
        var b = new cc.FontDefinition;
        a ? (b.fontSize = this._fontSize, b.boundingWidth = cc.contentScaleFactor() * this._dimensions.width, b.boundingHeight = cc.contentScaleFactor() * this._dimensions.height) : (b.fontSize = this._fontSize, b.boundingWidth = this._dimensions.width, b.boundingHeight = this._dimensions.height);
        b.fontName = this._fontName;
        b.textAlign = this._hAlignment;
        b.verticalAlign = this._vAlignment;
        if (this._strokeEnabled) {
            b.strokeEnabled = !0;
            var c = this._strokeColor;
            b.strokeStyle = cc.color(c.r, c.g, c.b);
            b.lineWidth = this._strokeSize
        } else b.strokeEnabled = !1;
        this._shadowEnabled ? (b.shadowEnabled = !0, b.shadowBlur = this._shadowBlur, b.shadowOpacity = this._shadowOpacity, b.shadowOffsetX = (a ? cc.contentScaleFactor() : 1) * this._shadowOffset.x, b.shadowOffsetY = (a ? cc.contentScaleFactor() : 1) * this._shadowOffset.y) : b._shadowEnabled = !1;
        a = this._textFillColor;
        b.fillStyle = cc.color(a.r, a.g, a.b);
        return b
    },
    getScale: function() {
        this._scaleX !== this._scaleY && cc.log(cc._LogInfos.Node_getScale);
        return this._scaleX * cc.view.getDevicePixelRatio()
    },
    setScale: function(a, b) {
        var c = cc.view.getDevicePixelRatio();
        this._scaleX = a / c;
        this._scaleY = (b || 0 === b ? b: a) / c;
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    getScaleX: function() {
        return this._scaleX * cc.view.getDevicePixelRatio()
    },
    setScaleX: function(a) {
        this._scaleX = a / cc.view.getDevicePixelRatio();
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    getScaleY: function() {
        return this._scaleY * cc.view.getDevicePixelRatio()
    },
    setScaleY: function(a) {
        this._scaleY = a / cc.view.getDevicePixelRatio();
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    setString: function(a) {
        a = String(a);
        this._originalText !== a && (this._originalText = a + "", this._updateString(), this._setUpdateTextureDirty(), this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty))
    },
    _updateString: function() {
        this._string && "" !== this._string || this._string === this._originalText || (cc.renderer.childrenOrderDirty = !0);
        this._string = this._originalText
    },
    setHorizontalAlignment: function(a) {
        a !== this._hAlignment && (this._hAlignment = a, this._setUpdateTextureDirty())
    },
    setVerticalAlignment: function(a) {
        a !== this._vAlignment && (this._vAlignment = a, this._setUpdateTextureDirty())
    },
    setDimensions: function(a, b) {
        var c;
        void 0 === b ? (c = a.width, b = a.height) : c = a;
        if (c !== this._dimensions.width || b !== this._dimensions.height) this._dimensions.width = c,
        this._dimensions.height = b,
        this._updateString(),
        this._setUpdateTextureDirty()
    },
    _getBoundingWidth: function() {
        return this._dimensions.width
    },
    _setBoundingWidth: function(a) {
        a !== this._dimensions.width && (this._dimensions.width = a, this._updateString(), this._setUpdateTextureDirty())
    },
    _getBoundingHeight: function() {
        return this._dimensions.height
    },
    _setBoundingHeight: function(a) {
        a !== this._dimensions.height && (this._dimensions.height = a, this._updateString(), this._setUpdateTextureDirty())
    },
    setFontSize: function(a) {
        this._fontSize !== a && (this._fontSize = a, this._renderCmd._setFontStyle(this._fontName, this._fontSize, this._fontStyle, this._fontWeight), this._setUpdateTextureDirty())
    },
    setFontName: function(a) {
        this._fontName && this._fontName !== a && (this._fontName = a, this._renderCmd._setFontStyle(this._fontName, this._fontSize, this._fontStyle, this._fontWeight), this._setUpdateTextureDirty())
    },
    _getFont: function() {
        return this._renderCmd._getFontStyle()
    },
    _setFont: function(a) {
        if (a = cc.LabelTTF._fontStyleRE.exec(a)) this._fontSize = parseInt(a[1]),
        this._fontName = a[2],
        this._renderCmd._setFontStyle(this._fontName, this._fontSize, this._fontStyle, this._fontWeight),
        this._setUpdateTextureDirty()
    },
    getContentSize: function() {
        this._needUpdateTexture && this._renderCmd._updateTTF();
        var a = cc.view.getDevicePixelRatio();
        return cc.size(this._contentSize.width / a, this._contentSize.height / a)
    },
    _getWidth: function() {
        this._needUpdateTexture && this._renderCmd._updateTTF();
        return this._contentSize.width / cc.view.getDevicePixelRatio()
    },
    _getHeight: function() {
        this._needUpdateTexture && this._renderCmd._updateTTF();
        return this._contentSize.height / cc.view.getDevicePixelRatio()
    },
    setTextureRect: function(a, b, c) {
        this._rectRotated = b || !1;
        this.setContentSize(c || a);
        b = this._rect;
        b.x = a.x;
        b.y = a.y;
        b.width = a.width;
        b.height = a.height;
        this._renderCmd._setTextureCoords(a, !1);
        c = this._unflippedOffsetPositionFromCenter.x;
        var d = this._unflippedOffsetPositionFromCenter.y;
        this._flippedX && (c = -c);
        this._flippedY && (d = -d);
        this._offsetPosition.x = c + (a.width - b.width) / 2;
        this._offsetPosition.y = d + (a.height - b.height) / 2
    },
    setDrawMode: function(a) {
        this._onCacheCanvasMode = a
    },
    _createRenderCmd: function() {
        return cc._renderType === cc.game.RENDER_TYPE_WEBGL ? new cc.LabelTTF.WebGLRenderCmd(this) : this._onCacheCanvasMode ? new cc.LabelTTF.CacheCanvasRenderCmd(this) : new cc.LabelTTF.CanvasRenderCmd(this)
    },
    _setFontStyle: function(a) {
        this._fontStyle !== a && (this._fontStyle = a, this._renderCmd._setFontStyle(this._fontName, this._fontSize, this._fontStyle, this._fontWeight), this._setUpdateTextureDirty())
    },
    _getFontStyle: function() {
        return this._fontStyle
    },
    _setFontWeight: function(a) {
        this._fontWeight !== a && (this._fontWeight = a, this._renderCmd._setFontStyle(this._fontName, this._fontSize, this._fontStyle, this._fontWeight), this._setUpdateTextureDirty())
    },
    _getFontWeight: function() {
        return this._fontWeight
    }
});
cc.assert(cc.isFunction(cc._tmp.PrototypeLabelTTF), cc._LogInfos.MissingFile, "LabelTTFPropertyDefine.js");
cc._tmp.PrototypeLabelTTF();
delete cc._tmp.PrototypeLabelTTF;
cc.LabelTTF._fontStyleRE = /^(\d+)px\s+['"]?([\w\s\d]+)['"]?$/;
cc.LabelTTF.create = function(a, b, c, d, e, f) {
    return new cc.LabelTTF(a, b, c, d, e, f)
};
cc.LabelTTF.createWithFontDefinition = cc.LabelTTF.create;
cc.LabelTTF.__labelHeightDiv = document.createElement("div");
cc.LabelTTF.__labelHeightDiv.style.fontFamily = "Arial";
cc.LabelTTF.__labelHeightDiv.style.position = "absolute";
cc.LabelTTF.__labelHeightDiv.style.left = "-100px";
cc.LabelTTF.__labelHeightDiv.style.top = "-100px";
cc.LabelTTF.__labelHeightDiv.style.lineHeight = "normal";
document.body ? document.body.appendChild(cc.LabelTTF.__labelHeightDiv) : window.addEventListener("load",
function() {
    this.removeEventListener("load", arguments.callee, !1);
    document.body.appendChild(cc.LabelTTF.__labelHeightDiv)
},
!1);
cc.LabelTTF.__getFontHeightByDiv = function(a, b) {
    var c, d = cc.LabelTTF.__labelHeightDiv;
    if (a instanceof cc.FontDefinition) {
        c = cc.LabelTTF.__fontHeightCache[a._getCanvasFontStr()];
        if (0 < c) return c;
        d.innerHTML = "ajghl~!";
        d.style.fontFamily = a.fontName;
        d.style.fontSize = a.fontSize + "px";
        d.style.fontStyle = a.fontStyle;
        d.style.fontWeight = a.fontWeight;
        c = d.clientHeight;
        cc.LabelTTF.__fontHeightCache[a._getCanvasFontStr()] = c
    } else {
        c = cc.LabelTTF.__fontHeightCache[a + "." + b];
        if (0 < c) return c;
        d.innerHTML = "ajghl~!";
        d.style.fontFamily = a;
        d.style.fontSize = b + "px";
        c = d.clientHeight;
        cc.LabelTTF.__fontHeightCache[a + "." + b] = c
    }
    d.innerHTML = "";
    return c
};
cc.LabelTTF.__fontHeightCache = {};
cc.LabelTTF._textAlign = ["left", "center", "right"];
cc.LabelTTF._textBaseline = ["top", "middle", "bottom"];
cc.LabelTTF.wrapInspection = !0;
cc.LabelTTF._wordRex = /([a-zA-Z0-9\-\u00bf\u00a1\u00ab\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02af\u0300-\u034e\u0350-\u036F\u0370-\u052f\u2011\u2035-\u2037\u2039\u2045]+|\S)/;
cc.LabelTTF._symbolRex = /^[!,.:;}\]%\?>\u3001\u2018\u201c\u300b\u00bb\uff1f\u3002\uff0c\uff01\u2010\u2032-\u2034\u203a\u203c\u2046\u2047-\u2049]/;
cc.LabelTTF._lastWordRex = /([a-zA-Z0-9\-\u00bf\u00a1\u00ab\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02af\u0300-\u034e\u0350-\u036F\u0370-\u052f\u2011\u2035-\u2037\u2039\u2045]+|\S)$/;
cc.LabelTTF._lastEnglish = /[a-zA-Z0-9\-\u00bf\u00a1\u00ab\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02af\u0300-\u034e\u0350-\u036F\u0370-\u052f\u2011\u2035-\u2037\u2039\u2045]+$/;
cc.LabelTTF._firsrEnglish = /^[a-zA-Z0-9\-\u00bf\u00a1\u00ab\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02af\u0300-\u034e\u0350-\u036F\u0370-\u052f\u2011\u2035-\u2037\u2039\u2045]/; (function() {
    cc.LabelTTF.RenderCmd = function() {
        this._fontClientHeight = 18;
        this._fontStyleStr = "";
        this._shadowColorStr = "rgba(128, 128, 128, 0.5)";
        this._strokeColorStr = "";
        this._fillColorStr = "rgba(255,255,255,1)";
        this._labelContext = this._labelCanvas = null;
        this._lineWidths = [];
        this._strings = [];
        this._isMultiLine = !1;
        this._status = [];
        this._renderingIndex = 0;
        this._canUseDirtyRegion = !0
    };
    var a = cc.LabelTTF.RenderCmd.prototype;
    a.constructor = cc.LabelTTF.RenderCmd;
    a._labelCmdCtor = cc.LabelTTF.RenderCmd;
    a._setFontStyle = function(a, b, e, f) {
        if (a instanceof cc.FontDefinition) this._fontStyleStr = a._getCanvasFontStr(),
        this._fontClientHeight = cc.LabelTTF.__getFontHeightByDiv(a);
        else {
            var g = b * cc.view.getDevicePixelRatio();
            this._fontStyleStr = e + " " + f + " " + g + "px '" + a + "'";
            this._fontClientHeight = cc.LabelTTF.__getFontHeightByDiv(a, b)
        }
    };
    a._getFontStyle = function() {
        return this._fontStyleStr
    };
    a._getFontClientHeight = function() {
        return this._fontClientHeight
    };
    a._updateColor = function() {
        this._setColorsString();
        this._updateTexture()
    };
    a._setColorsString = function() {
        var a = this._displayedColor,
        b = this._node,
        e = b._shadowColor || this._displayedColor,
        f = b._strokeColor,
        g = b._textFillColor,
        h = a.r / 255,
        k = a.g / 255,
        a = a.b / 255;
        this._shadowColorStr = "rgba(" + (0 | h * e.r) + "," + (0 | k * e.g) + "," + (0 | a * e.b) + "," + b._shadowOpacity + ")";
        this._fillColorStr = "rgba(" + (0 | h * g.r) + "," + (0 | k * g.g) + "," + (0 | a * g.b) + ", 1)";
        this._strokeColorStr = "rgba(" + (0 | h * f.r) + "," + (0 | k * f.g) + "," + (0 | a * f.b) + ", 1)"
    };
    var b = new cc.Rect;
    a.getLocalBB = function() {
        var a = this._node;
        b.x = b.y = 0;
        var d = cc.view.getDevicePixelRatio();
        b.width = a._getWidth() * d;
        b.height = a._getHeight() * d;
        return b
    };
    a._updateTTF = function() {
        var a = this._node,
        b = cc.view.getDevicePixelRatio(),
        e = a._dimensions.width * b,
        f,
        g,
        h = this._lineWidths;
        h.length = 0;
        this._isMultiLine = !1;
        this._measureConfig();
        var k = {};
        if (0 !== e) for (this._strings = a._string.split("\n"), f = 0; f < this._strings.length; f++) this._checkWarp(this._strings, f, e);
        else for (this._strings = a._string.split("\n"), f = 0, g = this._strings.length; f < g; f++) if (this._strings[f]) {
            var m = this._measure(this._strings[f]);
            h.push(m);
            k[this._strings[f]] = m
        } else h.push(0);
        1 < this._strings.length && (this._isMultiLine = !0);
        g = f = 0;
        a._strokeEnabled && (f = g = 2 * a._strokeSize);
        a._shadowEnabled && (m = a._shadowOffset, f += 2 * Math.abs(m.x), g += 2 * Math.abs(m.y));
        0 === e ? this._isMultiLine ? b = cc.size(Math.ceil(Math.max.apply(Math, h) + f), Math.ceil(this._fontClientHeight * b * this._strings.length + g)) : (m = k[a._string], !m && a._string && (m = this._measure(a._string)), b = cc.size(Math.ceil((m ? m: 0) + f), Math.ceil(this._fontClientHeight * b + g))) : b = 0 === a._dimensions.height ? this._isMultiLine ? cc.size(Math.ceil(e + f), Math.ceil(a.getLineHeight() * b * this._strings.length + g)) : cc.size(Math.ceil(e + f), Math.ceil(a.getLineHeight() * b + g)) : cc.size(Math.ceil(e + f), Math.ceil(a._dimensions.height * b + g));
        "normal" !== a._getFontStyle() && (b.width = Math.ceil(b.width + 0.3 * a._fontSize));
        a.setContentSize(b);
        a._strokeShadowOffsetX = f;
        a._strokeShadowOffsetY = g;
        a = a._anchorPoint;
        this._anchorPointInPoints.x = 0.5 * f + (b.width - f) * a.x;
        this._anchorPointInPoints.y = 0.5 * g + (b.height - g) * a.y
    };
    a._saveStatus = function() {
        var a = this._node,
        b = cc.view.getDevicePixelRatio(),
        e = a._strokeShadowOffsetX,
        f = a._strokeShadowOffsetY,
        g = a._contentSize.height - f,
        h = a._vAlignment,
        k = a._hAlignment,
        m = 0.5 * e,
        f = g + 0.5 * f,
        r = 0,
        s = 0,
        t = [],
        e = a._contentSize.width - e,
        a = a.getLineHeight() * b,
        b = (a - this._fontClientHeight * b) / 2,
        r = k === cc.TEXT_ALIGNMENT_RIGHT ? r + e: k === cc.TEXT_ALIGNMENT_CENTER ? r + e / 2 : r + 0;
        if (this._isMultiLine) for (k = this._strings.length, h === cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM ? s = a - 2 * b + g - a * k: h === cc.VERTICAL_TEXT_ALIGNMENT_CENTER && (s = (a - 2 * b) / 2 + (g - a * k) / 2), h = 0; h < k; h++) t.push( - g + (a * h + b) + s);
        else h !== cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM && (s = h === cc.VERTICAL_TEXT_ALIGNMENT_TOP ? s - g: s - 0.5 * g),
        t.push(s);
        g = {
            contextTransform: cc.p(m, f),
            xOffset: r,
            OffsetYArray: t
        };
        this._status.push(g)
    };
    a._drawTTFInCanvas = function(a) {
        if (a) {
            var b = this._status.pop();
            a.setTransform(1, 0, 0, 1, b.contextTransform.x, b.contextTransform.y);
            this.drawLabels(a, b.xOffset, b.OffsetYArray)
        }
    };
    a._checkWarp = function(a, b, e) {
        var f = a[b],
        g = this._measure(f);
        if (g > e && 1 < f.length) {
            for (var h = e / g * f.length | 0,
            k = f.substr(h), m = g - this._measure(k), r, s = 0, t = 0; m > e && 100 > t++;) h *= e / m,
            h |= 0,
            k = f.substr(h),
            m = g - this._measure(k);
            for (t = 0; m < e && 100 > t++;) k && (s = (r = cc.LabelTTF._wordRex.exec(k)) ? r[0].length: 1, r = k),
            h += s,
            k = f.substr(h),
            m = g - this._measure(k);
            h -= s;
            0 === h && (h = 1, r = r.substr(1));
            e = f.substr(0, h);
            cc.LabelTTF.wrapInspection && cc.LabelTTF._symbolRex.test(r || k) && (g = cc.LabelTTF._lastWordRex.exec(e), h -= g ? g[0].length: 0, 0 === h && (h = 1), r = f.substr(h), e = f.substr(0, h));
            cc.LabelTTF._firsrEnglish.test(r) && (g = cc.LabelTTF._lastEnglish.exec(e)) && e !== g[0] && (h -= g[0].length, r = f.substr(h), e = f.substr(0, h));
            a[b] = r || k;
            a.splice(b, 0, e)
        }
    };
    a.updateStatus = function() {
        this._dirtyFlag & cc.Node._dirtyFlags.textDirty && this._updateTexture();
        this.originUpdateStatus()
    };
    a._syncStatus = function(a) {
        var b = cc.Node._dirtyFlags,
        e = this._dirtyFlag;
        e & b.textDirty && this._updateTexture();
        this._originSyncStatus(a); (cc._renderType === cc.game.RENDER_TYPE_WEBGL || e & b.transformDirty) && this.transform(a)
    };
    a.drawLabels = function(a, b, e) {
        var f = this._node;
        if (f._shadowEnabled) {
            var g = f._shadowOffset;
            a.shadowColor = this._shadowColorStr;
            a.shadowOffsetX = g.x;
            a.shadowOffsetY = -g.y;
            a.shadowBlur = f._shadowBlur
        }
        var g = f._hAlignment,
        h = f._vAlignment,
        k = f._strokeSize;
        a.font !== this._fontStyleStr && (a.font = this._fontStyleStr);
        a.fillStyle = this._fillColorStr;
        if (f = f._strokeEnabled) a.lineWidth = 2 * k,
        a.strokeStyle = this._strokeColorStr;
        a.textBaseline = cc.LabelTTF._textBaseline[h];
        a.textAlign = cc.LabelTTF._textAlign[g];
        g = this._strings.length;
        for (h = 0; h < g; h++) k = this._strings[h],
        f && (a.lineJoin = "round", a.strokeText(k, b, e[h])),
        a.fillText(k, b, e[h]);
        cc.g_NumberOfDraws++
    }
})(); (function() {
    cc.LabelTTF.CacheRenderCmd = function() {
        this._labelCmdCtor();
        var a = this._labelCanvas = document.createElement("canvas");
        a.width = 1;
        a.height = 1;
        this._labelContext = a.getContext("2d")
    };
    cc.LabelTTF.CacheRenderCmd.prototype = Object.create(cc.LabelTTF.RenderCmd.prototype);
    cc.inject(cc.LabelTTF.RenderCmd.prototype, cc.LabelTTF.CacheRenderCmd.prototype);
    var a = cc.LabelTTF.CacheRenderCmd.prototype;
    a.constructor = cc.LabelTTF.CacheRenderCmd;
    a._cacheCmdCtor = cc.LabelTTF.CacheRenderCmd;
    a._updateTexture = function() {
        this._dirtyFlag ^= this._dirtyFlag & cc.Node._dirtyFlags.textDirty;
        var a = this._node;
        a._needUpdateTexture = !1;
        var c = a._contentSize;
        this._updateTTF();
        var d = c.width,
        e = c.height,
        f = this._labelContext,
        g = this._labelCanvas;
        if (!a._texture) {
            var h = new cc.Texture2D;
            h.initWithElement(this._labelCanvas);
            a.setTexture(h)
        }
        if (0 === a._string.length) return g.width = 1,
        g.height = c.height || 1,
        a._texture && (a._texture._htmlElementObj = this._labelCanvas, a._texture.handleLoadedTexture()),
        a.setTextureRect(cc.rect(0, 0, 1, c.height)),
        !0;
        f.font = this._fontStyleStr;
        c = g.width === d && g.height === e;
        g.width = d;
        g.height = e;
        c && f.clearRect(0, 0, d, e);
        this._saveStatus();
        this._drawTTFInCanvas(f);
        a._texture && (a._texture._htmlElementObj = this._labelCanvas, a._texture.handleLoadedTexture());
        a.setTextureRect(cc.rect(0, 0, d, e));
        return ! 0
    };
    a._measureConfig = function() {
        this._labelContext.font = this._fontStyleStr
    };
    a._measure = function(a) {
        return a ? this._labelContext.measureText(a).width: 0
    }
})(); (function() {
    cc.LabelTTF.CacheCanvasRenderCmd = function(a) {
        this._spriteCmdCtor(a);
        this._cacheCmdCtor()
    };
    var a = cc.LabelTTF.CacheCanvasRenderCmd.prototype = Object.create(cc.Sprite.CanvasRenderCmd.prototype);
    cc.inject(cc.LabelTTF.CacheRenderCmd.prototype, a);
    a.constructor = cc.LabelTTF.CacheCanvasRenderCmd
})(); (function() {
    cc.LabelTTF.CanvasRenderCmd = function(a) {
        this._spriteCmdCtor(a);
        this._labelCmdCtor()
    };
    cc.LabelTTF.CanvasRenderCmd.prototype = Object.create(cc.Sprite.CanvasRenderCmd.prototype);
    cc.inject(cc.LabelTTF.RenderCmd.prototype, cc.LabelTTF.CanvasRenderCmd.prototype);
    var a = cc.LabelTTF.CanvasRenderCmd.prototype;
    a.constructor = cc.LabelTTF.CanvasRenderCmd;
    a._measureConfig = function() {};
    a._measure = function(a) {
        if (a) {
            var c = cc._renderContext.getContext();
            c.font = this._fontStyleStr;
            return c.measureText(a).width
        }
        return 0
    };
    a._updateTexture = function() {
        this._dirtyFlag ^= this._dirtyFlag & cc.Node._dirtyFlags.textDirty;
        var a = this._node,
        c = a._contentSize;
        this._updateTTF();
        var d = c.width,
        e = c.height;
        if (0 === a._string.length) return a.setTextureRect(cc.rect(0, 0, 1, c.height)),
        !0;
        this._saveStatus();
        a.setTextureRect(cc.rect(0, 0, d, e));
        return ! 0
    };
    a.rendering = function(a) {
        var c = cc.view.getScaleX(),
        d = cc.view.getScaleY();
        a = a || cc._renderContext;
        var e = a.getContext();
        if (e) {
            var f = this._node;
            a.computeRealOffsetY();
            if (! (0 >= this._status.length)) {
                var g = this._renderingIndex >= this._status.length ? this._renderingIndex - this._status.length: this._renderingIndex,
                h = this._status[g];
                this._renderingIndex = g + 1;
                var k = f._offsetPosition.x,
                g = -f._offsetPosition.y - f._rect.height,
                m = this._displayedOpacity / 255;
                a.setTransform(this._worldTransform, c, d);
                a.setCompositeOperation(this._blendFuncStr);
                a.setGlobalAlpha(m);
                a.save();
                f._flippedX && (k = -k - f._rect.width, e.scale( - 1, 1));
                f._flippedY && (g = f._offsetPosition.y, e.scale(1, -1));
                c = h.xOffset + h.contextTransform.x + k * c;
                f = [];
                k = this._strings.length;
                for (m = 0; m < k; m++) f.push(h.OffsetYArray[m] + h.contextTransform.y + g * d);
                this.drawLabels(e, c, f);
                a.restore()
            }
        }
    }
})(); (function() {
    cc.LabelTTF.WebGLRenderCmd = function(a) {
        this._spriteCmdCtor(a);
        this._cacheCmdCtor()
    };
    var a = cc.LabelTTF.WebGLRenderCmd.prototype = Object.create(cc.Sprite.WebGLRenderCmd.prototype);
    cc.inject(cc.LabelTTF.CacheRenderCmd.prototype, a);
    a.constructor = cc.LabelTTF.WebGLRenderCmd;
    a._updateColor = function() {}
})();
cc.HashElement = function() {
    this.actions = [];
    this.target = null;
    this.actionIndex = 0;
    this.currentAction = null;
    this.lock = this.paused = !1
};
cc.ActionManager = cc.Class.extend({
    _elementPool: [],
    _searchElementByTarget: function(a, b) {
        for (var c = 0; c < a.length; c++) if (b === a[c].target) return a[c];
        return null
    },
    ctor: function() {
        this._hashTargets = {};
        this._arrayTargets = [];
        this._currentTarget = null
    },
    _getElement: function(a, b) {
        var c = this._elementPool.pop();
        c || (c = new cc.HashElement);
        c.target = a;
        c.paused = !!b;
        return c
    },
    _putElement: function(a) {
        a.actions.length = 0;
        a.actionIndex = 0;
        a.currentAction = null;
        a.paused = !1;
        a.target = null;
        a.lock = !1;
        this._elementPool.push(a)
    },
    addAction: function(a, b, c) {
        if (!a) throw Error("cc.ActionManager.addAction(): action must be non-null");
        if (!b) throw Error("cc.ActionManager.addAction(): target must be non-null");
        var d = this._hashTargets[b.__instanceId];
        d ? d.actions || (d.actions = []) : (d = this._getElement(b, c), this._hashTargets[b.__instanceId] = d, this._arrayTargets.push(d));
        d.actions.push(a);
        a.startWithTarget(b)
    },
    removeAllActions: function() {
        for (var a = this._arrayTargets,
        b = 0; b < a.length; b++) {
            var c = a[b];
            c && this.removeAllActionsFromTarget(c.target, !0)
        }
    },
    removeAllActionsFromTarget: function(a, b) {
        if (null != a) {
            var c = this._hashTargets[a.__instanceId];
            c && (c.actions.length = 0, this._deleteHashElement(c))
        }
    },
    removeAction: function(a) {
        if (null != a) {
            var b = a.getOriginalTarget();
            if (b = this._hashTargets[b.__instanceId]) for (var c = 0; c < b.actions.length; c++) {
                if (b.actions[c] === a) {
                    b.actions.splice(c, 1);
                    b.actionIndex >= c && b.actionIndex--;
                    break
                }
            } else cc.log(cc._LogInfos.ActionManager_removeAction)
        }
    },
    removeActionByTag: function(a, b) {
        a === cc.ACTION_TAG_INVALID && cc.log(cc._LogInfos.ActionManager_addAction);
        cc.assert(b, cc._LogInfos.ActionManager_addAction);
        var c = this._hashTargets[b.__instanceId];
        if (c) for (var d = c.actions.length,
        e = 0; e < d; ++e) {
            var f = c.actions[e];
            if (f && f.getTag() === a && f.getOriginalTarget() === b) {
                this._removeActionAtIndex(e, c);
                break
            }
        }
    },
    getActionByTag: function(a, b) {
        a === cc.ACTION_TAG_INVALID && cc.log(cc._LogInfos.ActionManager_getActionByTag);
        var c = this._hashTargets[b.__instanceId];
        if (c) {
            if (null != c.actions) for (var d = 0; d < c.actions.length; ++d) {
                var e = c.actions[d];
                if (e && e.getTag() === a) return e
            }
            cc.log(cc._LogInfos.ActionManager_getActionByTag_2, a)
        }
        return null
    },
    numberOfRunningActionsInTarget: function(a) {
        return (a = this._hashTargets[a.__instanceId]) ? a.actions ? a.actions.length: 0 : 0
    },
    pauseTarget: function(a) {
        if (a = this._hashTargets[a.__instanceId]) a.paused = !0
    },
    resumeTarget: function(a) {
        if (a = this._hashTargets[a.__instanceId]) a.paused = !1
    },
    pauseAllRunningActions: function() {
        for (var a = [], b = this._arrayTargets, c = 0; c < b.length; c++) {
            var d = b[c];
            d && !d.paused && (d.paused = !0, a.push(d.target))
        }
        return a
    },
    resumeTargets: function(a) {
        if (a) for (var b = 0; b < a.length; b++) a[b] && this.resumeTarget(a[b])
    },
    purgeSharedManager: function() {
        cc.director.getScheduler().unscheduleUpdate(this)
    },
    _removeActionAtIndex: function(a, b) {
        b.actions.splice(a, 1);
        b.actionIndex >= a && b.actionIndex--;
        0 === b.actions.length && this._deleteHashElement(b)
    },
    _deleteHashElement: function(a) {
        var b = !1;
        if (a && !a.lock && this._hashTargets[a.target.__instanceId]) {
            delete this._hashTargets[a.target.__instanceId];
            for (var b = this._arrayTargets,
            c = 0,
            d = b.length; c < d; c++) if (b[c] === a) {
                b.splice(c, 1);
                break
            }
            this._putElement(a);
            b = !0
        }
        return b
    },
    update: function(a) {
        for (var b = this._arrayTargets,
        c, d = 0; d < b.length; d++) {
            c = this._currentTarget = b[d];
            if (!c.paused && c.actions) {
                c.lock = !0;
                for (c.actionIndex = 0; c.actionIndex < c.actions.length; c.actionIndex++) if (c.currentAction = c.actions[c.actionIndex], c.currentAction) {
                    c.currentAction.step(a * (c.currentAction._speedMethod ? c.currentAction._speed: 1));
                    if (c.currentAction && c.currentAction.isDone()) {
                        c.currentAction.stop();
                        var e = c.currentAction;
                        c.currentAction = null;
                        this.removeAction(e)
                    }
                    c.currentAction = null
                }
                c.lock = !1
            }
            0 === c.actions.length && this._deleteHashElement(c) && d--
        }
    }
});
cc.profiler = function() {
    var a = !1,
    b = !1,
    c = 0,
    d = 0,
    e = 0,
    f = 0,
    g = null,
    h = document.createElement("div"),
    k = document.createElement("div"),
    m = document.createElement("div"),
    r = document.createElement("div"),
    s = 10,
    t = [0, 10, 20, 30],
    p = [0, 0, 0, 0],
    v = 3,
    u = 0,
    x = 0;
    r.id = "fps";
    r.style.position = "absolute";
    r.style.padding = "3px";
    r.style.textAlign = "left";
    r.style.backgroundColor = "rgb(0, 0, 34)";
    r.style.bottom = cc.DIRECTOR_STATS_POSITION.y + "0px";
    r.style.left = cc.DIRECTOR_STATS_POSITION.x + "px";
    r.style.width = "45px";
    r.style.height = "80px";
    for (var y = [m, k, h], w = 0; 3 > w; ++w) {
        var B = y[w].style;
        B.color = "rgb(0, 255, 255)";
        B.font = "bold 12px Helvetica, Arial";
        B.lineHeight = "20px";
        B.width = "100%";
        r.appendChild(y[w])
    }
    var z = function() {
        e = cc.director.getSecondsPerFrame();
        c++;
        f += cc.director.getDeltaTime();
        if (f > cc.DIRECTOR_FPS_INTERVAL) {
            d = c / f;
            f = c = 0;
            if (A.onFrameRateChange) {
                var b = d,
                g = t.length - 1,
                r = g,
                y = 0;
                u++;
                for (x += b; 0 <= r; r--) if (b >= t[r]) {
                    p[r]++;
                    break
                }
                if (u >= s) {
                    y = x / s;
                    for (r = g; 0 < r; r--) if (b = p[r] / s, 0.6 <= b && y >= t[r]) {
                        r != v && (v = r, A.onFrameRateChange && A.onFrameRateChange(y.toFixed(2)));
                        break
                    }
                    x = u = _changeCount = 0;
                    for (r = g; 0 < r; r--) p[r] = 0
                }
            }
            a && (g = cc._renderType === cc.game.RENDER_TYPE_CANVAS ? "\n canvas": "\n webgl", k.innerHTML = e.toFixed(3), h.innerHTML = d.toFixed(1).toString() + g, m.innerHTML = (0 | cc.g_NumberOfDraws).toString())
        }
    },
    A = {
        onFrameRateChange: null,
        getSecondsPerFrame: function() {
            return e
        },
        getFrameRate: function() {
            return d
        },
        setProfileDuration: function(a) { ! isNaN(a) && 0 < a && (s = a / cc.DIRECTOR_FPS_INTERVAL)
        },
        resumeProfiling: function() {
            cc.eventManager.addListener(g, 1)
        },
        stopProfiling: function() {
            cc.eventManager.removeListener(g)
        },
        isShowingStats: function() {
            return a
        },
        showStats: function() {
            b || this.init();
            null === r.parentElement && cc.container.appendChild(r);
            a = !0
        },
        hideStats: function() {
            a = !1;
            r.parentElement === cc.container && cc.container.removeChild(r)
        },
        init: function() {
            b || (g = cc.eventManager.addCustomListener(cc.Director.EVENT_AFTER_VISIT, z), b = !0)
        }
    };
    return A
} ();
cc.math = cc.math || {};
cc.math.EPSILON = 0.015625;
cc.math.square = function(a) {
    return a * a
};
cc.math.almostEqual = function(a, b) {
    return a + cc.math.EPSILON > b && a - cc.math.EPSILON < b
}; (function(a) {
    a.math.Vec2 = function(a, b) {
        void 0 === b ? (this.x = a.x, this.y = a.y) : (this.x = a || 0, this.y = b || 0)
    };
    var b = a.math.Vec2.prototype;
    b.fill = function(a, b) {
        this.x = a;
        this.y = b
    };
    b.length = function() {
        return Math.sqrt(a.math.square(this.x) + a.math.square(this.y))
    };
    b.lengthSq = function() {
        return a.math.square(this.x) + a.math.square(this.y)
    };
    b.normalize = function() {
        var a = 1 / this.length();
        this.x *= a;
        this.y *= a;
        return this
    };
    a.math.Vec2.add = function(a, b, e) {
        a.x = b.x + e.x;
        a.y = b.y + e.y;
        return a
    };
    b.add = function(a) {
        this.x += a.x;
        this.y += a.y;
        return this
    };
    b.dot = function(a) {
        return this.x * a.x + this.y * a.y
    };
    a.math.Vec2.subtract = function(a, b, e) {
        a.x = b.x - e.x;
        a.y = b.y - e.y;
        return a
    };
    b.subtract = function(a) {
        this.x -= a.x;
        this.y -= a.y;
        return this
    };
    b.transform = function(a) {
        var b = this.x,
        e = this.y;
        this.x = b * a.mat[0] + e * a.mat[3] + a.mat[6];
        this.y = b * a.mat[1] + e * a.mat[4] + a.mat[7];
        return this
    };
    a.math.Vec2.scale = function(a, b, e) {
        a.x = b.x * e;
        a.y = b.y * e;
        return a
    };
    b.scale = function(a) {
        this.x *= a;
        this.y *= a;
        return this
    };
    b.equals = function(b) {
        return this.x < b.x + a.math.EPSILON && this.x > b.x - a.math.EPSILON && this.y < b.y + a.math.EPSILON && this.y > b.y - a.math.EPSILON
    }
})(cc); (function(a) {
    a.math.Vec3 = a.kmVec3 = function(a, b, e) {
        a && void 0 === b ? (this.x = a.x, this.y = a.y, this.z = a.z) : (this.x = a || 0, this.y = b || 0, this.z = e || 0)
    };
    a.math.vec3 = function(b, d, e) {
        return new a.math.Vec3(b, d, e)
    };
    var b = a.math.Vec3.prototype;
    b.fill = function(a, b, e) {
        a && void 0 === b ? (this.x = a.x, this.y = a.y, this.z = a.z) : (this.x = a, this.y = b, this.z = e);
        return this
    };
    b.length = function() {
        return Math.sqrt(a.math.square(this.x) + a.math.square(this.y) + a.math.square(this.z))
    };
    b.lengthSq = function() {
        return a.math.square(this.x) + a.math.square(this.y) + a.math.square(this.z)
    };
    b.normalize = function() {
        var a = 1 / this.length();
        this.x *= a;
        this.y *= a;
        this.z *= a;
        return this
    };
    b.cross = function(a) {
        var b = this.x,
        e = this.y,
        f = this.z;
        this.x = e * a.z - f * a.y;
        this.y = f * a.x - b * a.z;
        this.z = b * a.y - e * a.x;
        return this
    };
    b.dot = function(a) {
        return this.x * a.x + this.y * a.y + this.z * a.z
    };
    b.add = function(a) {
        this.x += a.x;
        this.y += a.y;
        this.z += a.z;
        return this
    };
    b.subtract = function(a) {
        this.x -= a.x;
        this.y -= a.y;
        this.z -= a.z;
        return this
    };
    b.transform = function(a) {
        var b = this.x,
        e = this.y,
        f = this.z;
        a = a.mat;
        this.x = b * a[0] + e * a[4] + f * a[8] + a[12];
        this.y = b * a[1] + e * a[5] + f * a[9] + a[13];
        this.z = b * a[2] + e * a[6] + f * a[10] + a[14];
        return this
    };
    b.transformNormal = function(a) {
        var b = this.x,
        e = this.y,
        f = this.z;
        a = a.mat;
        this.x = b * a[0] + e * a[4] + f * a[8];
        this.y = b * a[1] + e * a[5] + f * a[9];
        this.z = b * a[2] + e * a[6] + f * a[10];
        return this
    };
    b.transformCoord = function(b) {
        var d = new a.math.Vec4(this.x, this.y, this.z, 1);
        d.transform(b);
        this.x = d.x / d.w;
        this.y = d.y / d.w;
        this.z = d.z / d.w;
        return this
    };
    b.scale = function(a) {
        this.x *= a;
        this.y *= a;
        this.z *= a;
        return this
    };
    b.equals = function(b) {
        var d = a.math.EPSILON;
        return this.x < b.x + d && this.x > b.x - d && this.y < b.y + d && this.y > b.y - d && this.z < b.z + d && this.z > b.z - d
    };
    b.inverseTransform = function(b) {
        b = b.mat;
        var d = new a.math.Vec3(this.x - b[12], this.y - b[13], this.z - b[14]);
        this.x = d.x * b[0] + d.y * b[1] + d.z * b[2];
        this.y = d.x * b[4] + d.y * b[5] + d.z * b[6];
        this.z = d.x * b[8] + d.y * b[9] + d.z * b[10];
        return this
    };
    b.inverseTransformNormal = function(a) {
        var b = this.x,
        e = this.y,
        f = this.z;
        a = a.mat;
        this.x = b * a[0] + e * a[1] + f * a[2];
        this.y = b * a[4] + e * a[5] + f * a[6];
        this.z = b * a[8] + e * a[9] + f * a[10];
        return this
    };
    b.assignFrom = function(a) {
        if (!a) return this;
        this.x = a.x;
        this.y = a.y;
        this.z = a.z;
        return this
    };
    a.math.Vec3.zero = function(a) {
        a.x = a.y = a.z = 0;
        return a
    };
    b.toTypeArray = function() {
        var a = new Float32Array(3);
        a[0] = this.x;
        a[1] = this.y;
        a[2] = this.z;
        return a
    }
})(cc); (function(a) {
    a.math.Vec4 = function(a, b, e, f) {
        a && void 0 === b ? (this.x = a.x, this.y = a.y, this.z = a.z, this.w = a.w) : (this.x = a || 0, this.y = b || 0, this.z = e || 0, this.w = f || 0)
    };
    a.kmVec4 = a.math.Vec4;
    var b = a.math.Vec4.prototype;
    b.fill = function(a, b, e, f) {
        a && void 0 === b ? (this.x = a.x, this.y = a.y, this.z = a.z, this.w = a.w) : (this.x = a, this.y = b, this.z = e, this.w = f)
    };
    b.add = function(a) {
        if (!a) return this;
        this.x += a.x;
        this.y += a.y;
        this.z += a.z;
        this.w += a.w;
        return this
    };
    b.dot = function(a) {
        return this.x * a.x + this.y * a.y + this.z * a.z + this.w * a.w
    };
    b.length = function() {
        return Math.sqrt(a.math.square(this.x) + a.math.square(this.y) + a.math.square(this.z) + a.math.square(this.w))
    };
    b.lengthSq = function() {
        return a.math.square(this.x) + a.math.square(this.y) + a.math.square(this.z) + a.math.square(this.w)
    };
    b.lerp = function(a, b) {
        return this
    };
    b.normalize = function() {
        var a = 1 / this.length();
        this.x *= a;
        this.y *= a;
        this.z *= a;
        this.w *= a;
        return this
    };
    b.scale = function(a) {
        this.normalize();
        this.x *= a;
        this.y *= a;
        this.z *= a;
        this.w *= a;
        return this
    };
    b.subtract = function(a) {
        this.x -= a.x;
        this.y -= a.y;
        this.z -= a.z;
        this.w -= a.w
    };
    b.transform = function(a) {
        var b = this.x,
        e = this.y,
        f = this.z,
        g = this.w;
        a = a.mat;
        this.x = b * a[0] + e * a[4] + f * a[8] + g * a[12];
        this.y = b * a[1] + e * a[5] + f * a[9] + g * a[13];
        this.z = b * a[2] + e * a[6] + f * a[10] + g * a[14];
        this.w = b * a[3] + e * a[7] + f * a[11] + g * a[15];
        return this
    };
    a.math.Vec4.transformArray = function(b, d) {
        for (var e = [], f = 0; f < b.length; f++) {
            var g = new a.math.Vec4(b[f]);
            g.transform(d);
            e.push(g)
        }
        return e
    };
    b.equals = function(b) {
        var d = a.math.EPSILON;
        return this.x < b.x + d && this.x > b.x - d && this.y < b.y + d && this.y > b.y - d && this.z < b.z + d && this.z > b.z - d && this.w < b.w + d && this.w > b.w - d
    };
    b.assignFrom = function(a) {
        this.x = a.x;
        this.y = a.y;
        this.z = a.z;
        this.w = a.w;
        return this
    };
    b.toTypeArray = function() {
        var a = new Float32Array(4);
        a[0] = this.x;
        a[1] = this.y;
        a[2] = this.z;
        a[3] = this.w;
        return a
    }
})(cc); (function(a) {
    function b(b, d, e) {
        d = new a.math.Vec2(d);
        d.subtract(b);
        e.x = -d.y;
        e.y = d.x;
        e.normalize()
    }
    a.math.Ray2 = function(b, d) {
        this.start = b || new a.math.Vec2;
        this.dir = d || new a.math.Vec2
    };
    a.math.Ray2.prototype.fill = function(a, b, e, f) {
        this.start.x = a;
        this.start.y = b;
        this.dir.x = e;
        this.dir.y = f
    };
    a.math.Ray2.prototype.intersectLineSegment = function(b, d, e) {
        var f = this.start.x,
        g = this.start.y,
        h = this.start.x + this.dir.x,
        k = this.start.y + this.dir.y,
        m = b.x,
        r = b.y,
        s = d.x,
        t = d.y,
        p = (t - r) * (h - f) - (s - m) * (k - g);
        if (p > -a.math.EPSILON && p < a.math.EPSILON) return ! 1;
        r = ((s - m) * (g - r) - (t - r) * (f - m)) / p;
        m = f + r * (h - f);
        r = g + r * (k - g);
        if (m < Math.min(b.x, d.x) - a.math.EPSILON || m > Math.max(b.x, d.x) + a.math.EPSILON || r < Math.min(b.y, d.y) - a.math.EPSILON || r > Math.max(b.y, d.y) + a.math.EPSILON || m < Math.min(f, h) - a.math.EPSILON || m > Math.max(f, h) + a.math.EPSILON || r < Math.min(g, k) - a.math.EPSILON || r > Math.max(g, k) + a.math.EPSILON) return ! 1;
        e.x = m;
        e.y = r;
        return ! 0
    };
    a.math.Ray2.prototype.intersectTriangle = function(c, d, e, f, g) {
        var h = new a.math.Vec2,
        k = new a.math.Vec2,
        m = new a.math.Vec2,
        r = 1E4,
        s = !1,
        t;
        this.intersectLineSegment(c, d, h) && (s = !0, t = h.subtract(this.start).length(), t < r && (k.x = h.x, k.y = h.y, r = t, b(c, d, m)));
        this.intersectLineSegment(d, e, h) && (s = !0, t = h.subtract(this.start).length(), t < r && (k.x = h.x, k.y = h.y, r = t, b(d, e, m)));
        this.intersectLineSegment(e, c, h) && (s = !0, t = h.subtract(this.start).length(), t < r && (k.x = h.x, k.y = h.y, b(e, c, m)));
        s && (f.x = k.x, f.y = k.y, g && (g.x = m.x, g.y = m.y));
        return s
    }
})(cc);
window.Uint16Array = window.Uint16Array || window.Array;
window.Float32Array = window.Float32Array || window.Array; (function(a) {
    a.math.Matrix3 = function(a) {
        this.mat = a && a.mat ? new Float32Array(a.mat) : new Float32Array(9)
    };
    a.kmMat3 = a.math.Matrix3;
    var b = a.math.Matrix3.prototype;
    b.fill = function(a) {
        var b = this.mat;
        a = a.mat;
        b[0] = a[0];
        b[1] = a[1];
        b[2] = a[2];
        b[3] = a[3];
        b[4] = a[4];
        b[5] = a[5];
        b[6] = a[6];
        b[7] = a[7];
        b[8] = a[8];
        return this
    };
    b.adjugate = function() {
        var a = this.mat,
        b = a[0],
        c = a[1],
        g = a[2],
        h = a[3],
        k = a[4],
        m = a[5],
        r = a[6],
        s = a[7],
        t = a[8];
        a[0] = k * t - m * s;
        a[1] = g * s - c * t;
        a[2] = c * m - g * k;
        a[3] = m * r - h * t;
        a[4] = b * t - g * r;
        a[5] = g * h - b * m;
        a[6] = h * s - k * r;
        a[8] = b * k - c * h;
        return this
    };
    b.identity = function() {
        var a = this.mat;
        a[1] = a[2] = a[3] = a[5] = a[6] = a[7] = 0;
        a[0] = a[4] = a[8] = 1;
        return this
    };
    var c = new a.math.Matrix3;
    b.inverse = function(a) {
        if (0 === a) return this;
        c.assignFrom(this);
        a = 1 / a;
        this.adjugate();
        this.multiplyScalar(a);
        return this
    };
    b.isIdentity = function() {
        var a = this.mat;
        return 1 === a[0] && 0 === a[1] && 0 === a[2] && 0 === a[3] && 1 === a[4] && 0 === a[5] && 0 === a[6] && 0 === a[7] && 1 === a[8]
    };
    b.transpose = function() {
        var a = this.mat,
        b = a[1],
        c = a[2],
        g = a[5],
        h = a[6],
        k = a[7];
        a[1] = a[3];
        a[2] = h;
        a[3] = b;
        a[5] = k;
        a[6] = c;
        a[7] = g;
        return this
    };
    b.determinant = function() {
        var a = this.mat,
        b = a[0] * a[4] * a[8] + a[1] * a[5] * a[6] + a[2] * a[3] * a[7];
        return b -= a[2] * a[4] * a[6] + a[0] * a[5] * a[7] + a[1] * a[3] * a[8]
    };
    b.multiply = function(a) {
        var b = this.mat,
        c = a.mat;
        a = b[0];
        var g = b[1],
        h = b[2],
        k = b[3],
        m = b[4],
        r = b[5],
        s = b[6],
        t = b[7],
        p = b[8],
        v = c[0],
        u = c[1],
        x = c[2],
        y = c[3],
        w = c[4],
        B = c[5],
        z = c[6],
        A = c[7],
        c = c[8];
        b[0] = a * v + k * u + s * x;
        b[1] = g * v + m * u + t * x;
        b[2] = h * v + r * u + p * x;
        b[3] = h * v + r * u + p * x;
        b[4] = g * y + m * w + t * B;
        b[5] = h * y + r * w + p * B;
        b[6] = a * z + k * A + s * c;
        b[7] = g * z + m * A + t * c;
        b[8] = h * z + r * A + p * c;
        return this
    };
    b.multiplyScalar = function(a) {
        var b = this.mat;
        b[0] *= a;
        b[1] *= a;
        b[2] *= a;
        b[3] *= a;
        b[4] *= a;
        b[5] *= a;
        b[6] *= a;
        b[7] *= a;
        b[8] *= a;
        return this
    };
    a.math.Matrix3.rotationAxisAngle = function(b, c) {
        var f = Math.cos(c),
        g = Math.sin(c),
        h = new a.math.Matrix3,
        k = h.mat;
        k[0] = f + b.x * b.x * (1 - f);
        k[1] = b.z * g + b.y * b.x * (1 - f);
        k[2] = -b.y * g + b.z * b.x * (1 - f);
        k[3] = -b.z * g + b.x * b.y * (1 - f);
        k[4] = f + b.y * b.y * (1 - f);
        k[5] = b.x * g + b.z * b.y * (1 - f);
        k[6] = b.y * g + b.x * b.z * (1 - f);
        k[7] = -b.x * g + b.y * b.z * (1 - f);
        k[8] = f + b.z * b.z * (1 - f);
        return h
    };
    b.assignFrom = function(b) {
        if (this === b) return a.log("cc.math.Matrix3.assign(): current matrix equals matIn"),
        this;
        var c = this.mat;
        b = b.mat;
        c[0] = b[0];
        c[1] = b[1];
        c[2] = b[2];
        c[3] = b[3];
        c[4] = b[4];
        c[5] = b[5];
        c[6] = b[6];
        c[7] = b[7];
        c[8] = b[8];
        return this
    };
    b.equals = function(b) {
        if (this === b) return ! 0;
        var c = a.math.EPSILON,
        f = this.mat;
        b = b.mat;
        for (var g = 0; 9 > g; ++g) if (! (f[g] + c > b[g] && f[g] - c < b[g])) return ! 1;
        return ! 0
    };
    a.math.Matrix3.createByRotationX = function(b) {
        var c = new a.math.Matrix3,
        f = c.mat;
        f[0] = 1;
        f[1] = 0;
        f[2] = 0;
        f[3] = 0;
        f[4] = Math.cos(b);
        f[5] = Math.sin(b);
        f[6] = 0;
        f[7] = -Math.sin(b);
        f[8] = Math.cos(b);
        return c
    };
    a.math.Matrix3.createByRotationY = function(b) {
        var c = new a.math.Matrix3,
        f = c.mat;
        f[0] = Math.cos(b);
        f[1] = 0;
        f[2] = -Math.sin(b);
        f[3] = 0;
        f[4] = 1;
        f[5] = 0;
        f[6] = Math.sin(b);
        f[7] = 0;
        f[8] = Math.cos(b);
        return c
    };
    a.math.Matrix3.createByRotationZ = function(b) {
        var c = new a.math.Matrix3,
        f = c.mat;
        f[0] = Math.cos(b);
        f[1] = -Math.sin(b);
        f[2] = 0;
        f[3] = Math.sin(b);
        f[4] = Math.cos(b);
        f[5] = 0;
        f[6] = 0;
        f[7] = 0;
        f[8] = 1;
        return c
    };
    a.math.Matrix3.createByRotation = function(b) {
        var c = new a.math.Matrix3,
        f = c.mat;
        f[0] = Math.cos(b);
        f[1] = Math.sin(b);
        f[2] = 0;
        f[3] = -Math.sin(b);
        f[4] = Math.cos(b);
        f[5] = 0;
        f[6] = 0;
        f[7] = 0;
        f[8] = 1;
        return c
    };
    a.math.Matrix3.createByScale = function(b, c) {
        var f = new a.math.Matrix3;
        f.identity();
        f.mat[0] = b;
        f.mat[4] = c;
        return f
    };
    a.math.Matrix3.createByTranslation = function(b, c) {
        var f = new a.math.Matrix3;
        f.identity();
        f.mat[6] = b;
        f.mat[7] = c;
        return f
    };
    a.math.Matrix3.createByQuaternion = function(b) {
        if (!b) return null;
        var c = new a.math.Matrix3,
        f = c.mat;
        f[0] = 1 - 2 * (b.y * b.y + b.z * b.z);
        f[1] = 2 * (b.x * b.y - b.w * b.z);
        f[2] = 2 * (b.x * b.z + b.w * b.y);
        f[3] = 2 * (b.x * b.y + b.w * b.z);
        f[4] = 1 - 2 * (b.x * b.x + b.z * b.z);
        f[5] = 2 * (b.y * b.z - b.w * b.x);
        f[6] = 2 * (b.x * b.z - b.w * b.y);
        f[7] = 2 * (b.y * b.z + b.w * b.x);
        f[8] = 1 - 2 * (b.x * b.x + b.y * b.y);
        return c
    };
    b.rotationToAxisAngle = function() {
        return a.math.Quaternion.rotationMatrix(this).toAxisAndAngle()
    }
})(cc); (function(a) {
    a.math.Matrix4 = function(a) {
        this.mat = a && a.mat ? new Float32Array(a.mat) : new Float32Array(16)
    };
    a.kmMat4 = a.math.Matrix4;
    var b = a.math.Matrix4.prototype;
    b.fill = function(a) {
        for (var b = this.mat,
        c = 0; 16 > c; c++) b[c] = a[c];
        return this
    };
    a.kmMat4Identity = function(a) {
        var b = a.mat;
        b[1] = b[2] = b[3] = b[4] = b[6] = b[7] = b[8] = b[9] = b[11] = b[12] = b[13] = b[14] = 0;
        b[0] = b[5] = b[10] = b[15] = 1;
        return a
    };
    b.identity = function() {
        var a = this.mat;
        a[1] = a[2] = a[3] = a[4] = a[6] = a[7] = a[8] = a[9] = a[11] = a[12] = a[13] = a[14] = 0;
        a[0] = a[5] = a[10] = a[15] = 1;
        return this
    };
    b.get = function(a, b) {
        return this.mat[a + 4 * b]
    };
    b.set = function(a, b, c) {
        this.mat[a + 4 * b] = c
    };
    b.swap = function(a, b, c, d) {
        var k = this.mat,
        m = k[a + 4 * b];
        k[a + 4 * b] = k[c + 4 * d];
        k[c + 4 * d] = m
    };
    a.math.Matrix4._gaussj = function(a, b) {
        var c, d = 0,
        k = 0,
        m, r, s, t, p = [0, 0, 0, 0],
        v = [0, 0, 0, 0],
        u = [0, 0, 0, 0];
        for (c = 0; 4 > c; c++) {
            for (m = t = 0; 4 > m; m++) if (1 !== u[m]) for (r = 0; 4 > r; r++) 0 === u[r] && (s = Math.abs(a.get(m, r)), s >= t && (t = s, k = m, d = r)); ++u[d];
            if (k !== d) {
                for (m = 0; 4 > m; m++) a.swap(k, m, d, m);
                for (m = 0; 4 > m; m++) b.swap(k, m, d, m)
            }
            v[c] = k;
            p[c] = d;
            if (0 === a.get(d, d)) return ! 1;
            r = 1 / a.get(d, d);
            a.set(d, d, 1);
            for (m = 0; 4 > m; m++) a.set(d, m, a.get(d, m) * r);
            for (m = 0; 4 > m; m++) b.set(d, m, b.get(d, m) * r);
            for (r = 0; 4 > r; r++) if (r !== d) {
                s = a.get(r, d);
                a.set(r, d, 0);
                for (m = 0; 4 > m; m++) a.set(r, m, a.get(r, m) - a.get(d, m) * s);
                for (m = 0; 4 > m; m++) b.set(r, m, a.get(r, m) - b.get(d, m) * s)
            }
        }
        for (m = 3; 0 <= m; m--) if (v[m] !== p[m]) for (r = 0; 4 > r; r++) a.swap(r, v[m], r, p[m]);
        return ! 0
    };
    var c = (new a.math.Matrix4).identity();
    a.kmMat4Inverse = function(b, d) {
        var g = new a.math.Matrix4(d),
        h = new a.math.Matrix4(c);
        if (!1 === a.math.Matrix4._gaussj(g, h)) return null;
        b.assignFrom(g);
        return b
    };
    b.inverse = function() {
        var b = new a.math.Matrix4(this),
        d = new a.math.Matrix4(c);
        return ! 1 === a.math.Matrix4._gaussj(b, d) ? null: b
    };
    b.isIdentity = function() {
        var a = this.mat;
        return 1 === a[0] && 0 === a[1] && 0 === a[2] && 0 === a[3] && 0 === a[4] && 1 === a[5] && 0 === a[6] && 0 === a[7] && 0 === a[8] && 0 === a[9] && 1 === a[10] && 0 === a[11] && 0 === a[12] && 0 === a[13] && 0 === a[14] && 1 === a[15]
    };
    b.transpose = function() {
        var a = this.mat,
        b = a[1],
        c = a[2],
        d = a[3],
        k = a[6],
        m = a[7],
        r = a[8],
        s = a[9],
        t = a[11],
        p = a[12],
        v = a[13],
        u = a[14];
        a[1] = a[4];
        a[2] = r;
        a[3] = p;
        a[4] = b;
        a[6] = s;
        a[7] = v;
        a[8] = c;
        a[9] = k;
        a[11] = u;
        a[12] = d;
        a[13] = m;
        a[14] = t;
        return this
    };
    a.kmMat4Multiply = function(a, b, c) {
        var d = a.mat,
        k = b.mat,
        m = c.mat;
        c = k[0];
        b = k[1];
        var r = k[2],
        s = k[3],
        t = k[4],
        p = k[5],
        v = k[6],
        u = k[7],
        x = k[8],
        y = k[9],
        w = k[10],
        B = k[11],
        z = k[12],
        A = k[13],
        D = k[14],
        k = k[15],
        C = m[0],
        H = m[1],
        E = m[2],
        F = m[3],
        G = m[4],
        I = m[5],
        K = m[6],
        L = m[7],
        J = m[8],
        N = m[9],
        O = m[10],
        M = m[11],
        P = m[12],
        Q = m[13],
        R = m[14],
        m = m[15];
        d[0] = C * c + H * t + E * x + F * z;
        d[1] = C * b + H * p + E * y + F * A;
        d[2] = C * r + H * v + E * w + F * D;
        d[3] = C * s + H * u + E * B + F * k;
        d[4] = G * c + I * t + K * x + L * z;
        d[5] = G * b + I * p + K * y + L * A;
        d[6] = G * r + I * v + K * w + L * D;
        d[7] = G * s + I * u + K * B + L * k;
        d[8] = J * c + N * t + O * x + M * z;
        d[9] = J * b + N * p + O * y + M * A;
        d[10] = J * r + N * v + O * w + M * D;
        d[11] = J * s + N * u + O * B + M * k;
        d[12] = P * c + Q * t + R * x + m * z;
        d[13] = P * b + Q * p + R * y + m * A;
        d[14] = P * r + Q * v + R * w + m * D;
        d[15] = P * s + Q * u + R * B + m * k;
        return a
    };
    b.multiply = function(a) {
        var b = this.mat,
        c = a.mat;
        a = b[0];
        var d = b[1],
        k = b[2],
        m = b[3],
        r = b[4],
        s = b[5],
        t = b[6],
        p = b[7],
        v = b[8],
        u = b[9],
        x = b[10],
        y = b[11],
        w = b[12],
        B = b[13],
        z = b[14],
        A = b[15],
        D = c[0],
        C = c[1],
        H = c[2],
        E = c[3],
        F = c[4],
        G = c[5],
        I = c[6],
        K = c[7],
        L = c[8],
        J = c[9],
        N = c[10],
        O = c[11],
        M = c[12],
        P = c[13],
        Q = c[14],
        c = c[15];
        b[0] = D * a + C * r + H * v + E * w;
        b[1] = D * d + C * s + H * u + E * B;
        b[2] = D * k + C * t + H * x + E * z;
        b[3] = D * m + C * p + H * y + E * A;
        b[4] = F * a + G * r + I * v + K * w;
        b[5] = F * d + G * s + I * u + K * B;
        b[6] = F * k + G * t + I * x + K * z;
        b[7] = F * m + G * p + I * y + K * A;
        b[8] = L * a + J * r + N * v + O * w;
        b[9] = L * d + J * s + N * u + O * B;
        b[10] = L * k + J * t + N * x + O * z;
        b[11] = L * m + J * p + N * y + O * A;
        b[12] = M * a + P * r + Q * v + c * w;
        b[13] = M * d + P * s + Q * u + c * B;
        b[14] = M * k + P * t + Q * x + c * z;
        b[15] = M * m + P * p + Q * y + c * A;
        return this
    };
    a.getMat4MultiplyValue = function(a, b) {
        var c = a.mat,
        d = b.mat,
        k = new Float32Array(16);
        k[0] = c[0] * d[0] + c[4] * d[1] + c[8] * d[2] + c[12] * d[3];
        k[1] = c[1] * d[0] + c[5] * d[1] + c[9] * d[2] + c[13] * d[3];
        k[2] = c[2] * d[0] + c[6] * d[1] + c[10] * d[2] + c[14] * d[3];
        k[3] = c[3] * d[0] + c[7] * d[1] + c[11] * d[2] + c[15] * d[3];
        k[4] = c[0] * d[4] + c[4] * d[5] + c[8] * d[6] + c[12] * d[7];
        k[5] = c[1] * d[4] + c[5] * d[5] + c[9] * d[6] + c[13] * d[7];
        k[6] = c[2] * d[4] + c[6] * d[5] + c[10] * d[6] + c[14] * d[7];
        k[7] = c[3] * d[4] + c[7] * d[5] + c[11] * d[6] + c[15] * d[7];
        k[8] = c[0] * d[8] + c[4] * d[9] + c[8] * d[10] + c[12] * d[11];
        k[9] = c[1] * d[8] + c[5] * d[9] + c[9] * d[10] + c[13] * d[11];
        k[10] = c[2] * d[8] + c[6] * d[9] + c[10] * d[10] + c[14] * d[11];
        k[11] = c[3] * d[8] + c[7] * d[9] + c[11] * d[10] + c[15] * d[11];
        k[12] = c[0] * d[12] + c[4] * d[13] + c[8] * d[14] + c[12] * d[15];
        k[13] = c[1] * d[12] + c[5] * d[13] + c[9] * d[14] + c[13] * d[15];
        k[14] = c[2] * d[12] + c[6] * d[13] + c[10] * d[14] + c[14] * d[15];
        k[15] = c[3] * d[12] + c[7] * d[13] + c[11] * d[14] + c[15] * d[15];
        return k
    };
    a.kmMat4Assign = function(b, c) {
        if (b === c) return a.log("cc.kmMat4Assign(): pOut equals pIn"),
        b;
        var d = b.mat,
        h = c.mat;
        d[0] = h[0];
        d[1] = h[1];
        d[2] = h[2];
        d[3] = h[3];
        d[4] = h[4];
        d[5] = h[5];
        d[6] = h[6];
        d[7] = h[7];
        d[8] = h[8];
        d[9] = h[9];
        d[10] = h[10];
        d[11] = h[11];
        d[12] = h[12];
        d[13] = h[13];
        d[14] = h[14];
        d[15] = h[15];
        return b
    };
    b.assignFrom = function(b) {
        if (this === b) return a.log("cc.mat.Matrix4.assignFrom(): mat4 equals current matrix"),
        this;
        var c = this.mat;
        b = b.mat;
        c[0] = b[0];
        c[1] = b[1];
        c[2] = b[2];
        c[3] = b[3];
        c[4] = b[4];
        c[5] = b[5];
        c[6] = b[6];
        c[7] = b[7];
        c[8] = b[8];
        c[9] = b[9];
        c[10] = b[10];
        c[11] = b[11];
        c[12] = b[12];
        c[13] = b[13];
        c[14] = b[14];
        c[15] = b[15];
        return this
    };
    b.equals = function(b) {
        if (this === b) return a.log("cc.kmMat4AreEqual(): pMat1 and pMat2 are same object."),
        !0;
        var c = this.mat;
        b = b.mat;
        for (var d = a.math.EPSILON,
        h = 0; 16 > h; h++) if (! (c[h] + d > b[h] && c[h] - d < b[h])) return ! 1;
        return ! 0
    };
    a.math.Matrix4.createByRotationX = function(b, c) {
        c = c || new a.math.Matrix4;
        var d = c.mat;
        d[0] = 1;
        d[3] = d[2] = d[1] = 0;
        d[4] = 0;
        d[5] = Math.cos(b);
        d[6] = Math.sin(b);
        d[7] = 0;
        d[8] = 0;
        d[9] = -Math.sin(b);
        d[10] = Math.cos(b);
        d[11] = 0;
        d[14] = d[13] = d[12] = 0;
        d[15] = 1;
        return c
    };
    a.math.Matrix4.createByRotationY = function(b, c) {
        c = c || new a.math.Matrix4;
        var d = c.mat;
        d[0] = Math.cos(b);
        d[1] = 0;
        d[2] = -Math.sin(b);
        d[3] = 0;
        d[7] = d[6] = d[4] = 0;
        d[5] = 1;
        d[8] = Math.sin(b);
        d[9] = 0;
        d[10] = Math.cos(b);
        d[11] = 0;
        d[14] = d[13] = d[12] = 0;
        d[15] = 1;
        return c
    };
    a.math.Matrix4.createByRotationZ = function(b, c) {
        c = c || new a.math.Matrix4;
        var d = c.mat;
        d[0] = Math.cos(b);
        d[1] = Math.sin(b);
        d[3] = d[2] = 0;
        d[4] = -Math.sin(b);
        d[5] = Math.cos(b);
        d[7] = d[6] = 0;
        d[11] = d[9] = d[8] = 0;
        d[10] = 1;
        d[14] = d[13] = d[12] = 0;
        d[15] = 1;
        return c
    };
    a.math.Matrix4.createByPitchYawRoll = function(b, c, d, h) {
        h = h || new a.math.Matrix4;
        var k = Math.cos(b);
        b = Math.sin(b);
        var m = Math.cos(c);
        c = Math.sin(c);
        var r = Math.cos(d);
        d = Math.sin(d);
        var s = b * c,
        t = k * c,
        p = h.mat;
        p[0] = m * r;
        p[4] = m * d;
        p[8] = -c;
        p[1] = s * r - k * d;
        p[5] = s * d + k * r;
        p[9] = b * m;
        p[2] = t * r + b * d;
        p[6] = t * d - b * r;
        p[10] = k * m;
        p[3] = p[7] = p[11] = 0;
        p[15] = 1;
        return h
    };
    a.math.Matrix4.createByQuaternion = function(b, c) {
        c = c || new a.math.Matrix4;
        var d = c.mat;
        d[0] = 1 - 2 * (b.y * b.y + b.z * b.z);
        d[1] = 2 * (b.x * b.y + b.z * b.w);
        d[2] = 2 * (b.x * b.z - b.y * b.w);
        d[3] = 0;
        d[4] = 2 * (b.x * b.y - b.z * b.w);
        d[5] = 1 - 2 * (b.x * b.x + b.z * b.z);
        d[6] = 2 * (b.z * b.y + b.x * b.w);
        d[7] = 0;
        d[8] = 2 * (b.x * b.z + b.y * b.w);
        d[9] = 2 * (b.y * b.z - b.x * b.w);
        d[10] = 1 - 2 * (b.x * b.x + b.y * b.y);
        d[11] = 0;
        d[14] = d[13] = d[12] = 0;
        d[15] = 1;
        return c
    };
    a.math.Matrix4.createByRotationTranslation = function(b, c, d) {
        d = d || new a.math.Matrix4;
        var h = d.mat;
        b = b.mat;
        h[0] = b[0];
        h[1] = b[1];
        h[2] = b[2];
        h[3] = 0;
        h[4] = b[3];
        h[5] = b[4];
        h[6] = b[5];
        h[7] = 0;
        h[8] = b[6];
        h[9] = b[7];
        h[10] = b[8];
        h[11] = 0;
        h[12] = c.x;
        h[13] = c.y;
        h[14] = c.z;
        h[15] = 1;
        return d
    };
    a.math.Matrix4.createByScale = function(b, c, d, h) {
        h = h || new a.math.Matrix4;
        var k = h.mat;
        k[0] = b;
        k[5] = c;
        k[10] = d;
        k[15] = 1;
        k[1] = k[2] = k[3] = k[4] = k[6] = k[7] = k[8] = k[9] = k[11] = k[12] = k[13] = k[14] = 0;
        return h
    };
    a.kmMat4Translation = function(a, b, c, d) {
        a.mat[0] = a.mat[5] = a.mat[10] = a.mat[15] = 1;
        a.mat[1] = a.mat[2] = a.mat[3] = a.mat[4] = a.mat[6] = a.mat[7] = a.mat[8] = a.mat[9] = a.mat[11] = 0;
        a.mat[12] = b;
        a.mat[13] = c;
        a.mat[14] = d;
        return a
    };
    a.math.Matrix4.createByTranslation = function(b, c, d, h) {
        h = h || new a.math.Matrix4;
        h.identity();
        h.mat[12] = b;
        h.mat[13] = c;
        h.mat[14] = d;
        return h
    };
    b.getUpVec3 = function() {
        var b = this.mat;
        return (new a.math.Vec3(b[4], b[5], b[6])).normalize()
    };
    b.getRightVec3 = function() {
        var b = this.mat;
        return (new a.math.Vec3(b[0], b[1], b[2])).normalize()
    };
    b.getForwardVec3 = function() {
        var b = this.mat;
        return (new a.math.Vec3(b[8], b[9], b[10])).normalize()
    };
    a.kmMat4PerspectiveProjection = function(b, c, d, h, k) {
        var m = a.degreesToRadians(c / 2);
        c = k - h;
        var r = Math.sin(m);
        if (0 === c || 0 === r || 0 === d) return null;
        m = Math.cos(m) / r;
        b.identity();
        b.mat[0] = m / d;
        b.mat[5] = m;
        b.mat[10] = -(k + h) / c;
        b.mat[11] = -1;
        b.mat[14] = -2 * h * k / c;
        b.mat[15] = 0;
        return b
    };
    a.math.Matrix4.createPerspectiveProjection = function(b, c, d, h) {
        var k = a.degreesToRadians(b / 2);
        b = h - d;
        var m = Math.sin(k);
        if (0 === b || 0 === m || 0 === c) return null;
        var k = Math.cos(k) / m,
        m = new a.math.Matrix4,
        r = m.mat;
        m.identity();
        r[0] = k / c;
        r[5] = k;
        r[10] = -(h + d) / b;
        r[11] = -1;
        r[14] = -2 * d * h / b;
        r[15] = 0;
        return m
    };
    a.kmMat4OrthographicProjection = function(a, b, c, d, k, m, r) {
        a.identity();
        a.mat[0] = 2 / (c - b);
        a.mat[5] = 2 / (k - d);
        a.mat[10] = -2 / (r - m);
        a.mat[12] = -((c + b) / (c - b));
        a.mat[13] = -((k + d) / (k - d));
        a.mat[14] = -((r + m) / (r - m));
        return a
    };
    a.math.Matrix4.createOrthographicProjection = function(b, c, d, h, k, m) {
        var r = new a.math.Matrix4,
        s = r.mat;
        r.identity();
        s[0] = 2 / (c - b);
        s[5] = 2 / (h - d);
        s[10] = -2 / (m - k);
        s[12] = -((c + b) / (c - b));
        s[13] = -((h + d) / (h - d));
        s[14] = -((m + k) / (m - k));
        return r
    };
    a.kmMat4LookAt = function(b, c, d, h) {
        d = new a.math.Vec3(d);
        var k = new a.math.Vec3(h);
        d.subtract(c);
        d.normalize();
        k.normalize();
        h = new a.math.Vec3(d);
        h.cross(k);
        h.normalize();
        k = new a.math.Vec3(h);
        k.cross(d);
        h.normalize();
        b.identity();
        b.mat[0] = h.x;
        b.mat[4] = h.y;
        b.mat[8] = h.z;
        b.mat[1] = k.x;
        b.mat[5] = k.y;
        b.mat[9] = k.z;
        b.mat[2] = -d.x;
        b.mat[6] = -d.y;
        b.mat[10] = -d.z;
        c = a.math.Matrix4.createByTranslation( - c.x, -c.y, -c.z);
        b.multiply(c);
        return b
    };
    var d = new a.math.Matrix4;
    b.lookAt = function(b, c, g) {
        c = new a.math.Vec3(c);
        var h = new a.math.Vec3(g);
        g = this.mat;
        c.subtract(b);
        c.normalize();
        h.normalize();
        var k = new a.math.Vec3(c);
        k.cross(h);
        k.normalize();
        h = new a.math.Vec3(k);
        h.cross(c);
        k.normalize();
        this.identity();
        g[0] = k.x;
        g[4] = k.y;
        g[8] = k.z;
        g[1] = h.x;
        g[5] = h.y;
        g[9] = h.z;
        g[2] = -c.x;
        g[6] = -c.y;
        g[10] = -c.z;
        d = a.math.Matrix4.createByTranslation( - b.x, -b.y, -b.z, d);
        this.multiply(d);
        return this
    };
    a.kmMat4RotationAxisAngle = function(b, c, d) {
        var h = Math.cos(d);
        d = Math.sin(d);
        c = new a.math.Vec3(c);
        c.normalize();
        b.mat[0] = h + c.x * c.x * (1 - h);
        b.mat[1] = c.z * d + c.y * c.x * (1 - h);
        b.mat[2] = -c.y * d + c.z * c.x * (1 - h);
        b.mat[3] = 0;
        b.mat[4] = -c.z * d + c.x * c.y * (1 - h);
        b.mat[5] = h + c.y * c.y * (1 - h);
        b.mat[6] = c.x * d + c.z * c.y * (1 - h);
        b.mat[7] = 0;
        b.mat[8] = c.y * d + c.x * c.z * (1 - h);
        b.mat[9] = -c.x * d + c.y * c.z * (1 - h);
        b.mat[10] = h + c.z * c.z * (1 - h);
        b.mat[11] = 0;
        b.mat[12] = 0;
        b.mat[13] = 0;
        b.mat[14] = 0;
        b.mat[15] = 1;
        return b
    };
    a.math.Matrix4.createByAxisAndAngle = function(b, c, d) {
        d = d || new a.math.Matrix4;
        var h = this.mat,
        k = Math.cos(c);
        c = Math.sin(c);
        b = new a.math.Vec3(b);
        b.normalize();
        h[0] = k + b.x * b.x * (1 - k);
        h[1] = b.z * c + b.y * b.x * (1 - k);
        h[2] = -b.y * c + b.z * b.x * (1 - k);
        h[3] = 0;
        h[4] = -b.z * c + b.x * b.y * (1 - k);
        h[5] = k + b.y * b.y * (1 - k);
        h[6] = b.x * c + b.z * b.y * (1 - k);
        h[7] = 0;
        h[8] = b.y * c + b.x * b.z * (1 - k);
        h[9] = -b.x * c + b.y * b.z * (1 - k);
        h[10] = k + b.z * b.z * (1 - k);
        h[11] = 0;
        h[12] = h[13] = h[14] = 0;
        h[15] = 1;
        return d
    };
    b.extractRotation = function() {
        var b = new a.math.Matrix3,
        c = this.mat,
        d = b.mat;
        d[0] = c[0];
        d[1] = c[1];
        d[2] = c[2];
        d[3] = c[4];
        d[4] = c[5];
        d[5] = c[6];
        d[6] = c[8];
        d[7] = c[9];
        d[8] = c[10];
        return b
    };
    b.extractPlane = function(b) {
        var c = new a.math.Plane,
        d = this.mat;
        switch (b) {
        case a.math.Plane.RIGHT:
            c.a = d[3] - d[0];
            c.b = d[7] - d[4];
            c.c = d[11] - d[8];
            c.d = d[15] - d[12];
            break;
        case a.math.Plane.LEFT:
            c.a = d[3] + d[0];
            c.b = d[7] + d[4];
            c.c = d[11] + d[8];
            c.d = d[15] + d[12];
            break;
        case a.math.Plane.BOTTOM:
            c.a = d[3] + d[1];
            c.b = d[7] + d[5];
            c.c = d[11] + d[9];
            c.d = d[15] + d[13];
            break;
        case a.math.Plane.TOP:
            c.a = d[3] - d[1];
            c.b = d[7] - d[5];
            c.c = d[11] - d[9];
            c.d = d[15] - d[13];
            break;
        case a.math.Plane.FAR:
            c.a = d[3] - d[2];
            c.b = d[7] - d[6];
            c.c = d[11] - d[10];
            c.d = d[15] - d[14];
            break;
        case a.math.Plane.NEAR:
            c.a = d[3] + d[2];
            c.b = d[7] + d[6];
            c.c = d[11] + d[10];
            c.d = d[15] + d[14];
            break;
        default:
            a.log("cc.math.Matrix4.extractPlane: Invalid plane index")
        }
        b = Math.sqrt(c.a * c.a + c.b * c.b + c.c * c.c);
        c.a /= b;
        c.b /= b;
        c.c /= b;
        c.d /= b;
        return c
    };
    b.toAxisAndAngle = function() {
        var b = this.extractRotation();
        return a.math.Quaternion.rotationMatrix(b).toAxisAndAngle()
    }
})(cc); (function(a) {
    a.math.Plane = function(a, b, e, f) {
        a && void 0 === b ? (this.a = a.a, this.b = a.b, this.c = a.c, this.d = a.d) : (this.a = a || 0, this.b = b || 0, this.c = e || 0, this.d = f || 0)
    };
    a.kmPlane = a.math.Plane;
    var b = a.math.Plane.prototype;
    a.math.Plane.LEFT = 0;
    a.math.Plane.RIGHT = 1;
    a.math.Plane.BOTTOM = 2;
    a.math.Plane.TOP = 3;
    a.math.Plane.NEAR = 4;
    a.math.Plane.FAR = 5;
    a.math.Plane.POINT_INFRONT_OF_PLANE = 0;
    a.math.Plane.POINT_BEHIND_PLANE = 1;
    a.math.Plane.POINT_ON_PLANE = 2;
    b.dot = function(a) {
        return this.a * a.x + this.b * a.y + this.c * a.z + this.d * a.w
    };
    b.dotCoord = function(a) {
        return this.a * a.x + this.b * a.y + this.c * a.z + this.d
    };
    b.dotNormal = function(a) {
        return this.a * a.x + this.b * a.y + this.c * a.z
    };
    a.math.Plane.fromPointNormal = function(b, d) {
        return new a.math.Plane(d.x, d.y, d.z, -d.dot(b))
    };
    a.math.Plane.fromPoints = function(b, d, e) {
        d = new a.math.Vec3(d);
        e = new a.math.Vec3(e);
        var f = new a.math.Plane;
        d.subtract(b);
        e.subtract(b);
        d.cross(e);
        d.normalize();
        f.a = d.x;
        f.b = d.y;
        f.c = d.z;
        f.d = d.scale( - 1).dot(b);
        return f
    };
    b.normalize = function() {
        var b = new a.math.Vec3(this.a, this.b, this.c),
        d = 1 / b.length();
        b.normalize();
        this.a = b.x;
        this.b = b.y;
        this.c = b.z;
        this.d *= d;
        return this
    };
    b.classifyPoint = function(b) {
        b = this.a * b.x + this.b * b.y + this.c * b.z + this.d;
        return 0.001 < b ? a.math.Plane.POINT_INFRONT_OF_PLANE: -0.001 > b ? a.math.Plane.POINT_BEHIND_PLANE: a.math.Plane.POINT_ON_PLANE
    }
})(cc); (function(a) {
    a.math.Quaternion = function(a, b, e, f) {
        a && void 0 === b ? (this.x = a.x, this.y = a.y, this.z = a.z, this.w = a.w) : (this.x = a || 0, this.y = b || 0, this.z = e || 0, this.w = f || 0)
    };
    a.kmQuaternion = a.math.Quaternion;
    var b = a.math.Quaternion.prototype;
    b.conjugate = function(a) {
        this.x = -a.x;
        this.y = -a.y;
        this.z = -a.z;
        this.w = a.w;
        return this
    };
    b.dot = function(a) {
        return this.w * a.w + this.x * a.x + this.y * a.y + this.z * a.z
    };
    b.exponential = function() {
        return this
    };
    b.identity = function() {
        this.z = this.y = this.x = 0;
        this.w = 1;
        return this
    };
    b.inverse = function() {
        var b = this.length();
        if (Math.abs(b) > a.math.EPSILON) return this.w = this.z = this.y = this.x = 0,
        this;
        this.conjugate(this).scale(1 / b);
        return this
    };
    b.isIdentity = function() {
        return 0 === this.x && 0 === this.y && 0 === this.z && 1 === this.w
    };
    b.length = function() {
        return Math.sqrt(this.lengthSq())
    };
    b.lengthSq = function() {
        return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w
    };
    b.multiply = function(a) {
        var b = this.x,
        e = this.y,
        f = this.z,
        g = this.w;
        this.w = g * a.w - b * a.x - e * a.y - f * a.z;
        this.x = g * a.x + b * a.w + e * a.z - f * a.y;
        this.y = g * a.y + e * a.w + f * a.x - b * a.z;
        this.z = g * a.z + f * a.w + b * a.y - e * a.x;
        return this
    };
    b.normalize = function() {
        var b = this.length();
        if (Math.abs(b) <= a.math.EPSILON) throw Error("current quaternion is an invalid value");
        this.scale(1 / b);
        return this
    };
    b.rotationAxis = function(a, b) {
        var e = 0.5 * b,
        f = Math.sin(e);
        this.w = Math.cos(e);
        this.x = a.x * f;
        this.y = a.y * f;
        this.z = a.z * f;
        return this
    };
    a.math.Quaternion.rotationMatrix = function(b) {
        if (!b) return null;
        var d, e, f;
        d = [];
        e = b.mat;
        b = 0;
        d[0] = e[0];
        d[1] = e[3];
        d[2] = e[6];
        d[4] = e[1];
        d[5] = e[4];
        d[6] = e[7];
        d[8] = e[2];
        d[9] = e[5];
        d[10] = e[8];
        d[15] = 1;
        var g = d[0];
        b = g[0] + g[5] + g[10] + 1;
        b > a.math.EPSILON ? (b = 2 * Math.sqrt(b), d = (g[9] - g[6]) / b, e = (g[2] - g[8]) / b, f = (g[4] - g[1]) / b, b *= 0.25) : g[0] > g[5] && g[0] > g[10] ? (b = 2 * Math.sqrt(1 + g[0] - g[5] - g[10]), d = 0.25 * b, e = (g[4] + g[1]) / b, f = (g[2] + g[8]) / b, b = (g[9] - g[6]) / b) : g[5] > g[10] ? (b = 2 * Math.sqrt(1 + g[5] - g[0] - g[10]), d = (g[4] + g[1]) / b, e = 0.25 * b, f = (g[9] + g[6]) / b, b = (g[2] - g[8]) / b) : (b = 2 * Math.sqrt(1 + g[10] - g[0] - g[5]), d = (g[2] + g[8]) / b, e = (g[9] + g[6]) / b, f = 0.25 * b, b = (g[4] - g[1]) / b);
        return new a.math.Quaternion(d, e, f, b)
    };
    a.math.Quaternion.rotationYawPitchRoll = function(b, d, e) {
        var f, g, h, k, m;
        f = a.degreesToRadians(d) / 2;
        g = a.degreesToRadians(b) / 2;
        h = a.degreesToRadians(e) / 2;
        e = Math.cos(f);
        b = Math.cos(g);
        d = Math.cos(h);
        f = Math.sin(f);
        g = Math.sin(g);
        h = Math.sin(h);
        k = b * d;
        m = g * h;
        var r = new a.math.Quaternion;
        r.w = e * k + f * m;
        r.x = f * k - e * m;
        r.y = e * g * d + f * b * h;
        r.z = e * b * h - f * g * d;
        r.normalize();
        return r
    };
    b.slerp = function(b, d) {
        if (this.x === b.x && this.y === b.y && this.z === b.z && this.w === b.w) return this;
        var e = this.dot(b),
        f = Math.acos(e),
        g = Math.sqrt(1 - a.math.square(e)),
        e = Math.sin(d * f) / g,
        f = Math.sin((1 - d) * f) / g,
        g = new a.math.Quaternion(b);
        this.scale(f);
        g.scale(e);
        this.add(g);
        return this
    };
    b.toAxisAndAngle = function() {
        var b, d, e = new a.math.Vec3;
        b = Math.acos(this.w);
        d = Math.sqrt(a.math.square(this.x) + a.math.square(this.y) + a.math.square(this.z));
        d > -a.math.EPSILON && d < a.math.EPSILON || d < 2 * Math.PI + a.math.EPSILON && d > 2 * Math.PI - a.math.EPSILON ? (b = 0, e.x = 0, e.y = 0, e.z = 1) : (b *= 2, e.x = this.x / d, e.y = this.y / d, e.z = this.z / d, e.normalize());
        return {
            axis: e,
            angle: b
        }
    };
    b.scale = function(a) {
        this.x *= a;
        this.y *= a;
        this.z *= a;
        this.w *= a;
        return this
    };
    b.assignFrom = function(a) {
        this.x = a.x;
        this.y = a.y;
        this.z = a.z;
        this.w = a.w;
        return this
    };
    b.add = function(a) {
        this.x += a.x;
        this.y += a.y;
        this.z += a.z;
        this.w += a.w;
        return this
    };
    a.math.Quaternion.rotationBetweenVec3 = function(b, d, e) {
        var f = new a.math.Vec3(b),
        g = new a.math.Vec3(d);
        f.normalize();
        g.normalize();
        var h = f.dot(g);
        d = new a.math.Quaternion;
        if (1 <= h) return d.identity(),
        d; - 0.999999 > h ? Math.abs(e.lengthSq()) < a.math.EPSILON ? d.rotationAxis(e, Math.PI) : (f = new a.math.Vec3(1, 0, 0), f.cross(b), Math.abs(f.lengthSq()) < a.math.EPSILON && (f.fill(0, 1, 0), f.cross(b)), f.normalize(), d.rotationAxis(f, Math.PI)) : (b = Math.sqrt(2 * (1 + h)), e = 1 / b, f.cross(g), d.x = f.x * e, d.y = f.y * e, d.z = f.z * e, d.w = 0.5 * b, d.normalize());
        return d
    };
    b.multiplyVec3 = function(b) {
        var d = this.x,
        e = this.y,
        f = this.z,
        g = new a.math.Vec3(b),
        h = new a.math.Vec3(d, e, f),
        d = new a.math.Vec3(d, e, f);
        h.cross(b);
        d.cross(h);
        h.scale(2 * q.w);
        d.scale(2);
        g.add(h);
        g.add(d);
        return g
    }
})(cc);
cc.math.AABB = function(a, b) {
    this.min = a || new cc.math.Vec3;
    this.max = b || new cc.math.Vec3
};
cc.math.AABB.prototype.containsPoint = function(a) {
    return a.x >= this.min.x && a.x <= this.max.x && a.y >= this.min.y && a.y <= this.max.y && a.z >= this.min.z && a.z <= this.max.z
};
cc.math.AABB.containsPoint = function(a, b) {
    return a.x >= b.min.x && a.x <= b.max.x && a.y >= b.min.y && a.y <= b.max.y && a.z >= b.min.z && a.z <= b.max.z
};
cc.math.AABB.prototype.assignFrom = function(a) {
    this.min.assignFrom(a.min);
    this.max.assignFrom(a.max)
};
cc.math.AABB.assign = function(a, b) {
    a.min.assignFrom(b.min);
    a.max.assignFrom(b.max);
    return a
}; (function(a) {
    a.math.Matrix4Stack = function(a, b) {
        this.top = a;
        this.stack = b || [];
        this.lastUpdated = 0
    };
    a.km_mat4_stack = a.math.Matrix4Stack;
    var b = a.math.Matrix4Stack.prototype;
    b.initialize = function() {
        this.stack.length = 0;
        this.top = null
    };
    a.km_mat4_stack_push = function(b, d) {
        b.stack.push(b.top);
        b.top = new a.math.Matrix4(d)
    };
    a.km_mat4_stack_pop = function(a, b) {
        a.top = a.stack.pop()
    };
    a.km_mat4_stack_release = function(a) {
        a.stack = null;
        a.top = null
    };
    b.push = function(b) {
        b = b || this.top;
        this.stack.push(this.top);
        this.top = new a.math.Matrix4(b)
    };
    b.pop = function() {
        this.top = this.stack.pop()
    };
    b.release = function() {
        this._matrixPool = this.top = this.stack = null
    };
    b._getFromPool = function(b) {
        var d = this._matrixPool;
        if (0 === d.length) return new a.math.Matrix4(b);
        d = d.pop();
        d.assignFrom(b);
        return d
    };
    b._putInPool = function(a) {
        this._matrixPool.push(a)
    }
})(cc); (function(a) {
    a.KM_GL_MODELVIEW = 5888;
    a.KM_GL_PROJECTION = 5889;
    a.KM_GL_TEXTURE = 5890;
    a.modelview_matrix_stack = new a.math.Matrix4Stack;
    a.projection_matrix_stack = new a.math.Matrix4Stack;
    a.texture_matrix_stack = new a.math.Matrix4Stack;
    a.current_stack = null;
    a.lazyInitialize = function() {
        var b = new a.math.Matrix4;
        a.modelview_matrix_stack.initialize();
        a.projection_matrix_stack.initialize();
        a.texture_matrix_stack.initialize();
        a.current_stack = a.modelview_matrix_stack;
        a.initialized = !0;
        b.identity();
        a.modelview_matrix_stack.push(b);
        a.projection_matrix_stack.push(b);
        a.texture_matrix_stack.push(b)
    };
    a.lazyInitialize();
    a.kmGLFreeAll = function() {
        a.modelview_matrix_stack.release();
        a.modelview_matrix_stack = null;
        a.projection_matrix_stack.release();
        a.projection_matrix_stack = null;
        a.texture_matrix_stack.release();
        a.texture_matrix_stack = null;
        a.initialized = !1;
        a.current_stack = null
    };
    a.kmGLPushMatrix = function() {
        a.current_stack.push(a.current_stack.top)
    };
    a.kmGLPushMatrixWitMat4 = function(b) {
        a.current_stack.stack.push(a.current_stack.top);
        b.assignFrom(a.current_stack.top);
        a.current_stack.top = b
    };
    a.kmGLPopMatrix = function() {
        a.current_stack.top = a.current_stack.stack.pop()
    };
    a.kmGLMatrixMode = function(b) {
        switch (b) {
        case a.KM_GL_MODELVIEW:
            a.current_stack = a.modelview_matrix_stack;
            break;
        case a.KM_GL_PROJECTION:
            a.current_stack = a.projection_matrix_stack;
            break;
        case a.KM_GL_TEXTURE:
            a.current_stack = a.texture_matrix_stack;
            break;
        default:
            throw Error("Invalid matrix mode specified");
        }
        a.current_stack.lastUpdated = a.director.getTotalFrames()
    };
    a.kmGLLoadIdentity = function() {
        a.current_stack.top.identity()
    };
    a.kmGLLoadMatrix = function(b) {
        a.current_stack.top.assignFrom(b)
    };
    a.kmGLMultMatrix = function(b) {
        a.current_stack.top.multiply(b)
    };
    var b = new a.math.Matrix4;
    a.kmGLTranslatef = function(c, e, f) {
        c = a.math.Matrix4.createByTranslation(c, e, f, b);
        a.current_stack.top.multiply(c)
    };
    var c = new a.math.Vec3;
    a.kmGLRotatef = function(d, e, f, g) {
        c.fill(e, f, g);
        d = a.math.Matrix4.createByAxisAndAngle(c, a.degreesToRadians(d), b);
        a.current_stack.top.multiply(d)
    };
    a.kmGLScalef = function(c, e, f) {
        c = a.math.Matrix4.createByScale(c, e, f, b);
        a.current_stack.top.multiply(c)
    };
    a.kmGLGetMatrix = function(b, c) {
        switch (b) {
        case a.KM_GL_MODELVIEW:
            c.assignFrom(a.modelview_matrix_stack.top);
            break;
        case a.KM_GL_PROJECTION:
            c.assignFrom(a.projection_matrix_stack.top);
            break;
        case a.KM_GL_TEXTURE:
            c.assignFrom(a.texture_matrix_stack.top);
            break;
        default:
            throw Error("Invalid matrix mode specified");
        }
    }
})(cc);
cc.SHADER_POSITION_UCOLOR_FRAG = "precision lowp float;\nvarying vec4 v_fragmentColor;\nvoid main()                              \n{ \n    gl_FragColor \x3d v_fragmentColor;      \n}\n";
cc.SHADER_POSITION_UCOLOR_VERT = "attribute vec4 a_position;\nuniform    vec4 u_color;\nuniform float u_pointSize;\nvarying lowp vec4 v_fragmentColor; \nvoid main(void)   \n{\n    gl_Position \x3d (CC_PMatrix * CC_MVMatrix) * a_position;  \n    gl_PointSize \x3d u_pointSize;          \n    v_fragmentColor \x3d u_color;           \n}";
cc.SHADER_POSITION_COLOR_FRAG = "precision lowp float; \nvarying vec4 v_fragmentColor; \nvoid main() \n{ \n     gl_FragColor \x3d v_fragmentColor; \n} ";
cc.SHADER_POSITION_COLOR_VERT = "attribute vec4 a_position;\nattribute vec4 a_color;\nvarying lowp vec4 v_fragmentColor;\nvoid main()\n{\n    gl_Position \x3d (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor \x3d a_color;             \n}";
cc.SHADER_SPRITE_POSITION_COLOR_VERT = "attribute vec4 a_position;\nattribute vec4 a_color;\nvarying lowp vec4 v_fragmentColor;\nvoid main()\n{\n    gl_Position \x3d CC_PMatrix * a_position;  \n    v_fragmentColor \x3d a_color;             \n}";
cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_FRAG = "// #extension GL_OES_standard_derivatives : enable\nvarying mediump vec4 v_color;\nvarying mediump vec2 v_texcoord;\nvoid main()\t\n{ \n// #if defined GL_OES_standard_derivatives\t\n// gl_FragColor \x3d v_color*smoothstep(0.0, length(fwidth(v_texcoord)), 1.0 - length(v_texcoord)); \n// #else\t\ngl_FragColor \x3d v_color * step(0.0, 1.0 - length(v_texcoord)); \n// #endif \n}";
cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_VERT = "attribute mediump vec4 a_position; \nattribute mediump vec2 a_texcoord; \nattribute mediump vec4 a_color;\t\nvarying mediump vec4 v_color; \nvarying mediump vec2 v_texcoord;\t\nvoid main() \n{ \n     v_color \x3d a_color;//vec4(a_color.rgb * a_color.a, a_color.a); \n     v_texcoord \x3d a_texcoord; \n    gl_Position \x3d (CC_PMatrix * CC_MVMatrix) * a_position;  \n}";
cc.SHADER_POSITION_TEXTURE_FRAG = "precision lowp float;   \nvarying vec2 v_texCoord;  \nvoid main() \n{  \n    gl_FragColor \x3d  texture2D(CC_Texture0, v_texCoord);   \n}";
cc.SHADER_POSITION_TEXTURE_VERT = "attribute vec4 a_position; \nattribute vec2 a_texCoord; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position \x3d (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_texCoord \x3d a_texCoord;               \n}";
cc.SHADER_POSITION_TEXTURE_UCOLOR_FRAG = "precision lowp float;  \nuniform vec4 u_color; \nvarying vec2 v_texCoord; \nvoid main() \n{  \n    gl_FragColor \x3d  texture2D(CC_Texture0, v_texCoord) * u_color;    \n}";
cc.SHADER_POSITION_TEXTURE_UCOLOR_VERT = "attribute vec4 a_position;\nattribute vec2 a_texCoord; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position \x3d (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_texCoord \x3d a_texCoord;                 \n}";
cc.SHADER_POSITION_TEXTURE_A8COLOR_FRAG = "precision lowp float;  \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_FragColor \x3d vec4( v_fragmentColor.rgb,         \n        v_fragmentColor.a * texture2D(CC_Texture0, v_texCoord).a   \n    ); \n}";
cc.SHADER_POSITION_TEXTURE_A8COLOR_VERT = "attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position \x3d (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor \x3d a_color; \n    v_texCoord \x3d a_texCoord; \n}";
cc.SHADER_POSITION_TEXTURE_COLOR_FRAG = "precision lowp float;\nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_FragColor \x3d v_fragmentColor * texture2D(CC_Texture0, v_texCoord); \n}";
cc.SHADER_POSITION_TEXTURE_COLOR_VERT = "attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position \x3d (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor \x3d a_color; \n    v_texCoord \x3d a_texCoord; \n}";
cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT = "attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position \x3d CC_PMatrix * a_position;  \n    v_fragmentColor \x3d a_color; \n    v_texCoord \x3d a_texCoord; \n}";
cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_GRAY_FRAG = "precision lowp float;\nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    vec4 c \x3d texture2D(CC_Texture0, v_texCoord); \n    gl_FragColor.xyz \x3d vec3(0.2126*c.r + 0.7152*c.g + 0.0722*c.b); \n     gl_FragColor.w \x3d c.w ; \n}";
cc.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG = "precision lowp float;   \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord;   \nuniform float CC_alpha_value; \nvoid main() \n{  \n    vec4 texColor \x3d texture2D(CC_Texture0, v_texCoord);  \n    if ( texColor.a \x3c\x3d CC_alpha_value )          \n        discard; \n    gl_FragColor \x3d texColor * v_fragmentColor;  \n}";
cc.SHADEREX_SWITCHMASK_FRAG = "precision lowp float; \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nuniform sampler2D u_texture;  \nuniform sampler2D   u_mask;   \nvoid main()  \n{  \n    vec4 texColor   \x3d texture2D(u_texture, v_texCoord);  \n    vec4 maskColor  \x3d texture2D(u_mask, v_texCoord); \n    vec4 finalColor \x3d vec4(texColor.r, texColor.g, texColor.b, maskColor.a * texColor.a);        \n    gl_FragColor    \x3d v_fragmentColor * finalColor; \n}";
cc.shaderCache = {
    TYPE_POSITION_TEXTURECOLOR: 0,
    TYPE_POSITION_TEXTURECOLOR_ALPHATEST: 1,
    TYPE_POSITION_COLOR: 2,
    TYPE_POSITION_TEXTURE: 3,
    TYPE_POSITION_TEXTURE_UCOLOR: 4,
    TYPE_POSITION_TEXTURE_A8COLOR: 5,
    TYPE_POSITION_UCOLOR: 6,
    TYPE_POSITION_LENGTH_TEXTURECOLOR: 7,
    TYPE_SPRITE_POSITION_TEXTURECOLOR: 8,
    TYPE_SPRITE_POSITION_TEXTURECOLOR_ALPHATEST: 9,
    TYPE_SPRITE_POSITION_COLOR: 10,
    TYPE_SPRITE_POSITION_TEXTURECOLOR_GRAY: 11,
    TYPE_MAX: 11,
    _keyMap: [cc.SHADER_POSITION_TEXTURECOLOR, cc.SHADER_POSITION_TEXTURECOLORALPHATEST, cc.SHADER_POSITION_COLOR, cc.SHADER_POSITION_TEXTURE, cc.SHADER_POSITION_TEXTURE_UCOLOR, cc.SHADER_POSITION_TEXTUREA8COLOR, cc.SHADER_POSITION_UCOLOR, cc.SHADER_POSITION_LENGTHTEXTURECOLOR, cc.SHADER_SPRITE_POSITION_TEXTURECOLOR, cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST, cc.SHADER_SPRITE_POSITION_COLOR, cc.SHADER_SPRITE_POSITION_TEXTURECOLOR_GRAY],
    _programs: {},
    _init: function() {
        this.loadDefaultShaders();
        return ! 0
    },
    _loadDefaultShader: function(a, b) {
        switch (b) {
        case cc.SHADER_POSITION_TEXTURECOLOR:
            a.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_COLOR_VERT, cc.SHADER_POSITION_TEXTURE_COLOR_FRAG);
            a.addAttribute(cc.ATTRIBUTE_NAME_POSITION, cc.VERTEX_ATTRIB_POSITION);
            a.addAttribute(cc.ATTRIBUTE_NAME_COLOR, cc.VERTEX_ATTRIB_COLOR);
            a.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD, cc.VERTEX_ATTRIB_TEX_COORDS);
            break;
        case cc.SHADER_SPRITE_POSITION_TEXTURECOLOR:
            a.initWithVertexShaderByteArray(cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT, cc.SHADER_POSITION_TEXTURE_COLOR_FRAG);
            a.addAttribute(cc.ATTRIBUTE_NAME_POSITION, cc.VERTEX_ATTRIB_POSITION);
            a.addAttribute(cc.ATTRIBUTE_NAME_COLOR, cc.VERTEX_ATTRIB_COLOR);
            a.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD, cc.VERTEX_ATTRIB_TEX_COORDS);
            break;
        case cc.SHADER_SPRITE_POSITION_TEXTURECOLOR_GRAY:
            a.initWithVertexShaderByteArray(cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT, cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_GRAY_FRAG);
            a.addAttribute(cc.ATTRIBUTE_NAME_POSITION, cc.VERTEX_ATTRIB_POSITION);
            a.addAttribute(cc.ATTRIBUTE_NAME_COLOR, cc.VERTEX_ATTRIB_COLOR);
            a.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD, cc.VERTEX_ATTRIB_TEX_COORDS);
            break;
        case cc.SHADER_POSITION_TEXTURECOLORALPHATEST:
            a.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_COLOR_VERT, cc.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG);
            a.addAttribute(cc.ATTRIBUTE_NAME_POSITION, cc.VERTEX_ATTRIB_POSITION);
            a.addAttribute(cc.ATTRIBUTE_NAME_COLOR, cc.VERTEX_ATTRIB_COLOR);
            a.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD, cc.VERTEX_ATTRIB_TEX_COORDS);
            break;
        case cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST:
            a.initWithVertexShaderByteArray(cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT, cc.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG);
            a.addAttribute(cc.ATTRIBUTE_NAME_POSITION, cc.VERTEX_ATTRIB_POSITION);
            a.addAttribute(cc.ATTRIBUTE_NAME_COLOR, cc.VERTEX_ATTRIB_COLOR);
            a.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD, cc.VERTEX_ATTRIB_TEX_COORDS);
            break;
        case cc.SHADER_POSITION_COLOR:
            a.initWithVertexShaderByteArray(cc.SHADER_POSITION_COLOR_VERT, cc.SHADER_POSITION_COLOR_FRAG);
            a.addAttribute(cc.ATTRIBUTE_NAME_POSITION, cc.VERTEX_ATTRIB_POSITION);
            a.addAttribute(cc.ATTRIBUTE_NAME_COLOR, cc.VERTEX_ATTRIB_COLOR);
            break;
        case cc.SHADER_SPRITE_POSITION_COLOR:
            a.initWithVertexShaderByteArray(cc.SHADER_SPRITE_POSITION_COLOR_VERT, cc.SHADER_POSITION_COLOR_FRAG);
            a.addAttribute(cc.ATTRIBUTE_NAME_POSITION, cc.VERTEX_ATTRIB_POSITION);
            a.addAttribute(cc.ATTRIBUTE_NAME_COLOR, cc.VERTEX_ATTRIB_COLOR);
            break;
        case cc.SHADER_POSITION_TEXTURE:
            a.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_VERT, cc.SHADER_POSITION_TEXTURE_FRAG);
            a.addAttribute(cc.ATTRIBUTE_NAME_POSITION, cc.VERTEX_ATTRIB_POSITION);
            a.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD, cc.VERTEX_ATTRIB_TEX_COORDS);
            break;
        case cc.SHADER_POSITION_TEXTURE_UCOLOR:
            a.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_UCOLOR_VERT, cc.SHADER_POSITION_TEXTURE_UCOLOR_FRAG);
            a.addAttribute(cc.ATTRIBUTE_NAME_POSITION, cc.VERTEX_ATTRIB_POSITION);
            a.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD, cc.VERTEX_ATTRIB_TEX_COORDS);
            break;
        case cc.SHADER_POSITION_TEXTUREA8COLOR:
            a.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_A8COLOR_VERT, cc.SHADER_POSITION_TEXTURE_A8COLOR_FRAG);
            a.addAttribute(cc.ATTRIBUTE_NAME_POSITION, cc.VERTEX_ATTRIB_POSITION);
            a.addAttribute(cc.ATTRIBUTE_NAME_COLOR, cc.VERTEX_ATTRIB_COLOR);
            a.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD, cc.VERTEX_ATTRIB_TEX_COORDS);
            break;
        case cc.SHADER_POSITION_UCOLOR:
            a.initWithVertexShaderByteArray(cc.SHADER_POSITION_UCOLOR_VERT, cc.SHADER_POSITION_UCOLOR_FRAG);
            a.addAttribute("aVertex", cc.VERTEX_ATTRIB_POSITION);
            break;
        case cc.SHADER_POSITION_LENGTHTEXTURECOLOR:
            a.initWithVertexShaderByteArray(cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_VERT, cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_FRAG);
            a.addAttribute(cc.ATTRIBUTE_NAME_POSITION, cc.VERTEX_ATTRIB_POSITION);
            a.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD, cc.VERTEX_ATTRIB_TEX_COORDS);
            a.addAttribute(cc.ATTRIBUTE_NAME_COLOR, cc.VERTEX_ATTRIB_COLOR);
            break;
        default:
            cc.log("cocos2d: cc.shaderCache._loadDefaultShader, error shader type");
            return
        }
        a.link();
        a.updateUniforms()
    },
    loadDefaultShaders: function() {
        for (var a = 0; a < this.TYPE_MAX; ++a) this.programForKey(this._keyMap[a])
    },
    reloadDefaultShaders: function() {
        var a = this.programForKey(cc.SHADER_POSITION_TEXTURECOLOR);
        a.reset();
        this._loadDefaultShader(a, cc.SHADER_POSITION_TEXTURECOLOR);
        a = this.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR);
        a.reset();
        this._loadDefaultShader(a, cc.SHADER_SPRITE_POSITION_TEXTURECOLOR);
        a = this.programForKey(cc.SHADER_POSITION_TEXTURECOLORALPHATEST);
        a.reset();
        this._loadDefaultShader(a, cc.SHADER_POSITION_TEXTURECOLORALPHATEST);
        a = this.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST);
        a.reset();
        this._loadDefaultShader(a, cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST);
        a = this.programForKey(cc.SHADER_POSITION_COLOR);
        a.reset();
        this._loadDefaultShader(a, cc.SHADER_POSITION_COLOR);
        a = this.programForKey(cc.SHADER_POSITION_TEXTURE);
        a.reset();
        this._loadDefaultShader(a, cc.SHADER_POSITION_TEXTURE);
        a = this.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_GRAY_FRAG);
        a.reset();
        this._loadDefaultShader(a, cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_GRAY_FRAG);
        a = this.programForKey(cc.SHADER_POSITION_TEXTURE_UCOLOR);
        a.reset();
        this._loadDefaultShader(a, cc.SHADER_POSITION_TEXTURE_UCOLOR);
        a = this.programForKey(cc.SHADER_POSITION_TEXTUREA8COLOR);
        a.reset();
        this._loadDefaultShader(a, cc.SHADER_POSITION_TEXTUREA8COLOR);
        a = this.programForKey(cc.SHADER_POSITION_UCOLOR);
        a.reset();
        this._loadDefaultShader(a, cc.SHADER_POSITION_UCOLOR)
    },
    programForKey: function(a) {
        if (!this._programs[a]) {
            var b = new cc.GLProgram;
            this._loadDefaultShader(b, a);
            this._programs[a] = b
        }
        return this._programs[a]
    },
    getProgram: function(a) {
        return this.programForKey(a)
    },
    addProgram: function(a, b) {
        this._programs[b] = a
    }
};
cc.GLProgram = cc.Class.extend({
    _glContext: null,
    _programObj: null,
    _vertShader: null,
    _fragShader: null,
    _uniforms: null,
    _hashForUniforms: null,
    _usesTime: !1,
    _projectionUpdated: -1,
    _updateUniform: function(a) {
        if (!a) return ! 1;
        var b = !1,
        c = this._hashForUniforms[a],
        d;
        if (Array.isArray(arguments[1])) d = arguments[1];
        else {
            d = Array(arguments.length - 1);
            for (var e = 1; e < arguments.length; e += 1) d[e - 1] = arguments[e]
        }
        if (c && c.length === d.length) for (e = 0; e < d.length; e += 1) {
            if (d[e] !== c[e] || "object" === typeof d[e]) c[e] = d[e],
            b = !0
        } else this._hashForUniforms[a] = [].concat(d),
        b = !0;
        return b
    },
    _description: function() {
        return "\x3cCCGLProgram \x3d " + this.toString() + " | Program \x3d " + this._programObj.toString() + ", VertexShader \x3d " + this._vertShader.toString() + ", FragmentShader \x3d " + this._fragShader.toString() + "\x3e"
    },
    _compileShader: function(a, b, c) {
        if (!c || !a) return ! 1;
        c = (cc.GLProgram._isHighpSupported() ? "precision highp float;\n": "precision mediump float;\n") + "uniform mat4 CC_PMatrix;         \nuniform mat4 CC_MVMatrix;        \nuniform mat4 CC_MVPMatrix;       \nuniform vec4 CC_Time;            \nuniform vec4 CC_SinTime;         \nuniform vec4 CC_CosTime;         \nuniform vec4 CC_Random01;        \nuniform sampler2D CC_Texture0;   \n//CC INCLUDES END                \n" + c;
        this._glContext.shaderSource(a, c);
        this._glContext.compileShader(a);
        c = this._glContext.getShaderParameter(a, this._glContext.COMPILE_STATUS);
        c || (cc.log("cocos2d: ERROR: Failed to compile shader:\n" + this._glContext.getShaderSource(a)), b === this._glContext.VERTEX_SHADER ? cc.log("cocos2d: \n" + this.vertexShaderLog()) : cc.log("cocos2d: \n" + this.fragmentShaderLog()));
        return ! 0 === c
    },
    ctor: function(a, b, c) {
        this._uniforms = {};
        this._hashForUniforms = {};
        this._glContext = c || cc._renderContext;
        a && b && this.init(a, b)
    },
    destroyProgram: function() {
        this._hashForUniforms = this._uniforms = this._fragShader = this._vertShader = null;
        this._glContext.deleteProgram(this._programObj)
    },
    initWithVertexShaderByteArray: function(a, b) {
        var c = this._glContext;
        if (null != c.createProgram) return this._programObj = c.createProgram(),
        this._fragShader = this._vertShader = null,
        a && (this._vertShader = c.createShader(c.VERTEX_SHADER), this._compileShader(this._vertShader, c.VERTEX_SHADER, a) || cc.log("cocos2d: ERROR: Failed to compile vertex shader")),
        b && (this._fragShader = c.createShader(c.FRAGMENT_SHADER), this._compileShader(this._fragShader, c.FRAGMENT_SHADER, b) || cc.log("cocos2d: ERROR: Failed to compile fragment shader")),
        this._vertShader && c.attachShader(this._programObj, this._vertShader),
        cc.checkGLErrorDebug(),
        this._fragShader && c.attachShader(this._programObj, this._fragShader),
        0 < Object.keys(this._hashForUniforms).length && (this._hashForUniforms = {}),
        cc.checkGLErrorDebug(),
        !0
    },
    initWithString: function(a, b) {
        return this.initWithVertexShaderByteArray(a, b)
    },
    initWithVertexShaderFilename: function(a, b) {
        var c = cc.loader.getRes(a);
        if (!c) throw Error("Please load the resource firset : " + a);
        var d = cc.loader.getRes(b);
        if (!d) throw Error("Please load the resource firset : " + b);
        return this.initWithVertexShaderByteArray(c, d)
    },
    init: function(a, b) {
        return this.initWithVertexShaderFilename(a, b)
    },
    addAttribute: function(a, b) {
        null != this._glContext.bindAttribLocation && this._glContext.bindAttribLocation(this._programObj, b, a)
    },
    link: function() {
        if (!this._programObj) return cc.log("cc.GLProgram.link(): Cannot link invalid program"),
        !1;
        this._glContext.linkProgram(this._programObj);
        this._vertShader && this._glContext.deleteShader(this._vertShader);
        this._fragShader && this._glContext.deleteShader(this._fragShader);
        this._fragShader = this._vertShader = null;
        return cc.game.config[cc.game.CONFIG_KEY.debugMode] && !this._glContext.getProgramParameter(this._programObj, this._glContext.LINK_STATUS) ? (cc.log("cocos2d: ERROR: Failed to link program: " + this._glContext.getProgramInfoLog(this._programObj)), cc.glDeleteProgram(this._programObj), this._programObj = null, !1) : !0
    },
    use: function() {
        cc.glUseProgram(this._programObj)
    },
    updateUniforms: function() {
        this._addUniformLocation(cc.UNIFORM_PMATRIX_S);
        this._addUniformLocation(cc.UNIFORM_MVMATRIX_S);
        this._addUniformLocation(cc.UNIFORM_MVPMATRIX_S);
        this._addUniformLocation(cc.UNIFORM_TIME_S);
        this._addUniformLocation(cc.UNIFORM_SINTIME_S);
        this._addUniformLocation(cc.UNIFORM_COSTIME_S);
        this._addUniformLocation(cc.UNIFORM_RANDOM01_S);
        this._addUniformLocation(cc.UNIFORM_SAMPLER_S);
        this._usesTime = null != this._uniforms[cc.UNIFORM_TIME_S] || null != this._uniforms[cc.UNIFORM_SINTIME_S] || null != this._uniforms[cc.UNIFORM_COSTIME_S];
        this.use();
        this.setUniformLocationWith1i(this._uniforms[cc.UNIFORM_SAMPLER_S], 0)
    },
    _addUniformLocation: function(a) {
        if (null != this._glContext.getUniformLocation) {
            var b = this._glContext.getUniformLocation(this._programObj, a);
            b && (b._name = a);
            return this._uniforms[a] = b
        }
    },
    getUniformLocationForName: function(a) {
        if (!a) throw Error("cc.GLProgram.getUniformLocationForName(): uniform name should be non-null");
        if (!this._programObj) throw Error("cc.GLProgram.getUniformLocationForName(): Invalid operation. Cannot get uniform location when program is not initialized");
        return this._uniforms[a] || this._addUniformLocation(a)
    },
    getUniformMVPMatrix: function() {
        return this._uniforms[cc.UNIFORM_MVPMATRIX_S]
    },
    getUniformSampler: function() {
        return this._uniforms[cc.UNIFORM_SAMPLER_S]
    },
    setUniformLocationWith1i: function(a, b) {
        var c = "string" === typeof a,
        d = c ? a: a && a._name;
        d ? this._updateUniform(d, b) && (c && (a = this.getUniformLocationForName(d)), this._glContext.uniform1i(a, b)) : null != this._glContext.uniform1i && this._glContext.uniform1i(a, b)
    },
    setUniformLocationWith2i: function(a, b, c) {
        var d = "string" === typeof a,
        e = d ? a: a && a._name;
        e ? this._updateUniform(e, b, c) && (d && (a = this.getUniformLocationForName(e)), this._glContext.uniform2i(a, b, c)) : this._glContext.uniform2i(a, b, c)
    },
    setUniformLocationWith3i: function(a, b, c, d) {
        var e = "string" === typeof a,
        f = e ? a: a && a._name;
        f ? this._updateUniform(f, b, c, d) && (e && (a = this.getUniformLocationForName(f)), this._glContext.uniform3i(a, b, c, d)) : this._glContext.uniform3i(a, b, c, d)
    },
    setUniformLocationWith4i: function(a, b, c, d, e) {
        var f = "string" === typeof a,
        g = f ? a: a && a._name;
        g ? this._updateUniform(g, b, c, d, e) && (f && (a = this.getUniformLocationForName(g)), this._glContext.uniform4i(a, b, c, d, e)) : this._glContext.uniform4i(a, b, c, d, e)
    },
    setUniformLocationWith2iv: function(a, b) {
        var c = "string" === typeof a,
        d = c ? a: a && a._name;
        d ? this._updateUniform(d, b) && (c && (a = this.getUniformLocationForName(d)), this._glContext.uniform2iv(a, b)) : this._glContext.uniform2iv(a, b)
    },
    setUniformLocationWith3iv: function(a, b) {
        var c = "string" === typeof a,
        d = c ? a: a && a._name;
        d ? this._updateUniform(d, b) && (c && (a = this.getUniformLocationForName(d)), this._glContext.uniform3iv(a, b)) : this._glContext.uniform3iv(a, b)
    },
    setUniformLocationWith4iv: function(a, b) {
        var c = "string" === typeof a,
        d = c ? a: a && a._name;
        d ? this._updateUniform(d, b) && (c && (a = this.getUniformLocationForName(d)), this._glContext.uniform4iv(a, b)) : this._glContext.uniform4iv(a, b)
    },
    setUniformLocationI32: function(a, b) {
        this.setUniformLocationWith1i(a, b)
    },
    setUniformLocationWith1f: function(a, b) {
        var c = "string" === typeof a,
        d = c ? a: a && a._name;
        d ? this._updateUniform(d, b) && (c && (a = this.getUniformLocationForName(d)), this._glContext.uniform1f(a, b)) : this._glContext.uniform1f(a, b)
    },
    setUniformLocationWith2f: function(a, b, c) {
        var d = "string" === typeof a,
        e = d ? a: a && a._name;
        e ? this._updateUniform(e, b, c) && (d && (a = this.getUniformLocationForName(e)), this._glContext.uniform2f(a, b, c)) : this._glContext.uniform2f(a, b, c)
    },
    setUniformLocationWith3f: function(a, b, c, d) {
        var e = "string" === typeof a,
        f = e ? a: a && a._name;
        f ? this._updateUniform(f, b, c, d) && (e && (a = this.getUniformLocationForName(f)), this._glContext.uniform3f(a, b, c, d)) : this._glContext.uniform3f(a, b, c, d)
    },
    setUniformLocationWith4f: function(a, b, c, d, e) {
        var f = "string" === typeof a,
        g = f ? a: a && a._name;
        g ? this._updateUniform(g, b, c, d, e) && (f && (a = this.getUniformLocationForName(g)), this._glContext.uniform4f(a, b, c, d, e)) : (this._glContext.uniform4f(a, b, c, d, e), cc.log("uniform4f", b, c, d, e))
    },
    setUniformLocationWith2fv: function(a, b) {
        var c = "string" === typeof a,
        d = c ? a: a && a._name;
        d ? this._updateUniform(d, b) && (c && (a = this.getUniformLocationForName(d)), this._glContext.uniform2fv(a, b)) : this._glContext.uniform2fv(a, b)
    },
    setUniformLocationWith3fv: function(a, b) {
        var c = "string" === typeof a,
        d = c ? a: a && a._name;
        d ? this._updateUniform(d, b) && (c && (a = this.getUniformLocationForName(d)), this._glContext.uniform3fv(a, b)) : this._glContext.uniform3fv(a, b)
    },
    setUniformLocationWith4fv: function(a, b) {
        var c = "string" === typeof a,
        d = c ? a: a && a._name;
        d ? this._updateUniform(d, b) && (c && (a = this.getUniformLocationForName(d)), this._glContext.uniform4fv(a, b)) : (this._glContext.uniform4fv(a, b), cc.log("uniform4fv", b))
    },
    setUniformLocationWithMatrix2fv: function(a, b) {
        var c = "string" === typeof a,
        d = c ? a: a && a._name;
        d ? this._updateUniform(d, b) && (c && (a = this.getUniformLocationForName(d)), this._glContext.uniformMatrix2fv(a, !1, b)) : this._glContext.uniformMatrix2fv(a, !1, b)
    },
    setUniformLocationWithMatrix3fv: function(a, b) {
        var c = "string" === typeof a,
        d = c ? a: a && a._name;
        d ? this._updateUniform(d, b) && (c && (a = this.getUniformLocationForName(d)), this._glContext.uniformMatrix3fv(a, !1, b)) : this._glContext.uniformMatrix3fv(a, !1, b)
    },
    setUniformLocationWithMatrix4fv: function(a, b) {
        var c = "string" === typeof a,
        d = c ? a: a && a._name;
        d ? this._updateUniform(d, b) && (c && (a = this.getUniformLocationForName(d)), this._glContext.uniformMatrix4fv(a, !1, b)) : this._glContext.uniformMatrix4fv(a, !1, b)
    },
    setUniformLocationF32: function() {
        if (! (2 > arguments.length)) switch (arguments.length) {
        case 2:
            this.setUniformLocationWith1f(arguments[0], arguments[1]);
            break;
        case 3:
            this.setUniformLocationWith2f(arguments[0], arguments[1], arguments[2]);
            break;
        case 4:
            this.setUniformLocationWith3f(arguments[0], arguments[1], arguments[2], arguments[3]);
            break;
        case 5:
            this.setUniformLocationWith4f(arguments[0], arguments[1], arguments[2], arguments[3], arguments[4])
        }
    },
    setUniformsForBuiltins: function() {
        var a = new cc.math.Matrix4,
        b = new cc.math.Matrix4,
        c = new cc.math.Matrix4;
        cc.kmGLGetMatrix(cc.KM_GL_PROJECTION, a);
        cc.kmGLGetMatrix(cc.KM_GL_MODELVIEW, b);
        cc.kmMat4Multiply(c, a, b);
        this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX_S], a.mat, 1);
        this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX_S], b.mat, 1);
        this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX_S], c.mat, 1);
        this._usesTime && (a = cc.director, a = a.getTotalFrames() * a.getAnimationInterval(), this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_TIME_S], a / 10, a, 2 * a, 4 * a), this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_SINTIME_S], a / 8, a / 4, a / 2, Math.sin(a)), this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_COSTIME_S], a / 8, a / 4, a / 2, Math.cos(a))); - 1 !== this._uniforms[cc.UNIFORM_RANDOM01_S] && this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_RANDOM01_S], Math.random(), Math.random(), Math.random(), Math.random())
    },
    _setUniformsForBuiltinsForRenderer: function(a) {
        if (a && a._renderCmd) {
            var b = new cc.math.Matrix4,
            c = new cc.math.Matrix4;
            cc.kmGLGetMatrix(cc.KM_GL_PROJECTION, b);
            cc.kmMat4Multiply(c, b, a._renderCmd._stackMatrix);
            this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX_S], b.mat, 1);
            this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX_S], a._renderCmd._stackMatrix.mat, 1);
            this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX_S], c.mat, 1);
            this._usesTime && (a = cc.director, a = a.getTotalFrames() * a.getAnimationInterval(), this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_TIME_S], a / 10, a, 2 * a, 4 * a), this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_SINTIME_S], a / 8, a / 4, a / 2, Math.sin(a)), this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_COSTIME_S], a / 8, a / 4, a / 2, Math.cos(a))); - 1 !== this._uniforms[cc.UNIFORM_RANDOM01_S] && this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_RANDOM01_S], Math.random(), Math.random(), Math.random(), Math.random())
        }
    },
    setUniformForModelViewProjectionMatrix: function() {
        this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX_S], cc.getMat4MultiplyValue(cc.projection_matrix_stack.top, cc.modelview_matrix_stack.top))
    },
    setUniformForModelViewProjectionMatrixWithMat4: function(a) {
        cc.kmMat4Multiply(a, cc.projection_matrix_stack.top, cc.modelview_matrix_stack.top);
        this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX_S], a.mat)
    },
    setUniformForModelViewAndProjectionMatrixWithMat4: function() {
        this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX_S], cc.modelview_matrix_stack.top.mat);
        this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX_S], cc.projection_matrix_stack.top.mat)
    },
    _setUniformForMVPMatrixWithMat4: function(a) {
        if (!a) throw Error("modelView matrix is undefined.");
        this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX_S], a.mat);
        this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX_S], cc.projection_matrix_stack.top.mat)
    },
    _updateProjectionUniform: function() {
        var a = cc.projection_matrix_stack;
        a.lastUpdated !== this._projectionUpdated && (this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX_S], !1, a.top.mat), this._projectionUpdated = a.lastUpdated)
    },
    vertexShaderLog: function() {
        return this._glContext.getShaderInfoLog(this._vertShader)
    },
    getVertexShaderLog: function() {
        return this._glContext.getShaderInfoLog(this._vertShader)
    },
    getFragmentShaderLog: function() {
        return this._glContext.getShaderInfoLog(this._vertShader)
    },
    fragmentShaderLog: function() {
        return this._glContext.getShaderInfoLog(this._fragShader)
    },
    programLog: function() {
        return this._glContext.getProgramInfoLog(this._programObj)
    },
    getProgramLog: function() {
        return this._glContext.getProgramInfoLog(this._programObj)
    },
    reset: function() {
        this._fragShader = this._vertShader = null;
        0 < Object.keys(this._uniforms).length && (this._uniforms = {});
        this._glContext.deleteProgram(this._programObj);
        this._programObj = null;
        0 < Object.keys(this._hashForUniforms).length && (this._hashForUniforms = {})
    },
    getProgram: function() {
        return this._programObj
    },
    retain: function() {},
    release: function() {}
});
cc.GLProgram.create = function(a, b) {
    return new cc.GLProgram(a, b)
};
cc.GLProgram._highpSupported = null;
cc.GLProgram._isHighpSupported = function() {
    var a = cc._renderContext;
    a.getShaderPrecisionFormat && null == cc.GLProgram._highpSupported && (a = a.getShaderPrecisionFormat(a.FRAGMENT_SHADER, a.HIGH_FLOAT), cc.GLProgram._highpSupported = 0 !== a.precision);
    return cc.GLProgram._highpSupported
};
cc.setProgram = function(a, b) {
    a.shaderProgram = b;
    var c = a.children;
    if (c) for (var d = 0; d < c.length; d++) cc.setProgram(c[d], b)
};
var types = {
    GL_FLOAT: 0,
    GL_INT: 1,
    GL_FLOAT_VEC2: 2,
    GL_FLOAT_VEC3: 3,
    GL_FLOAT_VEC4: 4,
    GL_FLOAT_MAT4: 5,
    GL_CALLBACK: 6,
    GL_TEXTURE: 7
};
cc.UniformValue = function(a, b) {
    this._uniform = a;
    this._glprogram = b;
    this._value = null;
    this._type = -1
};
cc.UniformValue.prototype = {
    setFloat: function(a) {
        this._value = a;
        this._type = types.GL_FLOAT
    },
    setInt: function(a) {
        this._value = a;
        this._type = types.GL_INT
    },
    setVec2: function(a, b) {
        this._value = [a, b];
        this._type = types.GL_FLOAT_VEC2
    },
    setVec2v: function(a) {
        this._value = a.slice(0);
        this._type = types.GL_FLOAT_VEC2
    },
    setVec3: function(a, b, c) {
        this._value = [a, b, c];
        this._type = types.GL_FLOAT_VEC3
    },
    setVec3v: function(a) {
        this._value = a.slice(0);
        this._type = types.GL_FLOAT_VEC3
    },
    setVec4: function(a, b, c, d) {
        this._value = [a, b, c, d];
        this._type = types.GL_FLOAT_VEC4
    },
    setVec4v: function(a) {
        this._value = a.slice(0);
        this._type = types.GL_FLOAT_VEC4
    },
    setMat4: function(a) {
        this._value = a.slice(0);
        this._type = types.GL_FLOAT_MAT4
    },
    setCallback: function(a) {
        this._value = a;
        this._type = types.GL_CALLBACK
    },
    setTexture: function(a, b) {
        this._value = b;
        this._textureId = a;
        this._type = types.GL_TEXTURE
    },
    apply: function() {
        switch (this._type) {
        case types.GL_INT:
            this._glprogram.setUniformLocationWith1i(this._uniform._location, this._value);
            break;
        case types.GL_FLOAT:
            this._glprogram.setUniformLocationWith1f(this._uniform._location, this._value);
            break;
        case types.GL_FLOAT_VEC2:
            this._glprogram.setUniformLocationWith2fv(this._uniform._location, this._value);
            break;
        case types.GL_FLOAT_VEC3:
            this._glprogram.setUniformLocationWith3fv(this._uniform._location, this._value);
            break;
        case types.GL_FLOAT_VEC4:
            this._glprogram.setUniformLocationWith4fv(this._uniform._location, this._value);
            break;
        case types.GL_FLOAT_MAT4:
            this._glprogram.setUniformLocationWithMatrix4fv(this._uniform._location, this._value);
            break;
        case types.GL_CALLBACK:
            this._value(this._glprogram, this._uniform);
            break;
        case types.GL_TEXTURE:
            this._glprogram.setUniformLocationWith1i(this._uniform._location, this._value),
            cc.glBindTexture2DN(this._value, this._textureId)
        }
    }
};
cc.GLProgramState = function(a) {
    this._glprogram = a;
    this._uniforms = {};
    this._boundTextureUnits = {};
    this._textureUnitIndex = 1;
    for (var b = a._glContext.getProgramParameter(a._programObj, a._glContext.ACTIVE_UNIFORMS), c = 0; c < b; c += 1) {
        var d = a._glContext.getActiveUniform(a._programObj, c);
        if (0 !== d.name.indexOf("CC_")) {
            d._location = a._glContext.getUniformLocation(a._programObj, d.name);
            d._location._name = d.name;
            var e = new cc.UniformValue(d, a);
            this._uniforms[d.name] = e
        }
    }
};
cc.GLProgramState.prototype = {
    apply: function(a) {
        this._glprogram.use();
        a && this._glprogram._setUniformForMVPMatrixWithMat4(a);
        for (var b in this._uniforms) this._uniforms[b].apply()
    },
    setGLProgram: function(a) {
        this._glprogram = a
    },
    getGLProgram: function() {
        return this._glprogram
    },
    getUniformCount: function() {
        return this._uniforms.length
    },
    getUniformValue: function(a) {
        return this._uniforms[a]
    },
    setUniformInt: function(a, b) {
        var c = this.getUniformValue(a);
        c ? c.setInt(b) : cc.log("cocos2d: warning: Uniform not found: " + a)
    },
    setUniformFloat: function(a, b) {
        var c = this.getUniformValue(a);
        c ? c.setFloat(b) : cc.log("cocos2d: warning: Uniform not found: " + a)
    },
    setUniformVec2: function(a, b, c) {
        var d = this.getUniformValue(a);
        d ? d.setVec2(b, c) : cc.log("cocos2d: warning: Uniform not found: " + a)
    },
    setUniformVec2v: function(a, b) {
        var c = this.getUniformValue(a);
        c ? c.setVec2v(b) : cc.log("cocos2d: warning: Uniform not found: " + a)
    },
    setUniformVec3: function(a, b, c, d) {
        var e = this.getUniformValue(a);
        e ? e.setVec3(b, c, d) : cc.log("cocos2d: warning: Uniform not found: " + a)
    },
    setUniformVec3v: function(a, b) {
        var c = this.getUniformValue(a);
        c ? c.setVec3v(b) : cc.log("cocos2d: warning: Uniform not found: " + a)
    },
    setUniformVec4: function(a, b, c, d, e) {
        var f = this.getUniformValue(a);
        f ? f.setVec4(b, c, d, e) : cc.log("cocos2d: warning: Uniform not found: " + a)
    },
    setUniformVec4v: function(a, b) {
        var c = this.getUniformValue(a);
        c ? c.setVec4v(b) : cc.log("cocos2d: warning: Uniform not found: " + a)
    },
    setUniformMat4: function(a, b) {
        var c = this.getUniformValue(a);
        c ? c.setMat4(b) : cc.log("cocos2d: warning: Uniform not found: " + a)
    },
    setUniformCallback: function(a, b) {
        var c = this.getUniformValue(a);
        c ? c.setCallback(b) : cc.log("cocos2d: warning: Uniform not found: " + a)
    },
    setUniformTexture: function(a, b) {
        var c = this.getUniformValue(a);
        if (c) {
            var d = this._boundTextureUnits[a];
            d ? c.setTexture(b, d) : (c.setTexture(b, this._textureUnitIndex), this._boundTextureUnits[a] = this._textureUnitIndex++)
        }
    }
};
cc.GLProgramState._cache = {};
cc.GLProgramState.getOrCreateWithGLProgram = function(a) {
    var b = cc.GLProgramState._cache[a.__instanceId];
    b || (b = new cc.GLProgramState(a), cc.GLProgramState._cache[a.__instanceId] = b);
    return b
};
cc._currentProjectionMatrix = -1;
cc.ENABLE_GL_STATE_CACHE && (cc.MAX_ACTIVETEXTURE = 16, cc._currentShaderProgram = -1, cc._currentBoundTexture = [ - 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1], cc._blendingSource = -1, cc._blendingDest = -1, cc._GLServerState = 0, cc.TEXTURE_ATLAS_USE_VAO && (cc._uVAO = 0));
cc.glInvalidateStateCache = function() {
    cc.kmGLFreeAll();
    cc._currentProjectionMatrix = -1;
    if (cc.ENABLE_GL_STATE_CACHE) {
        cc._currentShaderProgram = -1;
        for (var a = 0; a < cc.MAX_ACTIVETEXTURE; a++) cc._currentBoundTexture[a] = -1;
        cc._blendingSource = -1;
        cc._blendingDest = -1;
        cc._GLServerState = 0
    }
};
cc.glUseProgram = cc.ENABLE_GL_STATE_CACHE ?
function(a) {
    a !== cc._currentShaderProgram && (cc._currentShaderProgram = a, null != cc._renderContext.useProgram && cc._renderContext.useProgram(a))
}: function(a) {
    cc._renderContext.useProgram(a)
};
cc.glDeleteProgram = function(a) {
    cc.ENABLE_GL_STATE_CACHE && a === cc._currentShaderProgram && (cc._currentShaderProgram = -1);
    gl.deleteProgram(a)
};
cc.setBlending = function(a, b) {
    var c = cc._renderContext;
    a === c.ONE && b === c.ZERO ? c.disable(c.BLEND) : (c.enable(c.BLEND), cc._renderContext.blendFunc(a, b))
};
cc.glBlendFunc = cc.ENABLE_GL_STATE_CACHE ?
function(a, b) {
    if (a !== cc._blendingSource || b !== cc._blendingDest) cc._blendingSource = a,
    cc._blendingDest = b,
    cc.setBlending(a, b)
}: cc.setBlending;
cc.glBlendFuncForParticle = function(a, b) {
    if (a !== cc._blendingSource || b !== cc._blendingDest) {
        cc._blendingSource = a;
        cc._blendingDest = b;
        var c = cc._renderContext;
        a === c.ONE && b === c.ZERO ? c.disable(c.BLEND) : (c.enable(c.BLEND), c.blendFuncSeparate(c.SRC_ALPHA, b, a, b))
    }
};
cc.glBlendResetToCache = function() {
    var a = cc._renderContext;
    a.blendEquation(a.FUNC_ADD);
    cc.ENABLE_GL_STATE_CACHE ? cc.setBlending(cc._blendingSource, cc._blendingDest) : cc.setBlending(a.BLEND_SRC, a.BLEND_DST)
};
cc.setProjectionMatrixDirty = function() {
    cc._currentProjectionMatrix = -1
};
cc.glBindTexture2D = function(a) {
    cc.glBindTexture2DN(0, a)
};
cc.glBindTexture2DN = cc.ENABLE_GL_STATE_CACHE ?
function(a, b) {
    if (cc._currentBoundTexture[a] !== b) {
        cc._currentBoundTexture[a] = b;
        var c = cc._renderContext;
        c.activeTexture(c.TEXTURE0 + a);
        b ? c.bindTexture(c.TEXTURE_2D, b._webTextureObj) : c.bindTexture(c.TEXTURE_2D, null)
    }
}: function(a, b) {
    var c = cc._renderContext;
    c.activeTexture(c.TEXTURE0 + a);
    b ? c.bindTexture(c.TEXTURE_2D, b._webTextureObj) : c.bindTexture(c.TEXTURE_2D, null)
};
cc.glDeleteTexture = function(a) {
    cc.glDeleteTextureN(0, a)
};
cc.glDeleteTextureN = function(a, b) {
    cc.ENABLE_GL_STATE_CACHE && b === cc._currentBoundTexture[a] && (cc._currentBoundTexture[a] = -1);
    cc._renderContext.deleteTexture(b._webTextureObj)
};
cc.glBindVAO = function(a) {
    cc.TEXTURE_ATLAS_USE_VAO && cc.ENABLE_GL_STATE_CACHE && cc._uVAO !== a && (cc._uVAO = a)
};
cc.glEnable = function(a) {};
cc.IMAGE_FORMAT_JPEG = 0;
cc.IMAGE_FORMAT_PNG = 1;
cc.IMAGE_FORMAT_RAWDATA = 9;
cc.NextPOT = function(a) {
    a -= 1;
    a |= a >> 1;
    a |= a >> 2;
    a |= a >> 4;
    a |= a >> 8;
    return (a | a >> 16) + 1
};
cc.RenderTexture = cc.Node.extend({
    sprite: null,
    clearFlags: 0,
    clearDepthVal: 0,
    autoDraw: !1,
    _texture: null,
    _pixelFormat: 0,
    clearStencilVal: 0,
    _clearColor: null,
    _className: "RenderTexture",
    ctor: function(a, b, c, d) {
        cc.Node.prototype.ctor.call(this);
        this._cascadeOpacityEnabled = this._cascadeColorEnabled = !0;
        this._pixelFormat = cc.Texture2D.PIXEL_FORMAT_RGBA8888;
        this._clearColor = new cc.Color(0, 0, 0, 255);
        void 0 !== a && void 0 !== b && (c = c || cc.Texture2D.PIXEL_FORMAT_RGBA8888, this.initWithWidthAndHeight(a, b, c, d || 0));
        this.setAnchorPoint(0, 0)
    },
    _createRenderCmd: function() {
        return cc._renderType === cc.game.RENDER_TYPE_CANVAS ? new cc.RenderTexture.CanvasRenderCmd(this) : new cc.RenderTexture.WebGLRenderCmd(this)
    },
    visit: function(a) {
        var b = this._renderCmd;
        a = a ? a._renderCmd: null;
        if (this._visible) {
            var c = cc.renderer;
            b.visit(a);
            c.pushRenderCommand(b);
            this.sprite.visit(this);
            b._dirtyFlag = 0
        } else b._propagateFlagsDown(a)
    },
    cleanup: function() {
        cc.Node.prototype.onExit.call(this);
        this._renderCmd.cleanup()
    },
    getSprite: function() {
        return this.sprite
    },
    setSprite: function(a) {
        this.sprite = a
    },
    setVirtualViewport: function(a, b, c) {
        this._renderCmd.setVirtualViewport(a, b, c)
    },
    initWithWidthAndHeight: function(a, b, c, d) {
        return this._renderCmd.initWithWidthAndHeight(a, b, c, d)
    },
    begin: function() {
        cc.renderer._turnToCacheMode(this.__instanceId);
        this._renderCmd.begin()
    },
    beginWithClear: function(a, b, c, d, e, f) {
        var g = cc._renderContext;
        e = e || g.COLOR_BUFFER_BIT;
        f = f || g.COLOR_BUFFER_BIT | g.DEPTH_BUFFER_BIT;
        this._beginWithClear(a, b, c, d, e, f, g.COLOR_BUFFER_BIT | g.DEPTH_BUFFER_BIT | g.STENCIL_BUFFER_BIT)
    },
    _beginWithClear: function(a, b, c, d, e, f, g) {
        this.begin();
        this._renderCmd._beginWithClear(a, b, c, d, e, f, g)
    },
    end: function() {
        this._renderCmd.end()
    },
    clear: function(a, b, c, d) {
        this.beginWithClear(a, b, c, d);
        this.end()
    },
    clearRect: function(a, b, c, d) {
        this._renderCmd.clearRect(a, b, c, d)
    },
    clearDepth: function(a) {
        this._renderCmd.clearDepth(a)
    },
    clearStencil: function(a) {
        this._renderCmd.clearStencil(a)
    },
    getClearFlags: function() {
        return this.clearFlags
    },
    setClearFlags: function(a) {
        this.clearFlags = a
    },
    getClearColor: function() {
        return this._clearColor
    },
    setClearColor: function(a) {
        var b = this._clearColor;
        b.r = a.r;
        b.g = a.g;
        b.b = a.b;
        b.a = a.a;
        this._renderCmd.updateClearColor(a)
    },
    getClearDepth: function() {
        return this.clearDepthVal
    },
    setClearDepth: function(a) {
        this.clearDepthVal = a
    },
    getClearStencil: function() {
        return this.clearStencilVal
    },
    setClearStencil: function(a) {
        this.clearStencilVal = a
    },
    isAutoDraw: function() {
        return this.autoDraw
    },
    setAutoDraw: function(a) {
        this.autoDraw = a
    },
    saveToFile: function(a, b) {
        cc.log("saveToFile isn't supported on Cocos2d-Html5")
    },
    newCCImage: function(a) {
        cc.log("saveToFile isn't supported on cocos2d-html5");
        return null
    },
    listenToBackground: function(a) {},
    listenToForeground: function(a) {}
});
_p = cc.RenderTexture.prototype;
cc.defineGetterSetter(_p, "clearColorVal", _p.getClearColor, _p.setClearColor);
cc.RenderTexture.create = function(a, b, c, d) {
    return new cc.RenderTexture(a, b, c, d)
}; (function() {
    cc.RenderTexture.CanvasRenderCmd = function(a) {
        this._rootCtor(a);
        this._needDraw = !1;
        this._clearColorStr = "rgba(255,255,255,1)";
        this._cacheCanvas = document.createElement("canvas");
        this._cacheContext = new cc.CanvasContextWrapper(this._cacheCanvas.getContext("2d"))
    };
    var a = cc.RenderTexture.CanvasRenderCmd.prototype = Object.create(cc.Node.CanvasRenderCmd.prototype);
    a.constructor = cc.RenderTexture.CanvasRenderCmd;
    a.cleanup = function() {
        this._cacheCanvas = this._cacheContext = null
    };
    a.clearStencil = function(a) {};
    a.setVirtualViewport = function(a, c, d) {};
    a.updateClearColor = function(a) {
        this._clearColorStr = "rgba(" + (0 | a.r) + "," + (0 | a.g) + "," + (0 | a.b) + "," + a.a / 255 + ")"
    };
    a.initWithWidthAndHeight = function(a, c, d, e) {
        d = this._node;
        e = this._cacheCanvas;
        var f = cc.contentScaleFactor();
        e.width = 0 | a * f;
        e.height = 0 | c * f;
        a = new cc.Texture2D;
        a.initWithElement(e);
        a.handleLoadedTexture();
        a = d.sprite = new cc.Sprite(a);
        a.setBlendFunc(cc.ONE, cc.ONE_MINUS_SRC_ALPHA);
        d.autoDraw = !1;
        d.addChild(a);
        return ! 0
    };
    a.begin = function() {};
    a._beginWithClear = function(a, c, d, e, f, g, h) {
        a = a || 0;
        c = c || 0;
        d = d || 0;
        e = isNaN(e) ? 255 : e;
        f = this._cacheContext.getContext();
        g = this._cacheCanvas;
        f.setTransform(1, 0, 0, 1, 0, 0);
        this._cacheContext.setFillStyle("rgba(" + (0 | a) + "," + (0 | c) + "," + (0 | d) + "," + e / 255 + ")");
        f.clearRect(0, 0, g.width, g.height);
        f.fillRect(0, 0, g.width, g.height)
    };
    a.end = function() {
        var a = this._node,
        c = cc.contentScaleFactor();
        cc.renderer._renderingToCacheCanvas(this._cacheContext, a.__instanceId, c, c);
        a = a.sprite._renderCmd;
        a._notifyRegionStatus && a._notifyRegionStatus(cc.Node.CanvasRenderCmd.RegionStatus.Dirty)
    };
    a.clearRect = function(a, c, d, e) {
        this._cacheContext.clearRect(a, c, d, -e)
    };
    a.clearDepth = function(a) {
        cc.log("clearDepth isn't supported on Cocos2d-Html5")
    }
})(); (function() {
    cc.RenderTexture.WebGLRenderCmd = function(a) {
        this._rootCtor(a);
        this._needDraw = !0;
        this._depthRenderBuffer = this._textureCopy = this._oldFBO = this._fBO = null;
        this._rtTextureRect = new cc.Rect;
        this._fullRect = new cc.Rect;
        this._fullViewport = new cc.Rect
    };
    var a = cc.RenderTexture.WebGLRenderCmd.prototype = Object.create(cc.Node.WebGLRenderCmd.prototype);
    a.constructor = cc.RenderTexture.WebGLRenderCmd;
    a.setVirtualViewport = function(a, c, d) {
        this._rtTextureRect.x = a.x;
        this._rtTextureRect.y = a.y;
        this._fullRect = c;
        this._fullViewport = d
    };
    a.needDraw = function() {
        return this._needDraw && this._node.autoDraw
    };
    a.rendering = function(a) {
        var c = a || cc._renderContext;
        a = this._node;
        if (a.autoDraw) {
            a.begin();
            var d = a.clearFlags;
            if (d) {
                var e = [0, 0, 0, 0],
                f = 0,
                g = 0;
                d & c.COLOR_BUFFER_BIT && (e = c.getParameter(c.COLOR_CLEAR_VALUE), c.clearColor(a._clearColor.r / 255, a._clearColor.g / 255, a._clearColor.b / 255, a._clearColor.a / 255));
                d & c.DEPTH_BUFFER_BIT && (f = c.getParameter(c.DEPTH_CLEAR_VALUE), c.clearDepth(a.clearDepthVal));
                d & c.STENCIL_BUFFER_BIT && (g = c.getParameter(c.STENCIL_CLEAR_VALUE), c.clearStencil(a.clearStencilVal));
                c.clear(d);
                d & c.COLOR_BUFFER_BIT && c.clearColor(e[0], e[1], e[2], e[3]);
                d & c.DEPTH_BUFFER_BIT && c.clearDepth(f);
                d & c.STENCIL_BUFFER_BIT && c.clearStencil(g)
            }
            a.sortAllChildren();
            c = a._children;
            for (d = 0; d < c.length; d++) e = c[d],
            e !== a.sprite && e.visit(a.sprite);
            a.end()
        }
    };
    a.clearStencil = function(a) {
        var c = cc._renderContext,
        d = c.getParameter(c.STENCIL_CLEAR_VALUE);
        c.clearStencil(a);
        c.clear(c.STENCIL_BUFFER_BIT);
        c.clearStencil(d)
    };
    a.cleanup = function() {
        this._textureCopy = null;
        var a = cc._renderContext;
        a.deleteFramebuffer(this._fBO);
        this._depthRenderBuffer && a.deleteRenderbuffer(this._depthRenderBuffer)
    };
    a.updateClearColor = function(a) {};
    a.initWithWidthAndHeight = function(a, c, d, e) {
        var f = this._node;
        d === cc.Texture2D.PIXEL_FORMAT_A8 && cc.log("cc.RenderTexture._initWithWidthAndHeightForWebGL() : only RGB and RGBA formats are valid for a render texture;");
        var g = cc._renderContext,
        h = cc.contentScaleFactor();
        this._fullRect = new cc.Rect(0, 0, a, c);
        this._fullViewport = new cc.Rect(0, 0, a, c);
        a = 0 | a * h;
        c = 0 | c * h;
        this._oldFBO = g.getParameter(g.FRAMEBUFFER_BINDING);
        var k;
        cc.configuration.supportsNPOT() ? (h = a, k = c) : (h = cc.NextPOT(a), k = cc.NextPOT(c));
        for (var m = new Uint8Array(h * k * 4), r = 0; r < h * k * 4; r++) m[r] = 0;
        this._pixelFormat = d;
        r = f._texture = new cc.Texture2D;
        if (!f._texture) return ! 1;
        r.initWithData(m, f._pixelFormat, h, k, cc.size(a, c));
        d = g.getParameter(g.RENDERBUFFER_BINDING);
        if (cc.configuration.checkForGLExtension("GL_QCOM")) {
            this._textureCopy = new cc.Texture2D;
            if (!this._textureCopy) return ! 1;
            this._textureCopy.initWithData(m, f._pixelFormat, h, k, cc.size(a, c))
        }
        this._fBO = g.createFramebuffer();
        g.bindFramebuffer(g.FRAMEBUFFER, this._fBO);
        g.framebufferTexture2D(g.FRAMEBUFFER, g.COLOR_ATTACHMENT0, g.TEXTURE_2D, r._webTextureObj, 0);
        0 !== e && (this._depthRenderBuffer = g.createRenderbuffer(), g.bindRenderbuffer(g.RENDERBUFFER, this._depthRenderBuffer), g.renderbufferStorage(g.RENDERBUFFER, e, h, k), e === g.DEPTH_STENCIL ? g.framebufferRenderbuffer(g.FRAMEBUFFER, g.DEPTH_STENCIL_ATTACHMENT, g.RENDERBUFFER, this._depthRenderBuffer) : e === g.STENCIL_INDEX || e === g.STENCIL_INDEX8 ? g.framebufferRenderbuffer(g.FRAMEBUFFER, g.STENCIL_ATTACHMENT, g.RENDERBUFFER, this._depthRenderBuffer) : e === g.DEPTH_COMPONENT16 && g.framebufferRenderbuffer(g.FRAMEBUFFER, g.DEPTH_ATTACHMENT, g.RENDERBUFFER, this._depthRenderBuffer));
        g.checkFramebufferStatus(g.FRAMEBUFFER) !== g.FRAMEBUFFER_COMPLETE && cc.log("Could not attach texture to the framebuffer");
        r.setAliasTexParameters();
        a = f.sprite = new cc.Sprite(r);
        a.scaleY = -1;
        a.setBlendFunc(g.ONE, g.ONE_MINUS_SRC_ALPHA);
        g.bindRenderbuffer(g.RENDERBUFFER, d);
        g.bindFramebuffer(g.FRAMEBUFFER, this._oldFBO);
        f.autoDraw = !1;
        f.addChild(a);
        return ! 0
    };
    a.begin = function() {
        var a = this._node;
        cc.kmGLMatrixMode(cc.KM_GL_PROJECTION);
        cc.kmGLPushMatrix();
        cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW);
        cc.kmGLPushMatrix();
        var c = cc._renderContext,
        d = cc.director;
        d.setProjection(d.getProjection());
        var e = a._texture.getContentSizeInPixels(),
        f = cc.director.getWinSizeInPixels(),
        d = f.width / e.width,
        e = f.height / e.height,
        d = cc.math.Matrix4.createOrthographicProjection( - 1 / d, 1 / d, -1 / e, 1 / e, -1, 1);
        cc.kmGLMultMatrix(d);
        d = new cc.Rect(0, 0, 0, 0);
        d.width = this._fullViewport.width;
        d.height = this._fullViewport.height;
        e = d.height / this._fullRect.height;
        d.x = d.width / this._fullRect.width * (this._fullRect.x - this._rtTextureRect.x);
        d.y = (this._fullRect.y - this._rtTextureRect.y) * e;
        c.viewport(d.x, d.y, d.width, d.height);
        this._oldFBO = c.getParameter(c.FRAMEBUFFER_BINDING);
        c.bindFramebuffer(c.FRAMEBUFFER, this._fBO);
        cc.configuration.checkForGLExtension("GL_QCOM") && (c.framebufferTexture2D(c.FRAMEBUFFER, c.COLOR_ATTACHMENT0, c.TEXTURE_2D, this._textureCopy._webTextureObj, 0), c.clear(c.COLOR_BUFFER_BIT | c.DEPTH_BUFFER_BIT), c.framebufferTexture2D(c.FRAMEBUFFER, c.COLOR_ATTACHMENT0, c.TEXTURE_2D, a._texture._webTextureObj, 0))
    };
    a._beginWithClear = function(a, c, d, e, f, g, h) {
        a /= 255;
        c /= 255;
        d /= 255;
        e /= 255;
        var k = cc._renderContext,
        m = [0, 0, 0, 0],
        r = 0,
        s = 0;
        h & k.COLOR_BUFFER_BIT && (m = k.getParameter(k.COLOR_CLEAR_VALUE), k.clearColor(a, c, d, e));
        h & k.DEPTH_BUFFER_BIT && (r = k.getParameter(k.DEPTH_CLEAR_VALUE), k.clearDepth(f));
        h & k.STENCIL_BUFFER_BIT && (s = k.getParameter(k.STENCIL_CLEAR_VALUE), k.clearStencil(g));
        k.clear(h);
        h & k.COLOR_BUFFER_BIT && k.clearColor(m[0], m[1], m[2], m[3]);
        h & k.DEPTH_BUFFER_BIT && k.clearDepth(r);
        h & k.STENCIL_BUFFER_BIT && k.clearStencil(s)
    };
    a.end = function() {
        cc.renderer._renderingToBuffer(this._node.__instanceId);
        var a = cc._renderContext,
        c = cc.director;
        a.bindFramebuffer(a.FRAMEBUFFER, this._oldFBO);
        c.setViewport();
        cc.kmGLMatrixMode(cc.KM_GL_PROJECTION);
        cc.kmGLPopMatrix();
        cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW);
        cc.kmGLPopMatrix()
    };
    a.clearRect = function(a, c, d, e) {};
    a.clearDepth = function(a) {
        var c = this._node;
        c.begin();
        var d = cc._renderContext,
        e = d.getParameter(d.DEPTH_CLEAR_VALUE);
        d.clearDepth(a);
        d.clear(d.DEPTH_BUFFER_BIT);
        d.clearDepth(e);
        c.end()
    }
})();
cc.DrawNode = cc.Node.extend({
    _buffer: null,
    _blendFunc: null,
    _lineWidth: 1,
    _drawColor: null,
    getBlendFunc: function() {
        return this._blendFunc
    },
    setBlendFunc: function(a, b) {
        void 0 === b ? (this._blendFunc.src = a.src, this._blendFunc.dst = a.dst) : (this._blendFunc.src = a, this._blendFunc.dst = b)
    },
    setLineWidth: function(a) {
        this._lineWidth = a
    },
    getLineWidth: function() {
        return this._lineWidth
    },
    setDrawColor: function(a) {
        var b = this._drawColor;
        b.r = a.r;
        b.g = a.g;
        b.b = a.b;
        b.a = null == a.a ? 255 : a.a
    },
    getDrawColor: function() {
        return cc.color(this._drawColor.r, this._drawColor.g, this._drawColor.b, this._drawColor.a)
    }
});
cc.DrawNode.create = function() {
    return new cc.DrawNode
};
cc.DrawNode.TYPE_DOT = 0;
cc.DrawNode.TYPE_SEGMENT = 1;
cc.DrawNode.TYPE_POLY = 2;
cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,
function() {
    if (cc._renderType === cc.game.RENDER_TYPE_CANVAS) cc._DrawNodeElement = function(a, b, c, d, e, f, g, h, k) {
        this.type = a;
        this.verts = b || null;
        this.fillColor = c || null;
        this.lineWidth = d || 0;
        this.lineColor = e || null;
        this.lineCap = f || "butt";
        this.isClosePolygon = g || !1;
        this.isFill = h || !1;
        this.isStroke = k || !1
    },
    cc.extend(cc.DrawNode.prototype, {
        _className: "DrawNodeCanvas",
        ctor: function() {
            cc.Node.prototype.ctor.call(this);
            var a = this._renderCmd;
            a._buffer = this._buffer = [];
            a._drawColor = this._drawColor = cc.color(255, 255, 255, 255);
            a._blendFunc = this._blendFunc = new cc.BlendFunc(cc.SRC_ALPHA, cc.ONE_MINUS_SRC_ALPHA);
            this.init();
            this._localBB = new cc.Rect
        },
        setLocalBB: function(a, b, c, d) {
            var e = this._localBB;
            void 0 === b ? (e.x = a.x, e.y = a.y, e.width = a.width, e.height = a.height) : (e.x = a, e.y = b, e.width = c, e.height = d)
        },
        drawRect: function(a, b, c, d, e) {
            d = null == d ? this._lineWidth: d;
            e = e || this.getDrawColor();
            null == e.a && (e.a = 255);
            a = [a, cc.p(b.x, a.y), b, cc.p(a.x, b.y)];
            b = new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);
            b.verts = a;
            b.lineWidth = d;
            b.lineColor = e;
            b.isClosePolygon = !0;
            b.isStroke = !0;
            b.lineCap = "butt";
            if (b.fillColor = c) null == c.a && (c.a = 255),
            b.isFill = !0;
            this._buffer.push(b)
        },
        drawCircle: function(a, b, c, d, e, f, g) {
            f = f || this._lineWidth;
            g = g || this.getDrawColor();
            null == g.a && (g.a = 255);
            for (var h = 2 * Math.PI / d,
            k = [], m = 0; m <= d; m++) {
                var z = m * h,
                A = b * Math.cos(z + c) + a.x,
                z = b * Math.sin(z + c) + a.y;
                k.push(cc.p(A, z))
            }
            e && k.push(cc.p(a.x, a.y));
            a = new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);
            a.verts = k;
            a.lineWidth = f;
            a.lineColor = g;
            a.isClosePolygon = !0;
            a.isStroke = !0;
            this._buffer.push(a)
        },
        drawQuadBezier: function(a, b, c, d, e, f) {
            e = e || this._lineWidth;
            f = f || this.getDrawColor();
            null == f.a && (f.a = 255);
            for (var g = [], h = 0, k = 0; k < d; k++) {
                var m = Math.pow(1 - h, 2) * a.x + 2 * (1 - h) * h * b.x + h * h * c.x,
                z = Math.pow(1 - h, 2) * a.y + 2 * (1 - h) * h * b.y + h * h * c.y;
                g.push(cc.p(m, z));
                h += 1 / d
            }
            g.push(cc.p(c.x, c.y));
            a = new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);
            a.verts = g;
            a.lineWidth = e;
            a.lineColor = f;
            a.isStroke = !0;
            a.lineCap = "round";
            this._buffer.push(a)
        },
        drawCubicBezier: function(a, b, c, d, e, f, g) {
            f = f || this._lineWidth;
            g = g || this.getDrawColor();
            null == g.a && (g.a = 255);
            for (var h = [], k = 0, m = 0; m < e; m++) {
                var z = Math.pow(1 - k, 3) * a.x + 3 * Math.pow(1 - k, 2) * k * b.x + 3 * (1 - k) * k * k * c.x + k * k * k * d.x,
                A = Math.pow(1 - k, 3) * a.y + 3 * Math.pow(1 - k, 2) * k * b.y + 3 * (1 - k) * k * k * c.y + k * k * k * d.y;
                h.push(cc.p(z, A));
                k += 1 / e
            }
            h.push(cc.p(d.x, d.y));
            a = new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);
            a.verts = h;
            a.lineWidth = f;
            a.lineColor = g;
            a.isStroke = !0;
            a.lineCap = "round";
            this._buffer.push(a)
        },
        drawCatmullRom: function(a, b, c, d) {
            this.drawCardinalSpline(a, 0.5, b, c, d)
        },
        drawCardinalSpline: function(a, b, c, d, e) {
            d = d || this._lineWidth;
            e = e || this.getDrawColor();
            null == e.a && (e.a = 255);
            for (var f = [], g, h, k = 1 / a.length, m = 0; m < c + 1; m++) h = m / c,
            1 === h ? (g = a.length - 1, h = 1) : (g = 0 | h / k, h = (h - k * g) / k),
            g = cc.cardinalSplineAt(cc.getControlPointAt(a, g - 1), cc.getControlPointAt(a, g - 0), cc.getControlPointAt(a, g + 1), cc.getControlPointAt(a, g + 2), b, h),
            f.push(g);
            a = new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);
            a.verts = f;
            a.lineWidth = d;
            a.lineColor = e;
            a.isStroke = !0;
            a.lineCap = "round";
            this._buffer.push(a)
        },
        drawDot: function(a, b, c) {
            c = c || this.getDrawColor();
            null == c.a && (c.a = 255);
            var d = new cc._DrawNodeElement(cc.DrawNode.TYPE_DOT);
            d.verts = [a];
            d.lineWidth = b;
            d.fillColor = c;
            this._buffer.push(d)
        },
        drawDots: function(a, b, c) {
            if (a && 0 != a.length) {
                c = c || this.getDrawColor();
                null == c.a && (c.a = 255);
                for (var d = 0,
                e = a.length; d < e; d++) this.drawDot(a[d], b, c)
            }
        },
        drawSegment: function(a, b, c, d) {
            c = c || this._lineWidth;
            d = d || this.getDrawColor();
            null == d.a && (d.a = 255);
            var e = new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);
            e.verts = [a, b];
            e.lineWidth = 2 * c;
            e.lineColor = d;
            e.isStroke = !0;
            e.lineCap = "round";
            this._buffer.push(e)
        },
        drawPoly_: function(a, b, c, d) {
            c = null == c ? this._lineWidth: c;
            d = d || this.getDrawColor();
            null == d.a && (d.a = 255);
            var e = new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);
            e.verts = a;
            e.fillColor = b;
            e.lineWidth = c;
            e.lineColor = d;
            e.isClosePolygon = !0;
            e.isStroke = !0;
            e.lineCap = "round";
            b && (e.isFill = !0);
            this._buffer.push(e)
        },
        drawPoly: function(a, b, c, d) {
            for (var e = [], f = 0; f < a.length; f++) e.push(cc.p(a[f].x, a[f].y));
            return this.drawPoly_(e, b, c, d)
        },
        clear: function() {
            this._buffer.length = 0
        },
        _createRenderCmd: function() {
            return new cc.DrawNode.CanvasRenderCmd(this)
        }
    });
    else if (cc._renderType === cc.game.RENDER_TYPE_WEBGL) {
        var a = null,
        b = [],
        c = cc.p(),
        d = cc.p(),
        e = new Uint32Array(1),
        f = cc.p(),
        g = cc.p(),
        h = cc.p(),
        k = cc.p(),
        m = [];
        cc.extend(cc.DrawNode.prototype, {
            _bufferCapacity: 0,
            _vertexCount: 0,
            _offset: 0,
            _occupiedSize: 0,
            _f32Buffer: null,
            _ui32Buffer: null,
            _dirty: !1,
            _className: "DrawNodeWebGL",
            manualRelease: !1,
            ctor: function(b, c) {
                cc.Node.prototype.ctor.call(this);
                a || (a = new GlobalVertexBuffer(cc._renderContext, 20 * cc.DRAWNODE_TOTAL_VERTICES));
                this._renderCmd._shaderProgram = cc.shaderCache.programForKey(cc.SHADER_POSITION_LENGTHTEXTURECOLOR);
                this._blendFunc = new cc.BlendFunc(cc.SRC_ALPHA, cc.ONE_MINUS_SRC_ALPHA);
                this._drawColor = cc.color(255, 255, 255, 255);
                this._bufferCapacity = b || 64;
                this.manualRelease = c;
                this._dirty = !0
            },
            onEnter: function() {
                cc.Node.prototype.onEnter.call(this);
                this._occupiedSize < this._bufferCapacity && this._ensureCapacity(this._bufferCapacity)
            },
            onExit: function() {
                this.manualRelease || this.release();
                cc.Node.prototype.onExit.call(this)
            },
            release: function() {
                0 < this._occupiedSize && (this._vertexCount = 0, a.freeBuffer(this._offset, 20 * this._occupiedSize), this._occupiedSize = 0)
            },
            _ensureCapacity: function(b) {
                var c = this._occupiedSize,
                d = this._offset;
                if (b > c || this._bufferCapacity > c) {
                    var e = Math.max(Math.min(c + c, 200), b, this._bufferCapacity);
                    0 !== c && (a.freeBuffer(d, 20 * c), this._occupiedSize = 0);
                    b = this._offset = a.requestBuffer(20 * e);
                    if (0 <= b) {
                        this._occupiedSize = this._bufferCapacity = e;
                        this._f32Buffer = new Float32Array(a.data, b, 5 * this._occupiedSize);
                        this._ui32Buffer = new Uint32Array(a.data, b, 5 * this._occupiedSize);
                        if (0 !== c && d !== b) for (c = d / 4 + 5 * c, b /= 4, d /= 4; d < c; b++, d++) a.dataArray[b] = a.dataArray[d];
                        return ! 0
                    }
                    cc.warn("Failed to allocate buffer for DrawNode: buffer for " + e + " vertices requested");
                    return ! 1
                }
                return ! 0
            },
            drawRect: function(a, c, d, e, f) {
                e = null == e ? this._lineWidth: e;
                f = f || this._drawColor;
                b.length = 0;
                b.push(a.x, a.y, c.x, a.y, c.x, c.y, a.x, c.y);
                null == d ? this._drawSegments(b, e, f, !0) : this.drawPoly(b, d, e, f);
                b.length = 0
            },
            drawCircle: function(a, e, f, g, h, k, m) {
                k = k || this._lineWidth;
                m = m || this._drawColor;
                var y = 2 * Math.PI / g,
                w;
                for (w = b.length = 0; w <= g; w++) {
                    var B = w * y,
                    z = e * Math.cos(B + f) + a.x,
                    B = e * Math.sin(B + f) + a.y;
                    b.push(z, B)
                }
                h && b.push(a.x, a.y);
                k *= 0.5;
                w = 0;
                for (a = b.length - 2; w < a; w += 2) c.x = b[w],
                c.y = b[w + 1],
                d.x = b[w + 2],
                d.y = b[w + 3],
                this.drawSegment(c, d, k, m);
                b.length = 0
            },
            drawQuadBezier: function(a, c, d, e, f, g) {
                f = f || this._lineWidth;
                g = g || this._drawColor;
                for (var h = 0,
                k = b.length = 0; k < e; k++) {
                    var m = Math.pow(1 - h, 2) * a.x + 2 * (1 - h) * h * c.x + h * h * d.x,
                    B = Math.pow(1 - h, 2) * a.y + 2 * (1 - h) * h * c.y + h * h * d.y;
                    b.push(m, B);
                    h += 1 / e
                }
                b.push(d.x, d.y);
                this._drawSegments(b, f, g, !1);
                b.length = 0
            },
            drawCubicBezier: function(a, c, d, e, f, g, h) {
                g = g || this._lineWidth;
                h = h || this._drawColor;
                for (var k = 0,
                m = b.length = 0; m < f; m++) {
                    var B = Math.pow(1 - k, 3) * a.x + 3 * Math.pow(1 - k, 2) * k * c.x + 3 * (1 - k) * k * k * d.x + k * k * k * e.x,
                    z = Math.pow(1 - k, 3) * a.y + 3 * Math.pow(1 - k, 2) * k * c.y + 3 * (1 - k) * k * k * d.y + k * k * k * e.y;
                    b.push(B, z);
                    k += 1 / f
                }
                b.push(e.x, e.y);
                this._drawSegments(b, g, h, !1);
                b.length = 0
            },
            drawCatmullRom: function(a, b, c, d) {
                this.drawCardinalSpline(a, 0.5, b, c, d)
            },
            drawCardinalSpline: function(a, e, f, g, h) {
                g = g || this._lineWidth;
                h = h || this._drawColor;
                for (var k, m, y = 1 / a.length,
                w = b.length = 0; w < f + 1; w++) m = w / f,
                1 === m ? (k = a.length - 1, m = 1) : (k = 0 | m / y, m = (m - y * k) / y),
                cc.cardinalSplineAt(cc.getControlPointAt(a, k - 1), cc.getControlPointAt(a, k - 0), cc.getControlPointAt(a, k + 1), cc.getControlPointAt(a, k + 2), e, m, c),
                b.push(c.x, c.y);
                g *= 0.5;
                a = 0;
                for (e = b.length - 2; a < e; a += 2) c.x = b[a],
                c.y = b[a + 1],
                d.x = b[a + 2],
                d.y = b[a + 3],
                this.drawSegment(c, d, g, h);
                b.length = 0
            },
            drawDots: function(a, b, c) {
                if (a && 0 !== a.length) {
                    c = c || this._drawColor;
                    for (var d = 0,
                    e = a.length; d < e; d++) this.drawDot(a[d], b, c)
                }
            },
            _render: function() {
                var b = cc._renderContext;
                0 > this._offset || 0 >= this._vertexCount || (this._dirty ? (a.updateSubData(this._offset, this._f32Buffer), this._dirty = !1) : b.bindBuffer(b.ARRAY_BUFFER, a.vertexBuffer), b.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION), b.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR), b.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS), b.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION, 2, b.FLOAT, !1, 20, 0), b.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR, 4, b.UNSIGNED_BYTE, !0, 20, 8), b.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS, 2, b.FLOAT, !1, 20, 12), b.drawArrays(b.TRIANGLES, this._offset / 20, this._vertexCount), cc.incrementGLDraws(1))
            },
            appendVertexData: function(a, b, c, d, f) {
                var g = this._f32Buffer,
                h = 5 * this._vertexCount;
                g[h] = a;
                g[h + 1] = b;
                e[0] = c.a << 24 | c.b << 16 | c.g << 8 | c.r;
                this._ui32Buffer[h + 2] = e[0];
                g[h + 3] = d;
                g[h + 4] = f;
                this._vertexCount++
            },
            drawDot: function(a, b, c) {
                c = c || this._drawColor;
                null == c.a && (c.a = 255);
                var d = a.x - b,
                e = a.y - b,
                f = a.x + b;
                a = a.y + b;
                this._ensureCapacity(this._vertexCount + 6) && (this.appendVertexData(d, e, c, -1, -1), this.appendVertexData(d, a, c, -1, 1), this.appendVertexData(f, a, c, 1, 1), this.appendVertexData(d, e, c, -1, -1), this.appendVertexData(f, a, c, 1, 1), this.appendVertexData(f, e, c, 1, -1), this._dirty = !0)
            },
            drawSegment: function(a, b, c, d) {
                d = d || this.getDrawColor();
                null == d.a && (d.a = 255);
                c = c || 0.5 * this._lineWidth;
                if (this._ensureCapacity(this._vertexCount + 18)) {
                    f.x = a.y - b.y;
                    f.y = b.x - a.x;
                    cc.pNormalizeIn(f);
                    g.x = -f.y;
                    g.y = f.x;
                    var e = c;
                    h.x = f.x * e;
                    h.y = f.y * e;
                    k.x = g.x * c;
                    k.y = g.y * c;
                    c = b.x + h.x - k.x;
                    var e = b.y + h.y - k.y,
                    m = f.x - g.x,
                    x = f.y - g.y,
                    y = b.x - h.x,
                    w = b.y - h.y,
                    B = -f.x,
                    z = -f.y,
                    A = b.x + h.x,
                    D = b.y + h.y,
                    C = f.x,
                    H = f.y,
                    E = a.x - h.x,
                    F = a.y - h.y,
                    G = a.x + h.x,
                    I = a.y + h.y,
                    K = f.x,
                    L = f.y,
                    J = a.x - h.x + k.x,
                    N = a.y - h.y + k.y,
                    O = g.x - f.x,
                    M = g.y - f.y,
                    P = a.x + h.x + k.x;
                    a = a.y + h.y + k.y;
                    var Q = f.x + g.x,
                    R = f.y + g.y;
                    this.appendVertexData(b.x - h.x - k.x, b.y - h.y - k.y, d, -(f.x + g.x), -(f.y + g.y));
                    this.appendVertexData(c, e, d, m, x);
                    this.appendVertexData(y, w, d, B, z);
                    this.appendVertexData(A, D, d, C, H);
                    this.appendVertexData(c, e, d, m, x);
                    this.appendVertexData(y, w, d, B, z);
                    this.appendVertexData(A, D, d, C, H);
                    this.appendVertexData(E, F, d, B, z);
                    this.appendVertexData(y, w, d, B, z);
                    this.appendVertexData(A, D, d, C, H);
                    this.appendVertexData(E, F, d, B, z);
                    this.appendVertexData(G, I, d, K, L);
                    this.appendVertexData(J, N, d, O, M);
                    this.appendVertexData(E, F, d, B, z);
                    this.appendVertexData(G, I, d, K, L);
                    this.appendVertexData(J, N, d, O, M);
                    this.appendVertexData(P, a, d, Q, R);
                    this.appendVertexData(G, I, d, K, L);
                    this._dirty = !0
                }
            },
            drawPoly: function(a, c, d, e) {
                if ("object" === typeof a[0]) {
                    for (var g = b.length = 0; g < a.length; g++) b.push(a[g].x, a[g].y);
                    a = b
                }
                if (null == c) this._drawSegments(a, d, e, !0);
                else {
                    null == c.a && (c.a = 255);
                    null == e.a && (e.a = 255);
                    d = null == d ? this._lineWidth: d;
                    d *= 0.5;
                    for (var k, x, y, w, B, z, A, D = a.length,
                    g = m.length = 0; g < D; g += 2) k = a[(g - 2 + D) % D],
                    x = a[(g - 1 + D) % D],
                    y = a[g],
                    w = a[g + 1],
                    B = a[(g + 2) % D],
                    z = a[(g + 3) % D],
                    f.x = x - w,
                    f.y = y - k,
                    h.x = w - z,
                    h.y = B - y,
                    cc.pNormalizeIn(f),
                    cc.pNormalizeIn(h),
                    w = f.x * h.x + f.y * h.y + 1,
                    A = (f.x + h.x) / w,
                    w = (f.y + h.y) / w,
                    m.push(A, w, h.x, h.y);
                    D /= 2;
                    A = 0 < d;
                    if (this._ensureCapacity(this._vertexCount + 3 * (3 * D - 2))) {
                        for (var C = !1 == A ? 0.5 : 0, g = 0; g < D - 2; g++) k = a[0] - m[0] * C,
                        x = a[1] - m[1] * C,
                        y = a[2 * g + 2] - m[4 * (g + 1)] * C,
                        w = a[2 * g + 3] - m[4 * (g + 1) + 1] * C,
                        B = a[2 * g + 4] - m[4 * (g + 2)] * C,
                        z = a[2 * g + 5] - m[4 * (g + 2) + 1] * C,
                        this.appendVertexData(k, x, c, 0, 0),
                        this.appendVertexData(y, w, c, 0, 0),
                        this.appendVertexData(B, z, c, 0, 0);
                        var H, E, F, G;
                        d = A ? d: 0.5;
                        c = A ? e: c;
                        for (g = 0; g < D; g++) e = (g + 1) % D,
                        k = a[2 * g],
                        x = a[2 * g + 1],
                        y = a[2 * e],
                        w = a[2 * e + 1],
                        f.x = m[4 * g + 2],
                        f.y = m[4 * g + 3],
                        h.x = A ? -f.x: 0,
                        h.y = A ? -f.y: 0,
                        H = m[4 * g],
                        E = m[4 * g + 1],
                        F = m[4 * e],
                        G = m[4 * e + 1],
                        e = k - H * d,
                        B = x - E * d,
                        z = y - F * d,
                        C = w - G * d,
                        k += H * d,
                        x += E * d,
                        y += F * d,
                        w += G * d,
                        this.appendVertexData(e, B, c, h.x, h.y),
                        this.appendVertexData(z, C, c, h.x, h.y),
                        this.appendVertexData(y, w, c, f.x, f.y),
                        this.appendVertexData(e, B, c, h.x, h.y),
                        this.appendVertexData(k, x, c, f.x, f.y),
                        this.appendVertexData(y, w, c, f.x, f.y);
                        m.length = 0;
                        b.length = 0;
                        this._dirty = !0
                    }
                }
            },
            _drawSegments: function(a, b, c, d) {
                b = null == b ? this._lineWidth: b;
                if (! (0 >= b)) {
                    c = c || this._drawColor;
                    null == c.a && (c.a = 255);
                    b *= 0.5;
                    var e, g, k, y, w, B, z, A = a.length;
                    for (z = m.length = 0; z < A; z += 2) e = a[(z - 2 + A) % A],
                    g = a[(z - 1 + A) % A],
                    k = a[z],
                    y = a[z + 1],
                    w = a[(z + 2) % A],
                    B = a[(z + 3) % A],
                    f.x = g - y,
                    f.y = k - e,
                    h.x = y - B,
                    h.y = w - k,
                    cc.pNormalizeIn(f),
                    cc.pNormalizeIn(h),
                    k = f.x * h.x + f.y * h.y + 1,
                    y = (f.x + h.x) / k,
                    k = (f.y + h.y) / k,
                    m.push(y, k, h.x, h.y);
                    A /= 2;
                    if (this._ensureCapacity(this._vertexCount + 3 * (3 * A - 2))) {
                        d = d ? A: A - 1;
                        var D, C, H, E, F, G;
                        for (z = 0; z < d; z++) w = (z + 1) % A,
                        e = a[2 * z],
                        g = a[2 * z + 1],
                        k = a[2 * w],
                        y = a[2 * w + 1],
                        f.x = m[4 * z + 2],
                        f.y = m[4 * z + 3],
                        D = m[4 * z],
                        C = m[4 * z + 1],
                        H = m[4 * w],
                        E = m[4 * w + 1],
                        w = e - D * b,
                        B = g - C * b,
                        F = k - H * b,
                        G = y - E * b,
                        e += D * b,
                        g += C * b,
                        k += H * b,
                        y += E * b,
                        this.appendVertexData(w, B, c, -f.x, -f.y),
                        this.appendVertexData(F, G, c, -f.x, -f.y),
                        this.appendVertexData(k, y, c, f.x, f.y),
                        this.appendVertexData(w, B, c, -f.x, -f.y),
                        this.appendVertexData(e, g, c, f.x, f.y),
                        this.appendVertexData(k, y, c, f.x, f.y);
                        m.length = 0;
                        this._dirty = !0
                    }
                }
            },
            clear: function() {
                this.release();
                this._dirty = !0
            },
            _createRenderCmd: function() {
                return new cc.DrawNode.WebGLRenderCmd(this)
            }
        })
    }
}); (function() {
    cc.DrawNode.CanvasRenderCmd = function(a) {
        this._rootCtor(a);
        this._needDraw = !0;
        this._blendFunc = this._drawColor = this._buffer = null
    };
    cc.DrawNode.CanvasRenderCmd.prototype = Object.create(cc.Node.CanvasRenderCmd.prototype);
    cc.DrawNode.CanvasRenderCmd.prototype.constructor = cc.DrawNode.CanvasRenderCmd;
    cc.DrawNode.CanvasRenderCmd.prototype.getLocalBB = function() {
        return this._node._localBB
    };
    cc.extend(cc.DrawNode.CanvasRenderCmd.prototype, {
        rendering: function(a, b, c) {
            a = a || cc._renderContext;
            a.getContext();
            var d = this._displayedOpacity / 255;
            if (0 !== d) {
                a.setTransform(this._worldTransform, b, c);
                a.setGlobalAlpha(d);
                this._blendFunc && this._blendFunc.src === cc.SRC_ALPHA && this._blendFunc.dst === cc.ONE && a.setCompositeOperation("lighter");
                for (var d = this._buffer,
                e = 0,
                f = d.length; e < f; e++) {
                    var g = d[e];
                    switch (g.type) {
                    case cc.DrawNode.TYPE_DOT:
                        this._drawDot(a, g, b, c);
                        break;
                    case cc.DrawNode.TYPE_SEGMENT:
                        this._drawSegment(a, g, b, c);
                        break;
                    case cc.DrawNode.TYPE_POLY:
                        this._drawPoly(a, g, b, c)
                    }
                }
            }
        },
        _drawDot: function(a, b) {
            var c = b.fillColor,
            d = b.verts[0],
            e = b.lineWidth,
            f = a.getContext();
            a.setFillStyle("rgba(" + (0 | c.r) + "," + (0 | c.g) + "," + (0 | c.b) + "," + c.a / 255 + ")");
            f.beginPath();
            f.arc(d.x, -d.y, e, 0, 2 * Math.PI, !1);
            f.closePath();
            f.fill()
        },
        _drawSegment: function(a, b, c) {
            var d = b.lineColor,
            e = b.verts[0],
            f = b.verts[1],
            g = b.lineWidth;
            b = b.lineCap;
            var h = a.getContext();
            a.setStrokeStyle("rgba(" + (0 | d.r) + "," + (0 | d.g) + "," + (0 | d.b) + "," + d.a / 255 + ")");
            h.lineWidth = g * c;
            h.beginPath();
            h.lineCap = b;
            h.moveTo(e.x, -e.y);
            h.lineTo(f.x, -f.y);
            h.stroke()
        },
        _drawPoly: function(a, b, c) {
            var d = b.verts,
            e = b.lineCap;
            if (null != d) {
                var f = b.fillColor,
                g = b.lineWidth,
                h = b.lineColor,
                k = b.isClosePolygon,
                m = b.isFill;
                b = b.isStroke;
                var r = a.getContext(),
                s = d[0];
                r.lineCap = e;
                f && a.setFillStyle("rgba(" + (0 | f.r) + "," + (0 | f.g) + "," + (0 | f.b) + "," + f.a / 255 + ")");
                g && (r.lineWidth = g * c);
                h && a.setStrokeStyle("rgba(" + (0 | h.r) + "," + (0 | h.g) + "," + (0 | h.b) + "," + h.a / 255 + ")");
                r.beginPath();
                r.moveTo(s.x, -s.y);
                a = 1;
                for (c = d.length; a < c; a++) r.lineTo(d[a].x, -d[a].y);
                k && r.closePath();
                m && r.fill();
                b && r.stroke()
            }
        }
    })
})(); (function() {
    cc.DrawNode.WebGLRenderCmd = function(a) {
        this._rootCtor(a);
        this._needDraw = !0;
        this._matrix = new cc.math.Matrix4;
        this._matrix.identity()
    };
    cc.DrawNode.WebGLRenderCmd.prototype = Object.create(cc.Node.WebGLRenderCmd.prototype);
    cc.DrawNode.WebGLRenderCmd.prototype.constructor = cc.DrawNode.WebGLRenderCmd;
    cc.DrawNode.WebGLRenderCmd.prototype.rendering = function(a) {
        a = this._node;
        if (0 < a._vertexCount) {
            var b = this._worldTransform;
            this._matrix.mat[0] = b.a;
            this._matrix.mat[4] = b.c;
            this._matrix.mat[12] = b.tx;
            this._matrix.mat[1] = b.b;
            this._matrix.mat[5] = b.d;
            this._matrix.mat[13] = b.ty;
            cc.glBlendFunc(a._blendFunc.src, a._blendFunc.dst);
            this._glProgramState.apply(this._matrix);
            a._render()
        }
    }
})();
cc.ACTION_TAG_INVALID = -1;
cc.Action = cc.Class.extend({
    originalTarget: null,
    target: null,
    tag: cc.ACTION_TAG_INVALID,
    ctor: function() {
        this.target = this.originalTarget = null;
        this.tag = cc.ACTION_TAG_INVALID
    },
    copy: function() {
        cc.log("copy is deprecated. Please use clone instead.");
        return this.clone()
    },
    clone: function() {
        var a = new cc.Action;
        a.originalTarget = null;
        a.target = null;
        a.tag = this.tag;
        return a
    },
    isDone: function() {
        return ! 0
    },
    startWithTarget: function(a) {
        this.target = this.originalTarget = a
    },
    stop: function() {
        this.target = null
    },
    step: function(a) {
        cc.log("[Action step]. override me")
    },
    update: function(a) {
        cc.log("[Action update]. override me")
    },
    getTarget: function() {
        return this.target
    },
    setTarget: function(a) {
        this.target = a
    },
    getOriginalTarget: function() {
        return this.originalTarget
    },
    setOriginalTarget: function(a) {
        this.originalTarget = a
    },
    getTag: function() {
        return this.tag
    },
    setTag: function(a) {
        this.tag = a
    },
    retain: function() {},
    release: function() {}
});
cc.action = function() {
    return new cc.Action
};
cc.Action.create = cc.action;
cc.FiniteTimeAction = cc.Action.extend({
    _duration: 0,
    ctor: function() {
        cc.Action.prototype.ctor.call(this);
        this._duration = 0
    },
    getDuration: function() {
        return this._duration * (this._timesForRepeat || 1)
    },
    setDuration: function(a) {
        this._duration = a
    },
    reverse: function() {
        cc.log("cocos2d: FiniteTimeAction#reverse: Implement me");
        return null
    },
    clone: function() {
        return new cc.FiniteTimeAction
    }
});
cc.Speed = cc.Action.extend({
    _speed: 0,
    _innerAction: null,
    ctor: function(a, b) {
        cc.Action.prototype.ctor.call(this);
        this._speed = 0;
        this._innerAction = null;
        a && this.initWithAction(a, b)
    },
    getSpeed: function() {
        return this._speed
    },
    setSpeed: function(a) {
        this._speed = a
    },
    initWithAction: function(a, b) {
        if (!a) throw Error("cc.Speed.initWithAction(): action must be non nil");
        this._innerAction = a;
        this._speed = b;
        return ! 0
    },
    clone: function() {
        var a = new cc.Speed;
        a.initWithAction(this._innerAction.clone(), this._speed);
        return a
    },
    startWithTarget: function(a) {
        cc.Action.prototype.startWithTarget.call(this, a);
        this._innerAction.startWithTarget(a)
    },
    stop: function() {
        this._innerAction.stop();
        cc.Action.prototype.stop.call(this)
    },
    step: function(a) {
        this._innerAction.step(a * this._speed)
    },
    isDone: function() {
        return this._innerAction.isDone()
    },
    reverse: function() {
        return new cc.Speed(this._innerAction.reverse(), this._speed)
    },
    setInnerAction: function(a) {
        this._innerAction !== a && (this._innerAction = a)
    },
    getInnerAction: function() {
        return this._innerAction
    }
});
cc.speed = function(a, b) {
    return new cc.Speed(a, b)
};
cc.Speed.create = cc.speed;
cc.Follow = cc.Action.extend({
    _followedNode: null,
    _boundarySet: !1,
    _boundaryFullyCovered: !1,
    _halfScreenSize: null,
    _fullScreenSize: null,
    _worldRect: null,
    leftBoundary: 0,
    rightBoundary: 0,
    topBoundary: 0,
    bottomBoundary: 0,
    ctor: function(a, b) {
        cc.Action.prototype.ctor.call(this);
        this._followedNode = null;
        this._boundaryFullyCovered = this._boundarySet = !1;
        this._fullScreenSize = this._halfScreenSize = null;
        this.bottomBoundary = this.topBoundary = this.rightBoundary = this.leftBoundary = 0;
        this._worldRect = cc.rect(0, 0, 0, 0);
        a && (b ? this.initWithTarget(a, b) : this.initWithTarget(a))
    },
    clone: function() {
        var a = new cc.Follow,
        b = this._worldRect,
        b = new cc.Rect(b.x, b.y, b.width, b.height);
        a.initWithTarget(this._followedNode, b);
        return a
    },
    isBoundarySet: function() {
        return this._boundarySet
    },
    setBoudarySet: function(a) {
        this._boundarySet = a
    },
    initWithTarget: function(a, b) {
        if (!a) throw Error("cc.Follow.initWithAction(): followedNode must be non nil");
        b = b || cc.rect(0, 0, 0, 0);
        this._followedNode = a;
        this._worldRect = b;
        this._boundarySet = !cc._rectEqualToZero(b);
        this._boundaryFullyCovered = !1;
        var c = cc.director.getWinSize();
        this._fullScreenSize = cc.p(c.width, c.height);
        this._halfScreenSize = cc.pMult(this._fullScreenSize, 0.5);
        this._boundarySet && (this.leftBoundary = -(b.x + b.width - this._fullScreenSize.x), this.rightBoundary = -b.x, this.topBoundary = -b.y, this.bottomBoundary = -(b.y + b.height - this._fullScreenSize.y), this.rightBoundary < this.leftBoundary && (this.rightBoundary = this.leftBoundary = (this.leftBoundary + this.rightBoundary) / 2), this.topBoundary < this.bottomBoundary && (this.topBoundary = this.bottomBoundary = (this.topBoundary + this.bottomBoundary) / 2), this.topBoundary === this.bottomBoundary && this.leftBoundary === this.rightBoundary && (this._boundaryFullyCovered = !0));
        return ! 0
    },
    step: function(a) {
        a = this._followedNode.x;
        var b = this._followedNode.y;
        a = this._halfScreenSize.x - a;
        b = this._halfScreenSize.y - b;
        this.target._renderCmd._dirtyFlag = 0;
        this._boundarySet ? this._boundaryFullyCovered || this.target.setPosition(cc.clampf(a, this.leftBoundary, this.rightBoundary), cc.clampf(b, this.bottomBoundary, this.topBoundary)) : this.target.setPosition(a, b)
    },
    isDone: function() {
        return ! this._followedNode.running
    },
    stop: function() {
        this.target = null;
        cc.Action.prototype.stop.call(this)
    }
});
cc.follow = function(a, b) {
    return new cc.Follow(a, b)
};
cc.Follow.create = cc.follow;
cc.ActionInterval = cc.FiniteTimeAction.extend({
    _elapsed: 0,
    _firstTick: !1,
    _easeList: null,
    _timesForRepeat: 1,
    _repeatForever: !1,
    _repeatMethod: !1,
    _speed: 1,
    _speedMethod: !1,
    ctor: function(a) {
        this._timesForRepeat = this._speed = 1;
        this._repeatForever = !1;
        this.MAX_VALUE = 2;
        this._speedMethod = this._repeatMethod = !1;
        cc.FiniteTimeAction.prototype.ctor.call(this);
        void 0 !== a && this.initWithDuration(a)
    },
    getElapsed: function() {
        return this._elapsed
    },
    initWithDuration: function(a) {
        this._duration = 0 === a ? cc.FLT_EPSILON: a;
        this._elapsed = 0;
        return this._firstTick = !0
    },
    isDone: function() {
        return this._elapsed >= this._duration
    },
    _cloneDecoration: function(a) {
        a._repeatForever = this._repeatForever;
        a._speed = this._speed;
        a._timesForRepeat = this._timesForRepeat;
        a._easeList = this._easeList;
        a._speedMethod = this._speedMethod;
        a._repeatMethod = this._repeatMethod
    },
    _reverseEaseList: function(a) {
        if (this._easeList) {
            a._easeList = [];
            for (var b = 0; b < this._easeList.length; b++) a._easeList.push(this._easeList[b].reverse())
        }
    },
    clone: function() {
        var a = new cc.ActionInterval(this._duration);
        this._cloneDecoration(a);
        return a
    },
    easing: function(a) {
        this._easeList ? this._easeList.length = 0 : this._easeList = [];
        for (var b = 0; b < arguments.length; b++) this._easeList.push(arguments[b]);
        return this
    },
    _computeEaseTime: function(a) {
        var b = this._easeList;
        if (!b || 0 === b.length) return a;
        for (var c = 0,
        d = b.length; c < d; c++) a = b[c].easing(a);
        return a
    },
    step: function(a) {
        this._firstTick ? (this._firstTick = !1, this._elapsed = 0) : this._elapsed += a;
        a = this._elapsed / (1.192092896E-7 < this._duration ? this._duration: 1.192092896E-7);
        a = 1 > a ? a: 1;
        this.update(0 < a ? a: 0);
        this._repeatMethod && 1 < this._timesForRepeat && this.isDone() && (this._repeatForever || this._timesForRepeat--, this.startWithTarget(this.target), this.step(this._elapsed - this._duration))
    },
    startWithTarget: function(a) {
        cc.Action.prototype.startWithTarget.call(this, a);
        this._elapsed = 0;
        this._firstTick = !0
    },
    reverse: function() {
        cc.log("cc.IntervalAction: reverse not implemented.");
        return null
    },
    setAmplitudeRate: function(a) {
        cc.log("cc.ActionInterval.setAmplitudeRate(): it should be overridden in subclass.")
    },
    getAmplitudeRate: function() {
        cc.log("cc.ActionInterval.getAmplitudeRate(): it should be overridden in subclass.");
        return 0
    },
    speed: function(a) {
        if (0 >= a) return cc.log("The speed parameter error"),
        this;
        this._speedMethod = !0;
        this._speed *= a;
        return this
    },
    getSpeed: function() {
        return this._speed
    },
    setSpeed: function(a) {
        this._speed = a;
        return this
    },
    repeat: function(a) {
        a = Math.round(a);
        if (isNaN(a) || 1 > a) return cc.log("The repeat parameter error"),
        this;
        this._repeatMethod = !0;
        this._timesForRepeat *= a;
        return this
    },
    repeatForever: function() {
        this._repeatMethod = !0;
        this._timesForRepeat = this.MAX_VALUE;
        this._repeatForever = !0;
        return this
    }
});
cc.actionInterval = function(a) {
    return new cc.ActionInterval(a)
};
cc.ActionInterval.create = cc.actionInterval;
cc.Sequence = cc.ActionInterval.extend({
    _actions: null,
    _split: null,
    _last: 0,
    ctor: function(a) {
        cc.ActionInterval.prototype.ctor.call(this);
        this._actions = [];
        var b = a instanceof Array ? a: arguments,
        c = b.length - 1;
        0 <= c && null == b[c] && cc.log("parameters should not be ending with null in Javascript");
        if (0 <= c) {
            for (var d = b[0], e = 1; e < c; e++) b[e] && (d = cc.Sequence._actionOneTwo(d, b[e]));
            this.initWithTwoActions(d, b[c])
        }
    },
    initWithTwoActions: function(a, b) {
        if (!a || !b) throw Error("cc.Sequence.initWithTwoActions(): arguments must all be non nil");
        this.initWithDuration(a._duration + b._duration);
        this._actions[0] = a;
        this._actions[1] = b;
        return ! 0
    },
    clone: function() {
        var a = new cc.Sequence;
        this._cloneDecoration(a);
        a.initWithTwoActions(this._actions[0].clone(), this._actions[1].clone());
        return a
    },
    startWithTarget: function(a) {
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        this._split = this._actions[0]._duration / this._duration;
        this._last = -1
    },
    stop: function() { - 1 !== this._last && this._actions[this._last].stop();
        cc.Action.prototype.stop.call(this)
    },
    update: function(a) {
        var b = 0,
        c = this._split,
        d = this._actions,
        e = this._last;
        a = this._computeEaseTime(a);
        a < c ? (a = 0 !== c ? a / c: 1, 0 === b && 1 === e && (d[1].update(0), d[1].stop())) : (b = 1, a = 1 === c ? 1 : (a - c) / (1 - c), -1 === e && (d[0].startWithTarget(this.target), d[0].update(1), d[0].stop()), e || (d[0].update(1), d[0].stop()));
        d = d[b];
        e === b && d.isDone() || (e !== b && d.startWithTarget(this.target), a *= d._timesForRepeat, d.update(1 < a ? a % 1 : a), this._last = b)
    },
    reverse: function() {
        var a = cc.Sequence._actionOneTwo(this._actions[1].reverse(), this._actions[0].reverse());
        this._cloneDecoration(a);
        this._reverseEaseList(a);
        return a
    }
});
cc.sequence = function(a) {
    var b = a instanceof Array ? a: arguments;
    0 < b.length && null == b[b.length - 1] && cc.log("parameters should not be ending with null in Javascript");
    for (var c, d, e, f; b && 0 < b.length;) for (d = Array.prototype.shift.call(b), f = d._timesForRepeat || 1, d._repeatMethod = !1, d._timesForRepeat = 1, e = 0, c || (c = d, e = 1), e; e < f; e++) c = cc.Sequence._actionOneTwo(c, d);
    return c
};
cc.Sequence.create = cc.sequence;
cc.Sequence._actionOneTwo = function(a, b) {
    var c = new cc.Sequence;
    c.initWithTwoActions(a, b);
    return c
};
cc.Repeat = cc.ActionInterval.extend({
    _times: 0,
    _total: 0,
    _nextDt: 0,
    _actionInstant: !1,
    _innerAction: null,
    ctor: function(a, b) {
        cc.ActionInterval.prototype.ctor.call(this);
        void 0 !== b && this.initWithAction(a, b)
    },
    initWithAction: function(a, b) {
        return this.initWithDuration(a._duration * b) ? (this._times = b, this._innerAction = a, a instanceof cc.ActionInstant && (this._actionInstant = !0, this._times -= 1), this._total = 0, !0) : !1
    },
    clone: function() {
        var a = new cc.Repeat;
        this._cloneDecoration(a);
        a.initWithAction(this._innerAction.clone(), this._times);
        return a
    },
    startWithTarget: function(a) {
        this._total = 0;
        this._nextDt = this._innerAction._duration / this._duration;
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        this._innerAction.startWithTarget(a)
    },
    stop: function() {
        this._innerAction.stop();
        cc.Action.prototype.stop.call(this)
    },
    update: function(a) {
        a = this._computeEaseTime(a);
        var b = this._innerAction,
        c = this._duration,
        d = this._times,
        e = this._nextDt;
        if (a >= e) {
            for (; a > e && this._total < d;) b.update(1),
            this._total++,
            b.stop(),
            b.startWithTarget(this.target),
            this._nextDt = e += b._duration / c;
            1 <= a && this._total < d && this._total++;
            this._actionInstant || (this._total === d ? (b.update(1), b.stop()) : b.update(a - (e - b._duration / c)))
        } else b.update(a * d % 1)
    },
    isDone: function() {
        return this._total === this._times
    },
    reverse: function() {
        var a = new cc.Repeat(this._innerAction.reverse(), this._times);
        this._cloneDecoration(a);
        this._reverseEaseList(a);
        return a
    },
    setInnerAction: function(a) {
        this._innerAction !== a && (this._innerAction = a)
    },
    getInnerAction: function() {
        return this._innerAction
    }
});
cc.repeat = function(a, b) {
    return new cc.Repeat(a, b)
};
cc.Repeat.create = cc.repeat;
cc.RepeatForever = cc.ActionInterval.extend({
    _innerAction: null,
    ctor: function(a) {
        cc.ActionInterval.prototype.ctor.call(this);
        this._innerAction = null;
        a && this.initWithAction(a)
    },
    initWithAction: function(a) {
        if (!a) throw Error("cc.RepeatForever.initWithAction(): action must be non null");
        this._innerAction = a;
        return ! 0
    },
    clone: function() {
        var a = new cc.RepeatForever;
        this._cloneDecoration(a);
        a.initWithAction(this._innerAction.clone());
        return a
    },
    startWithTarget: function(a) {
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        this._innerAction.startWithTarget(a)
    },
    step: function(a) {
        var b = this._innerAction;
        b.step(a);
        b.isDone() && (b.startWithTarget(this.target), b.step(b.getElapsed() - b._duration))
    },
    isDone: function() {
        return ! 1
    },
    reverse: function() {
        var a = new cc.RepeatForever(this._innerAction.reverse());
        this._cloneDecoration(a);
        this._reverseEaseList(a);
        return a
    },
    setInnerAction: function(a) {
        this._innerAction !== a && (this._innerAction = a)
    },
    getInnerAction: function() {
        return this._innerAction
    }
});
cc.repeatForever = function(a) {
    return new cc.RepeatForever(a)
};
cc.RepeatForever.create = cc.repeatForever;
cc.Spawn = cc.ActionInterval.extend({
    _one: null,
    _two: null,
    ctor: function(a) {
        cc.ActionInterval.prototype.ctor.call(this);
        this._two = this._one = null;
        var b, c, d;
        if (a instanceof Array) c = a;
        else for (c = Array(arguments.length), b = 0; b < arguments.length; ++b) c[b] = arguments[b];
        d = c.length - 1;
        0 <= d && null == c[d] && cc.log("parameters should not be ending with null in Javascript");
        if (0 <= d) {
            var e = c[0];
            for (b = 1; b < d; b++) c[b] && (e = cc.Spawn._actionOneTwo(e, c[b]));
            this.initWithTwoActions(e, c[d])
        }
    },
    initWithTwoActions: function(a, b) {
        if (!a || !b) throw Error("cc.Spawn.initWithTwoActions(): arguments must all be non null");
        var c = !1,
        d = a._duration,
        e = b._duration;
        this.initWithDuration(Math.max(d, e)) && (this._one = a, this._two = b, d > e ? this._two = cc.Sequence._actionOneTwo(b, cc.delayTime(d - e)) : d < e && (this._one = cc.Sequence._actionOneTwo(a, cc.delayTime(e - d))), c = !0);
        return c
    },
    clone: function() {
        var a = new cc.Spawn;
        this._cloneDecoration(a);
        a.initWithTwoActions(this._one.clone(), this._two.clone());
        return a
    },
    startWithTarget: function(a) {
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        this._one.startWithTarget(a);
        this._two.startWithTarget(a)
    },
    stop: function() {
        this._one.stop();
        this._two.stop();
        cc.Action.prototype.stop.call(this)
    },
    update: function(a) {
        a = this._computeEaseTime(a);
        this._one && this._one.update(a);
        this._two && this._two.update(a)
    },
    reverse: function() {
        var a = cc.Spawn._actionOneTwo(this._one.reverse(), this._two.reverse());
        this._cloneDecoration(a);
        this._reverseEaseList(a);
        return a
    }
});
cc.spawn = function(a) {
    var b = a instanceof Array ? a: arguments;
    0 < b.length && null == b[b.length - 1] && cc.log("parameters should not be ending with null in Javascript");
    for (var c = b[0], d = 1; d < b.length; d++) null != b[d] && (c = cc.Spawn._actionOneTwo(c, b[d]));
    return c
};
cc.Spawn.create = cc.spawn;
cc.Spawn._actionOneTwo = function(a, b) {
    var c = new cc.Spawn;
    c.initWithTwoActions(a, b);
    return c
};
cc.RotateTo = cc.ActionInterval.extend({
    _dstAngleX: 0,
    _startAngleX: 0,
    _diffAngleX: 0,
    _dstAngleY: 0,
    _startAngleY: 0,
    _diffAngleY: 0,
    ctor: function(a, b, c) {
        cc.ActionInterval.prototype.ctor.call(this);
        void 0 !== b && this.initWithDuration(a, b, c)
    },
    initWithDuration: function(a, b, c) {
        return cc.ActionInterval.prototype.initWithDuration.call(this, a) ? (this._dstAngleX = b || 0, this._dstAngleY = void 0 !== c ? c: this._dstAngleX, !0) : !1
    },
    clone: function() {
        var a = new cc.RotateTo;
        this._cloneDecoration(a);
        a.initWithDuration(this._duration, this._dstAngleX, this._dstAngleY);
        return a
    },
    startWithTarget: function(a) {
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        var b = a.rotationX % 360,
        c = this._dstAngleX - b;
        180 < c && (c -= 360); - 180 > c && (c += 360);
        this._startAngleX = b;
        this._diffAngleX = c;
        this._startAngleY = a.rotationY % 360;
        a = this._dstAngleY - this._startAngleY;
        180 < a && (a -= 360); - 180 > a && (a += 360);
        this._diffAngleY = a
    },
    reverse: function() {
        cc.log("cc.RotateTo.reverse(): it should be overridden in subclass.")
    },
    update: function(a) {
        a = this._computeEaseTime(a);
        this.target && (this.target.rotationX = this._startAngleX + this._diffAngleX * a, this.target.rotationY = this._startAngleY + this._diffAngleY * a)
    }
});
cc.rotateTo = function(a, b, c) {
    return new cc.RotateTo(a, b, c)
};
cc.RotateTo.create = cc.rotateTo;
cc.RotateBy = cc.ActionInterval.extend({
    _angleX: 0,
    _startAngleX: 0,
    _angleY: 0,
    _startAngleY: 0,
    ctor: function(a, b, c) {
        cc.ActionInterval.prototype.ctor.call(this);
        void 0 !== b && this.initWithDuration(a, b, c)
    },
    initWithDuration: function(a, b, c) {
        return cc.ActionInterval.prototype.initWithDuration.call(this, a) ? (this._angleX = b || 0, this._angleY = c || this._angleX, !0) : !1
    },
    clone: function() {
        var a = new cc.RotateBy;
        this._cloneDecoration(a);
        a.initWithDuration(this._duration, this._angleX, this._angleY);
        return a
    },
    startWithTarget: function(a) {
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        this._startAngleX = a.rotationX;
        this._startAngleY = a.rotationY
    },
    update: function(a) {
        a = this._computeEaseTime(a);
        this.target && (this.target.rotationX = this._startAngleX + this._angleX * a, this.target.rotationY = this._startAngleY + this._angleY * a)
    },
    reverse: function() {
        var a = new cc.RotateBy(this._duration, -this._angleX, -this._angleY);
        this._cloneDecoration(a);
        this._reverseEaseList(a);
        return a
    }
});
cc.rotateBy = function(a, b, c) {
    return new cc.RotateBy(a, b, c)
};
cc.RotateBy.create = cc.rotateBy;
cc.MoveBy = cc.ActionInterval.extend({
    _positionDelta: null,
    _startPosition: null,
    _previousPosition: null,
    ctor: function(a, b, c) {
        cc.ActionInterval.prototype.ctor.call(this);
        this._positionDelta = cc.p(0, 0);
        this._startPosition = cc.p(0, 0);
        this._previousPosition = cc.p(0, 0);
        void 0 !== b && this.initWithDuration(a, b, c)
    },
    initWithDuration: function(a, b, c) {
        return cc.ActionInterval.prototype.initWithDuration.call(this, a) ? (void 0 !== b.x && (c = b.y, b = b.x), this._positionDelta.x = b, this._positionDelta.y = c, !0) : !1
    },
    clone: function() {
        var a = new cc.MoveBy;
        this._cloneDecoration(a);
        a.initWithDuration(this._duration, this._positionDelta);
        return a
    },
    startWithTarget: function(a) {
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        var b = a.getPositionX();
        a = a.getPositionY();
        this._previousPosition.x = b;
        this._previousPosition.y = a;
        this._startPosition.x = b;
        this._startPosition.y = a
    },
    update: function(a) {
        a = this._computeEaseTime(a);
        if (this.target) {
            var b = this._positionDelta.x * a;
            a *= this._positionDelta.y;
            var c = this._startPosition;
            if (cc.ENABLE_STACKABLE_ACTIONS) {
                var d = this.target.getPositionX(),
                e = this.target.getPositionY(),
                f = this._previousPosition;
                c.x = c.x + d - f.x;
                c.y = c.y + e - f.y;
                b += c.x;
                a += c.y;
                f.x = b;
                f.y = a;
                this.target.setPosition(b, a)
            } else this.target.setPosition(c.x + b, c.y + a)
        }
    },
    reverse: function() {
        var a = new cc.MoveBy(this._duration, cc.p( - this._positionDelta.x, -this._positionDelta.y));
        this._cloneDecoration(a);
        this._reverseEaseList(a);
        return a
    }
});
cc.moveBy = function(a, b, c) {
    return new cc.MoveBy(a, b, c)
};
cc.MoveBy.create = cc.moveBy;
cc.MoveTo = cc.MoveBy.extend({
    _endPosition: null,
    ctor: function(a, b, c) {
        cc.MoveBy.prototype.ctor.call(this);
        this._endPosition = cc.p(0, 0);
        void 0 !== b && this.initWithDuration(a, b, c)
    },
    initWithDuration: function(a, b, c) {
        return cc.MoveBy.prototype.initWithDuration.call(this, a, b, c) ? (void 0 !== b.x && (c = b.y, b = b.x), this._endPosition.x = b, this._endPosition.y = c, !0) : !1
    },
    clone: function() {
        var a = new cc.MoveTo;
        this._cloneDecoration(a);
        a.initWithDuration(this._duration, this._endPosition);
        return a
    },
    startWithTarget: function(a) {
        cc.MoveBy.prototype.startWithTarget.call(this, a);
        this._positionDelta.x = this._endPosition.x - a.getPositionX();
        this._positionDelta.y = this._endPosition.y - a.getPositionY()
    }
});
cc.moveTo = function(a, b, c) {
    return new cc.MoveTo(a, b, c)
};
cc.MoveTo.create = cc.moveTo;
cc.SkewTo = cc.ActionInterval.extend({
    _skewX: 0,
    _skewY: 0,
    _startSkewX: 0,
    _startSkewY: 0,
    _endSkewX: 0,
    _endSkewY: 0,
    _deltaX: 0,
    _deltaY: 0,
    ctor: function(a, b, c) {
        cc.ActionInterval.prototype.ctor.call(this);
        void 0 !== c && this.initWithDuration(a, b, c)
    },
    initWithDuration: function(a, b, c) {
        var d = !1;
        cc.ActionInterval.prototype.initWithDuration.call(this, a) && (this._endSkewX = b, this._endSkewY = c, d = !0);
        return d
    },
    clone: function() {
        var a = new cc.SkewTo;
        this._cloneDecoration(a);
        a.initWithDuration(this._duration, this._endSkewX, this._endSkewY);
        return a
    },
    startWithTarget: function(a) {
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        this._startSkewX = a.skewX % 180;
        this._deltaX = this._endSkewX - this._startSkewX;
        180 < this._deltaX && (this._deltaX -= 360); - 180 > this._deltaX && (this._deltaX += 360);
        this._startSkewY = a.skewY % 360;
        this._deltaY = this._endSkewY - this._startSkewY;
        180 < this._deltaY && (this._deltaY -= 360); - 180 > this._deltaY && (this._deltaY += 360)
    },
    update: function(a) {
        a = this._computeEaseTime(a);
        this.target.skewX = this._startSkewX + this._deltaX * a;
        this.target.skewY = this._startSkewY + this._deltaY * a
    }
});
cc.skewTo = function(a, b, c) {
    return new cc.SkewTo(a, b, c)
};
cc.SkewTo.create = cc.skewTo;
cc.SkewBy = cc.SkewTo.extend({
    ctor: function(a, b, c) {
        cc.SkewTo.prototype.ctor.call(this);
        void 0 !== c && this.initWithDuration(a, b, c)
    },
    initWithDuration: function(a, b, c) {
        var d = !1;
        cc.SkewTo.prototype.initWithDuration.call(this, a, b, c) && (this._skewX = b, this._skewY = c, d = !0);
        return d
    },
    clone: function() {
        var a = new cc.SkewBy;
        this._cloneDecoration(a);
        a.initWithDuration(this._duration, this._skewX, this._skewY);
        return a
    },
    startWithTarget: function(a) {
        cc.SkewTo.prototype.startWithTarget.call(this, a);
        this._deltaX = this._skewX;
        this._deltaY = this._skewY;
        this._endSkewX = this._startSkewX + this._deltaX;
        this._endSkewY = this._startSkewY + this._deltaY
    },
    reverse: function() {
        var a = new cc.SkewBy(this._duration, -this._skewX, -this._skewY);
        this._cloneDecoration(a);
        this._reverseEaseList(a);
        return a
    }
});
cc.skewBy = function(a, b, c) {
    return new cc.SkewBy(a, b, c)
};
cc.SkewBy.create = cc.skewBy;
cc.JumpBy = cc.ActionInterval.extend({
    _startPosition: null,
    _delta: null,
    _height: 0,
    _jumps: 0,
    _previousPosition: null,
    ctor: function(a, b, c, d, e) {
        cc.ActionInterval.prototype.ctor.call(this);
        this._startPosition = cc.p(0, 0);
        this._previousPosition = cc.p(0, 0);
        this._delta = cc.p(0, 0);
        void 0 !== d && this.initWithDuration(a, b, c, d, e)
    },
    initWithDuration: function(a, b, c, d, e) {
        return cc.ActionInterval.prototype.initWithDuration.call(this, a) ? (void 0 === e && (e = d, d = c, c = b.y, b = b.x), this._delta.x = b, this._delta.y = c, this._height = d, this._jumps = e, !0) : !1
    },
    clone: function() {
        var a = new cc.JumpBy;
        this._cloneDecoration(a);
        a.initWithDuration(this._duration, this._delta, this._height, this._jumps);
        return a
    },
    startWithTarget: function(a) {
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        var b = a.getPositionX();
        a = a.getPositionY();
        this._previousPosition.x = b;
        this._previousPosition.y = a;
        this._startPosition.x = b;
        this._startPosition.y = a
    },
    update: function(a) {
        a = this._computeEaseTime(a);
        if (this.target) {
            var b = a * this._jumps % 1,
            b = 4 * this._height * b * (1 - b),
            b = b + this._delta.y * a;
            a *= this._delta.x;
            var c = this._startPosition;
            if (cc.ENABLE_STACKABLE_ACTIONS) {
                var d = this.target.getPositionX(),
                e = this.target.getPositionY(),
                f = this._previousPosition;
                c.x = c.x + d - f.x;
                c.y = c.y + e - f.y;
                a += c.x;
                b += c.y;
                f.x = a;
                f.y = b;
                this.target.setPosition(a, b)
            } else this.target.setPosition(c.x + a, c.y + b)
        }
    },
    reverse: function() {
        var a = new cc.JumpBy(this._duration, cc.p( - this._delta.x, -this._delta.y), this._height, this._jumps);
        this._cloneDecoration(a);
        this._reverseEaseList(a);
        return a
    }
});
cc.jumpBy = function(a, b, c, d, e) {
    return new cc.JumpBy(a, b, c, d, e)
};
cc.JumpBy.create = cc.jumpBy;
cc.JumpTo = cc.JumpBy.extend({
    _endPosition: null,
    ctor: function(a, b, c, d, e) {
        cc.JumpBy.prototype.ctor.call(this);
        this._endPosition = cc.p(0, 0);
        void 0 !== d && this.initWithDuration(a, b, c, d, e)
    },
    initWithDuration: function(a, b, c, d, e) {
        return cc.JumpBy.prototype.initWithDuration.call(this, a, b, c, d, e) ? (void 0 === e && (c = b.y, b = b.x), this._endPosition.x = b, this._endPosition.y = c, !0) : !1
    },
    startWithTarget: function(a) {
        cc.JumpBy.prototype.startWithTarget.call(this, a);
        this._delta.x = this._endPosition.x - this._startPosition.x;
        this._delta.y = this._endPosition.y - this._startPosition.y
    },
    clone: function() {
        var a = new cc.JumpTo;
        this._cloneDecoration(a);
        a.initWithDuration(this._duration, this._endPosition, this._height, this._jumps);
        return a
    }
});
cc.jumpTo = function(a, b, c, d, e) {
    return new cc.JumpTo(a, b, c, d, e)
};
cc.JumpTo.create = cc.jumpTo;
cc.bezierAt = function(a, b, c, d, e) {
    return Math.pow(1 - e, 3) * a + 3 * e * Math.pow(1 - e, 2) * b + 3 * Math.pow(e, 2) * (1 - e) * c + Math.pow(e, 3) * d
};
cc.BezierBy = cc.ActionInterval.extend({
    _config: null,
    _startPosition: null,
    _previousPosition: null,
    ctor: function(a, b) {
        cc.ActionInterval.prototype.ctor.call(this);
        this._config = [];
        this._startPosition = cc.p(0, 0);
        this._previousPosition = cc.p(0, 0);
        b && this.initWithDuration(a, b)
    },
    initWithDuration: function(a, b) {
        return cc.ActionInterval.prototype.initWithDuration.call(this, a) ? (this._config = b, !0) : !1
    },
    clone: function() {
        var a = new cc.BezierBy;
        this._cloneDecoration(a);
        for (var b = [], c = 0; c < this._config.length; c++) {
            var d = this._config[c];
            b.push(cc.p(d.x, d.y))
        }
        a.initWithDuration(this._duration, b);
        return a
    },
    startWithTarget: function(a) {
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        var b = a.getPositionX();
        a = a.getPositionY();
        this._previousPosition.x = b;
        this._previousPosition.y = a;
        this._startPosition.x = b;
        this._startPosition.y = a
    },
    update: function(a) {
        a = this._computeEaseTime(a);
        if (this.target) {
            var b = this._config,
            c = b[0].y,
            d = b[1].y,
            e = b[2].y,
            b = cc.bezierAt(0, b[0].x, b[1].x, b[2].x, a);
            a = cc.bezierAt(0, c, d, e, a);
            c = this._startPosition;
            if (cc.ENABLE_STACKABLE_ACTIONS) {
                var d = this.target.getPositionX(),
                e = this.target.getPositionY(),
                f = this._previousPosition;
                c.x = c.x + d - f.x;
                c.y = c.y + e - f.y;
                b += c.x;
                a += c.y;
                f.x = b;
                f.y = a;
                this.target.setPosition(b, a)
            } else this.target.setPosition(c.x + b, c.y + a)
        }
    },
    reverse: function() {
        var a = this._config,
        a = [cc.pAdd(a[1], cc.pNeg(a[2])), cc.pAdd(a[0], cc.pNeg(a[2])), cc.pNeg(a[2])],
        a = new cc.BezierBy(this._duration, a);
        this._cloneDecoration(a);
        this._reverseEaseList(a);
        return a
    }
});
cc.bezierBy = function(a, b) {
    return new cc.BezierBy(a, b)
};
cc.BezierBy.create = cc.bezierBy;
cc.BezierTo = cc.BezierBy.extend({
    _toConfig: null,
    ctor: function(a, b) {
        cc.BezierBy.prototype.ctor.call(this);
        this._toConfig = [];
        b && this.initWithDuration(a, b)
    },
    initWithDuration: function(a, b) {
        return cc.ActionInterval.prototype.initWithDuration.call(this, a) ? (this._toConfig = b, !0) : !1
    },
    clone: function() {
        var a = new cc.BezierTo;
        this._cloneDecoration(a);
        a.initWithDuration(this._duration, this._toConfig);
        return a
    },
    startWithTarget: function(a) {
        cc.BezierBy.prototype.startWithTarget.call(this, a);
        a = this._startPosition;
        var b = this._toConfig,
        c = this._config;
        c[0] = cc.pSub(b[0], a);
        c[1] = cc.pSub(b[1], a);
        c[2] = cc.pSub(b[2], a)
    }
});
cc.bezierTo = function(a, b) {
    return new cc.BezierTo(a, b)
};
cc.BezierTo.create = cc.bezierTo;
cc.ScaleTo = cc.ActionInterval.extend({
    _scaleX: 1,
    _scaleY: 1,
    _startScaleX: 1,
    _startScaleY: 1,
    _endScaleX: 0,
    _endScaleY: 0,
    _deltaX: 0,
    _deltaY: 0,
    ctor: function(a, b, c) {
        cc.ActionInterval.prototype.ctor.call(this);
        void 0 !== b && this.initWithDuration(a, b, c)
    },
    initWithDuration: function(a, b, c) {
        return cc.ActionInterval.prototype.initWithDuration.call(this, a) ? (this._endScaleX = b, this._endScaleY = null != c ? c: b, !0) : !1
    },
    clone: function() {
        var a = new cc.ScaleTo;
        this._cloneDecoration(a);
        a.initWithDuration(this._duration, this._endScaleX, this._endScaleY);
        return a
    },
    startWithTarget: function(a) {
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        this._startScaleX = a.scaleX;
        this._startScaleY = a.scaleY;
        this._deltaX = this._endScaleX - this._startScaleX;
        this._deltaY = this._endScaleY - this._startScaleY
    },
    update: function(a) {
        a = this._computeEaseTime(a);
        this.target && (this.target.scaleX = this._startScaleX + this._deltaX * a, this.target.scaleY = this._startScaleY + this._deltaY * a)
    }
});
cc.scaleTo = function(a, b, c) {
    return new cc.ScaleTo(a, b, c)
};
cc.ScaleTo.create = cc.scaleTo;
cc.ScaleBy = cc.ScaleTo.extend({
    startWithTarget: function(a) {
        cc.ScaleTo.prototype.startWithTarget.call(this, a);
        this._deltaX = this._startScaleX * this._endScaleX - this._startScaleX;
        this._deltaY = this._startScaleY * this._endScaleY - this._startScaleY
    },
    reverse: function() {
        var a = new cc.ScaleBy(this._duration, 1 / this._endScaleX, 1 / this._endScaleY);
        this._cloneDecoration(a);
        this._reverseEaseList(a);
        return a
    },
    clone: function() {
        var a = new cc.ScaleBy;
        this._cloneDecoration(a);
        a.initWithDuration(this._duration, this._endScaleX, this._endScaleY);
        return a
    }
});
cc.scaleBy = function(a, b, c) {
    return new cc.ScaleBy(a, b, c)
};
cc.ScaleBy.create = cc.scaleBy;
cc.Blink = cc.ActionInterval.extend({
    _times: 0,
    _originalState: !1,
    ctor: function(a, b) {
        cc.ActionInterval.prototype.ctor.call(this);
        void 0 !== b && this.initWithDuration(a, b)
    },
    initWithDuration: function(a, b) {
        return cc.ActionInterval.prototype.initWithDuration.call(this, a) ? (this._times = b, !0) : !1
    },
    clone: function() {
        var a = new cc.Blink;
        this._cloneDecoration(a);
        a.initWithDuration(this._duration, this._times);
        return a
    },
    update: function(a) {
        a = this._computeEaseTime(a);
        if (this.target && !this.isDone()) {
            var b = 1 / this._times;
            this.target.visible = a % b > b / 2
        }
    },
    startWithTarget: function(a) {
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        this._originalState = a.visible
    },
    stop: function() {
        this.target.visible = this._originalState;
        cc.ActionInterval.prototype.stop.call(this)
    },
    reverse: function() {
        var a = new cc.Blink(this._duration, this._times);
        this._cloneDecoration(a);
        this._reverseEaseList(a);
        return a
    }
});
cc.blink = function(a, b) {
    return new cc.Blink(a, b)
};
cc.Blink.create = cc.blink;
cc.FadeTo = cc.ActionInterval.extend({
    _toOpacity: 0,
    _fromOpacity: 0,
    ctor: function(a, b) {
        cc.ActionInterval.prototype.ctor.call(this);
        void 0 !== b && this.initWithDuration(a, b)
    },
    initWithDuration: function(a, b) {
        return cc.ActionInterval.prototype.initWithDuration.call(this, a) ? (this._toOpacity = b, !0) : !1
    },
    clone: function() {
        var a = new cc.FadeTo;
        this._cloneDecoration(a);
        a.initWithDuration(this._duration, this._toOpacity);
        return a
    },
    update: function(a) {
        a = this._computeEaseTime(a);
        var b = void 0 !== this._fromOpacity ? this._fromOpacity: 255;
        this.target.opacity = b + (this._toOpacity - b) * a
    },
    startWithTarget: function(a) {
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        this._fromOpacity = a.opacity
    }
});
cc.fadeTo = function(a, b) {
    return new cc.FadeTo(a, b)
};
cc.FadeTo.create = cc.fadeTo;
cc.FadeIn = cc.FadeTo.extend({
    _reverseAction: null,
    ctor: function(a) {
        cc.FadeTo.prototype.ctor.call(this);
        null == a && (a = 0);
        this.initWithDuration(a, 255)
    },
    reverse: function() {
        var a = new cc.FadeOut;
        a.initWithDuration(this._duration, 0);
        this._cloneDecoration(a);
        this._reverseEaseList(a);
        return a
    },
    clone: function() {
        var a = new cc.FadeIn;
        this._cloneDecoration(a);
        a.initWithDuration(this._duration, this._toOpacity);
        return a
    },
    startWithTarget: function(a) {
        this._reverseAction && (this._toOpacity = this._reverseAction._fromOpacity);
        cc.FadeTo.prototype.startWithTarget.call(this, a)
    }
});
cc.fadeIn = function(a) {
    return new cc.FadeIn(a)
};
cc.FadeIn.create = cc.fadeIn;
cc.FadeOut = cc.FadeTo.extend({
    ctor: function(a) {
        cc.FadeTo.prototype.ctor.call(this);
        null == a && (a = 0);
        this.initWithDuration(a, 0)
    },
    reverse: function() {
        var a = new cc.FadeIn;
        a._reverseAction = this;
        a.initWithDuration(this._duration, 255);
        this._cloneDecoration(a);
        this._reverseEaseList(a);
        return a
    },
    clone: function() {
        var a = new cc.FadeOut;
        this._cloneDecoration(a);
        a.initWithDuration(this._duration, this._toOpacity);
        return a
    }
});
cc.fadeOut = function(a) {
    return new cc.FadeOut(a)
};
cc.FadeOut.create = cc.fadeOut;
cc.TintTo = cc.ActionInterval.extend({
    _to: null,
    _from: null,
    ctor: function(a, b, c, d) {
        cc.ActionInterval.prototype.ctor.call(this);
        this._to = cc.color(0, 0, 0);
        this._from = cc.color(0, 0, 0);
        void 0 !== d && this.initWithDuration(a, b, c, d)
    },
    initWithDuration: function(a, b, c, d) {
        return cc.ActionInterval.prototype.initWithDuration.call(this, a) ? (this._to = cc.color(b, c, d), !0) : !1
    },
    clone: function() {
        var a = new cc.TintTo;
        this._cloneDecoration(a);
        var b = this._to;
        a.initWithDuration(this._duration, b.r, b.g, b.b);
        return a
    },
    startWithTarget: function(a) {
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        this._from = this.target.color
    },
    update: function(a) {
        a = this._computeEaseTime(a);
        var b = this._from,
        c = this._to;
        b && this.target.setColor(cc.color(b.r + (c.r - b.r) * a, b.g + (c.g - b.g) * a, b.b + (c.b - b.b) * a))
    }
});
cc.tintTo = function(a, b, c, d) {
    return new cc.TintTo(a, b, c, d)
};
cc.TintTo.create = cc.tintTo;
cc.TintBy = cc.ActionInterval.extend({
    _deltaR: 0,
    _deltaG: 0,
    _deltaB: 0,
    _fromR: 0,
    _fromG: 0,
    _fromB: 0,
    ctor: function(a, b, c, d) {
        cc.ActionInterval.prototype.ctor.call(this);
        void 0 !== d && this.initWithDuration(a, b, c, d)
    },
    initWithDuration: function(a, b, c, d) {
        return cc.ActionInterval.prototype.initWithDuration.call(this, a) ? (this._deltaR = b, this._deltaG = c, this._deltaB = d, !0) : !1
    },
    clone: function() {
        var a = new cc.TintBy;
        this._cloneDecoration(a);
        a.initWithDuration(this._duration, this._deltaR, this._deltaG, this._deltaB);
        return a
    },
    startWithTarget: function(a) {
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        a = a.color;
        this._fromR = a.r;
        this._fromG = a.g;
        this._fromB = a.b
    },
    update: function(a) {
        a = this._computeEaseTime(a);
        this.target.color = cc.color(this._fromR + this._deltaR * a, this._fromG + this._deltaG * a, this._fromB + this._deltaB * a)
    },
    reverse: function() {
        var a = new cc.TintBy(this._duration, -this._deltaR, -this._deltaG, -this._deltaB);
        this._cloneDecoration(a);
        this._reverseEaseList(a);
        return a
    }
});
cc.tintBy = function(a, b, c, d) {
    return new cc.TintBy(a, b, c, d)
};
cc.TintBy.create = cc.tintBy;
cc.DelayTime = cc.ActionInterval.extend({
    update: function(a) {},
    reverse: function() {
        var a = new cc.DelayTime(this._duration);
        this._cloneDecoration(a);
        this._reverseEaseList(a);
        return a
    },
    clone: function() {
        var a = new cc.DelayTime;
        this._cloneDecoration(a);
        a.initWithDuration(this._duration);
        return a
    }
});
cc.delayTime = function(a) {
    return new cc.DelayTime(a)
};
cc.DelayTime.create = cc.delayTime;
cc.ReverseTime = cc.ActionInterval.extend({
    _other: null,
    ctor: function(a) {
        cc.ActionInterval.prototype.ctor.call(this);
        this._other = null;
        a && this.initWithAction(a)
    },
    initWithAction: function(a) {
        if (!a) throw Error("cc.ReverseTime.initWithAction(): action must be non null");
        if (a === this._other) throw Error("cc.ReverseTime.initWithAction(): the action was already passed in.");
        return cc.ActionInterval.prototype.initWithDuration.call(this, a._duration) ? (this._other = a, !0) : !1
    },
    clone: function() {
        var a = new cc.ReverseTime;
        this._cloneDecoration(a);
        a.initWithAction(this._other.clone());
        return a
    },
    startWithTarget: function(a) {
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        this._other.startWithTarget(a)
    },
    update: function(a) {
        a = this._computeEaseTime(a);
        this._other && this._other.update(1 - a)
    },
    reverse: function() {
        return this._other.clone()
    },
    stop: function() {
        this._other.stop();
        cc.Action.prototype.stop.call(this)
    }
});
cc.reverseTime = function(a) {
    return new cc.ReverseTime(a)
};
cc.ReverseTime.create = cc.reverseTime;
cc.Animate = cc.ActionInterval.extend({
    _animation: null,
    _nextFrame: 0,
    _origFrame: null,
    _executedLoops: 0,
    _splitTimes: null,
    _currFrameIndex: 0,
    ctor: function(a) {
        cc.ActionInterval.prototype.ctor.call(this);
        this._splitTimes = [];
        a && this.initWithAnimation(a)
    },
    getAnimation: function() {
        return this._animation
    },
    setAnimation: function(a) {
        this._animation = a
    },
    getCurrentFrameIndex: function() {
        return this._currFrameIndex
    },
    initWithAnimation: function(a) {
        if (!a) throw Error("cc.Animate.initWithAnimation(): animation must be non-NULL");
        var b = a.getDuration();
        if (this.initWithDuration(b * a.getLoops())) {
            this._nextFrame = 0;
            this.setAnimation(a);
            this._origFrame = null;
            this._executedLoops = 0;
            var c = this._splitTimes,
            d = c.length = 0,
            e = b / a.getTotalDelayUnits();
            a = a.getFrames();
            cc.arrayVerifyType(a, cc.AnimationFrame);
            for (var f = 0; f < a.length; f++) {
                var g = d * e / b,
                d = d + a[f].getDelayUnits();
                c.push(g)
            }
            return ! 0
        }
        return ! 1
    },
    clone: function() {
        var a = new cc.Animate;
        this._cloneDecoration(a);
        a.initWithAnimation(this._animation.clone());
        return a
    },
    startWithTarget: function(a) {
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        this._animation.getRestoreOriginalFrame() && (this._origFrame = a.getSpriteFrame());
        this._executedLoops = this._nextFrame = 0
    },
    update: function(a) {
        a = this._computeEaseTime(a);
        1 > a && (a *= this._animation.getLoops(), (0 | a) > this._executedLoops && (this._nextFrame = 0, this._executedLoops++), a %= 1);
        for (var b = this._animation.getFrames(), c = b.length, d = this._splitTimes, e = this._nextFrame; e < c; e++) if (d[e] <= a) _currFrameIndex = e,
        this.target.setSpriteFrame(b[_currFrameIndex].getSpriteFrame()),
        this._nextFrame = e + 1;
        else break
    },
    reverse: function() {
        var a = this._animation,
        b = a.getFrames(),
        c = [];
        cc.arrayVerifyType(b, cc.AnimationFrame);
        if (0 < b.length) for (var d = b.length - 1; 0 <= d; d--) {
            var e = b[d];
            if (!e) break;
            c.push(e.clone())
        }
        b = new cc.Animation(c, a.getDelayPerUnit(), a.getLoops());
        b.setRestoreOriginalFrame(a.getRestoreOriginalFrame());
        a = new cc.Animate(b);
        this._cloneDecoration(a);
        this._reverseEaseList(a);
        return a
    },
    stop: function() {
        this._animation.getRestoreOriginalFrame() && this.target && this.target.setSpriteFrame(this._origFrame);
        cc.Action.prototype.stop.call(this)
    }
});
cc.animate = function(a) {
    return new cc.Animate(a)
};
cc.Animate.create = cc.animate;
cc.TargetedAction = cc.ActionInterval.extend({
    _action: null,
    _forcedTarget: null,
    ctor: function(a, b) {
        cc.ActionInterval.prototype.ctor.call(this);
        b && this.initWithTarget(a, b)
    },
    initWithTarget: function(a, b) {
        return this.initWithDuration(b._duration) ? (this._forcedTarget = a, this._action = b, !0) : !1
    },
    clone: function() {
        var a = new cc.TargetedAction;
        this._cloneDecoration(a);
        a.initWithTarget(this._forcedTarget, this._action.clone());
        return a
    },
    startWithTarget: function(a) {
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        this._action.startWithTarget(this._forcedTarget)
    },
    stop: function() {
        this._action.stop()
    },
    update: function(a) {
        a = this._computeEaseTime(a);
        this._action.update(a)
    },
    getForcedTarget: function() {
        return this._forcedTarget
    },
    setForcedTarget: function(a) {
        this._forcedTarget !== a && (this._forcedTarget = a)
    }
});
cc.targetedAction = function(a, b) {
    return new cc.TargetedAction(a, b)
};
cc.TargetedAction.create = cc.targetedAction;
cc.ActionInstant = cc.FiniteTimeAction.extend({
    isDone: function() {
        return ! 0
    },
    step: function(a) {
        this.update(1)
    },
    update: function(a) {},
    reverse: function() {
        return this.clone()
    },
    clone: function() {
        return new cc.ActionInstant
    }
});
cc.Show = cc.ActionInstant.extend({
    update: function(a) {
        this.target.visible = !0
    },
    reverse: function() {
        return new cc.Hide
    },
    clone: function() {
        return new cc.Show
    }
});
cc.show = function() {
    return new cc.Show
};
cc.Show.create = cc.show;
cc.Hide = cc.ActionInstant.extend({
    update: function(a) {
        this.target.visible = !1
    },
    reverse: function() {
        return new cc.Show
    },
    clone: function() {
        return new cc.Hide
    }
});
cc.hide = function() {
    return new cc.Hide
};
cc.Hide.create = cc.hide;
cc.ToggleVisibility = cc.ActionInstant.extend({
    update: function(a) {
        this.target.visible = !this.target.visible
    },
    reverse: function() {
        return new cc.ToggleVisibility
    },
    clone: function() {
        return new cc.ToggleVisibility
    }
});
cc.toggleVisibility = function() {
    return new cc.ToggleVisibility
};
cc.ToggleVisibility.create = cc.toggleVisibility;
cc.RemoveSelf = cc.ActionInstant.extend({
    _isNeedCleanUp: !0,
    ctor: function(a) {
        cc.FiniteTimeAction.prototype.ctor.call(this);
        void 0 !== a && this.init(a)
    },
    update: function(a) {
        this.target.removeFromParent(this._isNeedCleanUp)
    },
    init: function(a) {
        this._isNeedCleanUp = a;
        return ! 0
    },
    reverse: function() {
        return new cc.RemoveSelf(this._isNeedCleanUp)
    },
    clone: function() {
        return new cc.RemoveSelf(this._isNeedCleanUp)
    }
});
cc.removeSelf = function(a) {
    return new cc.RemoveSelf(a)
};
cc.RemoveSelf.create = cc.removeSelf;
cc.FlipX = cc.ActionInstant.extend({
    _flippedX: !1,
    ctor: function(a) {
        cc.FiniteTimeAction.prototype.ctor.call(this);
        this._flippedX = !1;
        void 0 !== a && this.initWithFlipX(a)
    },
    initWithFlipX: function(a) {
        this._flippedX = a;
        return ! 0
    },
    update: function(a) {
        this.target.flippedX = this._flippedX
    },
    reverse: function() {
        return new cc.FlipX(!this._flippedX)
    },
    clone: function() {
        var a = new cc.FlipX;
        a.initWithFlipX(this._flippedX);
        return a
    }
});
cc.flipX = function(a) {
    return new cc.FlipX(a)
};
cc.FlipX.create = cc.flipX;
cc.FlipY = cc.ActionInstant.extend({
    _flippedY: !1,
    ctor: function(a) {
        cc.FiniteTimeAction.prototype.ctor.call(this);
        this._flippedY = !1;
        void 0 !== a && this.initWithFlipY(a)
    },
    initWithFlipY: function(a) {
        this._flippedY = a;
        return ! 0
    },
    update: function(a) {
        this.target.flippedY = this._flippedY
    },
    reverse: function() {
        return new cc.FlipY(!this._flippedY)
    },
    clone: function() {
        var a = new cc.FlipY;
        a.initWithFlipY(this._flippedY);
        return a
    }
});
cc.flipY = function(a) {
    return new cc.FlipY(a)
};
cc.FlipY.create = cc.flipY;
cc.Place = cc.ActionInstant.extend({
    _x: 0,
    _y: 0,
    ctor: function(a, b) {
        cc.FiniteTimeAction.prototype.ctor.call(this);
        this._y = this._x = 0;
        void 0 !== a && (void 0 !== a.x && (b = a.y, a = a.x), this.initWithPosition(a, b))
    },
    initWithPosition: function(a, b) {
        this._x = a;
        this._y = b;
        return ! 0
    },
    update: function(a) {
        this.target.setPosition(this._x, this._y)
    },
    clone: function() {
        var a = new cc.Place;
        a.initWithPosition(this._x, this._y);
        return a
    }
});
cc.place = function(a, b) {
    return new cc.Place(a, b)
};
cc.Place.create = cc.place;
cc.CallFunc = cc.ActionInstant.extend({
    _selectorTarget: null,
    _function: null,
    _data: null,
    ctor: function(a, b, c) {
        cc.FiniteTimeAction.prototype.ctor.call(this);
        this.initWithFunction(a, b, c)
    },
    initWithFunction: function(a, b, c) {
        a && (this._function = a);
        b && (this._selectorTarget = b);
        void 0 !== c && (this._data = c);
        return ! 0
    },
    execute: function() {
        this._function && this._function.call(this._selectorTarget, this.target, this._data)
    },
    update: function(a) {
        this.execute()
    },
    getTargetCallback: function() {
        return this._selectorTarget
    },
    setTargetCallback: function(a) {
        a !== this._selectorTarget && (this._selectorTarget && (this._selectorTarget = null), this._selectorTarget = a)
    },
    clone: function() {
        var a = new cc.CallFunc;
        a.initWithFunction(this._function, this._selectorTarget, this._data);
        return a
    }
});
cc.callFunc = function(a, b, c) {
    return new cc.CallFunc(a, b, c)
};
cc.CallFunc.create = cc.callFunc;
cc.ActionEase = cc.ActionInterval.extend({
    _inner: null,
    ctor: function(a) {
        cc.ActionInterval.prototype.ctor.call(this);
        a && this.initWithAction(a)
    },
    initWithAction: function(a) {
        if (!a) throw Error("cc.ActionEase.initWithAction(): action must be non nil");
        return this.initWithDuration(a.getDuration()) ? (this._inner = a, !0) : !1
    },
    clone: function() {
        var a = new cc.ActionEase;
        a.initWithAction(this._inner.clone());
        return a
    },
    startWithTarget: function(a) {
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        this._inner.startWithTarget(this.target)
    },
    stop: function() {
        this._inner.stop();
        cc.ActionInterval.prototype.stop.call(this)
    },
    update: function(a) {
        this._inner.update(a)
    },
    reverse: function() {
        return new cc.ActionEase(this._inner.reverse())
    },
    getInnerAction: function() {
        return this._inner
    }
});
cc.actionEase = function(a) {
    return new cc.ActionEase(a)
};
cc.ActionEase.create = cc.actionEase;
cc.EaseRateAction = cc.ActionEase.extend({
    _rate: 0,
    ctor: function(a, b) {
        cc.ActionEase.prototype.ctor.call(this);
        void 0 !== b && this.initWithAction(a, b)
    },
    setRate: function(a) {
        this._rate = a
    },
    getRate: function() {
        return this._rate
    },
    initWithAction: function(a, b) {
        return cc.ActionEase.prototype.initWithAction.call(this, a) ? (this._rate = b, !0) : !1
    },
    clone: function() {
        var a = new cc.EaseRateAction;
        a.initWithAction(this._inner.clone(), this._rate);
        return a
    },
    reverse: function() {
        return new cc.EaseRateAction(this._inner.reverse(), 1 / this._rate)
    }
});
cc.easeRateAction = function(a, b) {
    return new cc.EaseRateAction(a, b)
};
cc.EaseRateAction.create = cc.easeRateAction;
cc.EaseIn = cc.EaseRateAction.extend({
    update: function(a) {
        this._inner.update(Math.pow(a, this._rate))
    },
    reverse: function() {
        return new cc.EaseIn(this._inner.reverse(), 1 / this._rate)
    },
    clone: function() {
        var a = new cc.EaseIn;
        a.initWithAction(this._inner.clone(), this._rate);
        return a
    }
});
cc.EaseIn.create = function(a, b) {
    return new cc.EaseIn(a, b)
};
cc.easeIn = function(a) {
    return {
        _rate: a,
        easing: function(a) {
            return Math.pow(a, this._rate)
        },
        reverse: function() {
            return cc.easeIn(1 / this._rate)
        }
    }
};
cc.EaseOut = cc.EaseRateAction.extend({
    update: function(a) {
        this._inner.update(Math.pow(a, 1 / this._rate))
    },
    reverse: function() {
        return new cc.EaseOut(this._inner.reverse(), 1 / this._rate)
    },
    clone: function() {
        var a = new cc.EaseOut;
        a.initWithAction(this._inner.clone(), this._rate);
        return a
    }
});
cc.EaseOut.create = function(a, b) {
    return new cc.EaseOut(a, b)
};
cc.easeOut = function(a) {
    return {
        _rate: a,
        easing: function(a) {
            return Math.pow(a, 1 / this._rate)
        },
        reverse: function() {
            return cc.easeOut(1 / this._rate)
        }
    }
};
cc.EaseInOut = cc.EaseRateAction.extend({
    update: function(a) {
        a *= 2;
        1 > a ? this._inner.update(0.5 * Math.pow(a, this._rate)) : this._inner.update(1 - 0.5 * Math.pow(2 - a, this._rate))
    },
    clone: function() {
        var a = new cc.EaseInOut;
        a.initWithAction(this._inner.clone(), this._rate);
        return a
    },
    reverse: function() {
        return new cc.EaseInOut(this._inner.reverse(), this._rate)
    }
});
cc.EaseInOut.create = function(a, b) {
    return new cc.EaseInOut(a, b)
};
cc.easeInOut = function(a) {
    return {
        _rate: a,
        easing: function(a) {
            a *= 2;
            return 1 > a ? 0.5 * Math.pow(a, this._rate) : 1 - 0.5 * Math.pow(2 - a, this._rate)
        },
        reverse: function() {
            return cc.easeInOut(this._rate)
        }
    }
};
cc.EaseExponentialIn = cc.ActionEase.extend({
    update: function(a) {
        this._inner.update(0 === a ? 0 : Math.pow(2, 10 * (a - 1)))
    },
    reverse: function() {
        return new cc.EaseExponentialOut(this._inner.reverse())
    },
    clone: function() {
        var a = new cc.EaseExponentialIn;
        a.initWithAction(this._inner.clone());
        return a
    }
});
cc.EaseExponentialIn.create = function(a) {
    return new cc.EaseExponentialIn(a)
};
cc._easeExponentialInObj = {
    easing: function(a) {
        return 0 === a ? 0 : Math.pow(2, 10 * (a - 1))
    },
    reverse: function() {
        return cc._easeExponentialOutObj
    }
};
cc.easeExponentialIn = function() {
    return cc._easeExponentialInObj
};
cc.EaseExponentialOut = cc.ActionEase.extend({
    update: function(a) {
        this._inner.update(1 === a ? 1 : -Math.pow(2, -10 * a) + 1)
    },
    reverse: function() {
        return new cc.EaseExponentialIn(this._inner.reverse())
    },
    clone: function() {
        var a = new cc.EaseExponentialOut;
        a.initWithAction(this._inner.clone());
        return a
    }
});
cc.EaseExponentialOut.create = function(a) {
    return new cc.EaseExponentialOut(a)
};
cc._easeExponentialOutObj = {
    easing: function(a) {
        return 1 === a ? 1 : -Math.pow(2, -10 * a) + 1
    },
    reverse: function() {
        return cc._easeExponentialInObj
    }
};
cc.easeExponentialOut = function() {
    return cc._easeExponentialOutObj
};
cc.EaseExponentialInOut = cc.ActionEase.extend({
    update: function(a) {
        1 !== a && 0 !== a && (a *= 2, a = 1 > a ? 0.5 * Math.pow(2, 10 * (a - 1)) : 0.5 * ( - Math.pow(2, -10 * (a - 1)) + 2));
        this._inner.update(a)
    },
    reverse: function() {
        return new cc.EaseExponentialInOut(this._inner.reverse())
    },
    clone: function() {
        var a = new cc.EaseExponentialInOut;
        a.initWithAction(this._inner.clone());
        return a
    }
});
cc.EaseExponentialInOut.create = function(a) {
    return new cc.EaseExponentialInOut(a)
};
cc._easeExponentialInOutObj = {
    easing: function(a) {
        return 1 !== a && 0 !== a ? (a *= 2, 1 > a ? 0.5 * Math.pow(2, 10 * (a - 1)) : 0.5 * ( - Math.pow(2, -10 * (a - 1)) + 2)) : a
    },
    reverse: function() {
        return cc._easeExponentialInOutObj
    }
};
cc.easeExponentialInOut = function() {
    return cc._easeExponentialInOutObj
};
cc.EaseSineIn = cc.ActionEase.extend({
    update: function(a) {
        a = 0 === a || 1 === a ? a: -1 * Math.cos(a * Math.PI / 2) + 1;
        this._inner.update(a)
    },
    reverse: function() {
        return new cc.EaseSineOut(this._inner.reverse())
    },
    clone: function() {
        var a = new cc.EaseSineIn;
        a.initWithAction(this._inner.clone());
        return a
    }
});
cc.EaseSineIn.create = function(a) {
    return new cc.EaseSineIn(a)
};
cc._easeSineInObj = {
    easing: function(a) {
        return 0 === a || 1 === a ? a: -1 * Math.cos(a * Math.PI / 2) + 1
    },
    reverse: function() {
        return cc._easeSineOutObj
    }
};
cc.easeSineIn = function() {
    return cc._easeSineInObj
};
cc.EaseSineOut = cc.ActionEase.extend({
    update: function(a) {
        a = 0 === a || 1 === a ? a: Math.sin(a * Math.PI / 2);
        this._inner.update(a)
    },
    reverse: function() {
        return new cc.EaseSineIn(this._inner.reverse())
    },
    clone: function() {
        var a = new cc.EaseSineOut;
        a.initWithAction(this._inner.clone());
        return a
    }
});
cc.EaseSineOut.create = function(a) {
    return new cc.EaseSineOut(a)
};
cc._easeSineOutObj = {
    easing: function(a) {
        return 0 === a || 1 === a ? a: Math.sin(a * Math.PI / 2)
    },
    reverse: function() {
        return cc._easeSineInObj
    }
};
cc.easeSineOut = function() {
    return cc._easeSineOutObj
};
cc.EaseSineInOut = cc.ActionEase.extend({
    update: function(a) {
        a = 0 === a || 1 === a ? a: -0.5 * (Math.cos(Math.PI * a) - 1);
        this._inner.update(a)
    },
    clone: function() {
        var a = new cc.EaseSineInOut;
        a.initWithAction(this._inner.clone());
        return a
    },
    reverse: function() {
        return new cc.EaseSineInOut(this._inner.reverse())
    }
});
cc.EaseSineInOut.create = function(a) {
    return new cc.EaseSineInOut(a)
};
cc._easeSineInOutObj = {
    easing: function(a) {
        return 0 === a || 1 === a ? a: -0.5 * (Math.cos(Math.PI * a) - 1)
    },
    reverse: function() {
        return cc._easeSineInOutObj
    }
};
cc.easeSineInOut = function() {
    return cc._easeSineInOutObj
};
cc.EaseElastic = cc.ActionEase.extend({
    _period: 0.3,
    ctor: function(a, b) {
        cc.ActionEase.prototype.ctor.call(this);
        a && this.initWithAction(a, b)
    },
    getPeriod: function() {
        return this._period
    },
    setPeriod: function(a) {
        this._period = a
    },
    initWithAction: function(a, b) {
        cc.ActionEase.prototype.initWithAction.call(this, a);
        this._period = null == b ? 0.3 : b;
        return ! 0
    },
    reverse: function() {
        cc.log("cc.EaseElastic.reverse(): it should be overridden in subclass.");
        return null
    },
    clone: function() {
        var a = new cc.EaseElastic;
        a.initWithAction(this._inner.clone(), this._period);
        return a
    }
});
cc.EaseElastic.create = function(a, b) {
    return new cc.EaseElastic(a, b)
};
cc.EaseElasticIn = cc.EaseElastic.extend({
    update: function(a) {
        var b = 0;
        0 === a || 1 === a ? b = a: (b = this._period / 4, a -= 1, b = -Math.pow(2, 10 * a) * Math.sin((a - b) * Math.PI * 2 / this._period));
        this._inner.update(b)
    },
    reverse: function() {
        return new cc.EaseElasticOut(this._inner.reverse(), this._period)
    },
    clone: function() {
        var a = new cc.EaseElasticIn;
        a.initWithAction(this._inner.clone(), this._period);
        return a
    }
});
cc.EaseElasticIn.create = function(a, b) {
    return new cc.EaseElasticIn(a, b)
};
cc._easeElasticInObj = {
    easing: function(a) {
        if (0 === a || 1 === a) return a;
        a -= 1;
        return - Math.pow(2, 10 * a) * Math.sin((a - 0.075) * Math.PI * 2 / 0.3)
    },
    reverse: function() {
        return cc._easeElasticOutObj
    }
};
cc.easeElasticIn = function(a) {
    return a && 0.3 !== a ? {
        _period: a,
        easing: function(a) {
            if (0 === a || 1 === a) return a;
            a -= 1;
            return - Math.pow(2, 10 * a) * Math.sin((a - this._period / 4) * Math.PI * 2 / this._period)
        },
        reverse: function() {
            return cc.easeElasticOut(this._period)
        }
    }: cc._easeElasticInObj
};
cc.EaseElasticOut = cc.EaseElastic.extend({
    update: function(a) {
        var b = 0;
        0 === a || 1 === a ? b = a: (b = this._period / 4, b = Math.pow(2, -10 * a) * Math.sin((a - b) * Math.PI * 2 / this._period) + 1);
        this._inner.update(b)
    },
    reverse: function() {
        return new cc.EaseElasticIn(this._inner.reverse(), this._period)
    },
    clone: function() {
        var a = new cc.EaseElasticOut;
        a.initWithAction(this._inner.clone(), this._period);
        return a
    }
});
cc.EaseElasticOut.create = function(a, b) {
    return new cc.EaseElasticOut(a, b)
};
cc._easeElasticOutObj = {
    easing: function(a) {
        return 0 === a || 1 === a ? a: Math.pow(2, -10 * a) * Math.sin((a - 0.075) * Math.PI * 2 / 0.3) + 1
    },
    reverse: function() {
        return cc._easeElasticInObj
    }
};
cc.easeElasticOut = function(a) {
    return a && 0.3 !== a ? {
        _period: a,
        easing: function(a) {
            return 0 === a || 1 === a ? a: Math.pow(2, -10 * a) * Math.sin((a - this._period / 4) * Math.PI * 2 / this._period) + 1
        },
        reverse: function() {
            return cc.easeElasticIn(this._period)
        }
    }: cc._easeElasticOutObj
};
cc.EaseElasticInOut = cc.EaseElastic.extend({
    update: function(a) {
        var b = 0,
        b = this._period;
        if (0 === a || 1 === a) b = a;
        else {
            b || (b = this._period = 0.3 * 1.5);
            var c = b / 4;
            a = 2 * a - 1;
            b = 0 > a ? -0.5 * Math.pow(2, 10 * a) * Math.sin((a - c) * Math.PI * 2 / b) : Math.pow(2, -10 * a) * Math.sin((a - c) * Math.PI * 2 / b) * 0.5 + 1
        }
        this._inner.update(b)
    },
    reverse: function() {
        return new cc.EaseElasticInOut(this._inner.reverse(), this._period)
    },
    clone: function() {
        var a = new cc.EaseElasticInOut;
        a.initWithAction(this._inner.clone(), this._period);
        return a
    }
});
cc.EaseElasticInOut.create = function(a, b) {
    return new cc.EaseElasticInOut(a, b)
};
cc.easeElasticInOut = function(a) {
    return {
        _period: a || 0.3,
        easing: function(a) {
            var c = 0,
            c = this._period;
            if (0 === a || 1 === a) c = a;
            else {
                c || (c = this._period = 0.3 * 1.5);
                var d = c / 4;
                a = 2 * a - 1;
                c = 0 > a ? -0.5 * Math.pow(2, 10 * a) * Math.sin((a - d) * Math.PI * 2 / c) : Math.pow(2, -10 * a) * Math.sin((a - d) * Math.PI * 2 / c) * 0.5 + 1
            }
            return c
        },
        reverse: function() {
            return cc.easeElasticInOut(this._period)
        }
    }
};
cc.EaseBounce = cc.ActionEase.extend({
    bounceTime: function(a) {
        if (a < 1 / 2.75) return 7.5625 * a * a;
        if (a < 2 / 2.75) return a -= 1.5 / 2.75,
        7.5625 * a * a + 0.75;
        if (a < 2.5 / 2.75) return a -= 2.25 / 2.75,
        7.5625 * a * a + 0.9375;
        a -= 2.625 / 2.75;
        return 7.5625 * a * a + 0.984375
    },
    clone: function() {
        var a = new cc.EaseBounce;
        a.initWithAction(this._inner.clone());
        return a
    },
    reverse: function() {
        return new cc.EaseBounce(this._inner.reverse())
    }
});
cc.EaseBounce.create = function(a) {
    return new cc.EaseBounce(a)
};
cc.EaseBounceIn = cc.EaseBounce.extend({
    update: function(a) {
        a = 1 - this.bounceTime(1 - a);
        this._inner.update(a)
    },
    reverse: function() {
        return new cc.EaseBounceOut(this._inner.reverse())
    },
    clone: function() {
        var a = new cc.EaseBounceIn;
        a.initWithAction(this._inner.clone());
        return a
    }
});
cc.EaseBounceIn.create = function(a) {
    return new cc.EaseBounceIn(a)
};
cc._bounceTime = function(a) {
    if (a < 1 / 2.75) return 7.5625 * a * a;
    if (a < 2 / 2.75) return a -= 1.5 / 2.75,
    7.5625 * a * a + 0.75;
    if (a < 2.5 / 2.75) return a -= 2.25 / 2.75,
    7.5625 * a * a + 0.9375;
    a -= 2.625 / 2.75;
    return 7.5625 * a * a + 0.984375
};
cc._easeBounceInObj = {
    easing: function(a) {
        return 1 - cc._bounceTime(1 - a)
    },
    reverse: function() {
        return cc._easeBounceOutObj
    }
};
cc.easeBounceIn = function() {
    return cc._easeBounceInObj
};
cc.EaseBounceOut = cc.EaseBounce.extend({
    update: function(a) {
        a = this.bounceTime(a);
        this._inner.update(a)
    },
    reverse: function() {
        return new cc.EaseBounceIn(this._inner.reverse())
    },
    clone: function() {
        var a = new cc.EaseBounceOut;
        a.initWithAction(this._inner.clone());
        return a
    }
});
cc.EaseBounceOut.create = function(a) {
    return new cc.EaseBounceOut(a)
};
cc._easeBounceOutObj = {
    easing: function(a) {
        return cc._bounceTime(a)
    },
    reverse: function() {
        return cc._easeBounceInObj
    }
};
cc.easeBounceOut = function() {
    return cc._easeBounceOutObj
};
cc.EaseBounceInOut = cc.EaseBounce.extend({
    update: function(a) {
        var b = 0,
        b = 0.5 > a ? 0.5 * (1 - this.bounceTime(1 - 2 * a)) : 0.5 * this.bounceTime(2 * a - 1) + 0.5;
        this._inner.update(b)
    },
    clone: function() {
        var a = new cc.EaseBounceInOut;
        a.initWithAction(this._inner.clone());
        return a
    },
    reverse: function() {
        return new cc.EaseBounceInOut(this._inner.reverse())
    }
});
cc.EaseBounceInOut.create = function(a) {
    return new cc.EaseBounceInOut(a)
};
cc._easeBounceInOutObj = {
    easing: function(a) {
        return a = 0.5 > a ? 0.5 * (1 - cc._bounceTime(1 - 2 * a)) : 0.5 * cc._bounceTime(2 * a - 1) + 0.5
    },
    reverse: function() {
        return cc._easeBounceInOutObj
    }
};
cc.easeBounceInOut = function() {
    return cc._easeBounceInOutObj
};
cc.EaseBackIn = cc.ActionEase.extend({
    update: function(a) {
        this._inner.update(0 === a || 1 === a ? a: a * a * (2.70158 * a - 1.70158))
    },
    reverse: function() {
        return new cc.EaseBackOut(this._inner.reverse())
    },
    clone: function() {
        var a = new cc.EaseBackIn;
        a.initWithAction(this._inner.clone());
        return a
    }
});
cc.EaseBackIn.create = function(a) {
    return new cc.EaseBackIn(a)
};
cc._easeBackInObj = {
    easing: function(a) {
        return 0 === a || 1 === a ? a: a * a * (2.70158 * a - 1.70158)
    },
    reverse: function() {
        return cc._easeBackOutObj
    }
};
cc.easeBackIn = function() {
    return cc._easeBackInObj
};
cc.EaseBackOut = cc.ActionEase.extend({
    update: function(a) {
        a -= 1;
        this._inner.update(a * a * (2.70158 * a + 1.70158) + 1)
    },
    reverse: function() {
        return new cc.EaseBackIn(this._inner.reverse())
    },
    clone: function() {
        var a = new cc.EaseBackOut;
        a.initWithAction(this._inner.clone());
        return a
    }
});
cc.EaseBackOut.create = function(a) {
    return new cc.EaseBackOut(a)
};
cc._easeBackOutObj = {
    easing: function(a) {
        a -= 1;
        return a * a * (2.70158 * a + 1.70158) + 1
    },
    reverse: function() {
        return cc._easeBackInObj
    }
};
cc.easeBackOut = function() {
    return cc._easeBackOutObj
};
cc.EaseBackInOut = cc.ActionEase.extend({
    update: function(a) {
        a *= 2;
        1 > a ? this._inner.update(a * a * (3.5949095 * a - 2.5949095) / 2) : (a -= 2, this._inner.update(a * a * (3.5949095 * a + 2.5949095) / 2 + 1))
    },
    clone: function() {
        var a = new cc.EaseBackInOut;
        a.initWithAction(this._inner.clone());
        return a
    },
    reverse: function() {
        return new cc.EaseBackInOut(this._inner.reverse())
    }
});
cc.EaseBackInOut.create = function(a) {
    return new cc.EaseBackInOut(a)
};
cc._easeBackInOutObj = {
    easing: function(a) {
        a *= 2;
        if (1 > a) return a * a * (3.5949095 * a - 2.5949095) / 2;
        a -= 2;
        return a * a * (3.5949095 * a + 2.5949095) / 2 + 1
    },
    reverse: function() {
        return cc._easeBackInOutObj
    }
};
cc.easeBackInOut = function() {
    return cc._easeBackInOutObj
};
cc.EaseBezierAction = cc.ActionEase.extend({
    _p0: null,
    _p1: null,
    _p2: null,
    _p3: null,
    ctor: function(a) {
        cc.ActionEase.prototype.ctor.call(this, a)
    },
    _updateTime: function(a, b, c, d, e) {
        return Math.pow(1 - e, 3) * a + 3 * e * Math.pow(1 - e, 2) * b + 3 * Math.pow(e, 2) * (1 - e) * c + Math.pow(e, 3) * d
    },
    update: function(a) {
        a = this._updateTime(this._p0, this._p1, this._p2, this._p3, a);
        this._inner.update(a)
    },
    clone: function() {
        var a = new cc.EaseBezierAction;
        a.initWithAction(this._inner.clone());
        a.setBezierParamer(this._p0, this._p1, this._p2, this._p3);
        return a
    },
    reverse: function() {
        var a = new cc.EaseBezierAction(this._inner.reverse());
        a.setBezierParamer(this._p3, this._p2, this._p1, this._p0);
        return a
    },
    setBezierParamer: function(a, b, c, d) {
        this._p0 = a || 0;
        this._p1 = b || 0;
        this._p2 = c || 0;
        this._p3 = d || 0
    }
});
cc.EaseBezierAction.create = function(a) {
    return new cc.EaseBezierAction(a)
};
cc.easeBezierAction = function(a, b, c, d) {
    return {
        easing: function(e) {
            return cc.EaseBezierAction.prototype._updateTime(a, b, c, d, e)
        },
        reverse: function() {
            return cc.easeBezierAction(d, c, b, a)
        }
    }
};
cc.EaseQuadraticActionIn = cc.ActionEase.extend({
    _updateTime: function(a) {
        return Math.pow(a, 2)
    },
    update: function(a) {
        this._inner.update(this._updateTime(a))
    },
    clone: function() {
        var a = new cc.EaseQuadraticActionIn;
        a.initWithAction(this._inner.clone());
        return a
    },
    reverse: function() {
        return new cc.EaseQuadraticActionIn(this._inner.reverse())
    }
});
cc.EaseQuadraticActionIn.create = function(a) {
    return new cc.EaseQuadraticActionIn(a)
};
cc._easeQuadraticActionIn = {
    easing: cc.EaseQuadraticActionIn.prototype._updateTime,
    reverse: function() {
        return cc._easeQuadraticActionIn
    }
};
cc.easeQuadraticActionIn = function() {
    return cc._easeQuadraticActionIn
};
cc.EaseQuadraticActionOut = cc.ActionEase.extend({
    _updateTime: function(a) {
        return - a * (a - 2)
    },
    update: function(a) {
        this._inner.update(this._updateTime(a))
    },
    clone: function() {
        var a = new cc.EaseQuadraticActionOut;
        a.initWithAction();
        return a
    },
    reverse: function() {
        return new cc.EaseQuadraticActionOut(this._inner.reverse())
    }
});
cc.EaseQuadraticActionOut.create = function(a) {
    return new cc.EaseQuadraticActionOut(a)
};
cc._easeQuadraticActionOut = {
    easing: cc.EaseQuadraticActionOut.prototype._updateTime,
    reverse: function() {
        return cc._easeQuadraticActionOut
    }
};
cc.easeQuadraticActionOut = function() {
    return cc._easeQuadraticActionOut
};
cc.EaseQuadraticActionInOut = cc.ActionEase.extend({
    _updateTime: function(a) {
        var b = a;
        a *= 2;
        1 > a ? b = a * a * 0.5 : (--a, b = -0.5 * (a * (a - 2) - 1));
        return b
    },
    update: function(a) {
        this._inner.update(this._updateTime(a))
    },
    clone: function() {
        var a = new cc.EaseQuadraticActionInOut;
        a.initWithAction(this._inner.clone());
        return a
    },
    reverse: function() {
        return new cc.EaseQuadraticActionInOut(this._inner.reverse())
    }
});
cc.EaseQuadraticActionInOut.create = function(a) {
    return new cc.EaseQuadraticActionInOut(a)
};
cc._easeQuadraticActionInOut = {
    easing: cc.EaseQuadraticActionInOut.prototype._updateTime,
    reverse: function() {
        return cc._easeQuadraticActionInOut
    }
};
cc.easeQuadraticActionInOut = function() {
    return cc._easeQuadraticActionInOut
};
cc.EaseQuarticActionIn = cc.ActionEase.extend({
    _updateTime: function(a) {
        return a * a * a * a
    },
    update: function(a) {
        this._inner.update(this._updateTime(a))
    },
    clone: function() {
        var a = new cc.EaseQuarticActionIn;
        a.initWithAction(this._inner.clone());
        return a
    },
    reverse: function() {
        return new cc.EaseQuarticActionIn(this._inner.reverse())
    }
});
cc.EaseQuarticActionIn.create = function(a) {
    return new cc.EaseQuarticActionIn(a)
};
cc._easeQuarticActionIn = {
    easing: cc.EaseQuarticActionIn.prototype._updateTime,
    reverse: function() {
        return cc._easeQuarticActionIn
    }
};
cc.easeQuarticActionIn = function() {
    return cc._easeQuarticActionIn
};
cc.EaseQuarticActionOut = cc.ActionEase.extend({
    _updateTime: function(a) {
        a -= 1;
        return - (a * a * a * a - 1)
    },
    update: function(a) {
        this._inner.update(this._updateTime(a))
    },
    clone: function() {
        var a = new cc.EaseQuarticActionOut;
        a.initWithAction(this._inner.clone());
        return a
    },
    reverse: function() {
        return new cc.EaseQuarticActionOut(this._inner.reverse())
    }
});
cc.EaseQuarticActionOut.create = function(a) {
    return new cc.EaseQuarticActionOut(a)
};
cc._easeQuarticActionOut = {
    easing: cc.EaseQuarticActionOut.prototype._updateTime,
    reverse: function() {
        return cc._easeQuarticActionOut
    }
};
cc.easeQuarticActionOut = function() {
    return cc._easeQuarticActionOut
};
cc.EaseQuarticActionInOut = cc.ActionEase.extend({
    _updateTime: function(a) {
        a *= 2;
        if (1 > a) return 0.5 * a * a * a * a;
        a -= 2;
        return - 0.5 * (a * a * a * a - 2)
    },
    update: function(a) {
        this._inner.update(this._updateTime(a))
    },
    clone: function() {
        var a = new cc.EaseQuarticActionInOut;
        a.initWithAction(this._inner.clone());
        return a
    },
    reverse: function() {
        return new cc.EaseQuarticActionInOut(this._inner.reverse())
    }
});
cc.EaseQuarticActionInOut.create = function(a) {
    return new cc.EaseQuarticActionInOut(a)
};
cc._easeQuarticActionInOut = {
    easing: cc.EaseQuarticActionInOut.prototype._updateTime,
    reverse: function() {
        return cc._easeQuarticActionInOut
    }
};
cc.easeQuarticActionInOut = function() {
    return cc._easeQuarticActionInOut
};
cc.EaseQuinticActionIn = cc.ActionEase.extend({
    _updateTime: function(a) {
        return a * a * a * a * a
    },
    update: function(a) {
        this._inner.update(this._updateTime(a))
    },
    clone: function() {
        var a = new cc.EaseQuinticActionIn;
        a.initWithAction(this._inner.clone());
        return a
    },
    reverse: function() {
        return new cc.EaseQuinticActionIn(this._inner.reverse())
    }
});
cc.EaseQuinticActionIn.create = function(a) {
    return new cc.EaseQuinticActionIn(a)
};
cc._easeQuinticActionIn = {
    easing: cc.EaseQuinticActionIn.prototype._updateTime,
    reverse: function() {
        return cc._easeQuinticActionIn
    }
};
cc.easeQuinticActionIn = function() {
    return cc._easeQuinticActionIn
};
cc.EaseQuinticActionOut = cc.ActionEase.extend({
    _updateTime: function(a) {
        a -= 1;
        return a * a * a * a * a + 1
    },
    update: function(a) {
        this._inner.update(this._updateTime(a))
    },
    clone: function() {
        var a = new cc.EaseQuinticActionOut;
        a.initWithAction(this._inner.clone());
        return a
    },
    reverse: function() {
        return new cc.EaseQuinticActionOut(this._inner.reverse())
    }
});
cc.EaseQuinticActionOut.create = function(a) {
    return new cc.EaseQuinticActionOut(a)
};
cc._easeQuinticActionOut = {
    easing: cc.EaseQuinticActionOut.prototype._updateTime,
    reverse: function() {
        return cc._easeQuinticActionOut
    }
};
cc.easeQuinticActionOut = function() {
    return cc._easeQuinticActionOut
};
cc.EaseQuinticActionInOut = cc.ActionEase.extend({
    _updateTime: function(a) {
        a *= 2;
        if (1 > a) return 0.5 * a * a * a * a * a;
        a -= 2;
        return 0.5 * (a * a * a * a * a + 2)
    },
    update: function(a) {
        this._inner.update(this._updateTime(a))
    },
    clone: function() {
        var a = new cc.EaseQuinticActionInOut;
        a.initWithAction(this._inner.clone());
        return a
    },
    reverse: function() {
        return new cc.EaseQuinticActionInOut(this._inner.reverse())
    }
});
cc.EaseQuinticActionInOut.create = function(a) {
    return new cc.EaseQuinticActionInOut(a)
};
cc._easeQuinticActionInOut = {
    easing: cc.EaseQuinticActionInOut.prototype._updateTime,
    reverse: function() {
        return cc._easeQuinticActionInOut
    }
};
cc.easeQuinticActionInOut = function() {
    return cc._easeQuinticActionInOut
};
cc.EaseCircleActionIn = cc.ActionEase.extend({
    _updateTime: function(a) {
        return - 1 * (Math.sqrt(1 - a * a) - 1)
    },
    update: function(a) {
        this._inner.update(this._updateTime(a))
    },
    clone: function() {
        var a = new cc.EaseCircleActionIn;
        a.initWithAction(this._inner.clone());
        return a
    },
    reverse: function() {
        return new cc.EaseCircleActionIn(this._inner.reverse())
    }
});
cc.EaseCircleActionIn.create = function(a) {
    return new cc.EaseCircleActionIn(a)
};
cc._easeCircleActionIn = {
    easing: cc.EaseCircleActionIn.prototype._updateTime,
    reverse: function() {
        return cc._easeCircleActionIn
    }
};
cc.easeCircleActionIn = function() {
    return cc._easeCircleActionIn
};
cc.EaseCircleActionOut = cc.ActionEase.extend({
    _updateTime: function(a) {
        a -= 1;
        return Math.sqrt(1 - a * a)
    },
    update: function(a) {
        this._inner.update(this._updateTime(a))
    },
    clone: function() {
        var a = new cc.EaseCircleActionOut;
        a.initWithAction(this._inner.clone());
        return a
    },
    reverse: function() {
        return new cc.EaseCircleActionOut(this._inner.reverse())
    }
});
cc.EaseCircleActionOut.create = function(a) {
    return new cc.EaseCircleActionOut(a)
};
cc._easeCircleActionOut = {
    easing: cc.EaseCircleActionOut.prototype._updateTime,
    reverse: function() {
        return cc._easeCircleActionOut
    }
};
cc.easeCircleActionOut = function() {
    return cc._easeCircleActionOut
};
cc.EaseCircleActionInOut = cc.ActionEase.extend({
    _updateTime: function(a) {
        a *= 2;
        if (1 > a) return - 0.5 * (Math.sqrt(1 - a * a) - 1);
        a -= 2;
        return 0.5 * (Math.sqrt(1 - a * a) + 1)
    },
    update: function(a) {
        this._inner.update(this._updateTime(a))
    },
    clone: function() {
        var a = new cc.EaseCircleActionInOut;
        a.initWithAction(this._inner.clone());
        return a
    },
    reverse: function() {
        return new cc.EaseCircleActionInOut(this._inner.reverse())
    }
});
cc.EaseCircleActionInOut.create = function(a) {
    return new cc.EaseCircleActionInOut(a)
};
cc._easeCircleActionInOut = {
    easing: cc.EaseCircleActionInOut.prototype._updateTime,
    reverse: function() {
        return cc._easeCircleActionInOut
    }
};
cc.easeCircleActionInOut = function() {
    return cc._easeCircleActionInOut
};
cc.EaseCubicActionIn = cc.ActionEase.extend({
    _updateTime: function(a) {
        return a * a * a
    },
    update: function(a) {
        this._inner.update(this._updateTime(a))
    },
    clone: function() {
        var a = new cc.EaseCubicActionIn;
        a.initWithAction(this._inner.clone());
        return a
    },
    reverse: function() {
        return new cc.EaseCubicActionIn(this._inner.reverse())
    }
});
cc.EaseCubicActionIn.create = function(a) {
    return new cc.EaseCubicActionIn(a)
};
cc._easeCubicActionIn = {
    easing: cc.EaseCubicActionIn.prototype._updateTime,
    reverse: function() {
        return cc._easeCubicActionIn
    }
};
cc.easeCubicActionIn = function() {
    return cc._easeCubicActionIn
};
cc.EaseCubicActionOut = cc.ActionEase.extend({
    _updateTime: function(a) {
        a -= 1;
        return a * a * a + 1
    },
    update: function(a) {
        this._inner.update(this._updateTime(a))
    },
    clone: function() {
        var a = new cc.EaseCubicActionOut;
        a.initWithAction(this._inner.clone());
        return a
    },
    reverse: function() {
        return new cc.EaseCubicActionOut(this._inner.reverse())
    }
});
cc.EaseCubicActionOut.create = function(a) {
    return new cc.EaseCubicActionOut(a)
};
cc._easeCubicActionOut = {
    easing: cc.EaseCubicActionOut.prototype._updateTime,
    reverse: function() {
        return cc._easeCubicActionOut
    }
};
cc.easeCubicActionOut = function() {
    return cc._easeCubicActionOut
};
cc.EaseCubicActionInOut = cc.ActionEase.extend({
    _updateTime: function(a) {
        a *= 2;
        if (1 > a) return 0.5 * a * a * a;
        a -= 2;
        return 0.5 * (a * a * a + 2)
    },
    update: function(a) {
        this._inner.update(this._updateTime(a))
    },
    clone: function() {
        var a = new cc.EaseCubicActionInOut;
        a.initWithAction(this._inner.clone());
        return a
    },
    reverse: function() {
        return new cc.EaseCubicActionInOut(this._inner.reverse())
    }
});
cc.EaseCubicActionInOut.create = function(a) {
    return new cc.EaseCubicActionInOut(a)
};
cc._easeCubicActionInOut = {
    easing: cc.EaseCubicActionInOut.prototype._updateTime,
    reverse: function() {
        return cc._easeCubicActionInOut
    }
};
cc.easeCubicActionInOut = function() {
    return cc._easeCubicActionInOut
};
cc.cardinalSplineAt = function(a, b, c, d, e, f, g) {
    var h = f * f,
    k = h * f,
    m = (1 - e) / 2;
    e = m * ( - k + 2 * h - f);
    var r = m * ( - k + h) + (2 * k - 3 * h + 1);
    f = m * (k - 2 * h + f) + ( - 2 * k + 3 * h);
    k = m * (k - h);
    h = a.x * e + b.x * r + c.x * f + d.x * k;
    a = a.y * e + b.y * r + c.y * f + d.y * k;
    if (void 0 !== g) g.x = h,
    g.y = a;
    else return cc.p(h, a)
};
cc.reverseControlPoints = function(a) {
    for (var b = [], c = a.length - 1; 0 <= c; c--) b.push(cc.p(a[c].x, a[c].y));
    return b
};
cc.cloneControlPoints = function(a) {
    for (var b = [], c = 0; c < a.length; c++) b.push(cc.p(a[c].x, a[c].y));
    return b
};
cc.copyControlPoints = cc.cloneControlPoints;
cc.getControlPointAt = function(a, b) {
    var c = Math.min(a.length - 1, Math.max(b, 0));
    return a[c]
};
cc.reverseControlPointsInline = function(a) {
    for (var b = a.length,
    c = 0 | b / 2,
    d = 0; d < c; ++d) {
        var e = a[d];
        a[d] = a[b - d - 1];
        a[b - d - 1] = e
    }
};
cc.CardinalSplineTo = cc.ActionInterval.extend({
    _points: null,
    _deltaT: 0,
    _tension: 0,
    _previousPosition: null,
    _accumulatedDiff: null,
    ctor: function(a, b, c) {
        cc.ActionInterval.prototype.ctor.call(this);
        this._points = [];
        void 0 !== c && this.initWithDuration(a, b, c)
    },
    initWithDuration: function(a, b, c) {
        if (!b || 0 === b.length) throw Error("Invalid configuration. It must at least have one control point");
        return cc.ActionInterval.prototype.initWithDuration.call(this, a) ? (this.setPoints(b), this._tension = c, !0) : !1
    },
    clone: function() {
        var a = new cc.CardinalSplineTo;
        a.initWithDuration(this._duration, cc.copyControlPoints(this._points), this._tension);
        return a
    },
    startWithTarget: function(a) {
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        this._deltaT = 1 / (this._points.length - 1);
        this._previousPosition = cc.p(this.target.getPositionX(), this.target.getPositionY());
        this._accumulatedDiff = cc.p(0, 0)
    },
    update: function(a) {
        a = this._computeEaseTime(a);
        var b, c = this._points;
        if (1 === a) b = c.length - 1,
        a = 1;
        else {
            var d = this._deltaT;
            b = 0 | a / d;
            a = (a - d * b) / d
        }
        b = cc.cardinalSplineAt(cc.getControlPointAt(c, b - 1), cc.getControlPointAt(c, b - 0), cc.getControlPointAt(c, b + 1), cc.getControlPointAt(c, b + 2), this._tension, a);
        cc.ENABLE_STACKABLE_ACTIONS && (c = this.target.getPositionX() - this._previousPosition.x, a = this.target.getPositionY() - this._previousPosition.y, 0 !== c || 0 !== a) && (d = this._accumulatedDiff, c = d.x + c, a = d.y + a, d.x = c, d.y = a, b.x += c, b.y += a);
        this.updatePosition(b)
    },
    reverse: function() {
        var a = cc.reverseControlPoints(this._points);
        return cc.cardinalSplineTo(this._duration, a, this._tension)
    },
    updatePosition: function(a) {
        this.target.setPosition(a);
        this._previousPosition = a
    },
    getPoints: function() {
        return this._points
    },
    setPoints: function(a) {
        this._points = a
    }
});
cc.cardinalSplineTo = function(a, b, c) {
    return new cc.CardinalSplineTo(a, b, c)
};
cc.CardinalSplineTo.create = cc.cardinalSplineTo;
cc.CardinalSplineBy = cc.CardinalSplineTo.extend({
    _startPosition: null,
    ctor: function(a, b, c) {
        cc.CardinalSplineTo.prototype.ctor.call(this);
        this._startPosition = cc.p(0, 0);
        void 0 !== c && this.initWithDuration(a, b, c)
    },
    startWithTarget: function(a) {
        cc.CardinalSplineTo.prototype.startWithTarget.call(this, a);
        this._startPosition.x = a.getPositionX();
        this._startPosition.y = a.getPositionY()
    },
    reverse: function() {
        for (var a = this._points.slice(), b, c = a[0], d = 1; d < a.length; ++d) b = a[d],
        a[d] = cc.pSub(b, c),
        c = b;
        a = cc.reverseControlPoints(a);
        c = a[a.length - 1];
        a.pop();
        c.x = -c.x;
        c.y = -c.y;
        a.unshift(c);
        for (d = 1; d < a.length; ++d) b = a[d],
        b.x = -b.x,
        b.y = -b.y,
        b.x += c.x,
        b.y += c.y,
        c = a[d] = b;
        return cc.cardinalSplineBy(this._duration, a, this._tension)
    },
    updatePosition: function(a) {
        var b = this._startPosition,
        c = a.x + b.x;
        a = a.y + b.y;
        this._previousPosition.x = c;
        this._previousPosition.y = a;
        this.target.setPosition(c, a)
    },
    clone: function() {
        var a = new cc.CardinalSplineBy;
        a.initWithDuration(this._duration, cc.copyControlPoints(this._points), this._tension);
        return a
    }
});
cc.cardinalSplineBy = function(a, b, c) {
    return new cc.CardinalSplineBy(a, b, c)
};
cc.CardinalSplineBy.create = cc.cardinalSplineBy;
cc.CatmullRomTo = cc.CardinalSplineTo.extend({
    ctor: function(a, b) {
        b && this.initWithDuration(a, b)
    },
    initWithDuration: function(a, b) {
        return cc.CardinalSplineTo.prototype.initWithDuration.call(this, a, b, 0.5)
    },
    clone: function() {
        var a = new cc.CatmullRomTo;
        a.initWithDuration(this._duration, cc.copyControlPoints(this._points));
        return a
    }
});
cc.catmullRomTo = function(a, b) {
    return new cc.CatmullRomTo(a, b)
};
cc.CatmullRomTo.create = cc.catmullRomTo;
cc.CatmullRomBy = cc.CardinalSplineBy.extend({
    ctor: function(a, b) {
        cc.CardinalSplineBy.prototype.ctor.call(this);
        b && this.initWithDuration(a, b)
    },
    initWithDuration: function(a, b) {
        return cc.CardinalSplineTo.prototype.initWithDuration.call(this, a, b, 0.5)
    },
    clone: function() {
        var a = new cc.CatmullRomBy;
        a.initWithDuration(this._duration, cc.copyControlPoints(this._points));
        return a
    }
});
cc.catmullRomBy = function(a, b) {
    return new cc.CatmullRomBy(a, b)
};
cc.CatmullRomBy.create = cc.catmullRomBy;
cc.ActionTweenDelegate = cc.Class.extend({
    updateTweenAction: function(a, b) {}
});
cc.ActionTween = cc.ActionInterval.extend({
    key: "",
    from: 0,
    to: 0,
    delta: 0,
    ctor: function(a, b, c, d) {
        cc.ActionInterval.prototype.ctor.call(this);
        this.key = "";
        void 0 !== d && this.initWithDuration(a, b, c, d)
    },
    initWithDuration: function(a, b, c, d) {
        return cc.ActionInterval.prototype.initWithDuration.call(this, a) ? (this.key = b, this.to = d, this.from = c, !0) : !1
    },
    startWithTarget: function(a) {
        if (!a || !a.updateTweenAction) throw Error("cc.ActionTween.startWithTarget(): target must be non-null, and target must implement updateTweenAction function");
        cc.ActionInterval.prototype.startWithTarget.call(this, a);
        this.delta = this.to - this.from
    },
    update: function(a) {
        this.target.updateTweenAction(this.to - this.delta * (1 - a), this.key)
    },
    reverse: function() {
        return new cc.ActionTween(this.duration, this.key, this.to, this.from)
    },
    clone: function() {
        var a = new cc.ActionTween;
        a.initWithDuration(this._duration, this.key, this.from, this.to);
        return a
    }
});
cc.actionTween = function(a, b, c, d) {
    return new cc.ActionTween(a, b, c, d)
};
cc.ActionTween.create = cc.actionTween;
cc.stencilBits = -1;
cc.ClippingNode = cc.Node.extend({
    inverted: !1,
    _alphaThreshold: 0,
    _stencil: null,
    _className: "ClippingNode",
    _originStencilProgram: null,
    ctor: function(a) {
        a = a || null;
        cc.Node.prototype.ctor.call(this);
        if (this._stencil = a) this._originStencilProgram = a.getShaderProgram();
        this.alphaThreshold = 1;
        this.inverted = !1;
        this._renderCmd.initStencilBits()
    },
    onEnter: function() {
        cc.Node.prototype.onEnter.call(this);
        this._stencil && this._stencil._performRecursive(cc.Node._stateCallbackType.onEnter)
    },
    onEnterTransitionDidFinish: function() {
        cc.Node.prototype.onEnterTransitionDidFinish.call(this);
        this._stencil && this._stencil._performRecursive(cc.Node._stateCallbackType.onEnterTransitionDidFinish)
    },
    onExitTransitionDidStart: function() {
        this._stencil._performRecursive(cc.Node._stateCallbackType.onExitTransitionDidStart);
        cc.Node.prototype.onExitTransitionDidStart.call(this)
    },
    onExit: function() {
        this._stencil._performRecursive(cc.Node._stateCallbackType.onExit);
        cc.Node.prototype.onExit.call(this)
    },
    visit: function(a) {
        this._renderCmd.clippingVisit(a && a._renderCmd)
    },
    _visitChildren: function() {
        this._reorderChildDirty && this.sortAllChildren();
        for (var a = this._children,
        b, c = 0,
        d = a.length; c < d; c++)(b = a[c]) && b._visible && b.visit(this);
        this._renderCmd._dirtyFlag = 0
    },
    getAlphaThreshold: function() {
        return this._alphaThreshold
    },
    setAlphaThreshold: function(a) {
        1 === a && a !== this._alphaThreshold && this._renderCmd.resetProgramByStencil();
        this._alphaThreshold = a
    },
    isInverted: function() {
        return this.inverted
    },
    setInverted: function(a) {
        this.inverted = a
    },
    getStencil: function() {
        return this._stencil
    },
    setStencil: function(a) {
        this._stencil !== a && (a && (this._originStencilProgram = a.getShaderProgram()), this._renderCmd.setStencil(a))
    },
    _createRenderCmd: function() {
        return cc._renderType === cc.game.RENDER_TYPE_CANVAS ? new cc.ClippingNode.CanvasRenderCmd(this) : new cc.ClippingNode.WebGLRenderCmd(this)
    }
});
_p = cc.ClippingNode.prototype;
cc.defineGetterSetter(_p, "stencil", _p.getStencil, _p.setStencil);
cc.defineGetterSetter(_p, "alphaThreshold", _p.getAlphaThreshold, _p.setAlphaThreshold);
cc.ClippingNode.create = function(a) {
    return new cc.ClippingNode(a)
}; (function() {
    cc.ClippingNode.CanvasRenderCmd = function(a) {
        this._rootCtor(a);
        this._clipElemType = this._godhelpme = this._needDraw = !1;
        this._rendererSaveCmd = new cc.CustomRenderCmd(this, this._saveCmdCallback);
        this._rendererClipCmd = new cc.CustomRenderCmd(this, this._clipCmdCallback);
        this._rendererRestoreCmd = new cc.CustomRenderCmd(this, this._restoreCmdCallback)
    };
    var a = cc.ClippingNode.CanvasRenderCmd.prototype = Object.create(cc.Node.CanvasRenderCmd.prototype);
    a.constructor = cc.ClippingNode.CanvasRenderCmd;
    a.resetProgramByStencil = function() {};
    a.initStencilBits = function() {};
    a.setStencil = function(a) {
        if (null != a) if (this._node._stencil = a, a instanceof cc.DrawNode) {
            if (a._buffer) for (var c = 0; c < a._buffer.length; c++) a._buffer[c].isFill = !1,
            a._buffer[c].isStroke = !1;
            a._renderCmd.rendering = function(a, b, c) {};
            a._renderCmd._canUseDirtyRegion = !0;
            this._rendererSaveCmd._canUseDirtyRegion = !0;
            this._rendererClipCmd._canUseDirtyRegion = !0;
            this._rendererRestoreCmd._canUseDirtyRegion = !0
        } else a._parent = this._node
    };
    a._saveCmdCallback = function(a, c, d) {
        var e = a || cc._renderContext;
        a = e.getContext();
        this._clipElemType ? (c = cc.ClippingNode.CanvasRenderCmd._getSharedCache(), d = a.canvas, c.width = d.width, c.height = d.height, c.getContext("2d").drawImage(d, 0, 0)) : (e.save(), e.setTransform(this._worldTransform, c, d), this._node.inverted && (a.beginPath(), a.rect(0, 0, a.canvas.width, -a.canvas.height), a.clip()))
    };
    a._setStencilCompositionOperation = function(a) {
        if (a) {
            var c = this._node;
            a._renderCmd && a._renderCmd._blendFuncStr && (a._renderCmd._blendFuncStr = c.inverted ? "destination-out": "destination-in");
            if (a._children) {
                a = a._children;
                for (var c = 0,
                d = a.length; c < d; c++) this._setStencilCompositionOperation(a[c])
            }
        }
    };
    a._clipCmdCallback = function(a) {
        var c = this._node;
        a = (a || cc._renderContext).getContext();
        if (this._clipElemType) this._setStencilCompositionOperation(c._stencil);
        else {
            c = this._node._stencil;
            if (c instanceof cc.DrawNode) {
                a.beginPath();
                var d = c._renderCmd._transform;
                a.transform(d.a, d.b, d.c, d.d, d.tx, -d.ty);
                for (d = 0; d < c._buffer.length; d++) {
                    var e = c._buffer[d].verts,
                    f = e[0];
                    a.moveTo(f.x, -f.y);
                    for (f = e.length - 1; 0 < f; f--) a.lineTo(e[f].x, -e[f].y)
                }
            }
            a.clip()
        }
    };
    a._restoreCmdCallback = function(a) {
        var c = cc.ClippingNode.CanvasRenderCmd._getSharedCache();
        a = a || cc._renderContext;
        var d = a.getContext();
        this._clipElemType ? (d.save(), d.setTransform(1, 0, 0, 1, 0, 0), d.globalCompositeOperation = "destination-over", d.drawImage(c, 0, 0), d.restore(), this._dirtyFlag = 0) : a.restore()
    };
    a.transform = function(a, c) {
        this.originTransform(a, c);
        var d = this._node;
        d._stencil && d._stencil._renderCmd && (d._stencil._renderCmd.transform(this, !0), d._stencil._dirtyFlag &= ~cc.Node._dirtyFlags.transformDirty)
    };
    a._cangodhelpme = function(a) {
        if (!0 === a || !1 === a) cc.ClippingNode.CanvasRenderCmd.prototype._godhelpme = a;
        return cc.ClippingNode.CanvasRenderCmd.prototype._godhelpme
    };
    a.clippingVisit = function(a) {
        var c = this._node;
        a = a || this.getParentRenderCmd();
        this.visit(a);
        this._clipElemType = !(!this._cangodhelpme() && c._stencil instanceof cc.DrawNode);
        if (c._stencil && c._stencil.visible) {
            cc.renderer.pushRenderCommand(this._rendererSaveCmd);
            this._clipElemType ? c._visitChildren() : c._stencil.visit(c);
            cc.renderer.pushRenderCommand(this._rendererClipCmd);
            if (this._clipElemType) c._stencil.visit(c);
            else {
                this._cangodhelpme(!0);
                a = c._children;
                var d, e = a.length;
                if (0 < e) for (c.sortAllChildren(), d = 0; d < e; d++) a[d].visit(c);
                this._cangodhelpme(!1)
            }
            cc.renderer.pushRenderCommand(this._rendererRestoreCmd);
            this._dirtyFlag = 0
        } else this.inverted && c._visitChildren()
    };
    cc.ClippingNode.CanvasRenderCmd._sharedCache = null;
    cc.ClippingNode.CanvasRenderCmd._getSharedCache = function() {
        return cc.ClippingNode.CanvasRenderCmd._sharedCache || (cc.ClippingNode.CanvasRenderCmd._sharedCache = document.createElement("canvas"))
    }
})();
function setProgram(a, b) {
    a.shaderProgram = b;
    var c = a.children;
    if (c) for (var d = 0; d < c.length; d++) setProgram(c[d], b)
} (function() {
    cc.ClippingNode.WebGLRenderCmd = function(a) {
        this._rootCtor(a);
        this._needDraw = !1;
        this._beforeVisitCmd = new cc.CustomRenderCmd(this, this._onBeforeVisit);
        this._afterDrawStencilCmd = new cc.CustomRenderCmd(this, this._onAfterDrawStencil);
        this._afterVisitCmd = new cc.CustomRenderCmd(this, this._onAfterVisit);
        this._mask_layer_le = this._currentStencilEnabled = null
    };
    var a = cc.ClippingNode.WebGLRenderCmd.prototype = Object.create(cc.Node.WebGLRenderCmd.prototype);
    a.constructor = cc.ClippingNode.WebGLRenderCmd;
    cc.ClippingNode.WebGLRenderCmd._init_once = null;
    cc.ClippingNode.WebGLRenderCmd._visit_once = null;
    cc.ClippingNode.WebGLRenderCmd._layer = -1;
    a.initStencilBits = function() {
        cc.ClippingNode.WebGLRenderCmd._init_once = !0;
        cc.ClippingNode.WebGLRenderCmd._init_once && (cc.stencilBits = cc._renderContext.getParameter(cc._renderContext.STENCIL_BITS), 0 >= cc.stencilBits && cc.log("Stencil buffer is not enabled."), cc.ClippingNode.WebGLRenderCmd._init_once = !1)
    };
    a.transform = function(a, c) {
        var d = this._node;
        this.originTransform(a, c);
        d._stencil && (d._stencil._renderCmd.transform(this, !0), d._stencil._dirtyFlag &= ~cc.Node._dirtyFlags.transformDirty)
    };
    a.clippingVisit = function(a) {
        var c = this._node;
        a = a || this.getParentRenderCmd();
        this.visit(a);
        if (1 > cc.stencilBits) c._visitChildren();
        else if (c._stencil && c._stencil.visible) if (cc.ClippingNode.WebGLRenderCmd._layer + 1 === cc.stencilBits) cc.ClippingNode.WebGLRenderCmd._visit_once = !0,
        cc.ClippingNode.WebGLRenderCmd._visit_once && (cc.log("Nesting more than " + cc.stencilBits + "stencils is not supported. Everything will be drawn without stencil for this node and its children."), cc.ClippingNode.WebGLRenderCmd._visit_once = !1),
        c._visitChildren();
        else {
            cc.renderer.pushRenderCommand(this._beforeVisitCmd);
            c._stencil.visit(c);
            cc.renderer.pushRenderCommand(this._afterDrawStencilCmd);
            if ((a = c._children) && 0 < a.length) {
                var d = a.length;
                c.sortAllChildren();
                for (var e = 0; e < d; e++) a[e].visit(c)
            }
            cc.renderer.pushRenderCommand(this._afterVisitCmd);
            this._dirtyFlag = 0
        } else c.inverted && c._visitChildren()
    };
    a.setStencil = function(a) {
        var c = this._node;
        c._stencil && (c._stencil._parent = null);
        c._stencil = a;
        c._stencil && (c._stencil._parent = c)
    };
    a.resetProgramByStencil = function() {
        var a = this._node;
        a._stencil && setProgram(a._stencil, a._originStencilProgram)
    };
    a._onBeforeVisit = function(a) {
        var c = a || cc._renderContext;
        a = this._node;
        cc.ClippingNode.WebGLRenderCmd._layer++;
        var d = 1 << cc.ClippingNode.WebGLRenderCmd._layer;
        this._mask_layer_le = d | d - 1;
        this._currentStencilEnabled = c.isEnabled(c.STENCIL_TEST);
        c.clear(c.DEPTH_BUFFER_BIT);
        c.enable(c.STENCIL_TEST);
        c.depthMask(!1);
        c.stencilFunc(c.NEVER, d, d);
        c.stencilOp(c.REPLACE, c.KEEP, c.KEEP);
        c.stencilMask(d);
        c.clear(c.STENCIL_BUFFER_BIT);
        1 > a.alphaThreshold && (c = cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLORALPHATEST), cc.glUseProgram(c.getProgram()), c.setUniformLocationWith1f(cc.UNIFORM_ALPHA_TEST_VALUE_S, a.alphaThreshold), c.setUniformLocationWithMatrix4fv(cc.UNIFORM_MVMATRIX_S, cc.renderer.mat4Identity.mat), cc.setProgram(a._stencil, c))
    };
    a._onAfterDrawStencil = function(a) {
        a = a || cc._renderContext;
        a.depthMask(!0);
        a.stencilFunc(this._node.inverted ? a.NOTEQUAL: a.EQUAL, this._mask_layer_le, this._mask_layer_le);
        a.stencilOp(a.KEEP, a.KEEP, a.KEEP)
    };
    a._onAfterVisit = function(a) {
        a = a || cc._renderContext;
        cc.ClippingNode.WebGLRenderCmd._layer--;
        if (this._currentStencilEnabled) {
            var c = 1 << cc.ClippingNode.WebGLRenderCmd._layer,
            d = c | c - 1;
            a.stencilMask(c);
            a.stencilFunc(a.EQUAL, d, d)
        } else a.disable(a.STENCIL_TEST)
    }
})();
cc.LabelBMFont = cc.SpriteBatchNode.extend({
    _opacityModifyRGB: !1,
    _string: "",
    _config: null,
    _fntFile: "",
    _initialString: "",
    _alignment: cc.TEXT_ALIGNMENT_CENTER,
    _width: -1,
    _lineBreakWithoutSpaces: !1,
    _imageOffset: null,
    _textureLoaded: !1,
    _className: "LabelBMFont",
    _createRenderCmd: function() {
        return cc._renderType === cc.game.RENDER_TYPE_WEBGL ? new cc.LabelBMFont.WebGLRenderCmd(this) : new cc.LabelBMFont.CanvasRenderCmd(this)
    },
    _setString: function(a, b) {
        b ? this._initialString = a: this._string = a;
        var c = this._children;
        if (c) for (var d = 0; d < c.length; d++) {
            var e = c[d];
            e && e.setVisible(!1)
        }
        this._textureLoaded && (this._string && 0 < this._string.length && this.createFontChars(), b && this.updateLabel())
    },
    ctor: function(a, b, c, d, e) {
        cc.SpriteBatchNode.prototype.ctor.call(this);
        this._imageOffset = cc.p(0, 0);
        this._cascadeOpacityEnabled = this._cascadeColorEnabled = !0;
        this.initWithString(a, b, c, d, e)
    },
    textureLoaded: function() {
        return this._textureLoaded
    },
    addLoadedEventListener: function(a, b) {
        this.addEventListener("load", a, b)
    },
    isOpacityModifyRGB: function() {
        return this._opacityModifyRGB
    },
    setOpacityModifyRGB: function(a) {
        this._opacityModifyRGB = a;
        if (a = this._children) for (var b = 0; b < a.length; b++) {
            var c = a[b];
            c && (c.opacityModifyRGB = this._opacityModifyRGB)
        }
    },
    _changeTextureColor: function() {
        this._renderCmd._changeTextureColor()
    },
    init: function() {
        return this.initWithString(null, null, null, null, null)
    },
    initWithString: function(a, b, c, d, e) {
        a = a || "";
        this._config && cc.log("cc.LabelBMFont.initWithString(): re-init is no longer supported");
        var f;
        if (b) {
            f = cc.loader.getRes(b);
            if (!f && (f = cc.FntFrameCache[b] || cc.FntFrameCache[cc.path.basename(b)], !f)) return cc.log("cc.LabelBMFont.initWithString(): Impossible to create font. Please check file"),
            !1;
            this._config = f;
            this._fntFile = b;
            b = f.atlasName; (b = cc.spriteFrameCache.getSpriteFrame(b) || cc.spriteFrameCache.getSpriteFrame(cc.path.basename(b))) ? (f = b.getTexture(), this._spriteFrame = b) : f = cc.textureCache.addImage(f.atlasName); (this._textureLoaded = b = f.isLoaded()) || f.addEventListener("load",
            function(a) {
                this._textureLoaded = !0;
                this.initWithTexture(a, this._initialString.length);
                this.setString(this._initialString, !0);
                this.dispatchEvent("load")
            },
            this)
        } else f = new cc.Texture2D,
        b = new Image,
        f.initWithElement(b),
        this._textureLoaded = !1;
        return this.initWithTexture(f, a.length) ? (this._alignment = d || cc.TEXT_ALIGNMENT_LEFT, this._imageOffset = e || cc.p(0, 0), this._width = void 0 === c ? -1 : c, this._realOpacity = 255, this._realColor = cc.color(255, 255, 255, 255), this._contentSize.width = 0, this._contentSize.height = 0, this.setAnchorPoint(0.5, 0.5), this.setString(a, !0), !0) : !1
    },
    createFontChars: function() {
        var a = this._string,
        b = a ? a.length: 0,
        c = this._renderCmd,
        d = c._texture || this._texture,
        e = 0,
        f = cc.size(0, 0),
        g = 0,
        h = 1,
        k,
        m = this._config,
        r = m.kerningDict,
        s = m.commonHeight,
        t = m.fontDefDictionary;
        for (k = 0; k < b - 1; k++) 10 === a.charCodeAt(k) && h++;
        var p = s * h,
        h = -(s - s * h),
        v = -1,
        u;
        for (k = 0; k < b; k++) if (s = a.charCodeAt(k), 0 !== s) if (10 === s) e = 0,
        h -= m.commonHeight;
        else {
            v = r[v << 16 | s & 65535] || 0;
            u = t[s];
            u || (cc.log("cocos2d: LabelBMFont: character not found " + a[k]), u = {
                rect: {
                    x: 0,
                    y: 0,
                    width: 0,
                    height: 0
                },
                xOffset: 0,
                yOffset: 0,
                xAdvance: 0
            });
            var x = cc.rect(u.rect.x, u.rect.y, u.rect.width, u.rect.height),
            x = cc.rectPixelsToPoints(x);
            x.x += this._imageOffset.x;
            x.y += this._imageOffset.y;
            var y = !1;
            if (this._spriteFrame) {
                var w = this._spriteFrame._rect;
                if (this._spriteFrame._rotated) {
                    var y = !0,
                    B = x.x;
                    x.x = x.y + w.x;
                    x.y = B + w.y
                } else x.x += w.x,
                x.y += w.y
            } (w = this.getChildByTag(k)) ? c._updateCharTexture(w, x, s, y) : (w = new cc.Sprite, w.initWithTexture(d, x, y), w._newTextureWhenChangeColor = !0, this.addChild(w, 0, k));
            w.opacityModifyRGB = this._opacityModifyRGB;
            c._updateCharColorAndOpacity(w);
            x = cc.p(e + u.xOffset + 0.5 * u.rect.width + v, h + (m.commonHeight - u.yOffset) - 0.5 * x.height * cc.contentScaleFactor());
            w.setPosition(cc.pointPixelsToPoints(x));
            e += u.xAdvance + v;
            v = s;
            g < e && (g = e)
        }
        f.width = u && u.xAdvance < u.rect.width ? g - u.xAdvance + u.rect.width: g;
        f.height = p;
        this.setContentSize(cc.sizePixelsToPoints(f))
    },
    updateString: function(a) {
        var b = this._children;
        if (b) for (var c = 0,
        d = b.length; c < d; c++) {
            var e = b[c];
            e && (e.visible = !1)
        }
        this._config && this._string && 0 < this._string.length && this.createFontChars();
        a || this.updateLabel()
    },
    getString: function() {
        return this._initialString
    },
    setString: function(a, b) {
        a = String(a);
        void 0 === b && (b = !0);
        if (void 0 === a || "string" !== typeof a) a += "";
        this._initialString = a;
        this._setString(a, b)
    },
    _setStringForSetter: function(a) {
        this.setString(a, !1)
    },
    setCString: function(a) {
        this.setString(a, !0)
    },
    _getCharsWidth: function(a, b) {
        if (0 >= b) return 0;
        var c = this.getChildByTag(a),
        d = this.getChildByTag(a + b);
        return this._getLetterPosXLeft(d) - this._getLetterPosXLeft(c)
    },
    _checkWarp: function(a, b, c, d) {
        for (var e = a[b], f = 0, g = 0; g < b; g++) f += a[g].length;
        var f = f + b - d,
        h = this._getCharsWidth(f, a[b].length - 1);
        if (h > c && 1 < e.length) {
            d = c / h * e.length | 0;
            for (var g = e.substr(d), k = h - this._getCharsWidth(f + d, g.length - 1), m, r = 0, s = 0; k > c && 100 > s++;) d *= c / k,
            d |= 0,
            g = e.substr(d),
            k = h - this._getCharsWidth(f + d, g.length - 1);
            for (s = 0; k < c && 100 > s++;) g && (r = (m = cc.LabelTTF._wordRex.exec(g)) ? m[0].length: 1, m = g),
            this._lineBreakWithoutSpaces && (r = 0),
            d += r,
            g = e.substr(d),
            k = h - this._getCharsWidth(f + d, g.length - 1);
            d -= r;
            0 === d && (d = 1, m = m.substr(1));
            c = e.substr(0, d);
            cc.LabelTTF.wrapInspection && cc.LabelTTF._symbolRex.test(m || g) && (r = (f = cc.LabelTTF._lastWordRex.exec(c)) ? f[0].length: 0, this._lineBreakWithoutSpaces && (r = 0), d -= r, m = e.substr(d), c = e.substr(0, d));
            cc.LabelTTF._firsrEnglish.test(m) && (f = cc.LabelTTF._lastEnglish.exec(c)) && c !== f[0] && (r = f[0].length, this._lineBreakWithoutSpaces && (r = 0), d -= r, m = e.substr(d), c = e.substr(0, d));
            a[b] = m || g;
            a.splice(b, 0, c)
        }
    },
    updateLabel: function() {
        this.string = this._initialString;
        var a, b, c;
        if (0 < this._width) {
            var d = this.string.split("\n"),
            e = "",
            f = 0,
            g = 0;
            for (a = 0; a < d.length; a++) g = d.length,
            this._checkWarp(d, a, this._width * this._scaleX, f),
            g < d.length && f++,
            0 < a && (e += "\n"),
            e += d[a];
            e += String.fromCharCode(0);
            this._setString(e, !1)
        }
        if (this._alignment !== cc.TEXT_ALIGNMENT_LEFT) for (d = a = 0, e = this._string.length, f = [], g = 0; g < e; g++) if (10 === this._string[g].charCodeAt(0) || 0 === this._string[g].charCodeAt(0)) {
            b = 0;
            var h = f.length;
            if (0 === h) d++;
            else if (c = a + h - 1 + d, !(0 > c)) {
                var k = this.getChildByTag(c);
                if (null != k) {
                    b = k.getPositionX() + k._getWidth() / 2;
                    k = 0;
                    switch (this._alignment) {
                    case cc.TEXT_ALIGNMENT_CENTER:
                        k = this.width / 2 - b / 2;
                        break;
                    case cc.TEXT_ALIGNMENT_RIGHT:
                        k = this.width - b
                    }
                    if (0 !== k) for (b = 0; b < h; b++) c = a + b + d,
                    0 > c || (c = this.getChildByTag(c)) && (c.x += k);
                    a += h;
                    d++;
                    f.length = 0
                }
            }
        } else f.push(this._string[a])
    },
    setAlignment: function(a) {
        this._alignment = a;
        this.updateLabel()
    },
    _getAlignment: function() {
        return this._alignment
    },
    setBoundingWidth: function(a) {
        this._width = a;
        this.updateLabel()
    },
    _getBoundingWidth: function() {
        return this._width
    },
    setLineBreakWithoutSpace: function(a) {
        this._lineBreakWithoutSpaces = a;
        this.updateLabel()
    },
    setScale: function(a, b) {
        cc.Node.prototype.setScale.call(this, a, b);
        this.updateLabel()
    },
    setScaleX: function(a) {
        cc.Node.prototype.setScaleX.call(this, a);
        this.updateLabel()
    },
    setScaleY: function(a) {
        cc.Node.prototype.setScaleY.call(this, a);
        this.updateLabel()
    },
    setFntFile: function(a) {
        if (null != a && a !== this._fntFile) {
            var b = cc.loader.getRes(a);
            b ? (this._fntFile = a, this._config = b, a = cc.textureCache.addImage(b.atlasName), (this._textureLoaded = b = a.isLoaded()) ? (this.setTexture(a), this._string && 0 < this._string.length && this.createFontChars()) : a.addEventListener("load",
            function(a) {
                this._textureLoaded = !0;
                this.setTexture(a);
                this._string && 0 < this._string.length && this.createFontChars();
                this._changeTextureColor();
                this.updateLabel();
                this.dispatchEvent("load")
            },
            this)) : cc.log("cc.LabelBMFont.setFntFile() : Impossible to create font. Please check file")
        }
    },
    getFntFile: function() {
        return this._fntFile
    },
    setTexture: function(a) {
        this._texture = a;
        this._renderCmd.setTexture(a)
    },
    setAnchorPoint: function(a, b) {
        cc.Node.prototype.setAnchorPoint.call(this, a, b);
        this.updateLabel()
    },
    _setAnchorX: function(a) {
        cc.Node.prototype._setAnchorX.call(this, a);
        this.updateLabel()
    },
    _setAnchorY: function(a) {
        cc.Node.prototype._setAnchorY.call(this, a);
        this.updateLabel()
    },
    _atlasNameFromFntFile: function(a) {},
    _kerningAmountForFirst: function(a, b) {
        var c = 0;
        if (this._configuration.kerningDictionary) {
            var d = this._configuration.kerningDictionary[(a << 16 | b & 65535).toString()];
            d && (c = d.amount)
        }
        return c
    },
    _getLetterPosXLeft: function(a) {
        return a.getPositionX() * this._scaleX - a._getWidth() * this._scaleX * a._getAnchorX()
    },
    _getLetterPosXRight: function(a) {
        return a.getPositionX() * this._scaleX + a._getWidth() * this._scaleX * a._getAnchorX()
    },
    _isspace_unicode: function(a) {
        a = a.charCodeAt(0);
        return 9 <= a && 13 >= a || 32 === a || 133 === a || 160 === a || 5760 === a || 8192 <= a && 8202 >= a || 8232 === a || 8233 === a || 8239 === a || 8287 === a || 12288 === a
    },
    _utf8_trim_ws: function(a) {
        var b = a.length;
        if (! (0 >= b) && (b -= 1, this._isspace_unicode(a[b]))) {
            for (var c = b - 1; 0 <= c; --c) if (this._isspace_unicode(a[c])) b = c;
            else break;
            this._utf8_trim_from(a, b)
        }
    },
    _utf8_trim_from: function(a, b) {
        var c = a.length;
        b >= c || 0 > b || a.splice(b, c)
    }
}); (function() {
    var a = cc.LabelBMFont.prototype;
    cc.EventHelper.prototype.apply(a);
    cc.defineGetterSetter(a, "string", a.getString, a._setStringForSetter);
    cc.defineGetterSetter(a, "boundingWidth", a._getBoundingWidth, a.setBoundingWidth);
    cc.defineGetterSetter(a, "textAlign", a._getAlignment, a.setAlignment);
    cc.defineGetterSetter(a, "texture", a.getTexture, a.setTexture)
})();
cc.LabelBMFont.create = function(a, b, c, d, e) {
    return new cc.LabelBMFont(a, b, c, d, e)
};
cc.FntFrameCache = {};
var _fntLoader = {
    FNT_HEAD: /fntframes [^\n]*(\n|$)/gi,
    FNT_FRAME_NAME: /fntframe [^\n]*(\n|$)/gi,
    INFO_EXP: /info [^\n]*(\n|$)/gi,
    COMMON_EXP: /common [^\n]*(\n|$)/gi,
    PAGE_EXP: /page [^\n]*(\n|$)/gi,
    CHAR_EXP: /char [^\n]*(\n|$)/gi,
    KERNING_EXP: /kerning [^\n]*(\n|$)/gi,
    ITEM_EXP: /\w+=[^ \r\n]+/gi,
    INT_EXP: /^[\-]?\d+$/,
    _parseStrToObj: function(a) {
        a = a.match(this.ITEM_EXP);
        var b = {};
        if (a) for (var c = 0,
        d = a.length; c < d; c++) {
            var e = a[c],
            f = e.indexOf("\x3d"),
            g = e.substring(0, f),
            e = e.substring(f + 1);
            e.match(this.INT_EXP) ? e = parseInt(e) : '"' === e[0] && (e = e.substring(1, e.length - 1));
            b[g] = e
        }
        return b
    },
    _parseFntContent: function(a, b, c, d) {
        var e = this._parseStrToObj(b.match(this.COMMON_EXP)[0]);
        a.commonHeight = e.lineHeight;
        if (cc._renderType === cc.game.RENDER_TYPE_WEBGL) {
            var f = cc.configuration.getMaxTextureSize(); (e.scaleW > f.width || e.scaleH > f.height) && cc.log("cc.LabelBMFont._parseCommonArguments(): page can't be larger than supported")
        }
        1 !== e.pages && cc.log("cc.LabelBMFont._parseCommonArguments(): only supports 1 page");
        e = this._parseStrToObj(b.match(this.PAGE_EXP)[0]);
        0 !== e.id && cc.log("cc.LabelBMFont._parseImageFileName() : file could not be found");
        a.atlasName = d ? cc.path.join(cc.path.dirname(d.path) + e.file) : cc.path.changeBasename(c, e.file);
        e = b.match(this.CHAR_EXP);
        f = a.fontDefDictionary = {};
        c = 0;
        for (d = e.length; c < d; c++) {
            var g = this._parseStrToObj(e[c]);
            f[g.id] = {
                rect: {
                    x: g.x,
                    y: g.y,
                    width: g.width,
                    height: g.height
                },
                xOffset: g.xoffset,
                yOffset: g.yoffset,
                xAdvance: g.xadvance
            }
        }
        e = a.kerningDict = {};
        if (b = b.match(this.KERNING_EXP)) for (c = 0, d = b.length; c < d; c++) f = this._parseStrToObj(b[c]),
        e[f.first << 16 | f.second & 65535] = f.amount;
        return a
    },
    parseFnt: function(a, b) {
        var c = {},
        d = a.match(this.FNT_HEAD);
        if (d) {
            var e = this._parseStrToObj(d[0]);
            if (e && e.count) {
                a = a.substr(d[0].length);
                for (var d = a.split("----"), f = 0; f < e.count; ++f) {
                    var g = d[f],
                    h = g.match(this.FNT_FRAME_NAME);
                    if (h) {
                        var k = this._parseStrToObj(h[0]);
                        if (k && k.name) {
                            var c = {},
                            m = cc.path.join(cc.path.dirname(b), k.name);
                            cc.FntFrameCache[m] = this._parseFntContent(c, g.substr(h[0].length), b, {
                                path: k.name
                            })
                        }
                    }
                }
            }
        } else c = this._parseFntContent(c, a, b);
        return c
    },
    load: function(a, b, c, d) {
        var e = this;
        cc.loader.loadTxt(a,
        function(a, c) {
            if (a) return d(a);
            d(null, e.parseFnt(c, b))
        })
    }
};
cc.loader.register(["fnt"], _fntLoader); (function() {
    cc.LabelBMFont.CanvasRenderCmd = function(a) {
        this._rootCtor(a)
    };
    var a = cc.LabelBMFont.CanvasRenderCmd.prototype = Object.create(cc.Node.CanvasRenderCmd.prototype);
    a.constructor = cc.LabelBMFont.CanvasRenderCmd;
    a._updateCharTexture = function(a, c, d) {
        32 === d ? a.setTextureRect(c, !1, cc.size(0, 0)) : (a.setTextureRect(c, !1), a.visible = !0)
    };
    a._updateCharColorAndOpacity = function(a) {
        a._displayedColor = this._displayedColor;
        a._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty);
        a._displayedOpacity = this._displayedOpacity;
        a._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)
    };
    a.setTexture = function(a) {
        for (var c = this._node,
        d = c._children,
        e = this._displayedColor,
        f = 0; f < d.length; f++) {
            var g = d[f],
            h = g._renderCmd,
            k = h._displayedColor;
            if (c._texture === h._texture || k.r === e.r && k.g === e.g && k.b === e.b) g.texture = a
        }
        c._texture = a
    };
    a._changeTextureColor = function() {
        var a = this._node,
        c = a._texture,
        d = c.getContentSize(),
        e = a._texture,
        f = e.getHtmlElementObj(),
        g = this._displayedColor,
        h = cc.rect(0, 0, f.width, f.height);
        c && 0 < d.width && f && (c = e._generateColorTexture(g.r, g.g, g.b, h), a.setTexture(c))
    };
    a._updateChildrenDisplayedOpacity = function(a) {
        cc.Node.prototype.updateDisplayedOpacity.call(a, this._displayedOpacity)
    };
    a._updateChildrenDisplayedColor = function(a) {
        cc.Node.prototype.updateDisplayedColor.call(a, this._displayedColor)
    }
})(); (function() {
    cc.LabelBMFont.WebGLRenderCmd = function(a) {
        this._rootCtor(a)
    };
    var a = cc.LabelBMFont.WebGLRenderCmd.prototype = Object.create(cc.Node.WebGLRenderCmd.prototype);
    a.constructor = cc.LabelBMFont.WebGLRenderCmd;
    a.setTexture = function(a) {
        this._node.setOpacityModifyRGB(this._node._texture.hasPremultipliedAlpha())
    };
    a._updateCharTexture = function(a, c, d, e) {
        a.setTextureRect(c, e);
        a.visible = !0
    };
    a._changeTextureColor = function() {};
    a._updateCharColorAndOpacity = function() {}
})();
cc.LabelAtlas = cc.LabelBMFont.extend({
    _className: "LabelAtlas",
    ctor: function(a, b, c, d, e) {
        cc.SpriteBatchNode.prototype.ctor.call(this);
        this._imageOffset = cc.p(0, 0);
        this._cascadeOpacityEnabled = this._cascadeColorEnabled = !0;
        b && cc.LabelAtlas.prototype.initWithString.call(this, a, b, c, d, e)
    },
    _createRenderCmd: function() {
        return cc._renderType === cc.game.RENDER_TYPE_WEBGL ? new cc.LabelBMFont.WebGLRenderCmd(this) : new cc.LabelBMFont.CanvasRenderCmd(this)
    },
    _createFntConfig: function(a, b, c, d) {
        var e = {};
        e.commonHeight = c;
        var f = e.fontDefDictionary = {},
        g = a.pixelsWidth;
        a = a.pixelsHeight;
        d = d.charCodeAt(0);
        for (var h = 0,
        k = c; k <= a; k += c) for (var m = 0; m < g; m += b) f[d + h] = {
            rect: {
                x: m,
                y: k - c,
                width: b,
                height: c
            },
            xOffset: 0,
            yOffset: 0,
            xAdvance: b
        },
        ++h;
        e.kerningDict = {};
        return e
    },
    initWithString: function(a, b, c, d, e) {
        var f;
        this._string = this._initialString = a = a + "" || "";
        if (void 0 === c) {
            e = cc.loader.getRes(b);
            if (1 !== parseInt(e.version, 10)) return cc.log("cc.LabelAtlas.initWithString(): Unsupported version. Upgrade cocos2d version"),
            !1;
            f = cc.path.changeBasename(b, e.textureFilename);
            d = cc.contentScaleFactor();
            c = parseInt(e.itemWidth, 10) / d;
            d = parseInt(e.itemHeight, 10) / d;
            e = String.fromCharCode(parseInt(e.firstChar, 10))
        } else f = b,
        c = c || 0,
        d = d || 0,
        e = e || " ";
        if (b) {
            this._fntFile = "dummy_fnt_file:" + f;
            b = f;
            var g = cc.spriteFrameCache.getSpriteFrame(b) || cc.spriteFrameCache.getSpriteFrame(cc.path.basename(b));
            g ? (b = g.getTexture(), this._spriteFrame = g) : b = cc.textureCache.addImage(f);
            c = this._createFntConfig(b, c, d, e);
            c.atlasName = f;
            this._config = c; (this._textureLoaded = f = b.isLoaded()) || b.addEventListener("load",
            function(a) {
                this._textureLoaded = !0;
                this.initWithTexture(a, this._initialString.length);
                this.setString(this._initialString, !0);
                this.dispatchEvent("load")
            },
            this)
        } else b = new cc.Texture2D,
        f = new Image,
        b.initWithElement(f),
        this._textureLoaded = !1;
        return this.initWithTexture(b, a.length) ? (this._alignment = cc.TEXT_ALIGNMENT_LEFT, this._imageOffset = cc.p(0, 0), this._width = -1, this._realOpacity = 255, this._realColor = cc.color(255, 255, 255, 255), this._contentSize.width = 0, this._contentSize.height = 0, this.setString(a, !0), !0) : !1
    },
    setFntFile: function() {
        cc.warn("setFntFile doesn't support with LabelAtlas.")
    }
});
cc.LabelAtlas.create = function(a, b, c, d, e) {
    return new cc.LabelAtlas(a, b, c, d, e)
}; (function() {
    cc.LabelAtlas.CanvasRenderCmd = function(a) {
        cc.AtlasNode.CanvasRenderCmd.call(this, a);
        this._needDraw = !1
    };
    var a = cc.LabelAtlas.CanvasRenderCmd.prototype = Object.create(cc.AtlasNode.CanvasRenderCmd.prototype);
    a.constructor = cc.LabelAtlas.CanvasRenderCmd;
    a.setCascade = function() {
        var a = this._node;
        a._cascadeOpacityEnabled = !0;
        a._cascadeColorEnabled = !1
    };
    a.updateAtlasValues = function() {
        for (var a = this._node,
        c = a._string || "",
        d = c.length,
        e = this._textureToRender,
        f = a._itemWidth,
        g = a._itemHeight,
        h = 0,
        k = -1; h < d; h++) {
            var m = c.charCodeAt(h) - a._mapStartChar.charCodeAt(0),
            r = parseInt(m % a._itemsPerRow, 10),
            m = parseInt(m / a._itemsPerRow, 10);
            if (! (0 > r || 0 > m || (r = cc.rect(r * f, m * g, f, g), m = e._contentSize, 0 > r.x || 0 > r.y || r.x + r.width > m.width || r.y + r.height > m.height))) {
                k++;
                var m = c.charCodeAt(h),
                s = a.getChildByTag(h);
                s ? 32 === m ? (s.init(), s.setTextureRect(cc.rect(0, 0, 10, 10), !1, cc.size(0, 0))) : (s.initWithTexture(e, r), s.visible = !0) : (s = new cc.Sprite, 32 === m ? (s.init(), s.setTextureRect(cc.rect(0, 0, 10, 10), !1, cc.size(0, 0))) : s.initWithTexture(e, r), cc.Node.prototype.addChild.call(a, s, 0, h));
                s.setPosition(k * f + f / 2, g / 2)
            }
        }
        this.updateContentSize(h, k + 1)
    };
    a.updateContentSize = function(a, c) {
        var d = this._node,
        e = d._contentSize;
        a !== c && a * d._itemWidth === e.width && d._itemHeight === e.height && d.setContentSize(c * d._itemWidth, d._itemHeight)
    };
    a.setString = function(a) {
        a = this._node;
        if (a._children) {
            a = a._children;
            for (var c = a.length,
            d = 0; d < c; d++) {
                var e = a[d];
                e && !e._lateChild && (e.visible = !1)
            }
        }
    };
    a._addChild = function() {
        child._lateChild = !0
    }
})(); (function() {
    cc.LabelAtlas.WebGLRenderCmd = function(a) {
        cc.AtlasNode.WebGLRenderCmd.call(this, a);
        this._needDraw = !0
    };
    var a = cc.LabelAtlas.WebGLRenderCmd.prototype = Object.create(cc.AtlasNode.WebGLRenderCmd.prototype);
    a.constructor = cc.LabelAtlas.WebGLRenderCmd;
    a._updateColor = function() {
        if (this._colorF32Array) {
            var a = this._displayedColor,
            c = this._displayedOpacity / 255;
            this._node._opacityModifyRGB ? (this._colorF32Array[0] = a.r * c / 255, this._colorF32Array[1] = a.g * c / 255, this._colorF32Array[2] = a.b * c / 255) : (this._colorF32Array[0] = a.r / 255, this._colorF32Array[1] = a.g / 255, this._colorF32Array[2] = a.b / 255);
            this._colorF32Array[3] = c
        }
    };
    a.setCascade = function() {
        var a = this._node;
        a._cascadeOpacityEnabled = !0;
        a._cascadeColorEnabled = !0
    };
    a.rendering = function(a) {
        cc.AtlasNode.WebGLRenderCmd.prototype.rendering.call(this, a);
        if (cc.LABELATLAS_DEBUG_DRAW) {
            var c = this._node;
            a = c.getContentSize();
            var c = c.getBoundingBoxToWorld(),
            d = c.x,
            e = c.y;
            a.width = c.width;
            a.height = c.height;
            a = [cc.p(d, e), cc.p(d + a.width, e), cc.p(a.width + d, a.height + e), cc.p(d, e + a.height)];
            cc._drawingUtil.drawPoly(a, 4, !0)
        }
    };
    a.updateAtlasValues = function() {
        var a = this._node,
        c = a._string,
        d = c.length,
        e = this._textureAtlas,
        f = e.texture,
        g = f.pixelsWidth,
        f = f.pixelsHeight,
        h = a._itemWidth,
        k = a._itemHeight;
        a._ignoreContentScaleFactor || (h = a._itemWidth * cc.contentScaleFactor(), k = a._itemHeight * cc.contentScaleFactor());
        d > e.getCapacity() && cc.log("cc.LabelAtlas._updateAtlasValues(): Invalid String length");
        for (var m = e.quads,
        r = a._itemWidth,
        s = a._itemHeight,
        t = 0,
        p = -1; t < d; t++) {
            var v = c.charCodeAt(t) - a._mapStartChar.charCodeAt(0),
            u = v % a._itemsPerRow,
            x = 0 | v / a._itemsPerRow;
            if (! (0 > u || 0 > x || u * r + r > g || x * s + s > f)) {
                p++;
                var y;
                cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL ? (u = (2 * u * h + 1) / (2 * g), v = u + (2 * h - 2) / (2 * g), x = (2 * x * k + 1) / (2 * f), y = x + (2 * k - 2) / (2 * f)) : (u = u * h / g, v = u + h / g, x = x * k / f, y = x + k / f);
                var w = m[t],
                B = w.tl,
                z = w.tr,
                A = w.bl,
                w = w.br;
                B.texCoords.u = u;
                B.texCoords.v = x;
                z.texCoords.u = v;
                z.texCoords.v = x;
                A.texCoords.u = u;
                A.texCoords.v = y;
                w.texCoords.u = v;
                w.texCoords.v = y;
                A.vertices.x = p * r;
                A.vertices.y = 0;
                A.vertices.z = 0;
                w.vertices.x = p * r + r;
                w.vertices.y = 0;
                w.vertices.z = 0;
                B.vertices.x = p * r;
                B.vertices.y = a._itemHeight;
                B.vertices.z = 0;
                z.vertices.x = p * r + r;
                z.vertices.y = a._itemHeight;
                z.vertices.z = 0
            }
        }
        this._updateColor();
        this.updateContentSize(t, p + 1);
        0 < d && (e.dirty = !0, a = e.totalQuads, d > a && e.increaseTotalQuadsWith(d - a))
    };
    a.updateContentSize = function(a, c) {
        var d = this._node,
        e = d._contentSize;
        a !== c && a * d._itemWidth === e.width && d._itemHeight === e.height && d.setContentSize(c * d._itemWidth, d._itemHeight)
    };
    a.setString = function(a) {
        a = a.length;
        a > this._textureAtlas.totalQuads && this._textureAtlas.resizeCapacity(a)
    };
    a._addChild = function() {}
})(); (function() {
    var a = cc.sys,
    b = {
        ONLY_ONE: !1,
        WEB_AUDIO: !!(window.AudioContext || window.webkitAudioContext || window.mozAudioContext),
        DELAY_CREATE_CTX: !1,
        ONE_SOURCE: !1
    };
    a.browserType === a.BROWSER_TYPE_FIREFOX && (b.DELAY_CREATE_CTX = !0, b.USE_LOADER_EVENT = "canplay");
    a.os === a.OS_IOS && (b.USE_LOADER_EVENT = "loadedmetadata");
    a.os === a.OS_ANDROID && a.browserType === a.BROWSER_TYPE_UC && (b.ONE_SOURCE = !0);
    window.__audioSupport = b
})();
cc.Audio = cc.Class.extend({
    interruptPlay: !1,
    src: null,
    _element: null,
    _AUDIO_TYPE: "AUDIO",
    ctor: function(a) {
        this.src = a
    },
    setBuffer: function(a) {
        this._AUDIO_TYPE = "WEBAUDIO";
        this._element = new cc.Audio.WebAudio(a)
    },
    setElement: function(a) {
        this._AUDIO_TYPE = "AUDIO";
        this._element = a;
        a.addEventListener("ended",
        function() {
            a.loop || (a.paused = !0)
        })
    },
    play: function(a, b) {
        this._element ? (this._element.loop = b, this._element.play(), "AUDIO" === this._AUDIO_TYPE && this._element.paused && (this.stop(), cc.Audio.touchPlayList.push({
            loop: b,
            offset: a,
            audio: this._element
        })), !1 === cc.Audio.bindTouch && (cc.Audio.bindTouch = !0, cc.game.canvas.addEventListener("touchstart", cc.Audio.touchStart))) : this.interruptPlay = !1
    },
    getPlaying: function() {
        return this._element ? !this._element.paused: !0
    },
    stop: function() {
        if (this._element) {
            this._element.pause();
            try {
                this._element.currentTime = 0
            } catch(a) {}
        } else this.interruptPlay = !0
    },
    pause: function() {
        this._element ? this._element.pause() : this.interruptPlay = !0
    },
    resume: function() {
        this._element ? this._element.play() : this.interruptPlay = !1
    },
    setVolume: function(a) {
        this._element && (this._element.volume = a)
    },
    getVolume: function() {
        if (this._element) return this._element.volume
    },
    cloneNode: function() {
        var a = new cc.Audio(this.src);
        if ("AUDIO" === this._AUDIO_TYPE) {
            for (var b = document.createElement("audio"), c = b.getElementsByTagName("source"), d = 0; d < c.length; d++) b.appendChild(c[d]);
            b.src = this.src;
            a.setElement(b)
        } else a.setBuffer(this._element.buffer);
        return a
    }
});
cc.Audio.touchPlayList = [];
cc.Audio.bindTouch = !1;
cc.Audio.touchStart = function() {
    for (var a = cc.Audio.touchPlayList,
    b = null; b = a.pop();) b.audio.loop = !!b.loop,
    b.audio.play(b.offset)
};
cc.Audio.WebAudio = function(a) {
    this.buffer = a;
    this.context = cc.Audio._context;
    a = this.context.createGain();
    a.gain.value = 1;
    a.connect(this.context.destination);
    this._volume = a;
    this._loop = !1;
    this._startTime = -1;
    this._currentSource = null;
    this.playedLength = 0;
    this._currextTimer = null
};
cc.Audio.WebAudio.prototype = {
    constructor: cc.Audio.WebAudio,
    get paused() {
        return this._currentSource && this._currentSource.loop ? !1 : -1 === this._startTime ? !0 : this.context.currentTime - this._startTime > this.buffer.duration
    },
    set paused(a) {},
    get loop() {
        return this._loop
    },
    set loop(a) {
        return this._loop = a
    },
    get volume() {
        return this._volume.gain.value
    },
    set volume(a) {
        return this._volume.gain.value = a
    },
    get currentTime() {
        return this.playedLength
    },
    set currentTime(a) {
        return this.playedLength = a
    },
    play: function(a) {
        this._currentSource && !this.paused && (this._currentSource.stop(0), this.playedLength = 0);
        var b = this.context.createBufferSource();
        b.buffer = this.buffer;
        b.connect(this._volume);
        b.loop = this._loop;
        this._startTime = this.context.currentTime;
        a = a || this.playedLength;
        var c = this.buffer.duration;
        this._loop ? b.start ? b.start(0) : b.notoGrainOn ? b.noteGrainOn(0) : b.noteOn(0) : b.start ? b.start(0, a, c - a) : b.notoGrainOn ? b.noteGrainOn(0, a, c - a) : b.noteOn(0, a, c - a);
        this._currentSource = b;
        if (0 === this.context.currentTime) {
            var d = this;
            clearTimeout(this._currextTimer);
            this._currextTimer = setTimeout(function() {
                0 === d.context.currentTime && cc.Audio.touchPlayList.push({
                    offset: a,
                    audio: d
                })
            },
            10)
        }
    },
    pause: function() {
        this.playedLength = this.context.currentTime - this._startTime;
        this.playedLength %= this.buffer.duration;
        var a = this._currentSource;
        this._currentSource = null;
        this._startTime = -1;
        a && a.stop(0)
    }
}; (function(a) {
    var b = a.WEB_AUDIO,
    c = []; (function() {
        var a = document.createElement("audio");
        if (a.canPlayType) {
            var b = a.canPlayType('audio/ogg; codecs\x3d"vorbis"');
            b && "" !== b && c.push(".ogg"); (b = a.canPlayType("audio/mpeg")) && "" !== b && c.push(".mp3"); (b = a.canPlayType('audio/wav; codecs\x3d"1"')) && "" !== b && c.push(".wav"); (b = a.canPlayType("audio/mp4")) && "" !== b && c.push(".mp4"); (a = a.canPlayType("audio/x-m4a")) && "" !== a && c.push(".m4a")
        }
    })();
    try {
        if (b) {
            var d = new(window.AudioContext || window.webkitAudioContext || window.mozAudioContext);
            cc.Audio._context = d;
            if (! (d.createBufferSource && d.createGain && d.destination && d.decodeAudioData)) throw "context is incomplete";
            a.DELAY_CREATE_CTX && setTimeout(function() {
                d = new(window.AudioContext || window.webkitAudioContext || window.mozAudioContext);
                cc.Audio._context = d
            },
            0)
        }
    } catch(e) {
        b = !1,
        cc.log("browser don't support web audio")
    }
    cc.loader.register(["mp3", "ogg", "wav", "mp4", "m4a"], {
        cache: {},
        useWebAudio: !0,
        loadBuffer: function(a, c) {
            if (b) {
                var e = cc.loader.getXMLHttpRequest();
                e.open("GET", a, !0);
                e.responseType = "arraybuffer";
                e.onload = function() {
                    0 <= e._timeoutId && clearTimeout(e._timeoutId);
                    d.decodeAudioData(e.response,
                    function(a) {
                        c(null, a)
                    },
                    function() {
                        c("decode error - " + a)
                    })
                };
                e.onerror = function() {
                    c("request error - " + a)
                };
                void 0 === e.ontimeout && (e._timeoutId = setTimeout(function() {
                    e.ontimeout()
                },
                e.timeout));
                e.ontimeout = function() {
                    c("request timeout - " + a)
                };
                e.send()
            }
        },
        load: function(a, b, d, e) {
            if (0 === c.length) return e("can not support audio!");
            var m = cc.loader.getRes(b);
            if (m) return e(null, m);
            cc.loader.audioPath && (a = cc.path.join(cc.loader.audioPath, a));
            m = cc.path.extname(a);
            d = [m];
            for (var r = 0; r < c.length; r++) m !== c[r] && d.push(c[r]);
            m = new cc.Audio(a);
            cc.loader.cache[b] = m;
            this.loadAudioFromExtList(a, d, m, e);
            return m
        },
        loadAudioFromExtList: function(d, e, h, k) {
            if (0 === e.length) {
                var m = "can not found the resource of audio! Last match url is : ",
                m = m + d.replace(/\.(.*)?$/, "(");
                c.forEach(function(a) {
                    m += a + "|"
                });
                m = m.replace(/\|$/, ")");
                return k({
                    status: 520,
                    errorMessage: m
                },
                null)
            }
            if (b && this.useWebAudio) this.loadBuffer(d,
            function(a, b) {
                a && cc.log(a);
                b && h.setBuffer(b);
                k(null, h)
            });
            else {
                for (var r = a.ONE_SOURCE ? 1 : e.length, s = document.createElement("audio"), t = 0; t < r; t++) {
                    var p = document.createElement("source");
                    p.src = cc.path.changeExtname(d, e[t]);
                    s.appendChild(p)
                }
                h.setElement(s);
                var v = setTimeout(function() {
                    0 === s.readyState ? x() : u()
                },
                8E3),
                u = function() {
                    s.removeEventListener("canplaythrough", u, !1);
                    s.removeEventListener("error", x, !1);
                    s.removeEventListener("emptied", u, !1);
                    a.USE_LOADER_EVENT && s.removeEventListener(a.USE_LOADER_EVENT, u, !1);
                    clearTimeout(v);
                    k(null, h)
                },
                x = function() {
                    cc.log("load audio failure - " + d);
                    u()
                };
                s.addEventListener("canplaythrough", u, !1);
                s.addEventListener("error", x, !1);
                a.USE_LOADER_EVENT && s.addEventListener(a.USE_LOADER_EVENT, u, !1)
            }
        }
    });
    cc.audioEngine = {
        _currMusic: null,
        _musicVolume: 1,
        features: a,
        willPlayMusic: function() {
            return ! 1
        },
        playMusic: function(a, b) {
            var c = cc.loader.getRes(a);
            if (null != c) {
                var d = this._currMusic;
                d && d.getPlaying() && d.stop();
                var e = this._musicVolume,
                c = cc.loader.getRes(a);
                c || (cc.loader.load(a,
                function() {
                    c.getPlaying() || c.interruptPlay || (c.setVolume(e), c.play(0, b || !1))
                }), c = cc.loader.getRes(a));
                c.setVolume(e);
                c.play(0, b || !1);
                this._currMusic = c
            }
        },
        stopMusic: function(a) {
            var b = this._currMusic;
            if (b) {
                for (var c = cc.Audio.touchPlayList,
                d = c.length - 1; 0 <= d; --d) this[d] && this[d].audio === b._element && c.splice(d, 1);
                b.stop();
                this._currMusic = null;
                a && cc.loader.release(b.src)
            }
        },
        pauseMusic: function() {
            var a = this._currMusic;
            a && a.pause()
        },
        resumeMusic: function() {
            var a = this._currMusic;
            a && a.resume()
        },
        rewindMusic: function() {
            var a = this._currMusic;
            a && (a.stop(), a.play())
        },
        getMusicVolume: function() {
            return this._musicVolume
        },
        setMusicVolume: function(a) {
            a -= 0;
            isNaN(a) && (a = 1);
            1 < a && (a = 1);
            0 > a && (a = 0);
            this._musicVolume = a;
            var b = this._currMusic;
            b && b.setVolume(a)
        },
        isMusicPlaying: function() {
            var a = this._currMusic;
            return a ? a.getPlaying() : !1
        },
        _audioPool: {},
        _maxAudioInstance: 10,
        _effectVolume: 1,
        playEffect: function(a, b) {
            var c = cc.loader.getRes(a);
            null != c && (c.setVolume(this._effectVolume), c.play(0, b || !1))
        },
        setEffectsVolume: function(a) {
            a -= 0;
            isNaN(a) && (a = 1);
            1 < a && (a = 1);
            0 > a && (a = 0);
            this._effectVolume = a;
            var b = this._audioPool,
            c;
            for (c in b) {
                var d = b[c];
                if (Array.isArray(d)) for (var e = 0; e < d.length; e++) d[e].setVolume(a)
            }
        },
        getEffectsVolume: function() {
            return this._effectVolume
        },
        pauseEffect: function(a) {
            a && a.pause()
        },
        pauseAllEffects: function() {
            var a = this._audioPool,
            b;
            for (b in a) for (var c = a[b], d = 0; d < a[b].length; d++) c[d].getPlaying() && c[d].pause()
        },
        resumeEffect: function(a) {
            a && a.resume()
        },
        resumeAllEffects: function() {
            var a = this._audioPool,
            b;
            for (b in a) for (var c = a[b], d = 0; d < a[b].length; d++) c[d].resume()
        },
        stopEffect: function(a) {
            a && a.stop()
        },
        stopAllEffects: function() {
            var a = this._audioPool,
            b;
            for (b in a) {
                for (var c = a[b], d = 0; d < c.length; d++) c[d].stop();
                c.length = 0
            }
            a.length = 0
        },
        unloadEffect: function(a) {
            if (a) {
                cc.loader.release(a);
                var b = this._audioPool[a];
                if (b) {
                    for (var c = 0; c < b.length; c++) b[c].stop();
                    b.length = 0
                }
                delete this._audioPool[a]
            }
        },
        end: function() {
            this.stopMusic();
            this.stopAllEffects()
        },
        _pauseCache: [],
        _pausePlaying: function() {
            var a = this._currMusic;
            a && a.getPlaying() && (a.pause(), this._pauseCache.push(a));
            var a = this._audioPool,
            b;
            for (b in a) for (var c = a[b], d = 0; d < a[b].length; d++) c[d].getPlaying() && (c[d].pause(), this._pauseCache.push(c[d]))
        },
        _resumePlaying: function() {
            for (var a = this._pauseCache,
            b = 0; b < a.length; b++) a[b].resume();
            a.length = 0
        }
    }
})(window.__audioSupport);
cc.KEYBOARD_RETURNTYPE_DEFAULT = 0;
cc.KEYBOARD_RETURNTYPE_DONE = 1;
cc.KEYBOARD_RETURNTYPE_SEND = 2;
cc.KEYBOARD_RETURNTYPE_SEARCH = 3;
cc.KEYBOARD_RETURNTYPE_GO = 4;
cc.EDITBOX_INPUT_MODE_ANY = 0;
cc.EDITBOX_INPUT_MODE_EMAILADDR = 1;
cc.EDITBOX_INPUT_MODE_NUMERIC = 2;
cc.EDITBOX_INPUT_MODE_PHONENUMBER = 3;
cc.EDITBOX_INPUT_MODE_URL = 4;
cc.EDITBOX_INPUT_MODE_DECIMAL = 5;
cc.EDITBOX_INPUT_MODE_SINGLELINE = 6;
cc.EDITBOX_INPUT_FLAG_PASSWORD = 0;
cc.EDITBOX_INPUT_FLAG_SENSITIVE = 1;
cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_WORD = 2;
cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_SENTENCE = 3;
cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_ALL_CHARACTERS = 4;
cc.EditBoxDelegate = cc.Class.extend({
    editBoxEditingDidBegin: function(a) {},
    editBoxEditingDidEnd: function(a) {},
    editBoxTextChanged: function(a, b) {},
    editBoxReturn: function(a) {}
});
cc.EditBox = cc.Node.extend({
    _backgroundSprite: null,
    _delegate: null,
    _editBoxInputMode: cc.EDITBOX_INPUT_MODE_ANY,
    _editBoxInputFlag: cc.EDITBOX_INPUT_FLAG_SENSITIVE,
    _keyboardReturnType: cc.KEYBOARD_RETURNTYPE_DEFAULT,
    _maxLength: 50,
    _text: "",
    _textColor: null,
    _placeholderText: "",
    _placeholderFontName: "",
    _placeholderFontSize: 14,
    _placeholderColor: null,
    _className: "EditBox",
    _touchListener: null,
    _touchEnabled: !0,
    ctor: function(a, b) {
        cc.Node.prototype.ctor.call(this);
        this._anchorPoint = cc.p(0.5, 0.5);
        this._textColor = cc.color.WHITE;
        this._placeholderColor = cc.color.GRAY;
        this._renderCmd._createLabels();
        this.createDomElementIfNeeded();
        this.initWithSizeAndBackgroundSprite(a, b);
        this._touchListener = cc.EventListener.create({
            event: cc.EventListener.TOUCH_ONE_BY_ONE,
            swallowTouches: !0,
            onTouchBegan: this._onTouchBegan.bind(this),
            onTouchEnded: this._onTouchEnded.bind(this)
        });
        cc.eventManager.addListener(this._touchListener, this);
        this.setInputFlag(this._editBoxInputFlag)
    },
    setTouchEnabled: function(a) {
        this._touchEnabled !== a && ((this._touchEnabled = a) ? cc.eventManager.addListener(this._touchListener, this) : cc.eventManager.removeListener(this._touchListener))
    },
    _createRenderCmd: function() {
        return cc._renderType === cc.game.RENDER_TYPE_CANVAS ? new cc.EditBox.CanvasRenderCmd(this) : new cc.EditBox.WebGLRenderCmd(this)
    },
    setContentSize: function(a, b) {
        void 0 !== a.width && void 0 !== a.height && (b = a.height, a = a.width);
        cc.Node.prototype.setContentSize.call(this, a, b);
        this._updateEditBoxSize(a, b)
    },
    setVisible: function(a) {
        cc.Node.prototype.setVisible.call(this, a);
        this._renderCmd.updateVisibility()
    },
    createDomElementIfNeeded: function() {
        this._renderCmd._edTxt || this._renderCmd._createDomTextArea()
    },
    setTabIndex: function(a) {
        this._renderCmd._edTxt && (this._renderCmd._edTxt.tabIndex = a)
    },
    getTabIndex: function() {
        if (this._renderCmd._edTxt) return this._renderCmd._edTxt.tabIndex;
        cc.warn("The dom control is not created!");
        return - 1
    },
    setFocus: function() {
        this._renderCmd._edTxt && this._renderCmd._edTxt.focus()
    },
    isFocused: function() {
        if (this._renderCmd._edTxt) return document.activeElement === this._renderCmd._edTxt;
        cc.warn("The dom control is not created!");
        return ! 1
    },
    stayOnTop: function(a) {
        this._alwaysOnTop !== a && (this._alwaysOnTop = a, this._renderCmd.stayOnTop(this._alwaysOnTop))
    },
    cleanup: function() {
        this._super();
        this._renderCmd._removeDomFromGameContainer()
    },
    _isAncestorsVisible: function(a) {
        return null == a ? !0 : (a = a.getParent()) && !a.isVisible() ? !1 : this._isAncestorsVisible(a)
    },
    _onTouchBegan: function(a) {
        if (this.isVisible() && this._isAncestorsVisible(this)) {
            a = a.getLocation();
            var b = cc.rect(0, 0, this._contentSize.width, this._contentSize.height);
            if (cc.rectContainsPoint(b, this.convertToNodeSpace(a))) return ! 0;
            this._renderCmd._endEditing();
            return ! 1
        }
    },
    _onTouchEnded: function() {
        this.isVisible() && this._isAncestorsVisible(this) && this._renderCmd._beginEditing()
    },
    _updateBackgroundSpriteSize: function(a, b) {
        this._backgroundSprite && this._backgroundSprite.setContentSize(a, b)
    },
    _updateEditBoxSize: function(a, b) {
        var c = "number" === typeof a.width ? a.width: a,
        d = "number" === typeof a.height ? a.height: b;
        this._updateBackgroundSpriteSize(c, d);
        this._renderCmd.updateSize(c, d)
    },
    setLineHeight: function(a) {
        this._renderCmd.setLineHeight(a)
    },
    setFont: function(a, b) {
        this._renderCmd.setFont(a, b)
    },
    _setFont: function(a) {
        this._renderCmd._setFont(a)
    },
    getBackgroundSprite: function() {
        return this._backgroundSprite
    },
    setFontName: function(a) {
        this._renderCmd.setFontName(a)
    },
    setFontSize: function(a) {
        this._renderCmd.setFontSize(a)
    },
    setString: function(a) {
        a.length >= this._maxLength && (a = a.slice(0, this._maxLength));
        this._text = a;
        this._renderCmd.setString(a)
    },
    setFontColor: function(a) {
        this._textColor = a;
        this._renderCmd.setFontColor(a)
    },
    setMaxLength: function(a) {
        isNaN(a) || (0 > a && (a = 65535), this._maxLength = a, this._renderCmd.setMaxLength(a))
    },
    getMaxLength: function() {
        return this._maxLength
    },
    setPlaceHolder: function(a) {
        null !== a && (this._renderCmd.setPlaceHolder(a), this._placeholderText = a)
    },
    setPlaceholderFont: function(a, b) {
        this._placeholderFontName = a;
        this._placeholderFontSize = b;
        this._renderCmd._updateDOMPlaceholderFontStyle()
    },
    _setPlaceholderFont: function(a) {
        if (a = cc.LabelTTF._fontStyleRE.exec(a)) this._placeholderFontName = a[2],
        this._placeholderFontSize = parseInt(a[1]),
        this._renderCmd._updateDOMPlaceholderFontStyle()
    },
    setPlaceholderFontName: function(a) {
        this._placeholderFontName = a;
        this._renderCmd._updateDOMPlaceholderFontStyle()
    },
    setPlaceholderFontSize: function(a) {
        this._placeholderFontSize = a;
        this._renderCmd._updateDOMPlaceholderFontStyle()
    },
    setPlaceholderFontColor: function(a) {
        this._placeholderColor = a;
        this._renderCmd.setPlaceholderFontColor(a)
    },
    setInputFlag: function(a) {
        this._editBoxInputFlag = a;
        this._renderCmd.setInputFlag(a)
    },
    getString: function() {
        return this._text
    },
    initWithSizeAndBackgroundSprite: function(a, b) {
        this._backgroundSprite && this._backgroundSprite.removeFromParent();
        this._backgroundSprite = b;
        this.setContentSize(a);
        this._backgroundSprite && !this._backgroundSprite.parent && (this._backgroundSprite.setAnchorPoint(cc.p(0, 0)), this.addChild(this._backgroundSprite), this._updateBackgroundSpriteSize(a.width, a.height));
        this.y = this.x = 0;
        return ! 0
    },
    setDelegate: function(a) {
        this._delegate = a
    },
    getPlaceHolder: function() {
        return this._placeholderText
    },
    setInputMode: function(a) {
        if (this._editBoxInputMode !== a) {
            var b = this.getString();
            this._editBoxInputMode = a;
            this._renderCmd.setInputMode(a);
            this._renderCmd.transform();
            this.setString(b);
            this._renderCmd._updateLabelPosition(this.getContentSize())
        }
    },
    setReturnType: function(a) {
        this._keyboardReturnType = a;
        this._renderCmd._updateDomInputType()
    },
    initWithBackgroundColor: function(a, b) {
        this._edWidth = a.width;
        this.dom.style.width = this._edWidth.toString() + "px";
        this._edHeight = a.height;
        this.dom.style.height = this._edHeight.toString() + "px";
        this.dom.style.backgroundColor = cc.colorToHex(b)
    }
});
_p = cc.EditBox.prototype;
cc.defineGetterSetter(_p, "font", null, _p._setFont);
cc.defineGetterSetter(_p, "fontName", null, _p.setFontName);
cc.defineGetterSetter(_p, "fontSize", null, _p.setFontSize);
cc.defineGetterSetter(_p, "fontColor", null, _p.setFontColor);
cc.defineGetterSetter(_p, "string", _p.getString, _p.setString);
cc.defineGetterSetter(_p, "maxLength", _p.getMaxLength, _p.setMaxLength);
cc.defineGetterSetter(_p, "placeholder", _p.getPlaceHolder, _p.setPlaceHolder);
cc.defineGetterSetter(_p, "placeholderFont", null, _p._setPlaceholderFont);
cc.defineGetterSetter(_p, "placeholderFontName", null, _p.setPlaceholderFontName);
cc.defineGetterSetter(_p, "placeholderFontSize", null, _p.setPlaceholderFontSize);
cc.defineGetterSetter(_p, "placeholderFontColor", null, _p.setPlaceholderFontColor);
cc.defineGetterSetter(_p, "inputFlag", null, _p.setInputFlag);
cc.defineGetterSetter(_p, "delegate", null, _p.setDelegate);
cc.defineGetterSetter(_p, "inputMode", null, _p.setInputMode);
cc.defineGetterSetter(_p, "returnType", null, _p.setReturnType);
_p = null;
cc.EditBox.create = function(a, b, c, d) {
    return new cc.EditBox(a, b, c, d)
}; (function(a) {
    a._polyfill = {
        zoomInvalid: !1
    };
    cc.sys.OS_ANDROID !== cc.sys.os || cc.sys.browserType !== cc.sys.BROWSER_TYPE_SOUGOU && cc.sys.browserType !== cc.sys.BROWSER_TYPE_360 || (a._polyfill.zoomInvalid = !0)
})(cc.EditBox); (function(a) {
    function b(a) {
        var b = a.convertToWorldSpace(cc.p(0, 0)),
        e = cc.visibleRect.height,
        f = 0.5;
        cc.visibleRect.width > e && (f = 0.7);
        setTimeout(function() {
            if (window.scrollY < c && b.y < e * f) {
                var a = e * f - b.y - window.scrollY;
                35 > a && (a = 35);
                320 < a && (a = 320);
                window.scrollTo(a, a)
            }
        },
        d)
    }
    var c = 40,
    d = 400,
    e = function(a) {
        return a.replace(/(?:^|\s)\S/g,
        function(a) {
            return a.toUpperCase()
        })
    },
    f = function() {}.prototype = Object.create(Object.prototype);
    f.updateMatrix = function() {
        if (this._edTxt) {
            var b = this._node,
            c = cc.view._scaleX,
            d = cc.view._scaleY,
            e = cc.view._devicePixelRatio,
            f = this._worldTransform,
            c = c / e,
            d = d / e,
            g = cc.game.container,
            e = f.a * c,
            p = f.b,
            v = f.c,
            u = f.d * d,
            x = g && g.style.paddingLeft && parseInt(g.style.paddingLeft),
            g = g && g.style.paddingBottom && parseInt(g.style.paddingBottom),
            c = f.tx * c + x,
            d = f.ty * d + g;
            a.zoomInvalid && (this.updateSize(b._contentSize.width * e, b._contentSize.height * u), u = e = 1);
            b = "matrix(" + e + "," + -p + "," + -v + "," + u + "," + c + "," + -d + ")";
            this._edTxt.style.transform = b;
            this._edTxt.style["-webkit-transform"] = b;
            this._edTxt.style["transform-origin"] = "0px 100% 0px";
            this._edTxt.style["-webkit-transform-origin"] = "0px 100% 0px"
        }
    };
    f.updateVisibility = function() {
        this._edTxt && (this._edTxt.style.visibility = this._node.visible ? "visible": "hidden")
    };
    f.stayOnTop = function(a) {
        a ? (this._removeLabels(), this._edTxt.style.display = "") : (this._createLabels(), this._edTxt.style.display = "none", this._showLabels())
    };
    f._beginEditingOnMobile = function(a) {
        this.__orientationChanged = function() {
            b(a)
        };
        window.addEventListener("orientationchange", this.__orientationChanged);
        cc.view.isAutoFullScreenEnabled() ? (this.__fullscreen = !0, cc.view.enableAutoFullScreen(!1), cc.screen.exitFullScreen()) : this.__fullscreen = !1;
        this.__autoResize = cc.view.__resizeWithBrowserSize;
        cc.view.resizeWithBrowserSize(!1)
    };
    f._endEditingOnMobile = function() {
        if (this.__rotateScreen) {
            var a = cc.game.container.style;
            a["-webkit-transform"] = "rotate(90deg)";
            a.transform = "rotate(90deg)";
            var a = cc.view,
            b = a._originalDesignResolutionSize.width,
            c = a._originalDesignResolutionSize.height;
            0 < b && a.setDesignResolutionSize(b, c, a._resolutionPolicy);
            this.__rotateScreen = !1
        }
        window.removeEventListener("orientationchange", this.__orientationChanged);
        window.scrollTo(0, 0);
        this.__fullscreen && cc.view.enableAutoFullScreen(!0);
        this.__autoResize && cc.view.resizeWithBrowserSize(!0)
    };
    f._onFocusOnMobile = function(a) {
        if (cc.view._isRotated) {
            var c = cc.game.container.style;
            c["-webkit-transform"] = "rotate(0deg)";
            c.transform = "rotate(0deg)";
            c.margin = "0px";
            window.scrollTo(35, 35);
            this.__rotateScreen = !0
        } else this.__rotateScreen = !1;
        b(a)
    };
    f._createDomInput = function() {
        this._removeDomFromGameContainer();
        var a = this,
        b = this._edTxt = document.createElement("input");
        b.type = "text";
        b.style.fontFamily = this._edFontName;
        b.style.fontSize = this._edFontSize + "px";
        b.style.color = "#000000";
        b.style.border = 0;
        b.style.background = "transparent";
        b.style.width = "100%";
        b.style.height = "100%";
        b.style.active = 0;
        b.style.outline = "medium";
        b.style.padding = "0";
        b.style.textTransform = "uppercase";
        b.style.display = "none";
        b.style.position = "absolute";
        b.style.bottom = "0px";
        b.style.left = "2px";
        b.style.className = "cocosEditBox";
        this.setMaxLength(a._editBox._maxLength);
        b.addEventListener("input",
        function() {
            var b = a._editBox;
            this.value.length > this.maxLength && (this.value = this.value.slice(0, this.maxLength));
            b._delegate && b._delegate.editBoxTextChanged && b._text !== this.value && (b._text = this.value, a._updateDomTextCases(), b._delegate.editBoxTextChanged(b, b._text))
        });
        b.addEventListener("keypress",
        function(b) {
            var c = a._editBox;
            b.keyCode === cc.KEY.enter && (b.stopPropagation(), b.preventDefault(), "" === this.value && (this.style.fontSize = c._placeholderFontSize + "px", this.style.color = cc.colorToHex(c._placeholderColor)), c._text = this.value, a._updateDomTextCases(), a._endEditing(), c._delegate && c._delegate.editBoxReturn && c._delegate.editBoxReturn(c), cc._canvas.focus())
        });
        b.addEventListener("focus",
        function() {
            var b = a._editBox;
            this.style.fontSize = a._edFontSize + "px";
            this.style.color = cc.colorToHex(b._textColor);
            a._hiddenLabels();
            cc.sys.isMobile && a._onFocusOnMobile(b);
            b._delegate && b._delegate.editBoxEditingDidBegin && b._delegate.editBoxEditingDidBegin(b)
        });
        b.addEventListener("blur",
        function() {
            var b = a._editBox;
            b._text = this.value;
            a._updateDomTextCases();
            b._delegate && b._delegate.editBoxEditingDidEnd && b._delegate.editBoxEditingDidEnd(b);
            "" === this.value && (this.style.fontSize = b._placeholderFontSize + "px", this.style.color = cc.colorToHex(b._placeholderColor));
            a._endEditing()
        });
        this._addDomToGameContainer();
        return b
    };
    f._createDomTextArea = function() {
        this._removeDomFromGameContainer();
        var a = this,
        b = this._edTxt = document.createElement("textarea");
        b.type = "text";
        b.style.fontFamily = this._edFontName;
        b.style.fontSize = this._edFontSize + "px";
        b.style.color = "#000000";
        b.style.border = 0;
        b.style.background = "transparent";
        b.style.width = "100%";
        b.style.height = "100%";
        b.style.active = 0;
        b.style.outline = "medium";
        b.style.padding = "0";
        b.style.resize = "none";
        b.style.textTransform = "uppercase";
        b.style.overflow_y = "scroll";
        b.style.display = "none";
        b.style.position = "absolute";
        b.style.bottom = "0px";
        b.style.left = "2px";
        b.style.className = "cocosEditBox";
        this.setMaxLength(a._editBox._maxLength);
        b.addEventListener("input",
        function() {
            this.value.length > this.maxLength && (this.value = this.value.slice(0, this.maxLength));
            var b = a._editBox;
            b._delegate && b._delegate.editBoxTextChanged && b._text.toLowerCase() !== this.value.toLowerCase() && (b._text = this.value, a._updateDomTextCases(), b._delegate.editBoxTextChanged(b, b._text))
        });
        b.addEventListener("focus",
        function() {
            var b = a._editBox;
            a._hiddenLabels();
            this.style.fontSize = a._edFontSize + "px";
            this.style.color = cc.colorToHex(b._textColor);
            cc.sys.isMobile && a._onFocusOnMobile(b);
            b._delegate && b._delegate.editBoxEditingDidBegin && b._delegate.editBoxEditingDidBegin(b)
        });
        b.addEventListener("keypress",
        function(b) {
            var c = a._editBox;
            b.keyCode === cc.KEY.enter && (b.stopPropagation(), c._delegate && c._delegate.editBoxReturn && c._delegate.editBoxReturn(c))
        });
        b.addEventListener("blur",
        function() {
            var b = a._editBox;
            b._text = this.value;
            a._updateDomTextCases();
            b._delegate && b._delegate.editBoxEditingDidEnd && b._delegate.editBoxEditingDidEnd(b);
            "" === this.value && (this.style.fontSize = b._placeholderFontSize + "px", this.style.color = cc.colorToHex(b._placeholderColor));
            a._endEditing()
        });
        this._addDomToGameContainer();
        return b
    };
    f._createLabels = function() {
        var a = this._editBox.getContentSize();
        this._textLabel || (this._textLabel = new cc.LabelTTF, this._textLabel.setAnchorPoint(cc.p(0, 1)), this._editBox.addChild(this._textLabel, 100));
        this._placeholderLabel || (this._placeholderLabel = new cc.LabelTTF, this._placeholderLabel.setAnchorPoint(cc.p(0, 1)), this._placeholderLabel.setColor(cc.color.GRAY), this._editBox.addChild(this._placeholderLabel, 100));
        this._updateLabelPosition(a)
    };
    f._removeLabels = function() {
        this._textLabel && (this._editBox.removeChild(this._textLabel), this._textLabel = null)
    };
    f._updateLabelPosition = function(a) {
        if (this._textLabel && this._placeholderLabel) {
            var b = cc.size(a.width - 2, a.height);
            this._textLabel.setContentSize(b);
            this._textLabel.setDimensions(b);
            this._placeholderLabel.setLineHeight(a.height);
            b = this._placeholderLabel.getContentSize();
            this._editBox._editBoxInputMode === cc.EDITBOX_INPUT_MODE_ANY ? (this._textLabel.setPosition(2, a.height), this._placeholderLabel.setPosition(2, a.height), this._placeholderLabel.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_TOP), this._textLabel.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_TOP)) : (this._textLabel.setPosition(2, a.height), this._placeholderLabel.setPosition(2, (a.height + b.height) / 2), this._placeholderLabel.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER), this._textLabel.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER))
        }
    };
    f.setLineHeight = function(a) {
        this._textLabel && this._textLabel.setLineHeight(a)
    };
    f._hiddenLabels = function() {
        this._textLabel && this._textLabel.setVisible(!1);
        this._placeholderLabel && this._placeholderLabel.setVisible(!1)
    };
    f._updateDomTextCases = function() {
        var a = this._editBox._editBoxInputFlag;
        if (a === cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_ALL_CHARACTERS) this._editBox._text = this._editBox._text.toUpperCase();
        else if (a === cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_WORD) this._editBox._text = e(this._editBox._text);
        else if (a === cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_SENTENCE) {
            var a = this._editBox,
            b;
            b = this._editBox._text;
            b = b.charAt(0).toUpperCase() + b.slice(1);
            a._text = b
        }
    };
    f._updateLabelStringStyle = function() {
        if ("password" === this._edTxt.type) {
            for (var a = "",
            b = this._editBox._text.length,
            c = 0; c < b; ++c) a += "\u25cf";
            this._textLabel && this._textLabel.setString(a)
        } else this._updateDomTextCases(),
        this._textLabel && this._textLabel.setString(this._editBox._text)
    };
    f._showLabels = function() {
        this._hiddenLabels();
        "" === this._edTxt.value ? this._placeholderLabel && (this._placeholderLabel.setVisible(!0), this._placeholderLabel.setString(this._editBox._placeholderText)) : this._textLabel && (this._textLabel.setVisible(!0), this._textLabel.setString(this._editBox._text));
        this._updateLabelStringStyle()
    };
    f._beginEditing = function() {
        this._editBox._alwaysOnTop || "none" !== this._edTxt.style.display || (this._edTxt.style.display = "", this._edTxt.focus());
        cc.sys.isMobile && !this._editingMode && this._beginEditingOnMobile(this._editBox);
        this._editingMode = !0
    };
    f._endEditing = function() {
        this._editBox._alwaysOnTop || (this._edTxt.style.display = "none");
        this._showLabels();
        if (cc.sys.isMobile && this._editingMode) {
            var a = this;
            setTimeout(function() {
                a._endEditingOnMobile()
            },
            d)
        }
        this._editingMode = !1
    };
    f._setFont = function(a) {
        a = cc.LabelTTF._fontStyleRE.exec(a);
        var b = a[2],
        c = parseInt(a[1]);
        a && this.setFont(b, c)
    };
    f.setFont = function(a, b) {
        this._edFontName = a || this._edFontName;
        this._edFontSize = b || this._edFontSize;
        this._updateDOMFontStyle()
    };
    f.setFontName = function(a) {
        this._edFontName = a || this._edFontName;
        this._updateDOMFontStyle()
    };
    f.setFontSize = function(a) {
        this._edFontSize = a || this._edFontSize;
        this._updateDOMFontStyle()
    };
    f.setFontColor = function(a) {
        this._edTxt && (this._edTxt.value !== this._editBox._placeholderText && (this._edTxt.style.color = cc.colorToHex(a)), this._textLabel && this._textLabel.setColor(a))
    };
    f.setPlaceHolder = function(a) {
        this._placeholderLabel.setString(a)
    };
    f.setMaxLength = function(a) {
        this._edTxt && (this._edTxt.maxLength = a)
    };
    f._updateDOMPlaceholderFontStyle = function() {
        this._placeholderLabel.setFontName(this._editBox._placeholderFontName);
        this._placeholderLabel.setFontSize(this._editBox._placeholderFontSize)
    };
    f.setPlaceholderFontColor = function(a) {
        this._placeholderLabel.setColor(a)
    };
    f._updateDomInputType = function() {
        var a = this._editBox._editBoxInputMode;
        a === cc.EDITBOX_INPUT_MODE_EMAILADDR ? this._edTxt.type = "email": a === cc.EDITBOX_INPUT_MODE_DECIMAL || a === cc.EDITBOX_INPUT_MODE_NUMERIC ? this._edTxt.type = "number": a === cc.EDITBOX_INPUT_MODE_PHONENUMBER ? (this._edTxt.type = "number", this._edTxt.pattern = "[0-9]*") : a === cc.EDITBOX_INPUT_MODE_URL ? this._edTxt.type = "url": (this._edTxt.type = "text", this._editBox._keyboardReturnType === cc.KEYBOARD_RETURNTYPE_SEARCH && (this._edTxt.type = "search"));
        this._editBox._editBoxInputFlag === cc.EDITBOX_INPUT_FLAG_PASSWORD && (this._edTxt.type = "password")
    };
    f.setInputFlag = function(a) {
        this._edTxt && (this._updateDomInputType(), this._edTxt.style.textTransform = "none", a === cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_ALL_CHARACTERS ? this._edTxt.style.textTransform = "uppercase": a === cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_WORD && (this._edTxt.style.textTransform = "capitalize"), this._updateLabelStringStyle())
    };
    f.setInputMode = function(a) {
        a === cc.EDITBOX_INPUT_MODE_ANY ? this._createDomTextArea() : this._createDomInput();
        this._updateDomInputType();
        a = this._node.getContentSize();
        this.updateSize(a.width, a.height)
    };
    f.setString = function(a) {
        this._edTxt && null !== a && (this._edTxt.value = a, "" === a ? (this._placeholderLabel && (this._placeholderLabel.setString(this._editBox._placeholderText), this._placeholderLabel.setColor(this._editBox._placeholderColor)), this._editingMode || (this._placeholderLabel && this._placeholderLabel.setVisible(!0), this._textLabel && this._textLabel.setVisible(!1))) : (this._edTxt.style.color = cc.colorToHex(this._editBox._textColor), this._textLabel && this._textLabel.setColor(this._editBox._textColor), this._editingMode || (this._placeholderLabel && this._placeholderLabel.setVisible(!1), this._textLabel && this._textLabel.setVisible(!0)), this._updateLabelStringStyle()))
    };
    f._updateDOMFontStyle = function() {
        this._edTxt && ("" !== this._edTxt.value && (this._edTxt.style.fontFamily = this._edFontName, this._edTxt.style.fontSize = this._edFontSize + "px"), this._textLabel && (this._textLabel.setFontSize(this._edFontSize), this._textLabel.setFontName(this._edFontName)))
    };
    f.updateSize = function(a, b) {
        var c = this._edTxt;
        c && (c.style.width = a + "px", c.style.height = b + "px", this._updateLabelPosition(cc.size(a, b)))
    };
    f._addDomToGameContainer = function() {
        cc.game.container.appendChild(this._edTxt)
    };
    f._removeDomFromGameContainer = function() {
        var a = this._edTxt;
        if (a) {
            var b = !1; (b = "contains" in cc.game.container ? cc.game.container.contains(a) : cc.game.container.compareDocumentPosition(a) % 16) && cc.game.container.removeChild(a)
        }
        this._edTxt = null
    };
    f.initializeRenderCmd = function(a) {
        this._editBox = a;
        this._edFontSize = 14;
        this._edFontName = "Arial";
        this._placeholderLabel = this._textLabel = null;
        this.__rotateScreen = this.__autoResize = this.__fullscreen = this._editingMode = !1;
        this.__orientationChanged = null
    };
    cc.EditBox.CanvasRenderCmd = function(a) {
        this._rootCtor(a);
        this.initializeRenderCmd(a)
    };
    var g = cc.EditBox.CanvasRenderCmd.prototype = Object.create(cc.Node.CanvasRenderCmd.prototype);
    cc.inject(f, g);
    g.constructor = cc.EditBox.CanvasRenderCmd;
    g.transform = function(a, b) {
        this.originTransform(a, b);
        this.updateMatrix()
    };
    cc.EditBox.WebGLRenderCmd = function(a) {
        this._rootCtor(a);
        this.initializeRenderCmd(a)
    };
    g = cc.EditBox.WebGLRenderCmd.prototype = Object.create(cc.Node.WebGLRenderCmd.prototype);
    cc.inject(f, g);
    g.constructor = cc.EditBox.WebGLRenderCmd;
    g.transform = function(a, b) {
        this.originTransform(a, b);
        this.updateMatrix()
    }
})(cc.EditBox._polyfill);
cc.IMEKeyboardNotificationInfo = function(a, b, c) {
    this.begin = a || cc.rect(0, 0, 0, 0);
    this.end = b || cc.rect(0, 0, 0, 0);
    this.duration = c || 0
};
cc.IMEDelegate = cc.Class.extend({
    ctor: function() {
        cc.imeDispatcher.addDelegate(this)
    },
    removeDelegate: function() {
        cc.imeDispatcher.removeDelegate(this)
    },
    attachWithIME: function() {
        return cc.imeDispatcher.attachDelegateWithIME(this)
    },
    detachWithIME: function() {
        return cc.imeDispatcher.detachDelegateWithIME(this)
    },
    canAttachWithIME: function() {
        return ! 1
    },
    didAttachWithIME: function() {},
    canDetachWithIME: function() {
        return ! 1
    },
    didDetachWithIME: function() {},
    insertText: function(a, b) {},
    deleteBackward: function() {},
    getContentText: function() {
        return ""
    },
    keyboardWillShow: function(a) {},
    keyboardDidShow: function(a) {},
    keyboardWillHide: function(a) {},
    keyboardDidHide: function(a) {}
});
cc.IMEDispatcher = cc.Class.extend({
    _domInputControl: null,
    impl: null,
    _currentInputString: "",
    _lastClickPosition: null,
    ctor: function() {
        this.impl = new cc.IMEDispatcher.Impl;
        this._lastClickPosition = cc.p(0, 0)
    },
    init: function() {
        if (!cc.sys.isMobile) {
            this._domInputControl = cc.$("#imeDispatcherInput");
            this._domInputControl || (this._domInputControl = cc.$new("input"), this._domInputControl.setAttribute("type", "text"), this._domInputControl.setAttribute("id", "imeDispatcherInput"), this._domInputControl.resize(0, 0), this._domInputControl.translates(0, 0), this._domInputControl.style.opacity = "0", this._domInputControl.style.fontSize = "1px", this._domInputControl.setAttribute("tabindex", 2), this._domInputControl.style.position = "absolute", this._domInputControl.style.top = 0, this._domInputControl.style.left = 0, document.body.appendChild(this._domInputControl));
            var a = this;
            this._domInputControl.addEventListener("input",
            function() {
                a._processDomInputString(a._domInputControl.value)
            },
            !1);
            this._domInputControl.addEventListener("keydown",
            function(b) {
                b.keyCode === cc.KEY.tab ? (b.stopPropagation(), b.preventDefault()) : b.keyCode === cc.KEY.enter && (a.dispatchInsertText("\n", 1), b.stopPropagation(), b.preventDefault())
            },
            !1);
            /msie/i.test(navigator.userAgent) && this._domInputControl.addEventListener("keyup",
            function(b) {
                b.keyCode === cc.KEY.backspace && a._processDomInputString(a._domInputControl.value)
            },
            !1);
            window.addEventListener("mousedown",
            function(b) {
                var c = b.pageY || 0;
                a._lastClickPosition.x = b.pageX || 0;
                a._lastClickPosition.y = c
            },
            !1)
        }
    },
    _processDomInputString: function(a) {
        var b, c;
        b = this._currentInputString.length < a.length ? this._currentInputString.length: a.length;
        for (c = 0; c < b && a[c] === this._currentInputString[c]; c++);
        var d = this._currentInputString.length - c,
        e = a.length - c;
        for (b = 0; b < d; b++) this.dispatchDeleteBackward();
        for (b = 0; b < e; b++) this.dispatchInsertText(a[c + b], 1);
        this._currentInputString = a
    },
    dispatchInsertText: function(a, b) { ! this.impl || !a || 0 >= b || this.impl._delegateWithIme && this.impl._delegateWithIme.insertText(a, b)
    },
    dispatchDeleteBackward: function() {
        this.impl && this.impl._delegateWithIme && this.impl._delegateWithIme.deleteBackward()
    },
    getContentText: function() {
        if (this.impl && this.impl._delegateWithIme) {
            var a = this.impl._delegateWithIme.getContentText();
            return a ? a: ""
        }
        return ""
    },
    dispatchKeyboardWillShow: function(a) {
        if (this.impl) for (var b = 0; b < this.impl._delegateList.length; b++) {
            var c = this.impl._delegateList[b];
            c && c.keyboardWillShow(a)
        }
    },
    dispatchKeyboardDidShow: function(a) {
        if (this.impl) for (var b = 0; b < this.impl._delegateList.length; b++) {
            var c = this.impl._delegateList[b];
            c && c.keyboardDidShow(a)
        }
    },
    dispatchKeyboardWillHide: function(a) {
        if (this.impl) for (var b = 0; b < this.impl._delegateList.length; b++) {
            var c = this.impl._delegateList[b];
            c && c.keyboardWillHide(a)
        }
    },
    dispatchKeyboardDidHide: function(a) {
        if (this.impl) for (var b = 0; b < this.impl._delegateList.length; b++) {
            var c = this.impl._delegateList[b];
            c && c.keyboardDidHide(a)
        }
    },
    addDelegate: function(a) {
        a && this.impl && ( - 1 < this.impl._delegateList.indexOf(a) || this.impl._delegateList.splice(0, 0, a))
    },
    attachDelegateWithIME: function(a) {
        if (!this.impl || !a || -1 === this.impl._delegateList.indexOf(a)) return ! 1;
        if (this.impl._delegateWithIme) {
            if (!this.impl._delegateWithIme.canDetachWithIME() || !a.canAttachWithIME()) return ! 1;
            var b = this.impl._delegateWithIme;
            this.impl._delegateWithIme = null;
            b.didDetachWithIME();
            this._focusDomInput(a);
            return ! 0
        }
        if (!a.canAttachWithIME()) return ! 1;
        this._focusDomInput(a);
        return ! 0
    },
    _focusDomInput: function(a) {
        if (cc.sys.isMobile) {
            this.impl._delegateWithIme = a;
            a.didAttachWithIME();
            this._currentInputString = a.string || "";
            a = a.getTipMessage ? a.getTipMessage() : "please enter your word:";
            var b = window.Window;
            a = b && b.prototype.prompt && b.prototype.prompt != prompt ? b.prototype.prompt.call(window, a, this._currentInputString) : prompt(a, this._currentInputString);
            null != a && this._processDomInputString(a);
            this.dispatchInsertText("\n", 1)
        } else this.impl._delegateWithIme = a,
        this._currentInputString = a.string || "",
        a.didAttachWithIME(),
        this._domInputControl.focus(),
        this._domInputControl.value = this._currentInputString,
        this._domInputControlTranslate()
    },
    _domInputControlTranslate: function() { / msie / i.test(navigator.userAgent) ? (this._domInputControl.style.left = this._lastClickPosition.x + "px", this._domInputControl.style.top = this._lastClickPosition.y + "px") : this._domInputControl.translates(this._lastClickPosition.x, this._lastClickPosition.y)
    },
    detachDelegateWithIME: function(a) {
        if (!this.impl || !a || this.impl._delegateWithIme !== a || !a.canDetachWithIME()) return ! 1;
        this.impl._delegateWithIme = null;
        a.didDetachWithIME();
        cc._canvas.focus();
        return ! 0
    },
    removeDelegate: function(a) {
        this.impl && a && -1 !== this.impl._delegateList.indexOf(a) && (this.impl._delegateWithIme && a === this.impl._delegateWithIme && (this.impl._delegateWithIme = null), cc.arrayRemoveObject(this.impl._delegateList, a))
    },
    processKeycode: function(a) {
        32 > a ? a === cc.KEY.backspace ? this.dispatchDeleteBackward() : a === cc.KEY.enter && this.dispatchInsertText("\n", 1) : 255 > a && this.dispatchInsertText(String.fromCharCode(a), 1)
    }
});
cc.IMEDispatcher.Impl = cc.Class.extend({
    _delegateWithIme: null,
    _delegateList: null,
    ctor: function() {
        this._delegateList = []
    },
    findDelegate: function(a) {
        for (var b = 0; b < this._delegateList.length; b++) if (this._delegateList[b] === a) return b;
        return null
    }
});
cc.imeDispatcher = new cc.IMEDispatcher;
document.body ? cc.imeDispatcher.init() : window.addEventListener("load",
function() {
    cc.imeDispatcher.init()
},
!1);
cc.TextFieldDelegate = cc.Class.extend({
    onTextFieldAttachWithIME: function(a) {
        return ! 1
    },
    onTextFieldDetachWithIME: function(a) {
        return ! 1
    },
    onTextFieldInsertText: function(a, b, c) {
        return ! 1
    },
    onTextFieldDeleteBackward: function(a, b, c) {
        return ! 1
    },
    onDraw: function(a) {
        return ! 1
    }
});
cc.TextFieldTTF = cc.LabelTTF.extend({
    delegate: null,
    colorSpaceHolder: null,
    _colorText: null,
    _lens: null,
    _inputText: "",
    _placeHolder: "",
    _charCount: 0,
    _className: "TextFieldTTF",
    ctor: function(a, b, c, d, e) {
        this.colorSpaceHolder = cc.color(127, 127, 127);
        this._colorText = cc.color(255, 255, 255, 255);
        cc.LabelTTF.prototype.ctor.call(this);
        void 0 !== e ? (this.initWithPlaceHolder("", b, c, d, e), a && this.setPlaceHolder(a)) : void 0 === d && void 0 !== c && (this.initWithString("", b, c), a && this.setPlaceHolder(a))
    },
    onEnter: function() {
        cc.LabelTTF.prototype.onEnter.call(this);
        cc.imeDispatcher.addDelegate(this)
    },
    onExit: function() {
        cc.LabelTTF.prototype.onExit.call(this);
        cc.imeDispatcher.removeDelegate(this)
    },
    getDelegate: function() {
        return this.delegate
    },
    setDelegate: function(a) {
        this.delegate = a
    },
    getCharCount: function() {
        return this._charCount
    },
    getColorSpaceHolder: function() {
        return cc.color(this.colorSpaceHolder)
    },
    setColorSpaceHolder: function(a) {
        this.colorSpaceHolder.r = a.r;
        this.colorSpaceHolder.g = a.g;
        this.colorSpaceHolder.b = a.b;
        this.colorSpaceHolder.a = cc.isUndefined(a.a) ? 255 : a.a;
        this._inputText.length || this.setColor(this.colorSpaceHolder)
    },
    setTextColor: function(a) {
        this._colorText.r = a.r;
        this._colorText.g = a.g;
        this._colorText.b = a.b;
        this._colorText.a = cc.isUndefined(a.a) ? 255 : a.a;
        this._inputText.length && this.setColor(this._colorText)
    },
    initWithPlaceHolder: function(a, b, c, d, e) {
        switch (arguments.length) {
        case 5:
            return a && this.setPlaceHolder(a),
            this.initWithString(this._placeHolder, d, e, b, c);
        case 3:
            return a && this.setPlaceHolder(a),
            this.initWithString(this._placeHolder, arguments[1], arguments[2]);
        default:
            throw Error("Argument must be non-nil ");
        }
    },
    setString: function(a) {
        this._inputText = (a = String(a)) || "";
        this._inputText.length ? (cc.LabelTTF.prototype.setString.call(this, this._inputText), this.setColor(this._colorText)) : (cc.LabelTTF.prototype.setString.call(this, this._placeHolder), this.setColor(this.colorSpaceHolder));
        cc._renderType === cc.game.RENDER_TYPE_CANVAS && this._renderCmd._updateTexture();
        this._charCount = this._inputText.length
    },
    getString: function() {
        return this._inputText
    },
    setPlaceHolder: function(a) {
        this._placeHolder = a || "";
        this._inputText.length || (cc.LabelTTF.prototype.setString.call(this, this._placeHolder), this.setColor(this.colorSpaceHolder))
    },
    getPlaceHolder: function() {
        return this._placeHolder
    },
    draw: function(a) {
        a = a || cc._renderContext;
        this.delegate && this.delegate.onDraw(this) || cc.LabelTTF.prototype.draw.call(this, a)
    },
    attachWithIME: function() {
        return cc.imeDispatcher.attachDelegateWithIME(this)
    },
    detachWithIME: function() {
        return cc.imeDispatcher.detachDelegateWithIME(this)
    },
    canAttachWithIME: function() {
        return this.delegate ? !this.delegate.onTextFieldAttachWithIME(this) : !0
    },
    didAttachWithIME: function() {},
    canDetachWithIME: function() {
        return this.delegate ? !this.delegate.onTextFieldDetachWithIME(this) : !0
    },
    didDetachWithIME: function() {},
    deleteBackward: function() {
        var a = this._inputText.length;
        0 === a || this.delegate && this.delegate.onTextFieldDeleteBackward(this, this._inputText[a - 1], 1) || (1 >= a ? (this._inputText = "", this._charCount = 0, cc.LabelTTF.prototype.setString.call(this, this._placeHolder), this.setColor(this.colorSpaceHolder)) : this.string = this._inputText.substring(0, a - 1))
    },
    removeDelegate: function() {
        cc.imeDispatcher.removeDelegate(this)
    },
    _tipMessage: "please enter your word:",
    setTipMessage: function(a) {
        null != a && (this._tipMessage = a)
    },
    getTipMessage: function() {
        return this._tipMessage
    },
    insertText: function(a, b) {
        var c = a,
        d = c.indexOf("\n"); - 1 < d && (c = c.substring(0, d));
        if (0 < c.length) {
            if (this.delegate && this.delegate.onTextFieldInsertText(this, c, c.length)) return;
            c = this._inputText + c;
            this._charCount = c.length;
            this.string = c
        } - 1 !== d && (this.delegate && this.delegate.onTextFieldInsertText(this, "\n", 1) || this.detachWithIME())
    },
    getContentText: function() {
        return this._inputText
    },
    keyboardWillShow: function(a) {},
    keyboardDidShow: function(a) {},
    keyboardWillHide: function(a) {},
    keyboardDidHide: function(a) {}
});
_p = cc.TextFieldTTF.prototype;
cc.defineGetterSetter(_p, "charCount", _p.getCharCount);
cc.defineGetterSetter(_p, "placeHolder", _p.getPlaceHolder, _p.setPlaceHolder);
cc.TextFieldTTF.create = function(a, b, c, d, e) {
    return new cc.TextFieldTTF(a, b, c, d, e)
};
cc.ProtectedNode = cc.Node.extend({
    _protectedChildren: null,
    _reorderProtectedChildDirty: !1,
    _insertProtectedChild: function(a, b) {
        this._reorderProtectedChildDirty = !0;
        this._protectedChildren.push(a);
        a._setLocalZOrder(b)
    },
    ctor: function() {
        cc.Node.prototype.ctor.call(this);
        this._protectedChildren = []
    },
    visit: function(a) {
        var b = this._renderCmd,
        c = a ? a._renderCmd: null;
        if (this._visible) {
            a = cc.renderer;
            var d = this._children,
            e = d.length,
            f, g = this._protectedChildren,
            h = g.length,
            k;
            b.visit(c);
            var m = this.grid;
            m && m._active && m.beforeDraw();
            this._reorderChildDirty && this.sortAllChildren();
            this._reorderProtectedChildDirty && this.sortAllProtectedChildren();
            for (c = 0; c < e; c++) if (f = d[c], 0 > f._localZOrder) f.visit(this);
            else break;
            for (f = 0; f < h; f++) if ((k = g[f]) && 0 > k._localZOrder) b._changeProtectedChild(k),
            k.visit(this);
            else break;
            for (a.pushRenderCommand(b); c < e; c++) d[c].visit(this);
            for (; f < h; f++) if (k = g[f]) b._changeProtectedChild(k),
            k.visit(this);
            m && m._active && m.afterDraw(this);
            b._dirtyFlag = 0
        } else b._propagateFlagsDown(c)
    },
    addProtectedChild: function(a, b, c) {
        cc.assert(null != a, "child must be non-nil");
        cc.assert(!a.parent, "child already added. It can't be added again");
        b = b || a.getLocalZOrder();
        c && a.setTag(c);
        this._insertProtectedChild(a, b);
        a.setParent(this);
        a.setOrderOfArrival(cc.s_globalOrderOfArrival);
        this._running && (a._performRecursive(cc.Node._stateCallbackType.onEnter), this._isTransitionFinished && a._performRecursive(cc.Node._stateCallbackType.onEnterTransitionDidFinish));
        this._cascadeColorEnabled && this._renderCmd.setCascadeColorEnabledDirty();
        this._cascadeOpacityEnabled && this._renderCmd.setCascadeOpacityEnabledDirty()
    },
    getProtectedChildByTag: function(a) {
        cc.assert(a !== cc.NODE_TAG_INVALID, "Invalid tag");
        for (var b = this._protectedChildren,
        c = 0,
        d = b.length; c < d; c++) if (b.getTag() === a) return b[c];
        return null
    },
    removeProtectedChild: function(a, b) {
        null == b && (b = !0);
        var c = this._protectedChildren;
        if (0 !== c.length) {
            var d = c.indexOf(a); - 1 < d && (this._running && (a._performRecursive(cc.Node._stateCallbackType.onExitTransitionDidStart), a._performRecursive(cc.Node._stateCallbackType.onExit)), b && a._performRecursive(cc.Node._stateCallbackType.cleanup), a.setParent(null), c.splice(d, 1))
        }
    },
    removeProtectedChildByTag: function(a, b) {
        cc.assert(a !== cc.NODE_TAG_INVALID, "Invalid tag");
        null == b && (b = !0);
        var c = this.getProtectedChildByTag(a);
        null == c ? cc.log("cocos2d: removeChildByTag(tag \x3d %d): child not found!", a) : this.removeProtectedChild(c, b)
    },
    removeAllProtectedChildren: function() {
        this.removeAllProtectedChildrenWithCleanup(!0)
    },
    removeAllProtectedChildrenWithCleanup: function(a) {
        null == a && (a = !0);
        for (var b = this._protectedChildren,
        c = 0,
        d = b.length; c < d; c++) {
            var e = b[c];
            this._running && (e._performRecursive(cc.Node._stateCallbackType.onExitTransitionDidStart), e._performRecursive(cc.Node._stateCallbackType.onExit));
            a && e._performRecursive(cc.Node._stateCallbackType.cleanup);
            e.setParent(null)
        }
        b.length = 0
    },
    reorderProtectedChild: function(a, b) {
        cc.assert(null != a, "Child must be non-nil");
        this._reorderProtectedChildDirty = !0;
        a.setOrderOfArrival(cc.s_globalOrderOfArrival++);
        a._setLocalZOrder(b)
    },
    sortAllProtectedChildren: function() {
        if (this._reorderProtectedChildDirty) {
            var a = this._protectedChildren,
            b, c, d = a.length,
            e;
            for (b = 1; b < d; b++) {
                e = a[b];
                for (c = b - 1; 0 <= c;) {
                    if (e._localZOrder < a[c]._localZOrder) a[c + 1] = a[c];
                    else if (e._localZOrder === a[c]._localZOrder && e.arrivalOrder < a[c].arrivalOrder) a[c + 1] = a[c];
                    else break;
                    c--
                }
                a[c + 1] = e
            }
            this._reorderProtectedChildDirty = !1
        }
    },
    _changePosition: function() {},
    _createRenderCmd: function() {
        return cc._renderType === cc.game.RENDER_TYPE_CANVAS ? new cc.ProtectedNode.CanvasRenderCmd(this) : new cc.ProtectedNode.WebGLRenderCmd(this)
    }
});
cc.ProtectedNode.create = function() {
    return new cc.ProtectedNode
}; (function() {
    cc.ProtectedNode.RenderCmd = {
        _updateDisplayColor: function(a) {
            var c = this._node,
            d = this._displayedColor,
            e = c._realColor,
            f, g;
            if (this._cascadeColorEnabledDirty && !c._cascadeColorEnabled) {
                d.r = e.r;
                d.g = e.g;
                d.b = e.b;
                d = new cc.Color(255, 255, 255, 255);
                f = c._children;
                e = 0;
                for (a = f.length; e < a; e++)(g = f[e]) && g._renderCmd && g._renderCmd._updateDisplayColor(d);
                this._cascadeColorEnabledDirty = !1
            } else {
                void 0 === a && (a = (a = c._parent) && a._cascadeColorEnabled ? a.getDisplayedColor() : cc.color.WHITE);
                d.r = 0 | e.r * a.r / 255;
                d.g = 0 | e.g * a.g / 255;
                d.b = 0 | e.b * a.b / 255;
                if (c._cascadeColorEnabled) for (f = c._children, e = 0, a = f.length; e < a; e++)(g = f[e]) && g._renderCmd && (g._renderCmd._updateDisplayColor(d), g._renderCmd._updateColor());
                f = c._protectedChildren;
                e = 0;
                for (a = f.length; e < a; e++)(g = f[e]) && g._renderCmd && (g._renderCmd._updateDisplayColor(d), g._renderCmd._updateColor())
            }
            this._dirtyFlag ^= this._dirtyFlag & cc.Node._dirtyFlags.colorDirty
        },
        _updateDisplayOpacity: function(a) {
            var c = this._node,
            d, e, f;
            if (this._cascadeOpacityEnabledDirty && !c._cascadeOpacityEnabled) {
                this._displayedOpacity = c._realOpacity;
                e = c._children;
                a = 0;
                for (d = e.length; a < d; a++)(f = e[a]) && f._renderCmd && f._renderCmd._updateDisplayOpacity(255);
                this._cascadeOpacityEnabledDirty = !1
            } else {
                void 0 === a && (d = c._parent, a = 255, d && d._cascadeOpacityEnabled && (a = d.getDisplayedOpacity()));
                this._displayedOpacity = c._realOpacity * a / 255;
                if (c._cascadeOpacityEnabled) for (e = c._children, a = 0, d = e.length; a < d; a++)(f = e[a]) && f._renderCmd && (f._renderCmd._updateDisplayOpacity(this._displayedOpacity), f._renderCmd._updateColor());
                e = c._protectedChildren;
                a = 0;
                for (d = e.length; a < d; a++)(f = e[a]) && f._renderCmd && (f._renderCmd._updateDisplayOpacity(this._displayedOpacity), f._renderCmd._updateColor())
            }
            this._dirtyFlag ^= this._dirtyFlag & cc.Node._dirtyFlags.opacityDirty
        },
        _changeProtectedChild: function(a) {
            a = a._renderCmd;
            var c = a._dirtyFlag,
            d = cc.Node._dirtyFlags;
            this._dirtyFlag & d.colorDirty && (c |= d.colorDirty);
            this._dirtyFlag & d.opacityDirty && (c |= d.opacityDirty);
            var e = c & d.colorDirty,
            c = c & d.opacityDirty;
            e && a._updateDisplayColor(this._displayedColor);
            c && a._updateDisplayOpacity(this._displayedOpacity); (e || c) && a._updateColor()
        }
    };
    cc.ProtectedNode.CanvasRenderCmd = function(a) {
        this._rootCtor(a);
        this._cachedParent = null;
        this._cacheDirty = !1
    };
    var a = cc.ProtectedNode.CanvasRenderCmd.prototype = Object.create(cc.Node.CanvasRenderCmd.prototype);
    cc.inject(cc.ProtectedNode.RenderCmd, a);
    a.constructor = cc.ProtectedNode.CanvasRenderCmd;
    a._pNodeCmdCtor = cc.ProtectedNode.CanvasRenderCmd;
    a.transform = function(a, c) {
        var d = this._node;
        d._changePosition && d._changePosition();
        this.originTransform(a, c);
        var e, f = d._protectedChildren;
        if (c && f && 0 !== f.length) for (d = 0, e = f.length; d < e; d++) f[d]._renderCmd.transform(this, c)
    };
    a.pNodeTransform = a.transform
})(); (function() {
    if (cc.Node.WebGLRenderCmd) {
        cc.ProtectedNode.WebGLRenderCmd = function(a) {
            this._rootCtor(a)
        };
        var a = cc.ProtectedNode.WebGLRenderCmd.prototype = Object.create(cc.Node.WebGLRenderCmd.prototype);
        cc.inject(cc.ProtectedNode.RenderCmd, a);
        a.constructor = cc.ProtectedNode.WebGLRenderCmd;
        a._pNodeCmdCtor = cc.ProtectedNode.WebGLRenderCmd;
        a.transform = function(a, c) {
            this.originTransform(a, c);
            var d, e, f = this._node._protectedChildren;
            if (c && f && 0 !== f.length) for (d = 0, e = f.length; d < e; d++) f[d]._renderCmd.transform(this, c)
        };
        a.pNodeTransform = a.transform
    }
})();
var ccui = ccui || {};
ccui.Class = ccui.Class || cc.Class;
ccui.Class.extend = ccui.Class.extend || cc.Class.extend;
ccui.Node = ccui.Node || cc.Node;
ccui.Node.extend = ccui.Node.extend || cc.Node.extend;
ccui.ProtectedNode = ccui.ProtectedNode || cc.ProtectedNode;
ccui.ProtectedNode.extend = ccui.ProtectedNode.extend || cc.ProtectedNode.extend;
ccui.cocosGUIVersion = "CocosGUI v1.0.0.0";
ccui._FocusNavigationController = cc.Class.extend({
    _keyboardListener: null,
    _firstFocusedWidget: null,
    _enableFocusNavigation: !1,
    _keyboardEventPriority: 1,
    enableFocusNavigation: function(a) {
        this._enableFocusNavigation !== a && ((this._enableFocusNavigation = a) ? this._addKeyboardEventListener() : this._removeKeyboardEventListener())
    },
    _setFirstFocsuedWidget: function(a) {
        this._firstFocusedWidget = a
    },
    _onKeyPressed: function(a, b) {
        this._enableFocusNavigation && this._firstFocusedWidget && (a === cc.KEY.dpadDown && (this._firstFocusedWidget = this._firstFocusedWidget.findNextFocusedWidget(ccui.Widget.DOWN, this._firstFocusedWidget)), a === cc.KEY.dpadUp && (this._firstFocusedWidget = this._firstFocusedWidget.findNextFocusedWidget(ccui.Widget.UP, this._firstFocusedWidget)), a === cc.KEY.dpadLeft && (this._firstFocusedWidget = this._firstFocusedWidget.findNextFocusedWidget(ccui.Widget.LEFT, this._firstFocusedWidget)), a === cc.KEY.dpadRight && (this._firstFocusedWidget = this._firstFocusedWidget.findNextFocusedWidget(ccui.Widget.RIGHT, this._firstFocusedWidget)))
    },
    _addKeyboardEventListener: function() {
        this._keyboardListener || (this._keyboardListener = cc.EventListener.create({
            event: cc.EventListener.KEYBOARD,
            onKeyReleased: this._onKeyPressed.bind(this)
        }), cc.eventManager.addListener(this._keyboardListener, this._keyboardEventPriority))
    },
    _removeKeyboardEventListener: function() {
        this._keyboardListener && (cc.eventManager.removeEventListener(this._keyboardListener), this._keyboardListener = null)
    }
});
ccui.__LAYOUT_COMPONENT_NAME = "__ui_layout";
ccui.Widget = ccui.ProtectedNode.extend({
    _enabled: !0,
    _bright: !0,
    _touchEnabled: !1,
    _brightStyle: null,
    _touchBeganPosition: null,
    _touchMovePosition: null,
    _touchEndPosition: null,
    _touchEventListener: null,
    _touchEventSelector: null,
    _name: "default",
    _widgetType: null,
    _actionTag: 0,
    _customSize: null,
    _layoutParameterDictionary: null,
    _layoutParameterType: 0,
    _focused: !1,
    _focusEnabled: !0,
    _ignoreSize: !1,
    _affectByClipping: !1,
    _sizeType: null,
    _sizePercent: null,
    _positionType: null,
    _positionPercent: null,
    _hit: !1,
    _nodes: null,
    _touchListener: null,
    _className: "Widget",
    _flippedX: !1,
    _flippedY: !1,
    _opacity: 255,
    _highlight: !1,
    _touchEventCallback: null,
    _clickEventListener: null,
    _propagateTouchEvents: !0,
    _unifySize: !1,
    _callbackName: null,
    _callbackType: null,
    _usingLayoutComponent: !1,
    _inViewRect: !0,
    ctor: function() {
        cc.ProtectedNode.prototype.ctor.call(this);
        this._brightStyle = ccui.Widget.BRIGHT_STYLE_NONE;
        this._touchBeganPosition = cc.p(0, 0);
        this._touchMovePosition = cc.p(0, 0);
        this._touchEndPosition = cc.p(0, 0);
        this._widgetType = ccui.Widget.TYPE_WIDGET;
        this._customSize = cc.size(0, 0);
        this._layoutParameterDictionary = {};
        this._sizeType = ccui.Widget.SIZE_ABSOLUTE;
        this._sizePercent = cc.p(0, 0);
        this._positionType = ccui.Widget.POSITION_ABSOLUTE;
        this._positionPercent = cc.p(0, 0);
        this._nodes = [];
        this._layoutParameterType = ccui.LayoutParameter.NONE;
        ccui.Widget.prototype.init.call(this)
    },
    init: function() {
        this._layoutParameterDictionary = {};
        this._initRenderer();
        this.setBright(!0);
        this.onFocusChanged = this.onFocusChange;
        this.onNextFocusedWidget = null;
        this.setAnchorPoint(cc.p(0.5, 0.5));
        this.ignoreContentAdaptWithSize(!0);
        return ! 0
    },
    onEnter: function() {
        var a = this._touchListener;
        a && !a._isRegistered() && this._touchEnabled && cc.eventManager.addListener(a, this);
        this._usingLayoutComponent || this.updateSizeAndPosition();
        this._sizeDirty && this._onSizeChanged();
        cc.ProtectedNode.prototype.onEnter.call(this)
    },
    onExit: function() {
        this.unscheduleUpdate();
        cc.ProtectedNode.prototype.onExit.call(this)
    },
    _getOrCreateLayoutComponent: function() {
        var a = this.getComponent(ccui.__LAYOUT_COMPONENT_NAME);
        null == a && (a = new ccui.LayoutComponent, this.addComponent(a));
        return a
    },
    getWidgetParent: function() {
        var a = this.getParent();
        return a instanceof ccui.Widget ? a: null
    },
    _updateContentSizeWithTextureSize: function(a) {
        this._unifySize ? this.setContentSize(a) : this.setContentSize(this._ignoreSize ? a: this._customSize)
    },
    _isAncestorsEnabled: function() {
        var a = this._getAncensterWidget(this);
        return null == a ? !0 : a && !a.isEnabled() ? !1 : a._isAncestorsEnabled()
    },
    setPropagateTouchEvents: function(a) {
        this._propagateTouchEvents = a
    },
    isPropagateTouchEvents: function() {
        return this._propagateTouchEvents
    },
    setSwallowTouches: function(a) {
        this._touchListener && this._touchListener.setSwallowTouches(a)
    },
    isSwallowTouches: function() {
        return this._touchListener ? this._touchListener.isSwallowTouches() : !1
    },
    _getAncensterWidget: function(a) {
        if (null == a) return null;
        a = a.getParent();
        return null == a ? null: a instanceof ccui.Widget ? a: this._getAncensterWidget(a.getParent())
    },
    _isAncestorsVisible: function(a) {
        return null == a ? !0 : (a = a.getParent()) && !a.isVisible() ? !1 : this._isAncestorsVisible(a)
    },
    setEnabled: function(a) {
        this._enabled = a;
        this.setBright(a)
    },
    _initRenderer: function() {},
    setContentSize: function(a, b) {
        cc.Node.prototype.setContentSize.call(this, a, b);
        var c = this._contentSize.width,
        d = this._contentSize.height;
        this._customSize.width = c;
        this._customSize.height = d; ! this._unifySize && this._ignoreSize && (this._contentSize = this.getVirtualRendererSize());
        if (!this._usingLayoutComponent && this._running) {
            var e = this.getWidgetParent(),
            e = e ? e.getContentSize() : this._parent.getContentSize();
            this._sizePercent.x = 0 < e.width ? c / e.width: 0;
            this._sizePercent.y = 0 < e.height ? d / e.height: 0
        }
        this._running ? this._onSizeChanged() : this._sizeDirty = !0
    },
    _setWidth: function(a) {
        a !== this._contentSize.width && (cc.Node.prototype._setWidth.call(this, a), this._customSize.width = a, !this._unifySize && this._ignoreSize && (this._contentSize = this.getVirtualRendererSize()), !this._usingLayoutComponent && this._running && (a = (a = this.getWidgetParent()) ? a.width: this._parent.width, this._sizePercent.x = 0 < a ? this._customSize.width / a: 0), this._running ? this._onSizeChanged() : this._sizeDirty = !0)
    },
    _setHeight: function(a) {
        a !== this._contentSize.height && (cc.Node.prototype._setHeight.call(this, a), this._customSize.height = a, !this._unifySize && this._ignoreSize && (this._contentSize = this.getVirtualRendererSize()), !this._usingLayoutComponent && this._running && (a = (a = this.getWidgetParent()) ? a.height: this._parent.height, this._sizePercent.y = 0 < a ? this._customSize.height / a: 0), this._running ? this._onSizeChanged() : this._sizeDirty = !0)
    },
    setSizePercent: function(a) {
        if (this._usingLayoutComponent) {
            var b = this._getOrCreateLayoutComponent();
            b.setUsingPercentContentSize(!0);
            b.setPercentContentSize(a);
            b.refreshLayout()
        } else {
            this._sizePercent.x = a.x;
            this._sizePercent.y = a.y;
            var b = this._customSize.width,
            c = this._customSize.height;
            this._running && ((c = this.getWidgetParent()) ? (b = c.width * a.x, c = c.height * a.y) : (b = this._parent.width * a.x, c = this._parent.height * a.y));
            this._ignoreSize ? this.setContentSize(this.getVirtualRendererSize()) : this.setContentSize(b, c);
            this._customSize.width = b;
            this._customSize.height = c
        }
    },
    _setWidthPercent: function(a) {
        this._sizePercent.x = a;
        var b = this._customSize.width;
        this._running && (b = this.getWidgetParent(), b = (b ? b.width: this._parent.width) * a);
        this._ignoreSize ? this._setWidth(this.getVirtualRendererSize().width) : this._setWidth(b);
        this._customSize.width = b
    },
    _setHeightPercent: function(a) {
        this._sizePercent.y = a;
        var b = this._customSize.height;
        this._running && (b = this.getWidgetParent(), b = (b ? b.height: this._parent.height) * a);
        this._ignoreSize ? this._setHeight(this.getVirtualRendererSize().height) : this._setHeight(b);
        this._customSize.height = b
    },
    updateSizeAndPosition: function(a) {
        a || (a = (a = this.getWidgetParent()) ? a.getLayoutSize() : this._parent.getContentSize());
        switch (this._sizeType) {
        case ccui.Widget.SIZE_ABSOLUTE:
            this._ignoreSize ? this.setContentSize(this.getVirtualRendererSize()) : this.setContentSize(this._customSize);
            this._sizePercent.x = 0 < a.width ? this._customSize.width / a.width: 0;
            this._sizePercent.y = 0 < a.height ? this._customSize.height / a.height: 0;
            break;
        case ccui.Widget.SIZE_PERCENT:
            var b = cc.size(a.width * this._sizePercent.x, a.height * this._sizePercent.y);
            this._ignoreSize ? this.setContentSize(this.getVirtualRendererSize()) : this.setContentSize(b);
            this._customSize.width = b.width;
            this._customSize.height = b.height
        }
        this._onSizeChanged();
        b = this.getPosition();
        switch (this._positionType) {
        case ccui.Widget.POSITION_ABSOLUTE:
            0 >= a.width || 0 >= a.height ? this._positionPercent.x = this._positionPercent.y = 0 : (this._positionPercent.x = b.x / a.width, this._positionPercent.y = b.y / a.height);
            break;
        case ccui.Widget.POSITION_PERCENT:
            b = cc.p(a.width * this._positionPercent.x, a.height * this._positionPercent.y)
        }
        if (this._parent instanceof ccui.ImageView && (a = this._parent._imageRenderer) && !a._textureLoaded) return;
        this.setPosition(b)
    },
    setSizeType: function(a) {
        this._sizeType = a;
        this._usingLayoutComponent && this._getOrCreateLayoutComponent().setUsingPercentContentSize(this._sizeType === ccui.SIZE_PERCENT)
    },
    getSizeType: function() {
        return this._sizeType
    },
    ignoreContentAdaptWithSize: function(a) {
        this._unifySize ? this.setContentSize(this._customSize) : this._ignoreSize !== a && (this._ignoreSize = a, this.setContentSize(a ? this.getVirtualRendererSize() : this._customSize))
    },
    isIgnoreContentAdaptWithSize: function() {
        return this._ignoreSize
    },
    getCustomSize: function() {
        return cc.size(this._customSize)
    },
    getLayoutSize: function() {
        return cc.size(this._contentSize)
    },
    getSizePercent: function() {
        this._usingLayoutComponent && (this._sizePercent = this._getOrCreateLayoutComponent().getPercentContentSize());
        return this._sizePercent
    },
    _getWidthPercent: function() {
        return this._sizePercent.x
    },
    _getHeightPercent: function() {
        return this._sizePercent.y
    },
    getWorldPosition: function() {
        return this.convertToWorldSpace(cc.p(this._anchorPoint.x * this._contentSize.width, this._anchorPoint.y * this._contentSize.height))
    },
    getVirtualRenderer: function() {
        return this
    },
    getVirtualRendererSize: function() {
        return cc.size(this._contentSize)
    },
    _onSizeChanged: function() {
        if (!this._usingLayoutComponent) {
            for (var a = this.getChildren(), b = 0, c = a.length; b < c; b++) {
                var d = a[b];
                d instanceof ccui.Widget && d.updateSizeAndPosition()
            }
            this._sizeDirty = !1
        }
    },
    setTouchEnabled: function(a) {
        this._touchEnabled !== a && ((this._touchEnabled = a) ? (this._touchListener || (this._touchListener = cc.EventListener.create({
            event: cc.EventListener.TOUCH_ONE_BY_ONE,
            swallowTouches: !0,
            onTouchBegan: this.onTouchBegan.bind(this),
            onTouchMoved: this.onTouchMoved.bind(this),
            onTouchEnded: this.onTouchEnded.bind(this)
        })), cc.eventManager.addListener(this._touchListener, this)) : cc.eventManager.removeListener(this._touchListener))
    },
    isTouchEnabled: function() {
        return this._touchEnabled
    },
    isHighlighted: function() {
        return this._highlight
    },
    setHighlighted: function(a) {
        a !== this._highlight && (this._highlight = a, this._bright ? this._highlight ? this.setBrightStyle(ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT) : this.setBrightStyle(ccui.Widget.BRIGHT_STYLE_NORMAL) : this._onPressStateChangedToDisabled())
    },
    isFocused: function() {
        return this._focused
    },
    setFocused: function(a) {
        if (this._focused = a) ccui.Widget._focusedWidget = this,
        ccui.Widget._focusNavigationController && ccui.Widget._focusNavigationController._setFirstFocsuedWidget(this)
    },
    isFocusEnabled: function() {
        return this._focusEnabled
    },
    setFocusEnabled: function(a) {
        this._focusEnabled = a
    },
    findNextFocusedWidget: function(a, b) {
        if (null === this.onNextFocusedWidget || null == this.onNextFocusedWidget(a)) {
            var c = b instanceof ccui.Layout;
            if (this.isFocused() || c) {
                var d = this.getParent();
                return null !== d && d instanceof ccui.Layout ? d.findNextFocusedWidget(a, b) : c ? b.findNextFocusedWidget(a, b) : b
            }
            return b
        }
        c = this.onNextFocusedWidget(a);
        this.dispatchFocusEvent(this, c);
        return c
    },
    requestFocus: function() {
        this !== ccui.Widget._focusedWidget && this.dispatchFocusEvent(ccui.Widget._focusedWidget, this)
    },
    getCurrentFocusedWidget: function() {
        return ccui.Widget._focusedWidget
    },
    onFocusChanged: null,
    onNextFocusedWidget: null,
    interceptTouchEvent: function(a, b, c) {
        var d = this.getWidgetParent();
        d && d.interceptTouchEvent(a, b, c)
    },
    onFocusChange: function(a, b) {
        a && a.setFocused(!1);
        b && b.setFocused(!0)
    },
    dispatchFocusEvent: function(a, b) {
        a && !a.isFocused() && (a = ccui.Widget._focusedWidget);
        if (b !== a) {
            if (b && b.onFocusChanged) b.onFocusChanged(a, b);
            if (a && b.onFocusChanged) a.onFocusChanged(a, b);
            cc.eventManager.dispatchEvent(new cc.EventFocus(a, b))
        }
    },
    setBright: function(a) { (this._bright = a) ? (this._brightStyle = ccui.Widget.BRIGHT_STYLE_NONE, this.setBrightStyle(ccui.Widget.BRIGHT_STYLE_NORMAL)) : this._onPressStateChangedToDisabled()
    },
    setBrightStyle: function(a) {
        if (this._brightStyle !== a) switch (this._brightStyle = a = a || ccui.Widget.BRIGHT_STYLE_NORMAL, this._brightStyle) {
        case ccui.Widget.BRIGHT_STYLE_NORMAL:
            this._onPressStateChangedToNormal();
            break;
        case ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT:
            this._onPressStateChangedToPressed()
        }
    },
    _onPressStateChangedToNormal: function() {},
    _onPressStateChangedToPressed: function() {},
    _onPressStateChangedToDisabled: function() {},
    _updateChildrenDisplayedRGBA: function() {
        this.setColor(this.getColor());
        this.setOpacity(this.getOpacity())
    },
    didNotSelectSelf: function() {},
    onTouchBegan: function(a, b) {
        this._hit = !1;
        if (this.isVisible() && this.isEnabled() && this._isAncestorsEnabled() && this._isAncestorsVisible(this)) {
            var c = a.getLocation();
            this._touchBeganPosition.x = c.x;
            this._touchBeganPosition.y = c.y;
            this.hitTest(this._touchBeganPosition) && this.isClippingParentContainsPoint(this._touchBeganPosition) && (this._hit = !0)
        }
        if (!this._hit) return ! 1;
        this.setHighlighted(!0);
        this._propagateTouchEvents && this.propagateTouchEvent(ccui.Widget.TOUCH_BEGAN, this, a);
        this._pushDownEvent();
        return ! 0
    },
    propagateTouchEvent: function(a, b, c) {
        var d = this.getWidgetParent();
        d && d.interceptTouchEvent(a, b, c)
    },
    onTouchMoved: function(a, b) {
        var c = a.getLocation();
        this._touchMovePosition.x = c.x;
        this._touchMovePosition.y = c.y;
        this.setHighlighted(this.hitTest(c));
        this._propagateTouchEvents && this.propagateTouchEvent(ccui.Widget.TOUCH_MOVED, this, a);
        this._moveEvent()
    },
    onTouchEnded: function(a, b) {
        var c = a.getLocation();
        this._touchEndPosition.x = c.x;
        this._touchEndPosition.y = c.y;
        this._propagateTouchEvents && this.propagateTouchEvent(ccui.Widget.TOUCH_ENDED, this, a);
        c = this._highlight;
        this.setHighlighted(!1);
        c ? this._releaseUpEvent() : this._cancelUpEvent()
    },
    onTouchCancelled: function(a) {
        this.setHighlighted(!1);
        this._cancelUpEvent()
    },
    onTouchLongClicked: function(a) {
        this.longClickEvent()
    },
    _pushDownEvent: function() {
        this._touchEventCallback && this._touchEventCallback(this, ccui.Widget.TOUCH_BEGAN);
        this._touchEventListener && this._touchEventSelector && this._touchEventSelector.call(this._touchEventListener, this, ccui.Widget.TOUCH_BEGAN)
    },
    _moveEvent: function() {
        this._touchEventCallback && this._touchEventCallback(this, ccui.Widget.TOUCH_MOVED);
        this._touchEventListener && this._touchEventSelector && this._touchEventSelector.call(this._touchEventListener, this, ccui.Widget.TOUCH_MOVED)
    },
    _releaseUpEvent: function() {
        this._touchEventCallback && this._touchEventCallback(this, ccui.Widget.TOUCH_ENDED);
        this._touchEventListener && this._touchEventSelector && this._touchEventSelector.call(this._touchEventListener, this, ccui.Widget.TOUCH_ENDED);
        this._clickEventListener && this._clickEventListener(this)
    },
    _cancelUpEvent: function() {
        this._touchEventCallback && this._touchEventCallback(this, ccui.Widget.TOUCH_CANCELED);
        this._touchEventListener && this._touchEventSelector && this._touchEventSelector.call(this._touchEventListener, this, ccui.Widget.TOUCH_CANCELED)
    },
    longClickEvent: function() {},
    addTouchEventListener: function(a, b) {
        void 0 === b ? this._touchEventCallback = a: (this._touchEventSelector = a, this._touchEventListener = b)
    },
    addClickEventListener: function(a) {
        this._clickEventListener = a
    },
    hitTest: function(a) {
        var b = cc.rect(0, 0, this._contentSize.width, this._contentSize.height);
        return cc.rectContainsPoint(b, this.convertToNodeSpace(a))
    },
    isClippingParentContainsPoint: function(a) {
        this._affectByClipping = !1;
        for (var b = this.getParent(), c = null; b;) {
            if (b instanceof ccui.Layout && b.isClippingEnabled()) {
                this._affectByClipping = !0;
                c = b;
                break
            }
            b = b.getParent()
        }
        return this._affectByClipping ? c ? c.hitTest(a) ? c.isClippingParentContainsPoint(a) : !1 : !0 : !0
    },
    checkChildInfo: function(a, b, c) {
        var d = this.getWidgetParent();
        d && d.checkChildInfo(a, b, c)
    },
    setPosition: function(a, b) {
        if (!this._usingLayoutComponent && this._running) {
            var c = this.getWidgetParent();
            c && (c = c.getContentSize(), 0 >= c.width || 0 >= c.height ? (this._positionPercent.x = 0, this._positionPercent.y = 0) : void 0 === b ? (this._positionPercent.x = a.x / c.width, this._positionPercent.y = a.y / c.height) : (this._positionPercent.x = a / c.width, this._positionPercent.y = b / c.height))
        }
        cc.Node.prototype.setPosition.call(this, a, b)
    },
    setPositionX: function(a) {
        if (this._running) {
            var b = this.getWidgetParent();
            b && (b = b.width, this._positionPercent.x = 0 >= b ? 0 : a / b)
        }
        cc.Node.prototype.setPositionX.call(this, a)
    },
    setPositionY: function(a) {
        if (this._running) {
            var b = this.getWidgetParent();
            b && (b = b.height, this._positionPercent.y = 0 >= b ? 0 : a / b)
        }
        cc.Node.prototype.setPositionY.call(this, a)
    },
    setPositionPercent: function(a) {
        if (this._usingLayoutComponent) {
            var b = this._getOrCreateLayoutComponent();
            b.setPositionPercentX(a.x);
            b.setPositionPercentY(a.y);
            b.refreshLayout()
        } else this._setXPercent(a.x),
        this._setYPercent(a.y),
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    _setXPercent: function(a) {
        if (this._usingLayoutComponent) {
            var b = this._getOrCreateLayoutComponent();
            b.setPositionPercentX(a.x);
            b.refreshLayout()
        } else this._positionPercent.x = a,
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    _setYPercent: function(a) {
        if (this._usingLayoutComponent) {
            var b = this._getOrCreateLayoutComponent();
            b.setPositionPercentY(a.x);
            b.refreshLayout()
        } else this._positionPercent.y = a,
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    getPositionPercent: function() {
        if (this._usingLayoutComponent) {
            var a = this._getOrCreateLayoutComponent();
            this._positionPercent.x = a.getPositionPercentX();
            this._positionPercent.y = a.getPositionPercentY()
        }
        return cc.p(this._positionPercent)
    },
    _getXPercent: function() {
        if (this._usingLayoutComponent) {
            var a = this._getOrCreateLayoutComponent();
            this._positionPercent.x = a.getPositionPercentX();
            this._positionPercent.y = a.getPositionPercentY()
        }
        return this._positionPercent.x
    },
    _getYPercent: function() {
        if (this._usingLayoutComponent) {
            var a = this._getOrCreateLayoutComponent();
            this._positionPercent.x = a.getPositionPercentX();
            this._positionPercent.y = a.getPositionPercentY()
        }
        return this._positionPercent.y
    },
    setPositionType: function(a) {
        this._positionType = a;
        if (this._usingLayoutComponent) {
            var b = this._getOrCreateLayoutComponent();
            a === ccui.POSITION_ABSOLUTE ? (b.setPositionPercentXEnabled(!1), b.setPositionPercentYEnabled(!1)) : (b.setPositionPercentXEnabled(!0), b.setPositionPercentYEnabled(!0))
        }
        this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)
    },
    getPositionType: function() {
        return this._positionType
    },
    setFlippedX: function(a) {
        var b = this.getScaleX();
        this._flippedX = a;
        this.setScaleX(b)
    },
    isFlippedX: function() {
        return this._flippedX
    },
    setFlippedY: function(a) {
        var b = this.getScaleY();
        this._flippedY = a;
        this.setScaleY(b)
    },
    isFlippedY: function() {
        return this._flippedY
    },
    _adaptRenderers: function() {},
    isBright: function() {
        return this._bright
    },
    isEnabled: function() {
        return this._enabled
    },
    getLeftBoundary: function() {
        return this.getPositionX() - this._getAnchorX() * this._contentSize.width
    },
    getBottomBoundary: function() {
        return this.getPositionY() - this._getAnchorY() * this._contentSize.height
    },
    getRightBoundary: function() {
        return this.getLeftBoundary() + this._contentSize.width
    },
    getTopBoundary: function() {
        return this.getBottomBoundary() + this._contentSize.height
    },
    getTouchBeganPosition: function() {
        return cc.p(this._touchBeganPosition)
    },
    getTouchMovePosition: function() {
        return cc.p(this._touchMovePosition)
    },
    getTouchEndPosition: function() {
        return cc.p(this._touchEndPosition)
    },
    getWidgetType: function() {
        return this._widgetType
    },
    setLayoutParameter: function(a) {
        a && (this._layoutParameterDictionary[a.getLayoutType()] = a, this._layoutParameterType = a.getLayoutType())
    },
    getLayoutParameter: function(a) {
        a = a || this._layoutParameterType;
        return this._layoutParameterDictionary[a]
    },
    getDescription: function() {
        return "Widget"
    },
    clone: function() {
        var a = this._createCloneInstance();
        a._copyProperties(this);
        a._copyClonedWidgetChildren(this);
        return a
    },
    _createCloneInstance: function() {
        return new ccui.Widget
    },
    _copyClonedWidgetChildren: function(a) {
        a = a.getChildren();
        for (var b = 0; b < a.length; b++) {
            var c = a[b];
            c instanceof ccui.Widget && this.addChild(c.clone())
        }
    },
    _copySpecialProperties: function(a) {},
    _copyProperties: function(a) {
        this.setEnabled(a.isEnabled());
        this.setVisible(a.isVisible());
        this.setBright(a.isBright());
        this.setTouchEnabled(a.isTouchEnabled());
        this.setLocalZOrder(a.getLocalZOrder());
        this.setTag(a.getTag());
        this.setName(a.getName());
        this.setActionTag(a.getActionTag());
        this._ignoreSize = a._ignoreSize;
        this.setContentSize(a._contentSize);
        this._customSize.width = a._customSize.width;
        this._customSize.height = a._customSize.height;
        this._copySpecialProperties(a);
        this._sizeType = a.getSizeType();
        this._sizePercent.x = a._sizePercent.x;
        this._sizePercent.y = a._sizePercent.y;
        this._positionType = a._positionType;
        this._positionPercent.x = a._positionPercent.x;
        this._positionPercent.y = a._positionPercent.y;
        this.setPosition(a.getPosition());
        this.setAnchorPoint(a.getAnchorPoint());
        this.setScaleX(a.getScaleX());
        this.setScaleY(a.getScaleY());
        this.setRotation(a.getRotation());
        this.setRotationX(a.getRotationX());
        this.setRotationY(a.getRotationY());
        this.setFlippedX(a.isFlippedX());
        this.setFlippedY(a.isFlippedY());
        this.setColor(a.getColor());
        this.setOpacity(a.getOpacity());
        this._touchEventCallback = a._touchEventCallback;
        this._touchEventListener = a._touchEventListener;
        this._touchEventSelector = a._touchEventSelector;
        this._clickEventListener = a._clickEventListener;
        this._focused = a._focused;
        this._focusEnabled = a._focusEnabled;
        this._propagateTouchEvents = a._propagateTouchEvents;
        for (var b in a._layoutParameterDictionary) {
            var c = a._layoutParameterDictionary[b];
            c && this.setLayoutParameter(c.clone())
        }
    },
    setActionTag: function(a) {
        this._actionTag = a
    },
    getActionTag: function() {
        return this._actionTag
    },
    getLeftInParent: function() {
        cc.log("getLeftInParent is deprecated. Please use getLeftBoundary instead.");
        return this.getLeftBoundary()
    },
    getBottomInParent: function() {
        cc.log("getBottomInParent is deprecated. Please use getBottomBoundary instead.");
        return this.getBottomBoundary()
    },
    getRightInParent: function() {
        cc.log("getRightInParent is deprecated. Please use getRightBoundary instead.");
        return this.getRightBoundary()
    },
    getTopInParent: function() {
        cc.log("getTopInParent is deprecated. Please use getTopBoundary instead.");
        return this.getTopBoundary()
    },
    getTouchEndPos: function() {
        cc.log("getTouchEndPos is deprecated. Please use getTouchEndPosition instead.");
        return this.getTouchEndPosition()
    },
    getTouchMovePos: function() {
        cc.log("getTouchMovePos is deprecated. Please use getTouchMovePosition instead.");
        return this.getTouchMovePosition()
    },
    clippingParentAreaContainPoint: function(a) {
        cc.log("clippingParentAreaContainPoint is deprecated. Please use isClippingParentContainsPoint instead.");
        this.isClippingParentContainsPoint(a)
    },
    getTouchStartPos: function() {
        cc.log("getTouchStartPos is deprecated. Please use getTouchBeganPosition instead.");
        return this.getTouchBeganPosition()
    },
    setSize: function(a) {
        this.setContentSize(a)
    },
    getSize: function() {
        return this.getContentSize()
    },
    addNode: function(a, b, c) {
        a instanceof ccui.Widget ? cc.log("Please use addChild to add a Widget.") : (cc.Node.prototype.addChild.call(this, a, b, c), this._nodes.push(a))
    },
    getNodeByTag: function(a) {
        for (var b = this._nodes,
        c = 0; c < b.length; c++) {
            var d = b[c];
            if (d && d.getTag() === a) return d
        }
        return null
    },
    getNodes: function() {
        return this._nodes
    },
    removeNode: function(a, b) {
        cc.Node.prototype.removeChild.call(this, a, b);
        cc.arrayRemoveObject(this._nodes, a)
    },
    _getNormalGLProgram: function() {
        return cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR)
    },
    _getGrayGLProgram: function() {
        return cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR_GRAY)
    },
    removeNodeByTag: function(a, b) {
        var c = this.getChildByTag(a);
        c ? this.removeChild(c, b) : cc.log("cocos2d: removeNodeByTag(tag \x3d %d): child not found!", a)
    },
    removeAllNodes: function() {
        for (var a = 0; a < this._nodes.length; a++) cc.Node.prototype.removeChild.call(this, this._nodes[a]);
        this._nodes.length = 0
    },
    _findLayout: function() {
        cc.renderer.childrenOrderDirty = !0;
        for (var a = this._parent; a;) if (a._doLayout) {
            a._doLayoutDirty = !0;
            break
        } else a = a._parent
    },
    isUnifySizeEnabled: function() {
        return this._unifySize
    },
    setUnifySizeEnabled: function(a) {
        this._unifySize = a
    },
    _ccEventCallback: null,
    addCCSEventListener: function(a) {
        this._ccEventCallback = a
    },
    setScaleX: function(a) {
        this._flippedX && (a *= -1);
        cc.Node.prototype.setScaleX.call(this, a)
    },
    setScaleY: function(a) {
        this._flippedY && (a *= -1);
        cc.Node.prototype.setScaleY.call(this, a)
    },
    setScale: function(a, b) {
        void 0 === b && (b = a);
        this.setScaleX(a);
        this.setScaleY(b)
    },
    getScaleX: function() {
        var a = cc.Node.prototype.getScaleX.call(this);
        this._flippedX && (a *= -1);
        return a
    },
    getScaleY: function() {
        var a = cc.Node.prototype.getScaleY.call(this);
        this._flippedY && (a *= -1);
        return a
    },
    getScale: function() {
        this.getScaleX() !== this.getScaleY() && cc.log("Widget#scale. ScaleX !\x3d ScaleY. Don't know which one to return");
        return this.getScaleX()
    },
    setCallbackName: function(a) {
        this._callbackName = a
    },
    getCallbackName: function() {
        return this._callbackName
    },
    setCallbackType: function(a) {
        this._callbackType = a
    },
    getCallbackType: function() {
        return this._callbackType
    },
    setLayoutComponentEnabled: function(a) {
        this._usingLayoutComponent = a
    },
    isLayoutComponentEnabled: function() {
        return this._usingLayoutComponent
    },
    _createRenderCmd: function() {
        return cc._renderType === cc.game.RENDER_TYPE_WEBGL ? new ccui.Widget.WebGLRenderCmd(this) : new ccui.Widget.CanvasRenderCmd(this)
    }
});
_p = ccui.Widget.prototype;
cc.defineGetterSetter(_p, "xPercent", _p._getXPercent, _p._setXPercent);
cc.defineGetterSetter(_p, "yPercent", _p._getYPercent, _p._setYPercent);
cc.defineGetterSetter(_p, "widthPercent", _p._getWidthPercent, _p._setWidthPercent);
cc.defineGetterSetter(_p, "heightPercent", _p._getHeightPercent, _p._setHeightPercent);
cc.defineGetterSetter(_p, "widgetParent", _p.getWidgetParent);
cc.defineGetterSetter(_p, "enabled", _p.isEnabled, _p.setEnabled);
cc.defineGetterSetter(_p, "focused", _p.isFocused, _p.setFocused);
cc.defineGetterSetter(_p, "sizeType", _p.getSizeType, _p.setSizeType);
cc.defineGetterSetter(_p, "widgetType", _p.getWidgetType);
cc.defineGetterSetter(_p, "touchEnabled", _p.isTouchEnabled, _p.setTouchEnabled);
cc.defineGetterSetter(_p, "updateEnabled", _p.isUpdateEnabled, _p.setUpdateEnabled);
cc.defineGetterSetter(_p, "bright", _p.isBright, _p.setBright);
cc.defineGetterSetter(_p, "name", _p.getName, _p.setName);
cc.defineGetterSetter(_p, "actionTag", _p.getActionTag, _p.setActionTag);
cc.defineGetterSetter(_p, "opacity", _p.getOpacity, _p.setOpacity);
_p = null;
ccui.Widget.create = function() {
    return new ccui.Widget
};
ccui.Widget._focusedWidget = null;
ccui.Widget._focusNavigationController = null;
ccui.Widget.enableDpadNavigation = function(a) {
    a ? (null == ccui.Widget._focusNavigationController && (ccui.Widget._focusNavigationController = new ccui._FocusNavigationController, ccui.Widget._focusedWidget && ccui.Widget._focusNavigationController._setFirstFocsuedWidget(ccui.Widget._focusedWidget)), ccui.Widget._focusNavigationController.enableFocusNavigation(!0)) : ccui.Widget._focusNavigationController && (ccui.Widget._focusNavigationController.enableFocusNavigation(!1), ccui.Widget._focusNavigationController = null)
};
ccui.Widget.getCurrentFocusedWidget = function() {
    return ccui.Widget._focusedWidget
};
ccui.Widget.BRIGHT_STYLE_NONE = -1;
ccui.Widget.BRIGHT_STYLE_NORMAL = 0;
ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT = 1;
ccui.Widget.TYPE_WIDGET = 0;
ccui.Widget.TYPE_CONTAINER = 1;
ccui.Widget.LEFT = 0;
ccui.Widget.RIGHT = 1;
ccui.Widget.UP = 2;
ccui.Widget.DOWN = 3;
ccui.Widget.LOCAL_TEXTURE = 0;
ccui.Widget.PLIST_TEXTURE = 1;
ccui.Widget.TOUCH_BEGAN = 0;
ccui.Widget.TOUCH_MOVED = 1;
ccui.Widget.TOUCH_ENDED = 2;
ccui.Widget.TOUCH_CANCELED = 3;
ccui.Widget.SIZE_ABSOLUTE = 0;
ccui.Widget.SIZE_PERCENT = 1;
ccui.Widget.POSITION_ABSOLUTE = 0;
ccui.Widget.POSITION_PERCENT = 1;
cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,
function() {
    if (cc._renderType === cc.game.RENDER_TYPE_CANVAS) {
        ccui.Widget.CanvasRenderCmd = function(a) {
            this._pNodeCmdCtor(a);
            this._needDraw = !1
        };
        var a = ccui.Widget.CanvasRenderCmd.prototype = Object.create(cc.ProtectedNode.CanvasRenderCmd.prototype);
        a.constructor = ccui.Widget.CanvasRenderCmd;
        a.visit = function(a) {
            var c = this._node,
            d = cc.renderer;
            if (a = a || this.getParentRenderCmd()) this._curLevel = a._curLevel + 1;
            isNaN(c._customZ) && (c._vertexZ = d.assignedZ, d.assignedZ += d.assignedZStep);
            c._adaptRenderers();
            this._syncStatus(a)
        };
        a.transform = function(a, c) {
            this._transform || (this._transform = {
                a: 1,
                b: 0,
                c: 0,
                d: 1,
                tx: 0,
                ty: 0
            },
            this._worldTransform = {
                a: 1,
                b: 0,
                c: 0,
                d: 1,
                tx: 0,
                ty: 0
            });
            var d = this._node;
            if (d._visible && d._running) {
                d._adaptRenderers();
                if (!this._usingLayoutComponent) {
                    var e = d.getWidgetParent();
                    e && (e = e.getContentSize(), 0 !== e.width && 0 !== e.height && (d._position.x = e.width * d._positionPercent.x, d._position.y = e.height * d._positionPercent.y))
                }
                this.pNodeTransform(a, c)
            }
        }
    } else ccui.Widget.WebGLRenderCmd = function(a) {
        this._pNodeCmdCtor(a);
        this._needDraw = !1
    },
    a = ccui.Widget.WebGLRenderCmd.prototype = Object.create(cc.ProtectedNode.WebGLRenderCmd.prototype),
    a.constructor = ccui.Widget.WebGLRenderCmd,
    a.visit = function(a) {
        var c = this._node,
        d = cc.renderer;
        if (a = a || this.getParentRenderCmd()) this._curLevel = a._curLevel + 1;
        isNaN(c._customZ) && (c._vertexZ = d.assignedZ, d.assignedZ += d.assignedZStep);
        c._adaptRenderers();
        this._syncStatus(a)
    },
    a.transform = function(a, c) {
        this._transform || (this._transform = {
            a: 1,
            b: 0,
            c: 0,
            d: 1,
            tx: 0,
            ty: 0
        },
        this._worldTransform = {
            a: 1,
            b: 0,
            c: 0,
            d: 1,
            tx: 0,
            ty: 0
        });
        var d = this._node;
        if (d._visible && d._running) {
            d._adaptRenderers();
            if (!this._usingLayoutComponent) {
                var e = d.getWidgetParent();
                e && (e = e.getContentSize(), 0 !== e.width && 0 !== e.height && (d._position.x = e.width * d._positionPercent.x, d._position.y = e.height * d._positionPercent.y))
            }
            this.pNodeTransform(a, c)
        }
    };
    a.widgetTransform = a.transform
}); (function() {
    var a = {
        _pool: {},
        _lengths: [],
        put: function(a) {
            var b = a.length;
            this._pool[b] ? this._pool[b].push(a) : (this._pool[b] = [a], this._lengths.push(b), this._lengths.sort())
        },
        get: function(a) {
            for (var b, c = 0; c < this._lengths.length; c++) if (this._lengths[c] >= a) {
                b = this._lengths[c];
                break
            }
            if (b) return this._pool[b].pop()
        }
    },
    b = cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL,
    c,
    d = {
        _rebuildQuads_base: function(b, d, e, f) {
            var g = b._vertices,
            t = b._renderCmd._worldTransform,
            p, v, u;
            if (f) v = p = 0,
            u = e.width,
            e = e.height;
            else {
                p = d._originalSize;
                var x = d._rect,
                y = d._offset;
                u = e.width / p.width;
                f = e.height / p.height;
                var w = y.x - (p.width - x.width) / 2;
                v = y.y + (p.height - x.height) / 2;
                var B = y.y - (p.height - x.height) / 2;
                p = (y.x + (p.width - x.width) / 2) * u;
                v *= f;
                u = e.width + w * u;
                e = e.height + B * f
            }
            8 > g.length && (a.put(g), g = a.get(8) || new Float32Array(8), b._vertices = g);
            c ? (g[0] = p * t.a + v * t.c + t.tx, g[1] = p * t.b + v * t.d + t.ty, g[2] = u * t.a + v * t.c + t.tx, g[3] = u * t.b + v * t.d + t.ty, g[4] = p * t.a + e * t.c + t.tx, g[5] = p * t.b + e * t.d + t.ty, g[6] = u * t.a + e * t.c + t.tx, g[7] = u * t.b + e * t.d + t.ty) : (g[0] = p, g[1] = v, g[2] = u, g[3] = v, g[4] = p, g[5] = e, g[6] = u, g[7] = e);
            b._uvsDirty && this._calculateUVs(b, d);
            b._vertCount = 4
        },
        _calculateUVs: function(c, d) {
            var e = c._uvs,
            f = d._texture._pixelsWide,
            g = d._texture._pixelsHigh,
            t = d._rect,
            t = cc.rectPointsToPixels(t);
            8 > e.length && (a.put(e), e = a.get(8) || new Float32Array(8), c._uvs = e);
            var p, v, u = b ? 0.5 : 0;
            d._rotated ? (p = (t.x + u) / f, v = (t.y + t.width - u) / g, f = (t.x + t.height - u) / f, g = (t.y + u) / g, e[0] = p, e[1] = g, e[2] = p, e[3] = v, e[4] = f, e[5] = g, e[6] = f, e[7] = v) : (p = (t.x + u) / f, v = (t.y + t.height - u) / g, f = (t.x + t.width - u) / f, g = (t.y + u) / g, e[0] = p, e[1] = v, e[2] = f, e[3] = v, e[4] = p, e[5] = g, e[6] = f, e[7] = g)
        }
    },
    e = {
        x: Array(4),
        y: Array(4),
        _rebuildQuads_base: function(b, d, e, f, g, t, p) {
            var v = b._vertices,
            u = b._renderCmd._worldTransform,
            x = e.width - f - g,
            y = e.height - t - p,
            w = e.width / (f + g),
            B = e.height / (t + p),
            z = this.x,
            A = this.y;
            z[0] = 0;
            z[1] = f * (1 < w ? 1 : w);
            z[2] = z[1] + (0 > x ? 0 : x);
            z[3] = e.width;
            A[0] = 0;
            A[1] = p * (1 < B ? 1 : B);
            A[2] = A[1] + (0 > y ? 0 : y);
            A[3] = e.height;
            32 > v.length && (a.put(v), v = a.get(32) || new Float32Array(32), b._vertices = v);
            e = 0;
            if (c) for (x = 0; 4 > x; x++) for (y = 0; 4 > y; y++) v[e] = z[y] * u.a + A[x] * u.c + u.tx,
            v[e + 1] = z[y] * u.b + A[x] * u.d + u.ty,
            e += 2;
            else for (x = 0; 4 > x; x++) for (y = 0; 4 > y; y++) v[e] = z[y],
            v[e + 1] = A[x],
            e += 2;
            b._uvsDirty && this._calculateUVs(b, d, f, g, t, p)
        },
        _calculateUVs: function(c, d, e, f, g, t) {
            var p = c._uvs,
            v = d._rect,
            u = d._texture._pixelsWide,
            x = d._texture._pixelsHigh,
            y, w = d._rect,
            w = cc.rectPointsToPixels(w),
            v = cc.rectPointsToPixels(v),
            B = cc.contentScaleFactor();
            e *= B;
            f = v.width - e - f * B;
            g *= B;
            t *= B;
            y = v.height - g - t;
            32 > p.length && (a.put(p), p = a.get(32) || new Float32Array(32), c._uvs = p);
            c = this.x;
            var v = this.y,
            z = b ? 0.5 : 0,
            B = 0;
            if (d._rotated) for (c[0] = (w.x + z) / u, c[1] = (t + w.x) / u, c[2] = (t + y + w.x) / u, c[3] = (w.x + w.height - z) / u, v[3] = (w.y + z) / x, v[2] = (e + w.y) / x, v[1] = (e + f + w.y) / x, v[0] = (w.y + w.width - z) / x, d = 0; 4 > d; d++) for (u = 0; 4 > u; u++) p[B] = c[d],
            p[B + 1] = v[3 - u],
            B += 2;
            else for (c[0] = (w.x + z) / u, c[1] = (e + w.x) / u, c[2] = (e + f + w.x) / u, c[3] = (w.x + w.width - z) / u, v[3] = (w.y + z) / x, v[2] = (g + w.y) / x, v[1] = (g + y + w.y) / x, v[0] = (w.y + w.height - z) / x, d = 0; 4 > d; d++) for (u = 0; 4 > u; u++) p[B] = c[u],
            p[B + 1] = v[d],
            B += 2
        }
    };
    ccui.Scale9Sprite = cc.Scale9Sprite = cc.Node.extend({
        _spriteFrame: null,
        _scale9Image: null,
        _insetLeft: 0,
        _insetRight: 0,
        _insetTop: 0,
        _insetBottom: 0,
        _blendFunc: null,
        _renderingType: 1,
        _brightState: 0,
        _opacityModifyRGB: !1,
        _rawVerts: null,
        _rawUvs: null,
        _vertices: null,
        _uvs: null,
        _vertCount: 0,
        _quadsDirty: !0,
        _uvsDirty: !0,
        _isTriangle: !1,
        _isTrimmedContentSize: !1,
        _textureLoaded: !1,
        _flippedX: !1,
        _flippedY: !1,
        _className: "Scale9Sprite",
        ctor: function(b, d, e) {
            cc.Node.prototype.ctor.call(this);
            this._loader = new cc.Sprite.LoadManager;
            this._renderCmd.setState(this._brightState);
            this._blendFunc = cc.BlendFunc._alphaPremultiplied();
            this.setAnchorPoint(cc.p(0.5, 0.5));
            this._rawUvs = this._rawVerts = null;
            this._vertices = a.get(8) || new Float32Array(8);
            this._uvs = a.get(8) || new Float32Array(8);
            if (void 0 !== b) if (b instanceof cc.SpriteFrame) this.initWithSpriteFrame(b, d);
            else {
                var f = cc.spriteFrameCache.getSpriteFrame(b);
                f ? this.initWithSpriteFrame(f, d) : this.initWithFile(b, d, e)
            }
            void 0 === c && (c = cc._renderType === cc.game.RENDER_TYPE_WEBGL)
        },
        textureLoaded: function() {
            return this._textureLoaded
        },
        getCapInsets: function() {
            return cc.rect(this._capInsetsInternal)
        },
        _asyncSetCapInsets: function() {
            this.removeEventListener("load", this._asyncSetCapInsets, this);
            this.setCapInsets(this._cacheCapInsets);
            this._cacheCapInsets = null
        },
        setCapInsets: function(a) {
            if (!this.loaded()) return this._cacheCapInsets = a,
            this.removeEventListener("load", this._asyncSetCapInsets, this),
            this.addEventListener("load", this._asyncSetCapInsets, this),
            !1;
            this._capInsetsInternal = a;
            this._updateCapInsets(this._spriteFrame._rect, this._capInsetsInternal)
        },
        _updateCapInsets: function(a, b) {
            b && a && !cc._rectEqualToZero(b) ? this._capInsetsInternal = b: (a = a || {
                x: 0,
                y: 0,
                width: this._contentSize.width,
                height: this._contentSize.height
            },
            this._capInsetsInternal = cc.rect(a.width / 3, a.height / 3, a.width / 3, a.height / 3));
            cc._rectEqualToZero(a) || (this._insetLeft = this._capInsetsInternal.x, this._insetTop = this._capInsetsInternal.y, this._insetRight = a.width - this._insetLeft - this._capInsetsInternal.width, this._insetBottom = a.height - this._insetTop - this._capInsetsInternal.height)
        },
        initWithFile: function(a, b, c) {
            a instanceof cc.Rect ? (c = a = b, b = cc.rect(0, 0, 0, 0)) : (b = b || cc.rect(0, 0, 0, 0), c = c || cc.rect(0, 0, 0, 0));
            if (!a) throw Error("ccui.Scale9Sprite.initWithFile(): file should be non-null");
            var d = cc.textureCache.getTextureForKey(a);
            d || (d = cc.textureCache.addImage(a));
            var e = d.isLoaded();
            this._textureLoaded = e;
            this._loader.clear();
            if (!e) return this._loader.once(d,
            function() {
                this.initWithFile(a, b, c);
                this.dispatchEvent("load")
            },
            this),
            !1;
            cc._rectEqualToZero(b) && (e = d.getContentSize(), b = cc.rect(0, 0, e.width, e.height));
            this.setTexture(d, b);
            this._updateCapInsets(b, c);
            return ! 0
        },
        updateWithBatchNode: function(a, b, c, d) {
            if (!a) return ! 1;
            var e = a.getTexture();
            this._loader.clear();
            if (!e.isLoaded()) return this._loader.once(e,
            function() {
                this.updateWithBatchNode(a, b, c, d);
                this.dispatchEvent("load")
            },
            this),
            !1;
            this.setTexture(e, b);
            this._updateCapInsets(b, d);
            return ! 0
        },
        initWithSpriteFrame: function(a, b) {
            this.setSpriteFrame(a);
            b = b || cc.rect(0, 0, 0, 0);
            this._updateCapInsets(a._rect, b)
        },
        initWithSpriteFrameName: function(a, b) {
            if (!a) throw Error("ccui.Scale9Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null");
            b = b || cc.rect(0, 0, 0, 0);
            var c = cc.spriteFrameCache.getSpriteFrame(a);
            if (null == c) return cc.log("ccui.Scale9Sprite.initWithSpriteFrameName(): can't find the sprite frame by spriteFrameName"),
            !1;
            this.setSpriteFrame(c);
            b = b || cc.rect(0, 0, 0, 0);
            this._updateCapInsets(c._rect, b)
        },
        loaded: function() {
            return null === this._spriteFrame ? !1 : this._spriteFrame.textureLoaded()
        },
        setTexture: function(a, b) {
            var c = new cc.SpriteFrame(a, b);
            this.setSpriteFrame(c)
        },
        _updateBlendFunc: function() {
            var a = this._blendFunc;
            this._spriteFrame && this._spriteFrame._texture.hasPremultipliedAlpha() ? (a.src === cc.SRC_ALPHA && a.dst === cc.BLEND_DST && (a.src = cc.ONE), this._opacityModifyRGB = !0) : (a.src === cc.ONE && a.dst === cc.BLEND_DST && (a.src = cc.SRC_ALPHA), this._opacityModifyRGB = !1)
        },
        setOpacityModifyRGB: function(a) {
            this._opacityModifyRGB !== a && (this._opacityModifyRGB = a, this._renderCmd._setColorDirty())
        },
        isOpacityModifyRGB: function() {
            return this._opacityModifyRGB
        },
        setSpriteFrame: function(a) {
            if (a) {
                this._spriteFrame = a;
                this._uvsDirty = this._quadsDirty = !0;
                var b = this,
                c = function() {
                    cc.sizeEqualToSize(b._contentSize, cc.size(0, 0)) && b.setContentSize(b._spriteFrame._rect);
                    b._textureLoaded = !0;
                    b._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty);
                    cc.renderer.childrenOrderDirty = !0
                };
                b._textureLoaded = a.textureLoaded();
                b._textureLoaded ? c() : (this._loader.clear(), this._loader.once(a,
                function() {
                    c();
                    this.dispatchEvent("load")
                },
                this))
            }
        },
        setBlendFunc: function(a, b) {
            void 0 === b ? (this._blendFunc.src = a.src || cc.BLEND_SRC, this._blendFunc.dst = a.dst || cc.BLEND_DST) : (this._blendFunc.src = a || cc.BLEND_SRC, this._blendFunc.dst = b || cc.BLEND_DST);
            this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty)
        },
        getBlendFunc: function() {
            return new cc.BlendFunc(this._blendFunc.src, this._blendFunc.dst)
        },
        setPreferredSize: function(a) {
            a && !cc.sizeEqualToSize(this._contentSize, a) && this.setContentSize(a)
        },
        getPreferredSize: function() {
            return this.getContentSize()
        },
        setContentSize: function(a, b) {
            void 0 === b && (b = a.height, a = a.width);
            if (a !== this._contentSize.width || b !== this._contentSize.height) cc.Node.prototype.setContentSize.call(this, a, b),
            this._quadsDirty = !0
        },
        getContentSize: function() {
            return this._renderingType === ccui.Scale9Sprite.RenderingType.SIMPLE ? this._spriteFrame ? this._spriteFrame._originalSize: cc.size(this._contentSize) : cc.size(this._contentSize)
        },
        _setWidth: function(a) {
            cc.Node.prototype._setWidth.call(this, a);
            this._quadsDirty = !0
        },
        _setHeight: function(a) {
            cc.Node.prototype._setHeight.call(this, a);
            this._quadsDirty = !0
        },
        setState: function(a) {
            this._brightState = a;
            this._renderCmd.setState(a);
            this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty)
        },
        getState: function() {
            return this._brightState
        },
        setRenderingType: function(a) {
            this._renderingType !== a && (this._renderingType = a, this._uvsDirty = this._quadsDirty = !0, this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty))
        },
        getRenderingType: function() {
            return this._renderingType
        },
        setInsetLeft: function(a) {
            this._insetLeft = a;
            this._uvsDirty = this._quadsDirty = !0;
            this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty)
        },
        getInsetLeft: function() {
            return this._insetLeft
        },
        setInsetTop: function(a) {
            this._insetTop = a;
            this._uvsDirty = this._quadsDirty = !0;
            this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty)
        },
        getInsetTop: function() {
            return this._insetTop
        },
        setInsetRight: function(a) {
            this._insetRight = a;
            this._uvsDirty = this._quadsDirty = !0;
            this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty)
        },
        getInsetRight: function() {
            return this._insetRight
        },
        setInsetBottom: function(a) {
            this._insetBottom = a;
            this._uvsDirty = this._quadsDirty = !0;
            this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty)
        },
        getInsetBottom: function() {
            return this._insetBottom
        },
        _rebuildQuads: function() {
            if (this._spriteFrame && this._spriteFrame._textureLoaded) {
                this._updateBlendFunc();
                this._isTriangle = !1;
                switch (this._renderingType) {
                case g.SIMPLE:
                    d._rebuildQuads_base(this, this._spriteFrame, this._contentSize, this._isTrimmedContentSize);
                    break;
                case g.SLICED:
                    e._rebuildQuads_base(this, this._spriteFrame, this._contentSize, this._insetLeft, this._insetRight, this._insetTop, this._insetBottom);
                    break;
                default:
                    this._uvsDirty = this._quadsDirty = !1;
                    cc.error("Can not generate quad");
                    return
                }
                this._uvsDirty = this._quadsDirty = !1
            }
        },
        _createRenderCmd: function() {
            return cc._renderType === cc.game.RENDER_TYPE_CANVAS ? new ccui.Scale9Sprite.CanvasRenderCmd(this) : new ccui.Scale9Sprite.WebGLRenderCmd(this)
        }
    });
    var f = ccui.Scale9Sprite.prototype;
    cc.EventHelper.prototype.apply(f);
    cc.defineGetterSetter(f, "preferredSize", f.getPreferredSize, f.setPreferredSize);
    cc.defineGetterSetter(f, "capInsets", f.getCapInsets, f.setCapInsets);
    cc.defineGetterSetter(f, "insetLeft", f.getInsetLeft, f.setInsetLeft);
    cc.defineGetterSetter(f, "insetTop", f.getInsetTop, f.setInsetTop);
    cc.defineGetterSetter(f, "insetRight", f.getInsetRight, f.setInsetRight);
    cc.defineGetterSetter(f, "insetBottom", f.getInsetBottom, f.setInsetBottom);
    f = null;
    ccui.Scale9Sprite.create = function(a, b, c) {
        return new ccui.Scale9Sprite(a, b, c)
    };
    ccui.Scale9Sprite.createWithSpriteFrame = function(a, b) {
        return new ccui.Scale9Sprite(a, b)
    };
    ccui.Scale9Sprite.createWithSpriteFrameName = function(a, b) {
        return new ccui.Scale9Sprite(a, b)
    };
    ccui.Scale9Sprite.POSITIONS_CENTRE = 0;
    ccui.Scale9Sprite.POSITIONS_TOP = 1;
    ccui.Scale9Sprite.POSITIONS_LEFT = 2;
    ccui.Scale9Sprite.POSITIONS_RIGHT = 3;
    ccui.Scale9Sprite.POSITIONS_BOTTOM = 4;
    ccui.Scale9Sprite.POSITIONS_TOPRIGHT = 5;
    ccui.Scale9Sprite.POSITIONS_TOPLEFT = 6;
    ccui.Scale9Sprite.POSITIONS_BOTTOMRIGHT = 7;
    ccui.Scale9Sprite.state = {
        NORMAL: 0,
        GRAY: 1
    };
    var g = ccui.Scale9Sprite.RenderingType = {
        SIMPLE: 0,
        SLICED: 1
    }
})(); (function() {
    ccui.Scale9Sprite.CanvasRenderCmd = function(a) {
        cc.Node.CanvasRenderCmd.call(this, a);
        this._needDraw = !0;
        this._state = ccui.Scale9Sprite.state.NORMAL;
        this._originalTexture = this._textureToRender = null
    };
    var a = ccui.Scale9Sprite.CanvasRenderCmd.prototype = Object.create(cc.Node.CanvasRenderCmd.prototype);
    a.constructor = ccui.Scale9Sprite.CanvasRenderCmd;
    a.transform = function(a, c) {
        this.originTransform(a, c);
        this._node._rebuildQuads()
    };
    a.needDraw = function() {
        return this._needDraw && this._node.loaded()
    };
    a._updateDisplayColor = function(a) {
        cc.Node.RenderCmd.prototype._updateDisplayColor.call(this, a);
        this._originalTexture = this._textureToRender = null
    };
    a.setState = function(a) {
        this._state !== a && (this._state = a, this._originalTexture = this._textureToRender = null)
    };
    a._setColorDirty = function() {
        this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty | cc.Node._dirtyFlags.opacityDirty)
    };
    a.rendering = function(a, c, d) {
        var e = this._node,
        f = this._displayedOpacity,
        g = f / 255,
        h = null;
        e._spriteFrame && (h = e._spriteFrame._texture);
        if (e.loaded() && 0 !== f) {
            if (null === this._textureToRender || this._originalTexture !== h) this._textureToRender = this._originalTexture = h,
            cc.Scale9Sprite.state.GRAY === this._state && (this._textureToRender = this._textureToRender._generateGrayTexture()),
            f = e.getDisplayedColor(),
            !h || 255 === f.r && 255 === f.g && 255 === f.b || (this._textureToRender = this._textureToRender._generateColorTexture(f.r, f.g, f.b));
            h = a || cc._renderContext;
            a = h.getContext();
            h.setTransform(this._worldTransform, c, d);
            h.setCompositeOperation(cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(e._blendFunc));
            h.setGlobalAlpha(g);
            if (this._textureToRender) {
                e._quadsDirty && e._rebuildQuads();
                var k, m, r, s, t, p, v;
                c = this._textureToRender._pixelsWide;
                d = this._textureToRender._pixelsHigh;
                var g = this._textureToRender._htmlElementObj,
                f = e._vertices,
                u = e._uvs,
                x = 0,
                y = 0;
                if (e._renderingType === cc.Scale9Sprite.RenderingType.SLICED) {
                    for (h = 0; 3 > h; ++h) for (x = 0; 3 > x; ++x) y = 8 * h + 2 * x,
                    s = f[y],
                    t = f[y + 1],
                    p = f[y + 10] - s,
                    v = f[y + 11] - t,
                    t = -t - v,
                    e = u[y] * c,
                    k = u[y + 11] * d,
                    m = (u[y + 10] - u[y]) * c,
                    r = (u[y + 1] - u[y + 11]) * d,
                    0 < m && 0 < r && 0 < p && 0 < v && a.drawImage(g, e, k, m, r, s, t, p, v);
                    cc.g_NumberOfDraws += 9
                } else {
                    for (var w = Math.floor(e._vertCount / 4), y = x = 0; x < w; x++) s = f[y],
                    t = f[y + 1],
                    p = f[y + 6] - s,
                    v = f[y + 7] - t,
                    t = -t - v,
                    e = u[y] * c,
                    k = u[y + 7] * d,
                    m = (u[y + 6] - u[y]) * c,
                    r = (u[y + 1] - u[y + 7]) * d,
                    "" !== this._textureToRender._pattern ? (h.setFillStyle(a.createPattern(g, this._textureToRender._pattern)), a.fillRect(s, t, p, v)) : 0 < m && 0 < r && 0 < p && 0 < v && a.drawImage(g, e, k, m, r, s, t, p, v),
                    y += 8;
                    cc.g_NumberOfDraws += w
                }
            }
        }
    }
})(); (function() {
    if (cc.Node.WebGLRenderCmd) {
        ccui.Scale9Sprite.WebGLRenderCmd = function(a) {
            cc.Node.WebGLRenderCmd.call(this, a);
            this._needDraw = !0;
            this._color = new Uint32Array(1);
            this._dirty = !1;
            this._shaderProgram = cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR)
        };
        var a = ccui.Scale9Sprite,
        b = ccui.Scale9Sprite.WebGLRenderCmd.prototype = Object.create(cc.Node.WebGLRenderCmd.prototype);
        b.constructor = ccui.Scale9Sprite.WebGLRenderCmd;
        b.needDraw = function() {
            return this._needDraw && this._node.loaded()
        };
        b._uploadSliced = function(a, b, e, f, g, h, k) {
            for (var m, r = 0; 3 > r; ++r) for (var s = 0; 3 > s; ++s) m = 8 * r + 2 * s,
            g[k] = a[m],
            g[k + 1] = a[m + 1],
            g[k + 2] = f,
            h[k + 3] = e[0],
            g[k + 4] = b[m],
            g[k + 5] = b[m + 1],
            k += 6,
            g[k] = a[m + 2],
            g[k + 1] = a[m + 3],
            g[k + 2] = f,
            h[k + 3] = e[0],
            g[k + 4] = b[m + 2],
            g[k + 5] = b[m + 3],
            k += 6,
            g[k] = a[m + 8],
            g[k + 1] = a[m + 9],
            g[k + 2] = f,
            h[k + 3] = e[0],
            g[k + 4] = b[m + 8],
            g[k + 5] = b[m + 9],
            k += 6,
            g[k] = a[m + 10],
            g[k + 1] = a[m + 11],
            g[k + 2] = f,
            h[k + 3] = e[0],
            g[k + 4] = b[m + 10],
            g[k + 5] = b[m + 11],
            k += 6;
            return 36
        };
        b.transform = function(a, b) {
            this.originTransform(a, b);
            this._node._rebuildQuads()
        };
        b._setColorDirty = function() {};
        b.uploadData = function(b, d, e) {
            var f = this._node;
            if (0 === this._displayedOpacity) return 0;
            f._quadsDirty && f._rebuildQuads();
            var g = this._displayedOpacity,
            h = this._displayedColor.r,
            k = this._displayedColor.g,
            m = this._displayedColor.b;
            if (f._opacityModifyRGB) var r = g / 255,
            h = h * r,
            k = k * r,
            m = m * r;
            this._color[0] = g << 24 | m << 16 | k << 8 | h;
            g = f._vertexZ;
            h = f._vertices;
            k = f._uvs;
            r = a.RenderingType;
            m = 0;
            switch (f._renderingType) {
            case r.SIMPLE:
                m = this._node._vertCount;
                for (r = f = 0; f < m; f++, r += 2) b[e] = h[r],
                b[e + 1] = h[r + 1],
                b[e + 2] = g,
                d[e + 3] = this._color[0],
                b[e + 4] = k[r],
                b[e + 5] = k[r + 1],
                e += 6;
                break;
            case r.SLICED:
                m = this._uploadSliced(h, k, this._color, g, b, d, e)
            }
            return m
        };
        b.setState = function(b) {
            b === a.state.NORMAL ? this._shaderProgram = cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR) : b === a.state.GRAY && (this._shaderProgram = cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR_GRAY))
        }
    }
})();
ccui.Layout = ccui.Widget.extend({
    _clippingEnabled: !1,
    _backGroundScale9Enabled: null,
    _backGroundImage: null,
    _backGroundImageFileName: null,
    _backGroundImageCapInsets: null,
    _colorType: null,
    _bgImageTexType: ccui.Widget.LOCAL_TEXTURE,
    _colorRender: null,
    _gradientRender: null,
    _color: null,
    _startColor: null,
    _endColor: null,
    _alongVector: null,
    _opacity: 255,
    _backGroundImageTextureSize: null,
    _layoutType: null,
    _doLayoutDirty: !0,
    _clippingRectDirty: !0,
    _clippingType: null,
    _clippingStencil: null,
    _scissorRectDirty: !1,
    _clippingRect: null,
    _clippingParent: null,
    _className: "Layout",
    _backGroundImageColor: null,
    _finalPositionX: 0,
    _finalPositionY: 0,
    _backGroundImageOpacity: 0,
    _loopFocus: !1,
    __passFocusToChild: !0,
    _isFocusPassing: !1,
    _isInterceptTouch: !1,
    ctor: function() {
        this._layoutType = ccui.Layout.ABSOLUTE;
        this._widgetType = ccui.Widget.TYPE_CONTAINER;
        this._clippingType = ccui.Layout.CLIPPING_SCISSOR;
        this._colorType = ccui.Layout.BG_COLOR_NONE;
        ccui.Widget.prototype.ctor.call(this);
        this.ignoreContentAdaptWithSize(!1);
        this.setContentSize(cc.size(0, 0));
        this.setAnchorPoint(0, 0);
        this.onPassFocusToChild = this._findNearestChildWidgetIndex.bind(this);
        this._backGroundImageCapInsets = cc.rect(0, 0, 0, 0);
        this._color = cc.color(255, 255, 255, 255);
        this._startColor = cc.color(255, 255, 255, 255);
        this._endColor = cc.color(255, 255, 255, 255);
        this._alongVector = cc.p(0, -1);
        this._backGroundImageTextureSize = cc.size(0, 0);
        this._clippingRect = cc.rect(0, 0, 0, 0);
        this._backGroundImageColor = cc.color(255, 255, 255, 255)
    },
    onEnter: function() {
        ccui.Widget.prototype.onEnter.call(this);
        this._clippingStencil && this._clippingStencil._performRecursive(cc.Node._stateCallbackType.onEnter);
        this._clippingRectDirty = this._doLayoutDirty = !0
    },
    onExit: function() {
        ccui.Widget.prototype.onExit.call(this);
        this._clippingStencil && this._clippingStencil._performRecursive(cc.Node._stateCallbackType.onExit)
    },
    visit: function(a) {
        var b = this._renderCmd,
        c = a ? a._renderCmd: null;
        if (this._visible) {
            this._adaptRenderers();
            this._doLayout();
            b.visit(c);
            a = this._clippingEnabled && this._clippingType === ccui.Layout.CLIPPING_STENCIL;
            var d = this._clippingEnabled && this._clippingType === ccui.Layout.CLIPPING_SCISSOR;
            a ? b.stencilClippingVisit(c) : d && b.scissorClippingVisit(c);
            var e = this._children,
            f = e.length,
            g, h = this._protectedChildren,
            k = h.length,
            m;
            this._reorderChildDirty && this.sortAllChildren();
            this._reorderProtectedChildDirty && this.sortAllProtectedChildren();
            for (c = 0; c < f; c++) if (g = e[c], 0 > g._localZOrder) g.visit(this);
            else break;
            for (g = 0; g < k; g++) if (m = h[g], 0 > m._localZOrder) b._changeProtectedChild(m),
            m.visit(this);
            else break;
            for (; c < f; c++) e[c].visit(this);
            for (; g < k; g++) m = h[g],
            b._changeProtectedChild(m),
            m.visit(this);
            a ? b.postStencilVisit() : d && b.postScissorVisit();
            b._dirtyFlag = 0
        } else b._propagateFlagsDown(c)
    },
    setLoopFocus: function(a) {
        this._loopFocus = a
    },
    isLoopFocus: function() {
        return this._loopFocus
    },
    setPassFocusToChild: function(a) {
        this.__passFocusToChild = a
    },
    isPassFocusToChild: function() {
        return this.__passFocusToChild
    },
    findNextFocusedWidget: function(a, b) {
        if (this._isFocusPassing || this.isFocused()) {
            var c = this.getParent();
            this._isFocusPassing = !1;
            if (this.__passFocusToChild) {
                var d = this._passFocusToChild(a, b);
                return d instanceof ccui.Layout && c ? (c._isFocusPassing = !0, c.findNextFocusedWidget(a, this)) : d
            }
            if (null == c || !(c instanceof ccui.Layout)) return this;
            c._isFocusPassing = !0;
            return c.findNextFocusedWidget(a, this)
        }
        if (b.isFocused() || b instanceof ccui.Layout) if (this._layoutType === ccui.Layout.LINEAR_HORIZONTAL) switch (a) {
        case ccui.Widget.LEFT:
            return this._getPreviousFocusedWidget(a, b);
        case ccui.Widget.RIGHT:
            return this._getNextFocusedWidget(a, b);
        case ccui.Widget.DOWN:
        case ccui.Widget.UP:
            return this._isLastWidgetInContainer(this, a) ? this._isWidgetAncestorSupportLoopFocus(b, a) ? ccui.Widget.prototype.findNextFocusedWidget.call(this, a, this) : b: ccui.Widget.prototype.findNextFocusedWidget.call(this, a, this);
        default:
            return cc.assert(0, "Invalid Focus Direction"),
            b
        } else if (this._layoutType === ccui.Layout.LINEAR_VERTICAL) switch (a) {
        case ccui.Widget.LEFT:
        case ccui.Widget.RIGHT:
            return this._isLastWidgetInContainer(this, a) ? this._isWidgetAncestorSupportLoopFocus(b, a) ? ccui.Widget.prototype.findNextFocusedWidget.call(this, a, this) : b: ccui.Widget.prototype.findNextFocusedWidget.call(this, a, this);
        case ccui.Widget.DOWN:
            return this._getNextFocusedWidget(a, b);
        case ccui.Widget.UP:
            return this._getPreviousFocusedWidget(a, b);
        default:
            return cc.assert(0, "Invalid Focus Direction"),
            b
        } else return cc.assert(0, "Un Supported Layout type, please use VBox and HBox instead!!!"),
        b;
        else return b
    },
    onPassFocusToChild: null,
    addChild: function(a, b, c) {
        a instanceof ccui.Widget && this._supplyTheLayoutParameterLackToChild(a);
        ccui.Widget.prototype.addChild.call(this, a, b, c);
        this._doLayoutDirty = !0
    },
    removeChild: function(a, b) {
        ccui.Widget.prototype.removeChild.call(this, a, b);
        this._doLayoutDirty = !0
    },
    removeAllChildren: function(a) {
        ccui.Widget.prototype.removeAllChildren.call(this, a);
        this._doLayoutDirty = !0
    },
    removeAllChildrenWithCleanup: function(a) {
        ccui.Widget.prototype.removeAllChildrenWithCleanup.call(this, a);
        this._doLayoutDirty = !0
    },
    isClippingEnabled: function() {
        return this._clippingEnabled
    },
    setClippingEnabled: function(a) {
        if (a !== this._clippingEnabled) switch (this._clippingEnabled = a, this._clippingType) {
        case ccui.Layout.CLIPPING_SCISSOR:
        case ccui.Layout.CLIPPING_STENCIL:
            a ? (this._clippingStencil = new cc.DrawNode, this._renderCmd.rebindStencilRendering(this._clippingStencil), this._running && this._clippingStencil._performRecursive(cc.Node._stateCallbackType.onEnter), this._setStencilClippingSize(this._contentSize)) : (this._running && this._clippingStencil && this._clippingStencil._performRecursive(cc.Node._stateCallbackType.onExit), this._clippingStencil = null)
        }
    },
    setClippingType: function(a) {
        if (a !== this._clippingType) {
            var b = this.isClippingEnabled();
            this.setClippingEnabled(!1);
            this._clippingType = a;
            this.setClippingEnabled(b)
        }
    },
    getClippingType: function() {
        return this._clippingType
    },
    _setStencilClippingSize: function(a) {
        if (this._clippingEnabled) {
            var b = [];
            b[0] = cc.p(0, 0);
            b[1] = cc.p(a.width, 0);
            b[2] = cc.p(a.width, a.height);
            b[3] = cc.p(0, a.height);
            var c = cc.color.GREEN;
            this._clippingStencil.clear();
            this._clippingStencil.setLocalBB && this._clippingStencil.setLocalBB(0, 0, a.width, a.height);
            this._clippingStencil.drawPoly(b, 4, c, 0, c)
        }
    },
    _getClippingRect: function() {
        if (this._clippingRectDirty) {
            var a = this.convertToWorldSpace(cc.p(0, 0)),
            b = this.getNodeToWorldTransform(),
            c = this._contentSize.width * b.a,
            b = this._contentSize.height * b.d,
            d;
            for (d = this; d;) if ((d = d.getParent()) && d instanceof ccui.Layout && d.isClippingEnabled()) {
                this._clippingParent = d;
                break
            }
            this._clippingParent ? (d = this._clippingParent._getClippingRect(), this._clippingRect.x = Math.max(a.x, d.x), this._clippingRect.y = Math.max(a.y, d.y), c = Math.min(a.x + c, d.x + d.width), a = Math.min(a.y + b, d.y + d.height), this._clippingRect.width = Math.max(0, c - this._clippingRect.x), this._clippingRect.height = Math.max(0, a - this._clippingRect.y)) : (this._clippingRect.x = a.x, this._clippingRect.y = a.y, this._clippingRect.width = c, this._clippingRect.height = b);
            this._clippingRectDirty = !1
        }
        return this._clippingRect
    },
    _onSizeChanged: function() {
        ccui.Widget.prototype._onSizeChanged.call(this);
        var a = this._contentSize;
        this._setStencilClippingSize(a);
        this._clippingRectDirty = this._doLayoutDirty = !0;
        this._backGroundImage && (this._backGroundImage.setPosition(0.5 * a.width, 0.5 * a.height), this._backGroundScale9Enabled && this._backGroundImage instanceof ccui.Scale9Sprite && this._backGroundImage.setPreferredSize(a));
        this._colorRender && this._colorRender.setContentSize(a);
        this._gradientRender && this._gradientRender.setContentSize(a)
    },
    setBackGroundImageScale9Enabled: function(a) {
        this._backGroundScale9Enabled !== a && (this.removeProtectedChild(this._backGroundImage), this._backGroundImage = null, this._backGroundScale9Enabled = a, this._addBackGroundImage(), this.setBackGroundImage(this._backGroundImageFileName, this._bgImageTexType), this.setBackGroundImageCapInsets(this._backGroundImageCapInsets))
    },
    isBackGroundImageScale9Enabled: function() {
        return this._backGroundScale9Enabled
    },
    setBackGroundImage: function(a, b) {
        if (a) {
            b = b || ccui.Widget.LOCAL_TEXTURE;
            null === this._backGroundImage && (this._addBackGroundImage(), this.setBackGroundImageScale9Enabled(this._backGroundScale9Enabled));
            this._backGroundImageFileName = a;
            this._bgImageTexType = b;
            var c = this._backGroundImage;
            switch (this._bgImageTexType) {
            case ccui.Widget.LOCAL_TEXTURE:
                c.initWithFile(a);
                break;
            case ccui.Widget.PLIST_TEXTURE:
                c.initWithSpriteFrameName(a)
            }
            this._backGroundScale9Enabled && c.setPreferredSize(this._contentSize);
            this._backGroundImageTextureSize = c.getContentSize();
            c.setPosition(0.5 * this._contentSize.width, 0.5 * this._contentSize.height);
            this._updateBackGroundImageColor()
        }
    },
    setBackGroundImageCapInsets: function(a) {
        if (a) {
            var b = this._backGroundImageCapInsets;
            b.x = a.x;
            b.y = a.y;
            b.width = a.width;
            b.height = a.height;
            this._backGroundScale9Enabled && this._backGroundImage.setCapInsets(a)
        }
    },
    getBackGroundImageCapInsets: function() {
        return cc.rect(this._backGroundImageCapInsets)
    },
    _supplyTheLayoutParameterLackToChild: function(a) {
        if (a) switch (this._layoutType) {
        case ccui.Layout.LINEAR_HORIZONTAL:
        case ccui.Layout.LINEAR_VERTICAL:
            var b = a.getLayoutParameter(ccui.LayoutParameter.LINEAR);
            b || a.setLayoutParameter(new ccui.LinearLayoutParameter);
            break;
        case ccui.Layout.RELATIVE:
            (b = a.getLayoutParameter(ccui.LayoutParameter.RELATIVE)) || a.setLayoutParameter(new ccui.RelativeLayoutParameter)
        }
    },
    _addBackGroundImage: function() {
        var a = this._contentSize;
        this._backGroundScale9Enabled ? (this._backGroundImage = new ccui.Scale9Sprite, this._backGroundImage.setPreferredSize(a)) : this._backGroundImage = new cc.Sprite;
        this.addProtectedChild(this._backGroundImage, ccui.Layout.BACKGROUND_IMAGE_ZORDER, -1);
        this._backGroundImage.setPosition(0.5 * a.width, 0.5 * a.height)
    },
    removeBackGroundImage: function() {
        this._backGroundImage && (this.removeProtectedChild(this._backGroundImage), this._backGroundImage = null, this._backGroundImageFileName = "", this._backGroundImageTextureSize.width = 0, this._backGroundImageTextureSize.height = 0)
    },
    setBackGroundColorType: function(a) {
        if (this._colorType !== a) {
            switch (this._colorType) {
            case ccui.Layout.BG_COLOR_NONE:
                this._colorRender && (this.removeProtectedChild(this._colorRender), this._colorRender = null);
                this._gradientRender && (this.removeProtectedChild(this._gradientRender), this._gradientRender = null);
                break;
            case ccui.Layout.BG_COLOR_SOLID:
                this._colorRender && (this.removeProtectedChild(this._colorRender), this._colorRender = null);
                break;
            case ccui.Layout.BG_COLOR_GRADIENT:
                this._gradientRender && (this.removeProtectedChild(this._gradientRender), this._gradientRender = null)
            }
            this._colorType = a;
            switch (this._colorType) {
            case ccui.Layout.BG_COLOR_SOLID:
                this._colorRender = new cc.LayerColor;
                this._colorRender.setContentSize(this._contentSize);
                this._colorRender.setOpacity(this._opacity);
                this._colorRender.setColor(this._color);
                this.addProtectedChild(this._colorRender, ccui.Layout.BACKGROUND_RENDERER_ZORDER, -1);
                break;
            case ccui.Layout.BG_COLOR_GRADIENT:
                this._gradientRender = new cc.LayerGradient(cc.color(255, 0, 0, 255), cc.color(0, 255, 0, 255)),
                this._gradientRender.setContentSize(this._contentSize),
                this._gradientRender.setOpacity(this._opacity),
                this._gradientRender.setStartColor(this._startColor),
                this._gradientRender.setEndColor(this._endColor),
                this._gradientRender.setVector(this._alongVector),
                this.addProtectedChild(this._gradientRender, ccui.Layout.BACKGROUND_RENDERER_ZORDER, -1)
            }
        }
    },
    getBackGroundColorType: function() {
        return this._colorType
    },
    setBackGroundColor: function(a, b) {
        b ? (this._startColor.r = a.r, this._startColor.g = a.g, this._startColor.b = a.b, this._gradientRender && this._gradientRender.setStartColor(a), this._endColor.r = b.r, this._endColor.g = b.g, this._endColor.b = b.b, this._gradientRender && this._gradientRender.setEndColor(b)) : (this._color.r = a.r, this._color.g = a.g, this._color.b = a.b, this._colorRender && this._colorRender.setColor(a))
    },
    getBackGroundColor: function() {
        var a = this._color;
        return cc.color(a.r, a.g, a.b, a.a)
    },
    getBackGroundStartColor: function() {
        var a = this._startColor;
        return cc.color(a.r, a.g, a.b, a.a)
    },
    getBackGroundEndColor: function() {
        var a = this._endColor;
        return cc.color(a.r, a.g, a.b, a.a)
    },
    setBackGroundColorOpacity: function(a) {
        this._opacity = a;
        switch (this._colorType) {
        case ccui.Layout.BG_COLOR_SOLID:
            this._colorRender.setOpacity(a);
            break;
        case ccui.Layout.BG_COLOR_GRADIENT:
            this._gradientRender.setOpacity(a)
        }
    },
    getBackGroundColorOpacity: function() {
        return this._opacity
    },
    setBackGroundColorVector: function(a) {
        this._alongVector.x = a.x;
        this._alongVector.y = a.y;
        this._gradientRender && this._gradientRender.setVector(a)
    },
    getBackGroundColorVector: function() {
        return this._alongVector
    },
    setBackGroundImageColor: function(a) {
        this._backGroundImageColor.r = a.r;
        this._backGroundImageColor.g = a.g;
        this._backGroundImageColor.b = a.b;
        this._updateBackGroundImageColor()
    },
    setBackGroundImageOpacity: function(a) {
        this._backGroundImageColor.a = a;
        this.getBackGroundImageColor()
    },
    getBackGroundImageColor: function() {
        var a = this._backGroundImageColor;
        return cc.color(a.r, a.g, a.b, a.a)
    },
    getBackGroundImageOpacity: function() {
        return this._backGroundImageColor.a
    },
    _updateBackGroundImageColor: function() {
        this._backGroundImage && this._backGroundImage.setColor(this._backGroundImageColor)
    },
    getBackGroundImageTextureSize: function() {
        return this._backGroundImageTextureSize
    },
    setLayoutType: function(a) {
        this._layoutType = a;
        a = this._children;
        for (var b = null,
        c = 0; c < a.length; c++) b = a[c],
        b instanceof ccui.Widget && this._supplyTheLayoutParameterLackToChild(b);
        this._doLayoutDirty = !0
    },
    getLayoutType: function() {
        return this._layoutType
    },
    requestDoLayout: function() {
        this._doLayoutDirty = !0
    },
    _doLayout: function() {
        if (this._doLayoutDirty) {
            this.sortAllChildren();
            var a = ccui.getLayoutManager(this._layoutType);
            a && a._doLayout(this);
            this._doLayoutDirty = !1
        }
    },
    _getLayoutContentSize: function() {
        return this.getContentSize()
    },
    _getLayoutElements: function() {
        return this.getChildren()
    },
    _updateBackGroundImageOpacity: function() {
        this._backGroundImage && this._backGroundImage.setOpacity(this._backGroundImageOpacity)
    },
    _updateBackGroundImageRGBA: function() {
        this._backGroundImage && (this._backGroundImage.setColor(this._backGroundImageColor), this._backGroundImage.setOpacity(this._backGroundImageOpacity))
    },
    _getLayoutAccumulatedSize: function() {
        for (var a = this.getChildren(), b = cc.size(0, 0), c = 0, d, e = 0, f = a.length; e < f; e++) if (d = a[e], null !== d && d instanceof ccui.Layout) d = d._getLayoutAccumulatedSize(),
        b.width += d.width,
        b.height += d.height;
        else if (d instanceof ccui.Widget) {
            c++;
            var g = d.getLayoutParameter().getMargin();
            d = d.getContentSize();
            b.width += d.width + 0.5 * (g.right + g.left);
            b.height += d.height + 0.5 * (g.top + g.bottom)
        }
        a = this.getLayoutType();
        a === ccui.Layout.LINEAR_HORIZONTAL && (b.height -= b.height / c * (c - 1));
        a === ccui.Layout.LINEAR_VERTICAL && (b.width -= b.width / c * (c - 1));
        return b
    },
    _findNearestChildWidgetIndex: function(a, b) {
        if (null == b || b === this) return this._findFirstFocusEnabledWidgetIndex();
        var c = 0,
        d = this.getChildren(),
        e = d.length,
        f,
        g = cc.FLT_MAX,
        h = 0;
        if (a === ccui.Widget.LEFT || a === ccui.Widget.RIGHT || a === ccui.Widget.DOWN || a === ccui.Widget.UP) {
            for (f = this._getWorldCenterPoint(b); c < e;) {
                var k = d[c];
                k && k instanceof ccui.Widget && k.isFocusEnabled() && (k = k instanceof ccui.Layout ? k._calculateNearestDistance(b) : cc.pLength(cc.pSub(this._getWorldCenterPoint(k), f)), k < g && (h = c, g = k));
                c++
            }
            return h
        }
        cc.log("invalid focus direction!");
        return 0
    },
    _findFarthestChildWidgetIndex: function(a, b) {
        if (null == b || b === this) return this._findFirstFocusEnabledWidgetIndex();
        var c = 0,
        d = this.getChildren(),
        e = d.length,
        f = -cc.FLT_MAX,
        g = 0;
        if (a === ccui.Widget.LEFT || a === ccui.Widget.RIGHT || a === ccui.Widget.DOWN || a === ccui.Widget.UP) {
            for (var h = this._getWorldCenterPoint(b); c < e;) {
                var k = d[c];
                k && k instanceof ccui.Widget && k.isFocusEnabled() && (k = k instanceof ccui.Layout ? k._calculateFarthestDistance(b) : cc.pLength(cc.pSub(this._getWorldCenterPoint(k), h)), k > f && (g = c, f = k));
                c++
            }
            return g
        }
        cc.log("invalid focus direction!!!");
        return 0
    },
    _calculateNearestDistance: function(a) {
        for (var b = cc.FLT_MAX,
        c = this._getWorldCenterPoint(a), d = this._children, e = 0, f = d.length; e < f; e++) {
            var g = d[e];
            if (g instanceof ccui.Layout) g = g._calculateNearestDistance(a);
            else if (g instanceof ccui.Widget && g.isFocusEnabled()) g = cc.pLength(cc.pSub(this._getWorldCenterPoint(g), c));
            else continue;
            g < b && (b = g)
        }
        return b
    },
    _calculateFarthestDistance: function(a) {
        for (var b = -cc.FLT_MAX,
        c = this._getWorldCenterPoint(a), d = this._children, e = 0, f = d.length; e < f; e++) {
            var g = d[e];
            if (g instanceof ccui.Layout) g = g._calculateFarthestDistance(a);
            else if (g instanceof ccui.Widget && g.isFocusEnabled()) g = this._getWorldCenterPoint(g),
            g = cc.pLength(cc.pSub(g, c));
            else continue;
            g > b && (b = g)
        }
        return b
    },
    _findProperSearchingFunctor: function(a, b) {
        if (void 0 !== b) {
            var c = this._getWorldCenterPoint(b),
            d = this._getWorldCenterPoint(this._findFirstNonLayoutWidget());
            a === ccui.Widget.LEFT ? this.onPassFocusToChild = c.x > d.x ? this._findNearestChildWidgetIndex: this._findFarthestChildWidgetIndex: a === ccui.Widget.RIGHT ? this.onPassFocusToChild = c.x > d.x ? this._findFarthestChildWidgetIndex: this._findNearestChildWidgetIndex: a === ccui.Widget.DOWN ? this.onPassFocusToChild = c.y > d.y ? this._findNearestChildWidgetIndex: this._findFarthestChildWidgetIndex: a === ccui.Widget.UP ? this.onPassFocusToChild = c.y < d.y ? this._findNearestChildWidgetIndex: this._findFarthestChildWidgetIndex: cc.log("invalid direction!")
        }
    },
    _findFirstNonLayoutWidget: function() {
        for (var a = this._children,
        b = 0,
        c = a.length; b < c; b++) {
            var d = a[b];
            if (d instanceof ccui.Layout) {
                if (d = d._findFirstNonLayoutWidget()) return d
            } else if (d instanceof ccui.Widget) return d
        }
        return null
    },
    _findFirstFocusEnabledWidgetIndex: function() {
        for (var a = 0,
        b = this.getChildren(), c = b.length; a < c;) {
            var d = b[a];
            if (d && d instanceof ccui.Widget && d.isFocusEnabled()) return a;
            a++
        }
        return 0
    },
    _findFocusEnabledChildWidgetByIndex: function(a) {
        var b = this._getChildWidgetByIndex(a);
        return b ? b.isFocusEnabled() ? b: this._findFocusEnabledChildWidgetByIndex(a + 1) : null
    },
    _getWorldCenterPoint: function(a) {
        var b = a instanceof ccui.Layout ? a._getLayoutAccumulatedSize() : a.getContentSize();
        return a.convertToWorldSpace(cc.p(b.width / 2, b.height / 2))
    },
    _getNextFocusedWidget: function(a, b) {
        var c = null,
        c = this._children,
        d = c.indexOf(b),
        d = d + 1;
        if (d < c.length) {
            if (c = this._getChildWidgetByIndex(d)) {
                if (c.isFocusEnabled()) {
                    if (c instanceof ccui.Layout) return c._isFocusPassing = !0,
                    c.findNextFocusedWidget(a, c);
                    this.dispatchFocusEvent(b, c);
                    return c
                }
                return this._getNextFocusedWidget(a, c)
            }
            return b
        }
        if (this._loopFocus) {
            if (this._checkFocusEnabledChild()) {
                c = this._getChildWidgetByIndex(0);
                if (c.isFocusEnabled()) {
                    if (c instanceof ccui.Layout) return c._isFocusPassing = !0,
                    c.findNextFocusedWidget(a, c);
                    this.dispatchFocusEvent(b, c);
                    return c
                }
                return this._getNextFocusedWidget(a, c)
            }
            return b instanceof ccui.Layout ? b: ccui.Widget._focusedWidget
        }
        return this._isLastWidgetInContainer(b, a) ? this._isWidgetAncestorSupportLoopFocus(this, a) ? ccui.Widget.prototype.findNextFocusedWidget.call(this, a, this) : b instanceof ccui.Layout ? b: ccui.Widget._focusedWidget: ccui.Widget.prototype.findNextFocusedWidget.call(this, a, this)
    },
    _getPreviousFocusedWidget: function(a, b) {
        var c = null,
        c = this._children,
        d = c.indexOf(b),
        d = d - 1;
        if (0 <= d) {
            c = this._getChildWidgetByIndex(d);
            if (c.isFocusEnabled()) {
                if (c instanceof ccui.Layout) return c._isFocusPassing = !0,
                c.findNextFocusedWidget(a, c);
                this.dispatchFocusEvent(b, c);
                return c
            }
            return this._getPreviousFocusedWidget(a, c)
        }
        if (this._loopFocus) {
            if (this._checkFocusEnabledChild()) {
                d = c.length - 1;
                c = this._getChildWidgetByIndex(d);
                if (c.isFocusEnabled()) {
                    if (c instanceof ccui.Layout) return c._isFocusPassing = !0,
                    c.findNextFocusedWidget(a, c);
                    this.dispatchFocusEvent(b, c);
                    return c
                }
                return this._getPreviousFocusedWidget(a, c)
            }
            return b instanceof ccui.Layout ? b: ccui.Widget._focusedWidget
        }
        return this._isLastWidgetInContainer(b, a) ? this._isWidgetAncestorSupportLoopFocus(this, a) ? ccui.Widget.prototype.findNextFocusedWidget.call(this, a, this) : b instanceof ccui.Layout ? b: ccui.Widget._focusedWidget: ccui.Widget.prototype.findNextFocusedWidget.call(this, a, this)
    },
    _getChildWidgetByIndex: function(a) {
        for (var b = this._children,
        c = b.length,
        d = 0,
        e = a; a < c;) {
            var f = b[a];
            if (f && f instanceof ccui.Widget) return f;
            d++;
            a++
        }
        for (a = 0; a < e;) {
            if ((c = b[a]) && c instanceof ccui.Widget) return c;
            d++;
            a++
        }
        return null
    },
    _isLastWidgetInContainer: function(a, b) {
        var c = a.getParent();
        if (null == c || !(c instanceof ccui.Layout)) return ! 0;
        var d = c.getChildren(),
        e = d.indexOf(a);
        if (c.getLayoutType() === ccui.Layout.LINEAR_HORIZONTAL) {
            if (b === ccui.Widget.LEFT) return 0 === e ? this._isLastWidgetInContainer(c, b) : !1;
            if (b === ccui.Widget.RIGHT) return e === d.length - 1 ? this._isLastWidgetInContainer(c, b) : !1;
            if (b === ccui.Widget.DOWN || b === ccui.Widget.UP) return this._isLastWidgetInContainer(c, b)
        } else if (c.getLayoutType() === ccui.Layout.LINEAR_VERTICAL) {
            if (b === ccui.Widget.UP) return 0 === e ? this._isLastWidgetInContainer(c, b) : !1;
            if (b === ccui.Widget.DOWN) return e === d.length - 1 ? this._isLastWidgetInContainer(c, b) : !1;
            if (b === ccui.Widget.LEFT || b === ccui.Widget.RIGHT) return this._isLastWidgetInContainer(c, b)
        } else return cc.log("invalid layout Type"),
        !1
    },
    _isWidgetAncestorSupportLoopFocus: function(a, b) {
        var c = a.getParent();
        if (null == c || !(c instanceof ccui.Layout)) return ! 1;
        if (c.isLoopFocus()) {
            var d = c.getLayoutType();
            if (d === ccui.Layout.LINEAR_HORIZONTAL) return b === ccui.Widget.LEFT || b === ccui.Widget.RIGHT ? !0 : this._isWidgetAncestorSupportLoopFocus(c, b);
            if (d === ccui.Layout.LINEAR_VERTICAL) return b === ccui.Widget.DOWN || b === ccui.Widget.UP ? !0 : this._isWidgetAncestorSupportLoopFocus(c, b);
            cc.assert(0, "invalid layout type");
            return ! 1
        }
        return this._isWidgetAncestorSupportLoopFocus(c, b)
    },
    _passFocusToChild: function(a, b) {
        if (this._checkFocusEnabledChild()) {
            var c = ccui.Widget.getCurrentFocusedWidget();
            this._findProperSearchingFunctor(a, c);
            c = this.onPassFocusToChild(a, c);
            c = this._getChildWidgetByIndex(c);
            if (c instanceof ccui.Layout) return c._isFocusPassing = !0,
            c.findNextFocusedWidget(a, c);
            this.dispatchFocusEvent(b, c);
            return c
        }
        return this
    },
    _checkFocusEnabledChild: function() {
        for (var a = this._children,
        b = 0,
        c = a.length; b < c; b++) {
            var d = a[b];
            if (d && d instanceof ccui.Widget && d.isFocusEnabled()) return ! 0
        }
        return ! 1
    },
    getDescription: function() {
        return "Layout"
    },
    _createCloneInstance: function() {
        return new ccui.Layout
    },
    _copyClonedWidgetChildren: function(a) {
        ccui.Widget.prototype._copyClonedWidgetChildren.call(this, a)
    },
    _copySpecialProperties: function(a) {
        a instanceof ccui.Layout && (this.setBackGroundImageScale9Enabled(a._backGroundScale9Enabled), this.setBackGroundImage(a._backGroundImageFileName, a._bgImageTexType), this.setBackGroundImageCapInsets(a._backGroundImageCapInsets), this.setBackGroundColorType(a._colorType), this.setBackGroundColor(a._color), this.setBackGroundColor(a._startColor, a._endColor), this.setBackGroundColorOpacity(a._opacity), this.setBackGroundColorVector(a._alongVector), this.setLayoutType(a._layoutType), this.setClippingEnabled(a._clippingEnabled), this.setClippingType(a._clippingType), this._loopFocus = a._loopFocus, this.__passFocusToChild = a.__passFocusToChild, this._isInterceptTouch = a._isInterceptTouch)
    },
    forceDoLayout: function() {
        this.requestDoLayout();
        this._doLayout()
    },
    _createRenderCmd: function() {
        return cc._renderType === cc.game.RENDER_TYPE_WEBGL ? new ccui.Layout.WebGLRenderCmd(this) : new ccui.Layout.CanvasRenderCmd(this)
    }
});
_p = ccui.Layout.prototype;
cc.defineGetterSetter(_p, "clippingEnabled", _p.isClippingEnabled, _p.setClippingEnabled);
cc.defineGetterSetter(_p, "clippingType", null, _p.setClippingType);
cc.defineGetterSetter(_p, "layoutType", _p.getLayoutType, _p.setLayoutType);
_p = null;
ccui.Layout.create = function() {
    return new ccui.Layout
};
ccui.Layout.BG_COLOR_NONE = 0;
ccui.Layout.BG_COLOR_SOLID = 1;
ccui.Layout.BG_COLOR_GRADIENT = 2;
ccui.Layout.ABSOLUTE = 0;
ccui.Layout.LINEAR_VERTICAL = 1;
ccui.Layout.LINEAR_HORIZONTAL = 2;
ccui.Layout.RELATIVE = 3;
ccui.Layout.CLIPPING_STENCIL = 0;
ccui.Layout.CLIPPING_SCISSOR = 1;
ccui.Layout.BACKGROUND_IMAGE_ZORDER = -1;
ccui.Layout.BACKGROUND_RENDERER_ZORDER = -2; (function() {
    ccui.Layout.CanvasRenderCmd = function(a) {
        this._pNodeCmdCtor(a);
        this._needDraw = !1;
        this._rendererRestoreCmd = this._rendererClipCmd = this._rendererSaveCmd = null
    };
    var a = ccui.Layout.CanvasRenderCmd.prototype = Object.create(ccui.ProtectedNode.CanvasRenderCmd.prototype);
    a.constructor = ccui.Layout.CanvasRenderCmd;
    a._layoutCmdCtor = ccui.Layout.CanvasRenderCmd;
    a._onRenderSaveCmd = function(a, c, d) {
        var e = a || cc._renderContext;
        a = e.getContext();
        e.save();
        e.save();
        e.setTransform(this._worldTransform, c, d);
        c = this._node._clippingStencil._renderCmd._buffer;
        d = 0;
        for (e = c.length; d < e; d++) {
            var f = c[d].verts,
            g = f[0];
            a.beginPath();
            a.moveTo(g.x, -g.y);
            for (var g = 1,
            h = f.length; g < h; g++) a.lineTo(f[g].x, -f[g].y);
            a.closePath()
        }
    };
    a._onRenderClipCmd = function(a) {
        a = a || cc._renderContext;
        var c = a.getContext();
        a.restore();
        c.clip()
    };
    a._onRenderRestoreCmd = function(a) {
        a = a || cc._renderContext;
        a.getContext();
        a.restore()
    };
    a.rebindStencilRendering = function(a) {
        a._renderCmd.rendering = this.__stencilDraw;
        a._renderCmd._canUseDirtyRegion = !0
    };
    a.__stencilDraw = function(a, c, d) {};
    a.stencilClippingVisit = a.scissorClippingVisit = function(a) {
        a = this._node;
        a._clippingStencil && a._clippingStencil.isVisible() && (this._rendererSaveCmd || (this._rendererSaveCmd = new cc.CustomRenderCmd(this, this._onRenderSaveCmd), this._rendererClipCmd = new cc.CustomRenderCmd(this, this._onRenderClipCmd), this._rendererRestoreCmd = new cc.CustomRenderCmd(this, this._onRenderRestoreCmd)), cc.renderer.pushRenderCommand(this._rendererSaveCmd), a._clippingStencil.visit(this), cc.renderer.pushRenderCommand(this._rendererClipCmd))
    };
    a.postStencilVisit = a.postScissorVisit = function() {
        cc.renderer.pushRenderCommand(this._rendererRestoreCmd)
    };
    ccui.Layout.CanvasRenderCmd._getSharedCache = function() {
        return cc.ClippingNode._sharedCache || (cc.ClippingNode._sharedCache = document.createElement("canvas"))
    }
})(); (function() {
    if (ccui.ProtectedNode.WebGLRenderCmd) {
        ccui.Layout.WebGLRenderCmd = function(a) {
            this._pNodeCmdCtor(a);
            this._needDraw = !1;
            this._currentStencilEnabled = 0;
            this._scissorOldState = !1;
            this._clippingOldRect = null;
            this._mask_layer_le = 0;
            this._afterVisitCmdScissor = this._beforeVisitCmdScissor = this._afterVisitCmdStencil = this._afterDrawStencilCmd = this._beforeVisitCmdStencil = null
        };
        var a = ccui.Layout.WebGLRenderCmd.prototype = Object.create(ccui.ProtectedNode.WebGLRenderCmd.prototype);
        a.constructor = ccui.Layout.WebGLRenderCmd;
        a._layoutCmdCtor = ccui.Layout.CanvasRenderCmd;
        a._syncStatus = function(a) {
            this._originSyncStatus(a);
            a && a._dirtyFlag & cc.Node._dirtyFlags.transformDirty && (this._node._clippingRectDirty = !0)
        };
        a._onBeforeVisitStencil = function(a) {
            a = a || cc._renderContext;
            ccui.Layout.WebGLRenderCmd._layer++;
            var c = 1 << ccui.Layout.WebGLRenderCmd._layer;
            this._mask_layer_le = c | c - 1;
            this._currentStencilEnabled = a.isEnabled(a.STENCIL_TEST);
            a.clear(a.DEPTH_BUFFER_BIT);
            a.enable(a.STENCIL_TEST);
            a.depthMask(!1);
            a.stencilFunc(a.NEVER, c, c);
            a.stencilOp(a.REPLACE, a.KEEP, a.KEEP);
            a.stencilMask(c);
            a.clear(a.STENCIL_BUFFER_BIT)
        };
        a._onAfterDrawStencil = function(a) {
            a = a || cc._renderContext;
            a.depthMask(!0);
            a.stencilFunc(a.EQUAL, this._mask_layer_le, this._mask_layer_le);
            a.stencilOp(a.KEEP, a.KEEP, a.KEEP)
        };
        a._onAfterVisitStencil = function(a) {
            a = a || cc._renderContext;
            ccui.Layout.WebGLRenderCmd._layer--;
            if (this._currentStencilEnabled) {
                var c = 1 << ccui.Layout.WebGLRenderCmd._layer,
                d = c | c - 1;
                a.stencilMask(c);
                a.stencilFunc(a.EQUAL, d, d)
            } else a.disable(a.STENCIL_TEST)
        };
        a._onBeforeVisitScissor = function(a) {
            this._node._clippingRectDirty = !0;
            var c = this._node._getClippingRect();
            a = a || cc._renderContext; (this._scissorOldState = a.isEnabled(a.SCISSOR_TEST)) ? (this._clippingOldRect = cc.view.getScissorRect(), cc.rectEqualToRect(this._clippingOldRect, c) || cc.view.setScissorInPoints(c.x, c.y, c.width, c.height)) : (a.enable(a.SCISSOR_TEST), cc.view.setScissorInPoints(c.x, c.y, c.width, c.height))
        };
        a._onAfterVisitScissor = function(a) {
            a = a || cc._renderContext;
            this._scissorOldState ? cc.rectEqualToRect(this._clippingOldRect, this._node._clippingRect) || cc.view.setScissorInPoints(this._clippingOldRect.x, this._clippingOldRect.y, this._clippingOldRect.width, this._clippingOldRect.height) : a.disable(a.SCISSOR_TEST)
        };
        a.rebindStencilRendering = function(a) {};
        a.transform = function(a, c) {
            var d = this._node;
            this.pNodeTransform(a, c);
            d._clippingStencil && d._clippingStencil._renderCmd.transform(this, c)
        };
        a.stencilClippingVisit = function(a) {
            a = this._node;
            if (a._clippingStencil && a._clippingStencil.isVisible()) if (ccui.Layout.WebGLRenderCmd._layer + 1 === cc.stencilBits) ccui.Layout.WebGLRenderCmd._visit_once = !0,
            ccui.Layout.WebGLRenderCmd._visit_once && (cc.log("Nesting more than " + cc.stencilBits + "stencils is not supported. Everything will be drawn without stencil for this node and its childs."), ccui.Layout.WebGLRenderCmd._visit_once = !1);
            else {
                this._beforeVisitCmdStencil || (this._beforeVisitCmdStencil = new cc.CustomRenderCmd(this, this._onBeforeVisitStencil), this._afterDrawStencilCmd = new cc.CustomRenderCmd(this, this._onAfterDrawStencil), this._afterVisitCmdStencil = new cc.CustomRenderCmd(this, this._onAfterVisitStencil));
                cc.renderer.pushRenderCommand(this._beforeVisitCmdStencil);
                var c = cc.current_stack;
                c.stack.push(c.top);
                c.top = this._stackMatrix;
                a._clippingStencil.visit(this);
                cc.renderer.pushRenderCommand(this._afterDrawStencilCmd)
            }
        };
        a.postStencilVisit = function() {
            renderer.pushRenderCommand(cmd._afterVisitCmdStencil);
            cc.current_stack.top = cc.current_stack.stack.pop()
        };
        a.scissorClippingVisit = function(a) {
            this._beforeVisitCmdScissor || (this._beforeVisitCmdScissor = new cc.CustomRenderCmd(this, this._onBeforeVisitScissor), this._afterVisitCmdScissor = new cc.CustomRenderCmd(this, this._onAfterVisitScissor));
            cc.renderer.pushRenderCommand(this._beforeVisitCmdScissor)
        };
        a.postScissorVisit = function() {
            cc.renderer.pushRenderCommand(this._afterVisitCmdScissor)
        };
        ccui.Layout.WebGLRenderCmd._layer = -1;
        ccui.Layout.WebGLRenderCmd._visit_once = null
    }
})();
ccui.Margin = ccui.Class.extend({
    left: 0,
    top: 0,
    right: 0,
    bottom: 0,
    ctor: function(a, b, c, d) {
        void 0 !== a && void 0 === b && (this.left = a.left, this.top = a.top, this.right = a.right, this.bottom = a.bottom);
        void 0 !== d && (this.left = a, this.top = b, this.right = c, this.bottom = d)
    },
    setMargin: function(a, b, c, d) {
        this.left = a;
        this.top = b;
        this.right = c;
        this.bottom = d
    },
    equals: function(a) {
        return this.left === a.left && this.top === a.top && this.right === a.right && this.bottom === a.bottom
    }
});
ccui.MarginZero = function() {
    return new ccui.Margin(0, 0, 0, 0)
};
ccui.LayoutParameter = ccui.Class.extend({
    _margin: null,
    _layoutParameterType: null,
    ctor: function() {
        this._margin = new ccui.Margin;
        this._layoutParameterType = ccui.LayoutParameter.NONE
    },
    setMargin: function(a, b, c, d) {
        cc.isObject(a) ? (this._margin.left = a.left, this._margin.top = a.top, this._margin.right = a.right, this._margin.bottom = a.bottom) : (this._margin.left = a, this._margin.top = b, this._margin.right = c, this._margin.bottom = d)
    },
    getMargin: function() {
        return this._margin
    },
    getLayoutType: function() {
        return this._layoutParameterType
    },
    clone: function() {
        var a = this._createCloneInstance();
        a._copyProperties(this);
        return a
    },
    _createCloneInstance: function() {
        return new ccui.LayoutParameter
    },
    _copyProperties: function(a) {
        this._margin.bottom = a._margin.bottom;
        this._margin.left = a._margin.left;
        this._margin.right = a._margin.right;
        this._margin.top = a._margin.top
    }
});
ccui.LayoutParameter.create = function() {
    return new ccui.LayoutParameter
};
ccui.LayoutParameter.NONE = 0;
ccui.LayoutParameter.LINEAR = 1;
ccui.LayoutParameter.RELATIVE = 2;
ccui.LinearLayoutParameter = ccui.LayoutParameter.extend({
    _linearGravity: null,
    ctor: function() {
        ccui.LayoutParameter.prototype.ctor.call(this);
        this._linearGravity = ccui.LinearLayoutParameter.NONE;
        this._layoutParameterType = ccui.LayoutParameter.LINEAR
    },
    setGravity: function(a) {
        this._linearGravity = a
    },
    getGravity: function() {
        return this._linearGravity
    },
    _createCloneInstance: function() {
        return new ccui.LinearLayoutParameter
    },
    _copyProperties: function(a) {
        ccui.LayoutParameter.prototype._copyProperties.call(this, a);
        a instanceof ccui.LinearLayoutParameter && this.setGravity(a._linearGravity)
    }
});
ccui.LinearLayoutParameter.create = function() {
    return new ccui.LinearLayoutParameter
};
ccui.LinearLayoutParameter.NONE = 0;
ccui.LinearLayoutParameter.LEFT = 1;
ccui.LinearLayoutParameter.TOP = 2;
ccui.LinearLayoutParameter.RIGHT = 3;
ccui.LinearLayoutParameter.BOTTOM = 4;
ccui.LinearLayoutParameter.CENTER_VERTICAL = 5;
ccui.LinearLayoutParameter.CENTER_HORIZONTAL = 6;
ccui.RelativeLayoutParameter = ccui.LayoutParameter.extend({
    _relativeAlign: null,
    _relativeWidgetName: "",
    _relativeLayoutName: "",
    _put: !1,
    ctor: function() {
        ccui.LayoutParameter.prototype.ctor.call(this);
        this._relativeAlign = ccui.RelativeLayoutParameter.NONE;
        this._relativeLayoutName = this._relativeWidgetName = "";
        this._put = !1;
        this._layoutParameterType = ccui.LayoutParameter.RELATIVE
    },
    setAlign: function(a) {
        this._relativeAlign = a
    },
    getAlign: function() {
        return this._relativeAlign
    },
    setRelativeToWidgetName: function(a) {
        this._relativeWidgetName = a
    },
    getRelativeToWidgetName: function() {
        return this._relativeWidgetName
    },
    setRelativeName: function(a) {
        this._relativeLayoutName = a
    },
    getRelativeName: function() {
        return this._relativeLayoutName
    },
    _createCloneInstance: function() {
        return new ccui.RelativeLayoutParameter
    },
    _copyProperties: function(a) {
        ccui.LayoutParameter.prototype._copyProperties.call(this, a);
        a instanceof ccui.RelativeLayoutParameter && (this.setAlign(a._relativeAlign), this.setRelativeToWidgetName(a._relativeWidgetName), this.setRelativeName(a._relativeLayoutName))
    }
});
ccui.RelativeLayoutParameter.create = function() {
    return new ccui.RelativeLayoutParameter
};
ccui.RelativeLayoutParameter.NONE = 0;
ccui.RelativeLayoutParameter.PARENT_TOP_LEFT = 1;
ccui.RelativeLayoutParameter.PARENT_TOP_CENTER_HORIZONTAL = 2;
ccui.RelativeLayoutParameter.PARENT_TOP_RIGHT = 3;
ccui.RelativeLayoutParameter.PARENT_LEFT_CENTER_VERTICAL = 4;
ccui.RelativeLayoutParameter.CENTER_IN_PARENT = 5;
ccui.RelativeLayoutParameter.PARENT_RIGHT_CENTER_VERTICAL = 6;
ccui.RelativeLayoutParameter.PARENT_LEFT_BOTTOM = 7;
ccui.RelativeLayoutParameter.PARENT_BOTTOM_CENTER_HORIZONTAL = 8;
ccui.RelativeLayoutParameter.PARENT_RIGHT_BOTTOM = 9;
ccui.RelativeLayoutParameter.LOCATION_ABOVE_LEFTALIGN = 10;
ccui.RelativeLayoutParameter.LOCATION_ABOVE_CENTER = 11;
ccui.RelativeLayoutParameter.LOCATION_ABOVE_RIGHTALIGN = 12;
ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_TOPALIGN = 13;
ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_CENTER = 14;
ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_BOTTOMALIGN = 15;
ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_TOPALIGN = 16;
ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_CENTER = 17;
ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_BOTTOMALIGN = 18;
ccui.RelativeLayoutParameter.LOCATION_BELOW_LEFTALIGN = 19;
ccui.RelativeLayoutParameter.LOCATION_BELOW_CENTER = 20;
ccui.RelativeLayoutParameter.LOCATION_BELOW_RIGHTALIGN = 21;
ccui.LINEAR_GRAVITY_NONE = 0;
ccui.LINEAR_GRAVITY_LEFT = 1;
ccui.LINEAR_GRAVITY_TOP = 2;
ccui.LINEAR_GRAVITY_RIGHT = 3;
ccui.LINEAR_GRAVITY_BOTTOM = 4;
ccui.LINEAR_GRAVITY_CENTER_VERTICAL = 5;
ccui.LINEAR_GRAVITY_CENTER_HORIZONTAL = 6;
ccui.RELATIVE_ALIGN_NONE = 0;
ccui.RELATIVE_ALIGN_PARENT_TOP_LEFT = 1;
ccui.RELATIVE_ALIGN_PARENT_TOP_CENTER_HORIZONTAL = 2;
ccui.RELATIVE_ALIGN_PARENT_TOP_RIGHT = 3;
ccui.RELATIVE_ALIGN_PARENT_LEFT_CENTER_VERTICAL = 4;
ccui.RELATIVE_ALIGN_PARENT_CENTER = 5;
ccui.RELATIVE_ALIGN_PARENT_RIGHT_CENTER_VERTICAL = 6;
ccui.RELATIVE_ALIGN_PARENT_LEFT_BOTTOM = 7;
ccui.RELATIVE_ALIGN_PARENT_BOTTOM_CENTER_HORIZONTAL = 8;
ccui.RELATIVE_ALIGN_PARENT_RIGHT_BOTTOM = 9;
ccui.RELATIVE_ALIGN_LOCATION_ABOVE_LEFT = 10;
ccui.RELATIVE_ALIGN_LOCATION_ABOVE_CENTER = 11;
ccui.RELATIVE_ALIGN_LOCATION_ABOVE_RIGHT = 12;
ccui.RELATIVE_ALIGN_LOCATION_LEFT_TOP = 13;
ccui.RELATIVE_ALIGN_LOCATION_LEFT_CENTER = 14;
ccui.RELATIVE_ALIGN_LOCATION_LEFT_BOTTOM = 15;
ccui.RELATIVE_ALIGN_LOCATION_RIGHT_TOP = 16;
ccui.RELATIVE_ALIGN_LOCATION_RIGHT_CENTER = 17;
ccui.RELATIVE_ALIGN_LOCATION_RIGHT_BOTTOM = 18;
ccui.RELATIVE_ALIGN_LOCATION_BELOW_TOP = 19;
ccui.RELATIVE_ALIGN_LOCATION_BELOW_CENTER = 20;
ccui.RELATIVE_ALIGN_LOCATION_BELOW_BOTTOM = 21;
ccui.getLayoutManager = function(a) {
    switch (a) {
    case ccui.Layout.LINEAR_VERTICAL:
        return ccui.linearVerticalLayoutManager;
    case ccui.Layout.LINEAR_HORIZONTAL:
        return ccui.linearHorizontalLayoutManager;
    case ccui.Layout.RELATIVE:
        return ccui.relativeLayoutManager
    }
    return null
};
ccui.linearVerticalLayoutManager = {
    _doLayout: function(a) {
        var b = a._getLayoutContentSize();
        a = a._getLayoutElements();
        for (var c = b.height,
        d = 0,
        e = a.length; d < e; d++) {
            var f = a[d];
            if (f) {
                var g = f.getLayoutParameter();
                if (g) {
                    var h = g.getGravity(),
                    k = f.getAnchorPoint(),
                    m = f.getContentSize(),
                    r = k.x * m.width,
                    c = c - (1 - k.y) * m.height;
                    switch (h) {
                    case ccui.LinearLayoutParameter.RIGHT:
                        r = b.width - (1 - k.x) * m.width;
                        break;
                    case ccui.LinearLayoutParameter.CENTER_HORIZONTAL:
                        r = b.width / 2 - m.width * (0.5 - k.x)
                    }
                    g = g.getMargin();
                    r += g.left;
                    c -= g.top;
                    f.setPosition(r, c);
                    c = f.getPositionY() - k.y * m.height - g.bottom
                }
            }
        }
    }
};
ccui.linearHorizontalLayoutManager = {
    _doLayout: function(a) {
        var b = a._getLayoutContentSize();
        a = a._getLayoutElements();
        for (var c = 0,
        d = 0,
        e = a.length; d < e; d++) {
            var f = a[d];
            if (f) {
                var g = f.getLayoutParameter();
                if (g) {
                    var h = g.getGravity(),
                    k = f.getAnchorPoint(),
                    m = f.getContentSize(),
                    c = c + k.x * m.width,
                    r = b.height - (1 - k.y) * m.height;
                    switch (h) {
                    case ccui.LinearLayoutParameter.BOTTOM:
                        r = k.y * m.height;
                        break;
                    case ccui.LinearLayoutParameter.CENTER_VERTICAL:
                        r = b.height / 2 - m.height * (0.5 - k.y)
                    }
                    g = g.getMargin();
                    c += g.left;
                    r -= g.top;
                    f.setPosition(c, r);
                    c = f.getRightBoundary() + g.right
                }
            }
        }
    }
};
ccui.relativeLayoutManager = {
    _unlayoutChildCount: 0,
    _widgetChildren: [],
    _widget: null,
    _finalPositionX: 0,
    _finalPositionY: 0,
    _relativeWidgetLP: null,
    _doLayout: function(a) {
        for (var b = this._widgetChildren = this._getAllWidgets(a); 0 < this._unlayoutChildCount;) {
            for (var c = 0,
            d = b.length; c < d; c++) {
                this._widget = b[c];
                var e = this._widget.getLayoutParameter();
                e && !e._put && this._calculateFinalPositionWithRelativeWidget(a) && (this._calculateFinalPositionWithRelativeAlign(), this._widget.setPosition(this._finalPositionX, this._finalPositionY), e._put = !0)
            }
            this._unlayoutChildCount--
        }
        this._widgetChildren.length = 0
    },
    _getAllWidgets: function(a) {
        a = a._getLayoutElements();
        for (var b = this._widgetChildren,
        c = b.length = 0,
        d = a.length; c < d; c++) {
            var e = a[c];
            e && e instanceof ccui.Widget && (e.getLayoutParameter()._put = !1, this._unlayoutChildCount++, b.push(e))
        }
        return b
    },
    _getRelativeWidget: function(a) {
        var b = null;
        if ((a = a.getLayoutParameter().getRelativeToWidgetName()) && 0 !== a.length) for (var c = this._widgetChildren,
        d = 0,
        e = c.length; d < e; d++) {
            var f = c[d];
            if (f) {
                var g = f.getLayoutParameter();
                if (g && g.getRelativeName() === a) {
                    b = f;
                    this._relativeWidgetLP = g;
                    break
                }
            }
        }
        return b
    },
    _calculateFinalPositionWithRelativeWidget: function(a) {
        var b = this._widget,
        c = b.getAnchorPoint(),
        d = b.getContentSize();
        this._finalPositionY = this._finalPositionX = 0;
        var e = this._getRelativeWidget(b),
        b = b.getLayoutParameter().getAlign();
        a = a._getLayoutContentSize();
        switch (b) {
        case ccui.RelativeLayoutParameter.NONE:
        case ccui.RelativeLayoutParameter.PARENT_TOP_LEFT:
            this._finalPositionX = c.x * d.width;
            this._finalPositionY = a.height - (1 - c.y) * d.height;
            break;
        case ccui.RelativeLayoutParameter.PARENT_TOP_CENTER_HORIZONTAL:
            this._finalPositionX = 0.5 * a.width - d.width * (0.5 - c.x);
            this._finalPositionY = a.height - (1 - c.y) * d.height;
            break;
        case ccui.RelativeLayoutParameter.PARENT_TOP_RIGHT:
            this._finalPositionX = a.width - (1 - c.x) * d.width;
            this._finalPositionY = a.height - (1 - c.y) * d.height;
            break;
        case ccui.RelativeLayoutParameter.PARENT_LEFT_CENTER_VERTICAL:
            this._finalPositionX = c.x * d.width;
            this._finalPositionY = 0.5 * a.height - d.height * (0.5 - c.y);
            break;
        case ccui.RelativeLayoutParameter.CENTER_IN_PARENT:
            this._finalPositionX = 0.5 * a.width - d.width * (0.5 - c.x);
            this._finalPositionY = 0.5 * a.height - d.height * (0.5 - c.y);
            break;
        case ccui.RelativeLayoutParameter.PARENT_RIGHT_CENTER_VERTICAL:
            this._finalPositionX = a.width - (1 - c.x) * d.width;
            this._finalPositionY = 0.5 * a.height - d.height * (0.5 - c.y);
            break;
        case ccui.RelativeLayoutParameter.PARENT_LEFT_BOTTOM:
            this._finalPositionX = c.x * d.width;
            this._finalPositionY = c.y * d.height;
            break;
        case ccui.RelativeLayoutParameter.PARENT_BOTTOM_CENTER_HORIZONTAL:
            this._finalPositionX = 0.5 * a.width - d.width * (0.5 - c.x);
            this._finalPositionY = c.y * d.height;
            break;
        case ccui.RelativeLayoutParameter.PARENT_RIGHT_BOTTOM:
            this._finalPositionX = a.width - (1 - c.x) * d.width;
            this._finalPositionY = c.y * d.height;
            break;
        case ccui.RelativeLayoutParameter.LOCATION_ABOVE_LEFTALIGN:
            if (e) {
                if (this._relativeWidgetLP && !this._relativeWidgetLP._put) return ! 1;
                this._finalPositionY = e.getTopBoundary() + c.y * d.height;
                this._finalPositionX = e.getLeftBoundary() + c.x * d.width
            }
            break;
        case ccui.RelativeLayoutParameter.LOCATION_ABOVE_CENTER:
            if (e) {
                if (this._relativeWidgetLP && !this._relativeWidgetLP._put) return ! 1;
                a = e.getContentSize();
                this._finalPositionY = e.getTopBoundary() + c.y * d.height;
                this._finalPositionX = e.getLeftBoundary() + 0.5 * a.width + c.x * d.width - 0.5 * d.width
            }
            break;
        case ccui.RelativeLayoutParameter.LOCATION_ABOVE_RIGHTALIGN:
            if (e) {
                if (this._relativeWidgetLP && !this._relativeWidgetLP._put) return ! 1;
                this._finalPositionY = e.getTopBoundary() + c.y * d.height;
                this._finalPositionX = e.getRightBoundary() - (1 - c.x) * d.width
            }
            break;
        case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_TOPALIGN:
            if (e) {
                if (this._relativeWidgetLP && !this._relativeWidgetLP._put) return ! 1;
                this._finalPositionY = e.getTopBoundary() - (1 - c.y) * d.height;
                this._finalPositionX = e.getLeftBoundary() - (1 - c.x) * d.width
            }
            break;
        case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_CENTER:
            if (e) {
                if (this._relativeWidgetLP && !this._relativeWidgetLP._put) return ! 1;
                a = e.getContentSize();
                this._finalPositionX = e.getLeftBoundary() - (1 - c.x) * d.width;
                this._finalPositionY = e.getBottomBoundary() + 0.5 * a.height + c.y * d.height - 0.5 * d.height
            }
            break;
        case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_BOTTOMALIGN:
            if (e) {
                if (this._relativeWidgetLP && !this._relativeWidgetLP._put) return ! 1;
                this._finalPositionY = e.getBottomBoundary() + c.y * d.height;
                this._finalPositionX = e.getLeftBoundary() - (1 - c.x) * d.width
            }
            break;
        case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_TOPALIGN:
            if (e) {
                if (this._relativeWidgetLP && !this._relativeWidgetLP._put) return ! 1;
                this._finalPositionY = e.getTopBoundary() - (1 - c.y) * d.height;
                this._finalPositionX = e.getRightBoundary() + c.x * d.width
            }
            break;
        case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_CENTER:
            if (e) {
                if (this._relativeWidgetLP && !this._relativeWidgetLP._put) return ! 1;
                a = e.getContentSize();
                this._finalPositionX = e.getRightBoundary() + c.x * d.width;
                this._finalPositionY = e.getBottomBoundary() + 0.5 * a.height + c.y * d.height - 0.5 * d.height
            }
            break;
        case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_BOTTOMALIGN:
            if (e) {
                if (this._relativeWidgetLP && !this._relativeWidgetLP._put) return ! 1;
                this._finalPositionY = e.getBottomBoundary() + c.y * d.height;
                this._finalPositionX = e.getRightBoundary() + c.x * d.width
            }
            break;
        case ccui.RelativeLayoutParameter.LOCATION_BELOW_LEFTALIGN:
            if (e) {
                if (this._relativeWidgetLP && !this._relativeWidgetLP._put) return ! 1;
                this._finalPositionY = e.getBottomBoundary() - (1 - c.y) * d.height;
                this._finalPositionX = e.getLeftBoundary() + c.x * d.width
            }
            break;
        case ccui.RelativeLayoutParameter.LOCATION_BELOW_CENTER:
            if (e) {
                if (this._relativeWidgetLP && !this._relativeWidgetLP._put) return ! 1;
                a = e.getContentSize();
                this._finalPositionY = e.getBottomBoundary() - (1 - c.y) * d.height;
                this._finalPositionX = e.getLeftBoundary() + 0.5 * a.width + c.x * d.width - 0.5 * d.width
            }
            break;
        case ccui.RelativeLayoutParameter.LOCATION_BELOW_RIGHTALIGN:
            if (e) {
                if (this._relativeWidgetLP && !this._relativeWidgetLP._put) return ! 1;
                this._finalPositionY = e.getBottomBoundary() - (1 - c.y) * d.height;
                this._finalPositionX = e.getRightBoundary() - (1 - c.x) * d.width
            }
        }
        return ! 0
    },
    _calculateFinalPositionWithRelativeAlign: function() {
        var a = this._widget.getLayoutParameter(),
        b = a.getMargin();
        switch (a.getAlign()) {
        case ccui.RelativeLayoutParameter.NONE:
        case ccui.RelativeLayoutParameter.PARENT_TOP_LEFT:
            this._finalPositionX += b.left;
            this._finalPositionY -= b.top;
            break;
        case ccui.RelativeLayoutParameter.PARENT_TOP_CENTER_HORIZONTAL:
            this._finalPositionY -= b.top;
            break;
        case ccui.RelativeLayoutParameter.PARENT_TOP_RIGHT:
            this._finalPositionX -= b.right;
            this._finalPositionY -= b.top;
            break;
        case ccui.RelativeLayoutParameter.PARENT_LEFT_CENTER_VERTICAL:
            this._finalPositionX += b.left;
            break;
        case ccui.RelativeLayoutParameter.PARENT_RIGHT_CENTER_VERTICAL:
            this._finalPositionX -= b.right;
            break;
        case ccui.RelativeLayoutParameter.PARENT_LEFT_BOTTOM:
            this._finalPositionX += b.left;
            this._finalPositionY += b.bottom;
            break;
        case ccui.RelativeLayoutParameter.PARENT_BOTTOM_CENTER_HORIZONTAL:
            this._finalPositionY += b.bottom;
            break;
        case ccui.RelativeLayoutParameter.PARENT_RIGHT_BOTTOM:
            this._finalPositionX -= b.right;
            this._finalPositionY += b.bottom;
            break;
        case ccui.RelativeLayoutParameter.LOCATION_ABOVE_LEFTALIGN:
            this._finalPositionY += b.bottom;
            this._finalPositionX += b.left;
            break;
        case ccui.RelativeLayoutParameter.LOCATION_ABOVE_RIGHTALIGN:
            this._finalPositionY += b.bottom;
            this._finalPositionX -= b.right;
            break;
        case ccui.RelativeLayoutParameter.LOCATION_ABOVE_CENTER:
            this._finalPositionY += b.bottom;
            break;
        case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_TOPALIGN:
            this._finalPositionX -= b.right;
            this._finalPositionY -= b.top;
            break;
        case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_BOTTOMALIGN:
            this._finalPositionX -= b.right;
            this._finalPositionY += b.bottom;
            break;
        case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_CENTER:
            this._finalPositionX -= b.right;
            break;
        case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_TOPALIGN:
            this._finalPositionX += b.left;
            this._finalPositionY -= b.top;
            break;
        case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_BOTTOMALIGN:
            this._finalPositionX += b.left;
            this._finalPositionY += b.bottom;
            break;
        case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_CENTER:
            this._finalPositionX += b.left;
            break;
        case ccui.RelativeLayoutParameter.LOCATION_BELOW_LEFTALIGN:
            this._finalPositionY -= b.top;
            this._finalPositionX += b.left;
            break;
        case ccui.RelativeLayoutParameter.LOCATION_BELOW_RIGHTALIGN:
            this._finalPositionY -= b.top;
            this._finalPositionX -= b.right;
            break;
        case ccui.RelativeLayoutParameter.LOCATION_BELOW_CENTER:
            this._finalPositionY -= b.top
        }
    }
};
ccui.HBox = ccui.Layout.extend({
    ctor: function(a) {
        ccui.Layout.prototype.ctor.call(this);
        this.setLayoutType(ccui.Layout.LINEAR_HORIZONTAL);
        a && this.setContentSize(a)
    }
});
ccui.HBox.create = function(a) {
    return new ccui.HBox(a)
};
ccui.RelativeBox = ccui.Layout.extend({
    ctor: function(a) {
        ccui.Layout.prototype.ctor.call(this);
        this.setLayoutType(ccui.Layout.RELATIVE);
        a && this.setContentSize(a)
    }
});
ccui.RelativeBox.create = function(a) {
    return new ccui.RelativeBox(a)
};
ccui.VBox = ccui.Layout.extend({
    ctor: function(a) {
        ccui.Layout.prototype.ctor.call(this);
        this.setLayoutType(ccui.Layout.LINEAR_VERTICAL);
        a && this.setContentSize(a)
    },
    initWithSize: function(a) {
        return this.init() ? !0 : !1
    }
});
ccui.VBox.create = function(a) {
    return new ccui.VBox(a)
};
ccui.helper = {
    seekWidgetByTag: function(a, b) {
        if (!a) return null;
        if (a.getTag() === b) return a;
        for (var c = a.getChildren(), d = c.length, e = 0; e < d; e++) {
            var f = ccui.helper.seekWidgetByTag(c[e], b);
            if (null !== f) return f
        }
        return null
    },
    seekWidgetByName: function(a, b) {
        if (!a) return null;
        if (a.getName() === b) return a;
        for (var c = a.getChildren(), d = c.length, e = 0; e < d; e++) {
            var f = ccui.helper.seekWidgetByName(c[e], b);
            if (null !== f) return f
        }
        return null
    },
    seekWidgetByRelativeName: function(a, b) {
        if (!a) return null;
        for (var c = a.getChildren(), d = c.length, e = 0; e < d; e++) {
            var f = c[e],
            g = f.getLayoutParameter(ccui.LayoutParameter.RELATIVE);
            if (g && g.getRelativeName() === b) return f
        }
        return null
    },
    seekActionWidgetByActionTag: function(a, b) {
        if (!a) return null;
        if (a.getActionTag() === b) return a;
        for (var c = a.getChildren(), d = 0; d < c.length; d++) {
            var e = ccui.helper.seekActionWidgetByActionTag(c[d], b);
            if (null !== e) return e
        }
        return null
    },
    _activeLayout: !0,
    doLayout: function(a) {
        if (this._activeLayout) {
            a = a.getChildren();
            for (var b, c = 0,
            d = a.length; c < d; c++) {
                b = a[c];
                var e = b.getComponent(ccui.LayoutComponent.NAME);
                b = b.getParent();
                null != e && null !== b && e.refreshLayout && e.refreshLayout()
            }
        }
    },
    changeLayoutSystemActiveState: function(a) {
        this._activeLayout = a
    },
    restrictCapInsetRect: function(a, b) {
        var c = a.x,
        d = a.y,
        e = a.width,
        f = a.height;
        b.width < e && (e = c = 0);
        b.height < f && (f = d = 0);
        return cc.rect(c, d, e, f)
    },
    _createSpriteFromBase64: function(a, b) {
        var c = cc.textureCache.getTextureForKey(b);
        c || (c = new Image, c.src = a, cc.textureCache.cacheImage(b, c), c = cc.textureCache.getTextureForKey(b));
        return new cc.Sprite(c)
    }
};
ccui.Button = ccui.Widget.extend({
    _buttonScale9Renderer: null,
    _buttonNormalSpriteFrame: null,
    _buttonClickedSpriteFrame: null,
    _buttonDisableSpriteFrame: null,
    _titleRenderer: null,
    _normalFileName: "",
    _clickedFileName: "",
    _disabledFileName: "",
    _prevIgnoreSize: !0,
    _scale9Enabled: !1,
    _capInsetsNormal: null,
    _normalTexType: ccui.Widget.LOCAL_TEXTURE,
    _pressedTexType: ccui.Widget.LOCAL_TEXTURE,
    _disabledTexType: ccui.Widget.LOCAL_TEXTURE,
    _normalTextureSize: null,
    pressedActionEnabled: !1,
    _titleColor: null,
    _zoomScale: 0.1,
    _normalTextureLoaded: !1,
    _pressedTextureLoaded: !1,
    _disabledTextureLoaded: !1,
    _className: "Button",
    _normalTextureAdaptDirty: !0,
    _fontName: "Thonburi",
    _fontSize: 12,
    _type: 0,
    ctor: function(a, b, c, d) {
        this._capInsetsNormal = cc.rect(0, 0, 0, 0);
        this._normalTextureSize = cc.size(0, 0);
        ccui.Widget.prototype.ctor.call(this);
        this.setTouchEnabled(!0);
        this._normalLoader = new cc.Sprite.LoadManager;
        this._clickedLoader = new cc.Sprite.LoadManager;
        this._disabledLoader = new cc.Sprite.LoadManager;
        a && this.loadTextures(a, b, c, d)
    },
    _createTitleRendererIfNeeded: function() {
        this._titleRenderer || (this._titleRenderer = new cc.LabelTTF(""), this._titleRenderer.setAnchorPoint(0.5, 0.5), this._titleColor = cc.color.WHITE, this._titleRenderer.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER), this.addProtectedChild(this._titleRenderer, ccui.Button.TITLE_RENDERER_ZORDER, -1))
    },
    _initRenderer: function() {
        this._buttonScale9Renderer = new ccui.Scale9Sprite;
        this._buttonScale9Renderer.setRenderingType(ccui.Scale9Sprite.RenderingType.SIMPLE);
        this.addProtectedChild(this._buttonScale9Renderer, ccui.Button.DISABLED_RENDERER_ZORDER, -1)
    },
    setScale9Enabled: function(a) {
        this._scale9Enabled !== a && (this._brightStyle = ccui.Widget.BRIGHT_STYLE_NONE, (this._scale9Enabled = a) ? this._buttonScale9Renderer.setRenderingType(ccui.Scale9Sprite.RenderingType.SLICED) : this._buttonScale9Renderer.setRenderingType(ccui.Scale9Sprite.RenderingType.SIMPLE), this._scale9Enabled ? (a = this._ignoreSize, this.ignoreContentAdaptWithSize(!1), this._prevIgnoreSize = a) : this.ignoreContentAdaptWithSize(this._prevIgnoreSize), this.setCapInsets(this._capInsetsNormal), this.setBright(this._bright), this._normalTextureAdaptDirty = !0)
    },
    isScale9Enabled: function() {
        return this._scale9Enabled
    },
    ignoreContentAdaptWithSize: function(a) {
        if (this._unifySize) this._updateContentSize();
        else if (!this._scale9Enabled || this._scale9Enabled && !a) ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this, a),
        this._prevIgnoreSize = a
    },
    getVirtualRendererSize: function() {
        return this._unifySize ? this._getNormalSize() : !this._normalTextureLoaded && this._titleRenderer && 0 < this._titleRenderer.getString().length ? this._titleRenderer.getContentSize() : cc.size(this._normalTextureSize)
    },
    loadTextures: function(a, b, c, d) {
        this.loadTextureNormal(a, d);
        this.loadTexturePressed(b, d);
        this.loadTextureDisabled(c, d)
    },
    _createSpriteFrameWithFile: function(a) {
        var b = cc.textureCache.getTextureForKey(a);
        b || (b = cc.textureCache.addImage(a));
        if (!b._textureLoaded) return b;
        a = b.getContentSize();
        a = cc.rect(0, 0, a.width, a.height);
        return new cc.SpriteFrame(b, a)
    },
    _createSpriteFrameWithName: function(a) {
        a = cc.spriteFrameCache.getSpriteFrame(a);
        return null == a ? (cc.log("ccui.Scale9Sprite.initWithSpriteFrameName(): can't find the sprite frame by spriteFrameName"), null) : a
    },
    loadTextureNormal: function(a, b) {
        if (a) {
            b = b || ccui.Widget.LOCAL_TEXTURE;
            this._normalFileName = a;
            this._normalTexType = b;
            var c;
            switch (this._normalTexType) {
            case ccui.Widget.LOCAL_TEXTURE:
                c = this._createSpriteFrameWithFile(a);
                break;
            case ccui.Widget.PLIST_TEXTURE:
                "#" === a[0] && (a = a.substr(1, a.length - 1)),
                c = this._createSpriteFrameWithName(a)
            }
            c && (c._textureLoaded ? (this._normalTextureLoaded = c._textureLoaded, this._buttonNormalSpriteFrame = c, this._buttonScale9Renderer.setSpriteFrame(c), this._scale9Enabled && this._buttonScale9Renderer.setCapInsets(this._capInsetsNormal), !this._ignoreSize && cc.sizeEqualToSize(this._customSize, cc.size(0, 0)) && (this._customSize = this._buttonScale9Renderer.getContentSize()), this._normalTextureSize = this._buttonScale9Renderer.getContentSize(), this._updateChildrenDisplayedRGBA(), this._unifySize ? this._scale9Enabled && (this._buttonScale9Renderer.setCapInsets(this._capInsetsNormal), this._updateContentSizeWithTextureSize(this._getNormalSize())) : this._updateContentSizeWithTextureSize(this._normalTextureSize), this._normalTextureAdaptDirty = !0, this._findLayout()) : (this._normalLoader.clear(), this._normalLoader.once(c,
            function() {
                this.loadTextureNormal(this._normalFileName, this._normalTexType)
            },
            this)))
        }
    },
    loadTexturePressed: function(a, b) {
        if (a) {
            b = b || ccui.Widget.LOCAL_TEXTURE;
            this._clickedFileName = a;
            this._pressedTexType = b;
            var c;
            switch (this._pressedTexType) {
            case ccui.Widget.LOCAL_TEXTURE:
                c = this._createSpriteFrameWithFile(a);
                break;
            case ccui.Widget.PLIST_TEXTURE:
                "#" === a[0] && (a = a.substr(1, a.length - 1)),
                c = this._createSpriteFrameWithName(a)
            }
            c && (c._textureLoaded ? (this._buttonClickedSpriteFrame = c, this._updateChildrenDisplayedRGBA(), this._pressedTextureLoaded = !0) : (this._clickedLoader.clear(), this._clickedLoader.once(c,
            function() {
                this.loadTexturePressed(this._clickedFileName, this._pressedTexType)
            },
            this)))
        }
    },
    loadTextureDisabled: function(a, b) {
        if (a) {
            b = b || ccui.Widget.LOCAL_TEXTURE;
            this._disabledFileName = a;
            this._disabledTexType = b;
            var c;
            switch (this._disabledTexType) {
            case ccui.Widget.LOCAL_TEXTURE:
                c = this._createSpriteFrameWithFile(a);
                break;
            case ccui.Widget.PLIST_TEXTURE:
                "#" === a[0] && (a = a.substr(1, a.length - 1)),
                c = this._createSpriteFrameWithName(a)
            }
            c && (c._textureLoaded ? (this._buttonDisableSpriteFrame = c, this._updateChildrenDisplayedRGBA(), this._disabledTextureLoaded = !0, this._findLayout()) : (this._disabledLoader.clear(), this._disabledLoader.once(c,
            function() {
                this.loadTextureDisabled(this._disabledFileName, this._disabledTexType)
            },
            this)))
        }
    },
    setCapInsets: function(a) {
        this.setCapInsetsNormalRenderer(a)
    },
    setCapInsetsNormalRenderer: function(a) {
        if (a && this._scale9Enabled) {
            var b = a.x,
            c = a.y,
            d = a.width;
            a = a.height;
            this._normalTextureSize.width < d && (d = b = 0);
            this._normalTextureSize.height < a && (a = c = 0);
            var e = this._capInsetsNormal;
            e.x = b;
            e.y = c;
            e.width = d;
            e.height = a;
            this._capInsetsNormal = e;
            this._buttonScale9Renderer.setCapInsets(e)
        }
    },
    getCapInsetsNormalRenderer: function() {
        return cc.rect(this._capInsetsNormal)
    },
    setCapInsetsPressedRenderer: function(a) {
        this.setCapInsetsNormalRenderer(a)
    },
    getCapInsetsPressedRenderer: function() {
        return cc.rect(this._capInsetsNormal)
    },
    setCapInsetsDisabledRenderer: function(a) {
        this.setCapInsetsNormalRenderer(a)
    },
    getCapInsetsDisabledRenderer: function() {
        return cc.rect(this._capInsetsNormal)
    },
    _onPressStateChangedToNormal: function() {
        this._buttonScale9Renderer.setSpriteFrame(this._buttonNormalSpriteFrame);
        this._buttonScale9Renderer.setState(ccui.Scale9Sprite.state.NORMAL);
        if (this._pressedTextureLoaded) {
            if (this.pressedActionEnabled && (this._buttonScale9Renderer.stopAllActions(), this._buttonScale9Renderer.setScale(1), this._titleRenderer)) if (this._titleRenderer.stopAllActions(), this._unifySize) {
                var a = cc.scaleTo(ccui.Button.ZOOM_ACTION_TIME_STEP, 1, 1);
                this._titleRenderer.runAction(a)
            } else this._titleRenderer.setScaleX(1),
            this._titleRenderer.setScaleY(1)
        } else this._buttonScale9Renderer.stopAllActions(),
        this._buttonScale9Renderer.setScale(1),
        this._scale9Enabled && this._buttonScale9Renderer.setColor(cc.color.WHITE),
        this._titleRenderer && (this._titleRenderer.stopAllActions(), this._titleRenderer.setScaleX(1), this._titleRenderer.setScaleY(1))
    },
    _onPressStateChangedToPressed: function() {
        this._buttonScale9Renderer.setState(ccui.Scale9Sprite.state.NORMAL);
        if (this._pressedTextureLoaded) {
            if (this._buttonScale9Renderer.setSpriteFrame(this._buttonClickedSpriteFrame), this.pressedActionEnabled) {
                this._buttonScale9Renderer.stopAllActions();
                var a = cc.scaleTo(ccui.Button.ZOOM_ACTION_TIME_STEP, 1 + this._zoomScale, 1 + this._zoomScale);
                this._buttonScale9Renderer.runAction(a);
                this._titleRenderer && (this._titleRenderer.stopAllActions(), this._titleRenderer.runAction(cc.scaleTo(ccui.Button.ZOOM_ACTION_TIME_STEP, 1 + this._zoomScale, 1 + this._zoomScale)))
            }
        } else this._buttonScale9Renderer.setSpriteFrame(this._buttonClickedSpriteFrame),
        this._buttonScale9Renderer.stopAllActions(),
        this._buttonScale9Renderer.setScale(1 + this._zoomScale, 1 + this._zoomScale),
        this._titleRenderer && (this._titleRenderer.stopAllActions(), this._titleRenderer.setScaleX(1 + this._zoomScale), this._titleRenderer.setScaleY(1 + this._zoomScale))
    },
    _onPressStateChangedToDisabled: function() {
        this._disabledTextureLoaded ? this._buttonScale9Renderer.setSpriteFrame(this._buttonDisableSpriteFrame) : this._normalTextureLoaded && this._buttonScale9Renderer.setState(ccui.Scale9Sprite.state.GRAY);
        this._buttonScale9Renderer.setScale(1)
    },
    _updateContentSize: function() {
        if (this._unifySize) {
            if (this._scale9Enabled) ccui.ProtectedNode.setContentSize(this._customSize);
            else {
                var a = this._getNormalSize();
                ccui.ProtectedNode.setContentSize(a)
            }
            this._onSizeChanged()
        } else this._ignoreSize && this.setContentSize(this.getVirtualRendererSize())
    },
    _onSizeChanged: function() {
        ccui.Widget.prototype._onSizeChanged.call(this);
        this._titleRenderer && this._updateTitleLocation();
        this._normalTextureAdaptDirty = !0
    },
    getVirtualRenderer: function() {
        return this._buttonScale9Renderer
    },
    _normalTextureScaleChangedWithSize: function() {
        this._buttonScale9Renderer.setContentSize(this._contentSize);
        this._buttonScale9Renderer.setPosition(this._contentSize.width / 2, this._contentSize.height / 2)
    },
    _adaptRenderers: function() {
        this._normalTextureAdaptDirty && (this._normalTextureScaleChangedWithSize(), this._normalTextureAdaptDirty = !1)
    },
    _updateTitleLocation: function() {
        this._titleRenderer.setPosition(0.5 * this._contentSize.width, 0.5 * this._contentSize.height)
    },
    setPressedActionEnabled: function(a) {
        this.pressedActionEnabled = a
    },
    setTitleText: function(a) {
        a !== this.getTitleText() && (this._createTitleRendererIfNeeded(), this._titleRenderer.setString(a), this._ignoreSize ? (a = this.getVirtualRendererSize(), this.setContentSize(a)) : this._titleRenderer._renderCmd._updateTTF())
    },
    getTitleText: function() {
        return this._titleRenderer ? this._titleRenderer.getString() : ""
    },
    setTitleColor: function(a) {
        this._createTitleRendererIfNeeded();
        this._titleRenderer.setFontFillColor(a)
    },
    getTitleColor: function() {
        return this._titleRenderer ? this._titleRenderer._getFillStyle() : cc.color.WHITE
    },
    setTitleFontSize: function(a) {
        this._createTitleRendererIfNeeded();
        this._titleRenderer.setFontSize(a);
        this._fontSize = a
    },
    getTitleFontSize: function() {
        return this._titleRenderer ? this._titleRenderer.getFontSize() : this._fontSize
    },
    setZoomScale: function(a) {
        this._zoomScale = a
    },
    getZoomScale: function() {
        return this._zoomScale
    },
    getNormalTextureSize: function() {
        return this._normalTextureSize
    },
    setTitleFontName: function(a) {
        this._createTitleRendererIfNeeded();
        this._titleRenderer.setFontName(a);
        this._fontName = a
    },
    getTitleRenderer: function() {
        return this._titleRenderer
    },
    getTitleFontName: function() {
        return this._titleRenderer ? this._titleRenderer.getFontName() : this._fontName
    },
    _setTitleFont: function(a) {
        this._titleRenderer.font = a
    },
    _getTitleFont: function() {
        return this._titleRenderer.font
    },
    getDescription: function() {
        return "Button"
    },
    _createCloneInstance: function() {
        return new ccui.Button
    },
    _copySpecialProperties: function(a) {
        this._prevIgnoreSize = a._prevIgnoreSize;
        this._capInsetsNormal = a._capInsetsNormal;
        this.setScale9Enabled(a._scale9Enabled);
        this.loadTextureNormal(a._normalFileName, a._normalTexType);
        this.loadTexturePressed(a._clickedFileName, a._pressedTexType);
        this.loadTextureDisabled(a._disabledFileName, a._disabledTexType);
        a._titleRenderer && a._titleRenderer._string && (this.setTitleText(a.getTitleText()), this.setTitleFontName(a.getTitleFontName()), this.setTitleFontSize(a.getTitleFontSize()), this.setTitleColor(a.getTitleColor()));
        this.setPressedActionEnabled(a.pressedActionEnabled);
        this.setZoomScale(a._zoomScale)
    },
    _getNormalSize: function() {
        var a;
        null !== this._titleRenderer && (a = this._titleRenderer.getContentSize());
        var b = this._buttonScale9Renderer.getContentSize();
        return cc.size(a.width > b.width ? a.width: b.width, a.height > b.height ? a.height: b.height)
    }
});
_p = ccui.Button.prototype;
cc.defineGetterSetter(_p, "titleText", _p.getTitleText, _p.setTitleText);
cc.defineGetterSetter(_p, "titleFont", _p._getTitleFont, _p._setTitleFont);
cc.defineGetterSetter(_p, "titleFontSize", _p.getTitleFontSize, _p.setTitleFontSize);
cc.defineGetterSetter(_p, "titleFontName", _p.getTitleFontName, _p.setTitleFontName);
cc.defineGetterSetter(_p, "titleColor", _p.getTitleColor, _p.setTitleColor);
_p = null;
ccui.Button.create = function(a, b, c, d) {
    return new ccui.Button(a, b, c, d)
};
ccui.Button.NORMAL_RENDERER_ZORDER = -2;
ccui.Button.PRESSED_RENDERER_ZORDER = -2;
ccui.Button.DISABLED_RENDERER_ZORDER = -2;
ccui.Button.TITLE_RENDERER_ZORDER = -1;
ccui.Button.ZOOM_ACTION_TIME_STEP = 0.05;
ccui.Button.SYSTEM = 0;
ccui.Button.TTF = 1;
ccui.ImageView = ccui.Widget.extend({
    _scale9Enabled: !1,
    _prevIgnoreSize: !0,
    _capInsets: null,
    _imageRenderer: null,
    _textureFile: "",
    _imageTexType: ccui.Widget.LOCAL_TEXTURE,
    _imageTextureSize: null,
    _className: "ImageView",
    _imageRendererAdaptDirty: !0,
    ctor: function(a, b) {
        this._capInsets = cc.rect(0, 0, 0, 0);
        this._imageTextureSize = cc.size(this._capInsets.width, this._capInsets.height);
        ccui.Widget.prototype.ctor.call(this);
        a ? this.loadTexture(a, void 0 === b ? 0 : b) : this._imageTexType = ccui.Widget.LOCAL_TEXTURE
    },
    _initRenderer: function() {
        this._imageRenderer = new ccui.Scale9Sprite;
        this._imageRenderer.setRenderingType(ccui.Scale9Sprite.RenderingType.SIMPLE);
        this.addProtectedChild(this._imageRenderer, ccui.ImageView.RENDERER_ZORDER, -1)
    },
    loadTexture: function(a, b) {
        if (a && (this._textureFile != a || this._imageTexType != b)) {
            var c = this;
            b = b || ccui.Widget.LOCAL_TEXTURE;
            this._textureFile = a;
            this._imageTexType = b;
            var d = c._imageRenderer;
            switch (c._imageTexType) {
            case ccui.Widget.LOCAL_TEXTURE:
                c._scale9Enabled ? (d.initWithFile(a), d.setCapInsets(c._capInsets)) : d.initWithFile(a);
                break;
            case ccui.Widget.PLIST_TEXTURE:
                c._scale9Enabled ? (d.initWithSpriteFrameName(a), d.setCapInsets(c._capInsets)) : d.initWithSpriteFrameName(a)
            }
            if (!d._textureLoaded) {
                var e = function() {
                    d.removeEventListener("load", e); ! c._ignoreSize && cc.sizeEqualToSize(c._customSize, cc.size(0, 0)) && (c._customSize = c._imageRenderer.getContentSize());
                    c._imageTextureSize = d.getContentSize();
                    c._updateChildrenDisplayedRGBA();
                    c._updateContentSizeWithTextureSize(c._imageTextureSize)
                };
                d.addEventListener("load", e)
            } ! this._ignoreSize && cc.sizeEqualToSize(this._customSize, cc.size(0, 0)) && (this._customSize = this._imageRenderer.getContentSize());
            c._imageTextureSize = d.getContentSize();
            this._updateChildrenDisplayedRGBA();
            c._updateContentSizeWithTextureSize(c._imageTextureSize);
            c._imageRendererAdaptDirty = !0;
            c._findLayout()
        }
    },
    setTextureRect: function() {
        cc.warn("ImageView.setTextureRect  is deprecated!")
    },
    setScale9Enabled: function(a) {
        this._scale9Enabled !== a && ((this._scale9Enabled = a) ? this._imageRenderer.setRenderingType(ccui.Scale9Sprite.RenderingType.SLICED) : this._imageRenderer.setRenderingType(ccui.Scale9Sprite.RenderingType.SIMPLE), this._scale9Enabled ? (a = this._ignoreSize, this.ignoreContentAdaptWithSize(!1), this._prevIgnoreSize = a) : this.ignoreContentAdaptWithSize(this._prevIgnoreSize), this.setCapInsets(this._capInsets), this._imageRendererAdaptDirty = !0)
    },
    isScale9Enabled: function() {
        return this._scale9Enabled
    },
    ignoreContentAdaptWithSize: function(a) {
        if (!this._scale9Enabled || this._scale9Enabled && !a) ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this, a),
        this._prevIgnoreSize = a
    },
    setCapInsets: function(a) {
        if (a) {
            var b = this._capInsets;
            b.x = a.x;
            b.y = a.y;
            b.width = a.width;
            b.height = a.height;
            this._scale9Enabled && this._imageRenderer.setCapInsets(a)
        }
    },
    getCapInsets: function() {
        return cc.rect(this._capInsets)
    },
    _onSizeChanged: function() {
        ccui.Widget.prototype._onSizeChanged.call(this);
        this._imageRendererAdaptDirty = !0
    },
    _adaptRenderers: function() {
        this._imageRendererAdaptDirty && (this._imageTextureScaleChangedWithSize(), this._imageRendererAdaptDirty = !1)
    },
    getVirtualRendererSize: function() {
        return cc.size(this._imageTextureSize)
    },
    getVirtualRenderer: function() {
        return this._imageRenderer
    },
    _imageTextureScaleChangedWithSize: function() {
        this._imageRenderer.setContentSize(this._contentSize);
        this._imageRenderer.setPosition(this._contentSize.width / 2, this._contentSize.height / 2)
    },
    getDescription: function() {
        return "ImageView"
    },
    _createCloneInstance: function() {
        return new ccui.ImageView
    },
    _copySpecialProperties: function(a) {
        a instanceof ccui.ImageView && (this._prevIgnoreSize = a._prevIgnoreSize, this._capInsets = a._capInsets, this.loadTexture(a._textureFile, a._imageTexType), this.setScale9Enabled(a._scale9Enabled))
    },
    setContentSize: function(a, b) {
        b && (a = cc.size(a, b));
        ccui.Widget.prototype.setContentSize.call(this, a);
        this._imageRenderer.setContentSize(a)
    }
});
ccui.ImageView.create = function(a, b) {
    return new ccui.ImageView(a, b)
};
ccui.ImageView.RENDERER_ZORDER = -1;
ccui.LoadingBar = ccui.Widget.extend({
    _direction: null,
    _percent: 100,
    _totalLength: 0,
    _barRenderer: null,
    _renderBarTexType: ccui.Widget.LOCAL_TEXTURE,
    _barRendererTextureSize: null,
    _scale9Enabled: !1,
    _prevIgnoreSize: !0,
    _capInsets: null,
    _textureFile: "",
    _isTextureLoaded: !1,
    _className: "LoadingBar",
    _barRendererAdaptDirty: !0,
    ctor: function(a, b) {
        this._direction = ccui.LoadingBar.TYPE_LEFT;
        this._barRendererTextureSize = cc.size(0, 0);
        this._capInsets = cc.rect(0, 0, 0, 0);
        ccui.Widget.prototype.ctor.call(this);
        void 0 !== a && this.loadTexture(a);
        void 0 !== b && this.setPercent(b)
    },
    _initRenderer: function() {
        this._barRenderer = new cc.Sprite;
        this.addProtectedChild(this._barRenderer, ccui.LoadingBar.RENDERER_ZORDER, -1);
        this._barRenderer.setAnchorPoint(0, 0.5)
    },
    setDirection: function(a) {
        if (this._direction !== a) switch (this._direction = a, this._direction) {
        case ccui.LoadingBar.TYPE_LEFT:
            this._barRenderer.setAnchorPoint(0, 0.5);
            this._barRenderer.setPosition(0, 0.5 * this._contentSize.height);
            this._scale9Enabled || this._barRenderer.setFlippedX(!1);
            break;
        case ccui.LoadingBar.TYPE_RIGHT:
            this._barRenderer.setAnchorPoint(1, 0.5),
            this._barRenderer.setPosition(this._totalLength, 0.5 * this._contentSize.height),
            this._scale9Enabled || this._barRenderer.setFlippedX(!0)
        }
    },
    getDirection: function() {
        return this._direction
    },
    loadTexture: function(a, b) {
        if (a) {
            this._renderBarTexType = b = b || ccui.Widget.LOCAL_TEXTURE;
            this._textureFile = a;
            var c = this._barRenderer,
            d = this;
            c._textureLoaded || c.addEventListener("load",
            function() {
                d.loadTexture(d._textureFile, d._renderBarTexType);
                d._setPercent(d._percent)
            });
            switch (this._renderBarTexType) {
            case ccui.Widget.LOCAL_TEXTURE:
                c.initWithFile(a);
                break;
            case ccui.Widget.PLIST_TEXTURE:
                c.initWithSpriteFrameName(a)
            }
            var e = c.getContentSize();
            this._barRendererTextureSize.width = e.width;
            this._barRendererTextureSize.height = e.height;
            switch (this._direction) {
            case ccui.LoadingBar.TYPE_LEFT:
                c.setAnchorPoint(0, 0.5);
                this._scale9Enabled || c.setFlippedX(!1);
                break;
            case ccui.LoadingBar.TYPE_RIGHT:
                c.setAnchorPoint(1, 0.5),
                this._scale9Enabled || c.setFlippedX(!0)
            }
            this._scale9Enabled && c.setCapInsets(this._capInsets);
            this._updateChildrenDisplayedRGBA();
            this._barRendererScaleChangedWithSize();
            this._updateContentSizeWithTextureSize(this._barRendererTextureSize);
            this._barRendererAdaptDirty = !0;
            this._findLayout()
        }
    },
    setScale9Enabled: function(a) {
        this._scale9Enabled !== a && (this._scale9Enabled = a, this.removeProtectedChild(this._barRenderer), this._barRenderer = this._scale9Enabled ? new ccui.Scale9Sprite: new cc.Sprite, this.loadTexture(this._textureFile, this._renderBarTexType), this.addProtectedChild(this._barRenderer, ccui.LoadingBar.RENDERER_ZORDER, -1), this._scale9Enabled ? (a = this._ignoreSize, this.ignoreContentAdaptWithSize(!1), this._prevIgnoreSize = a) : this.ignoreContentAdaptWithSize(this._prevIgnoreSize), this.setCapInsets(this._capInsets), this.setPercent(this._percent), this._barRendererAdaptDirty = !0)
    },
    isScale9Enabled: function() {
        return this._scale9Enabled
    },
    setCapInsets: function(a) {
        if (a) {
            var b = this._capInsets;
            b.x = a.x;
            b.y = a.y;
            b.width = a.width;
            b.height = a.height;
            this._scale9Enabled && this._barRenderer.setCapInsets(a)
        }
    },
    getCapInsets: function() {
        return cc.rect(this._capInsets)
    },
    setPercent: function(a) {
        100 < a && (a = 100);
        0 > a && (a = 0);
        a !== this._percent && (this._percent = a, this._setPercent(a))
    },
    _setPercent: function() {
        var a, b, c, d;
        0 >= this._totalLength || (a = this._percent / 100, this._scale9Enabled ? this._setScale9Scale() : (c = this._barRenderer, d = this._barRendererTextureSize, b = c.getTextureRect(), b.width = d.width * a, c.setTextureRect(cc.rect(b.x, b.y, d.width * a, d.height), c._rectRotated)))
    },
    setContentSize: function(a, b) {
        ccui.Widget.prototype.setContentSize.call(this, a, b);
        this._totalLength = void 0 === b ? a.width: a
    },
    getPercent: function() {
        return this._percent
    },
    _onSizeChanged: function() {
        ccui.Widget.prototype._onSizeChanged.call(this);
        this._barRendererAdaptDirty = !0
    },
    _adaptRenderers: function() {
        this._barRendererAdaptDirty && (this._barRendererScaleChangedWithSize(), this._barRendererAdaptDirty = !1)
    },
    ignoreContentAdaptWithSize: function(a) {
        if (!this._scale9Enabled || this._scale9Enabled && !a) ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this, a),
        this._prevIgnoreSize = a
    },
    getVirtualRendererSize: function() {
        return cc.size(this._barRendererTextureSize)
    },
    getVirtualRenderer: function() {
        return this._barRenderer
    },
    _barRendererScaleChangedWithSize: function() {
        var a = this._barRenderer,
        b = this._contentSize;
        if (this._unifySize) this._totalLength = this._contentSize.width,
        this.setPercent(this._percent);
        else if (this._ignoreSize) this._scale9Enabled || (this._totalLength = this._barRendererTextureSize.width, a.setScale(1));
        else if (this._totalLength = b.width, this._scale9Enabled) this._setScale9Scale(),
        a.setScale(1);
        else {
            var c = this._barRendererTextureSize;
            if (0 >= c.width || 0 >= c.height) {
                a.setScale(1);
                return
            }
            var d = b.height / c.height;
            a.setScaleX(b.width / c.width);
            a.setScaleY(d)
        }
        switch (this._direction) {
        case ccui.LoadingBar.TYPE_LEFT:
            a.setPosition(0, 0.5 * b.height);
            break;
        case ccui.LoadingBar.TYPE_RIGHT:
            a.setPosition(this._totalLength, 0.5 * b.height)
        }
    },
    _setScale9Scale: function() {
        this._barRenderer.setPreferredSize(cc.size(this._percent / 100 * this._totalLength, this._contentSize.height))
    },
    getDescription: function() {
        return "LoadingBar"
    },
    _createCloneInstance: function() {
        return new ccui.LoadingBar
    },
    _copySpecialProperties: function(a) {
        a instanceof ccui.LoadingBar && (this._prevIgnoreSize = a._prevIgnoreSize, this.setScale9Enabled(a._scale9Enabled), this.loadTexture(a._textureFile, a._renderBarTexType), this.setCapInsets(a._capInsets), this.setPercent(a._percent), this.setDirection(a._direction))
    }
});
_p = ccui.LoadingBar.prototype;
cc.defineGetterSetter(_p, "direction", _p.getDirection, _p.setDirection);
cc.defineGetterSetter(_p, "percent", _p.getPercent, _p.setPercent);
_p = null;
ccui.LoadingBar.create = function(a, b) {
    return new ccui.LoadingBar(a, b)
};
ccui.LoadingBar.TYPE_LEFT = 0;
ccui.LoadingBar.TYPE_RIGHT = 1;
ccui.LoadingBar.RENDERER_ZORDER = -1;
ccui.Slider = ccui.Widget.extend({
    _barRenderer: null,
    _progressBarRenderer: null,
    _barTextureSize: null,
    _progressBarTextureSize: null,
    _slidBallNormalRenderer: null,
    _slidBallPressedRenderer: null,
    _slidBallDisabledRenderer: null,
    _slidBallRenderer: null,
    _barLength: 0,
    _percent: 0,
    _scale9Enabled: !1,
    _prevIgnoreSize: !0,
    _textureFile: "",
    _progressBarTextureFile: "",
    _slidBallNormalTextureFile: "",
    _slidBallPressedTextureFile: "",
    _slidBallDisabledTextureFile: "",
    _capInsetsBarRenderer: null,
    _capInsetsProgressBarRenderer: null,
    _sliderEventListener: null,
    _sliderEventSelector: null,
    _barTexType: ccui.Widget.LOCAL_TEXTURE,
    _progressBarTexType: ccui.Widget.LOCAL_TEXTURE,
    _ballNTexType: ccui.Widget.LOCAL_TEXTURE,
    _ballPTexType: ccui.Widget.LOCAL_TEXTURE,
    _ballDTexType: ccui.Widget.LOCAL_TEXTURE,
    _isTextureLoaded: !1,
    _className: "Slider",
    _barRendererAdaptDirty: !0,
    _progressBarRendererDirty: !0,
    _unifySize: !1,
    _zoomScale: 0.1,
    _sliderBallNormalTextureScaleX: 1,
    _sliderBallNormalTextureScaleY: 1,
    ctor: function(a, b, c) {
        this._barTextureSize = cc.size(0, 0);
        this._progressBarTextureSize = cc.size(0, 0);
        this._capInsetsBarRenderer = cc.rect(0, 0, 0, 0);
        this._capInsetsProgressBarRenderer = cc.rect(0, 0, 0, 0);
        ccui.Widget.prototype.ctor.call(this);
        c = c || 0;
        this.setTouchEnabled(!0);
        a && this.loadBarTexture(a, c);
        b && this.loadSlidBallTextures(b, c)
    },
    _initRenderer: function() {
        this._barRenderer = new cc.Sprite;
        this._progressBarRenderer = new cc.Sprite;
        this._progressBarRenderer.setAnchorPoint(0, 0.5);
        this.addProtectedChild(this._barRenderer, ccui.Slider.BASEBAR_RENDERER_ZORDER, -1);
        this.addProtectedChild(this._progressBarRenderer, ccui.Slider.PROGRESSBAR_RENDERER_ZORDER, -1);
        this._slidBallNormalRenderer = new cc.Sprite;
        this._slidBallPressedRenderer = new cc.Sprite;
        this._slidBallPressedRenderer.setVisible(!1);
        this._slidBallDisabledRenderer = new cc.Sprite;
        this._slidBallDisabledRenderer.setVisible(!1);
        this._slidBallRenderer = new cc.Node;
        this._slidBallRenderer.addChild(this._slidBallNormalRenderer);
        this._slidBallRenderer.addChild(this._slidBallPressedRenderer);
        this._slidBallRenderer.addChild(this._slidBallDisabledRenderer);
        this._slidBallRenderer.setCascadeColorEnabled(!0);
        this._slidBallRenderer.setCascadeOpacityEnabled(!0);
        this.addProtectedChild(this._slidBallRenderer, ccui.Slider.BALL_RENDERER_ZORDER, -1)
    },
    loadBarTexture: function(a, b) {
        if (a) {
            b = b || ccui.Widget.LOCAL_TEXTURE;
            this._textureFile = a;
            this._barTexType = b;
            var c = this._barRenderer,
            d = this;
            c._textureLoaded || c.addEventListener("load",
            function() {
                d.loadBarTexture(d._textureFile, d._barTexType)
            });
            switch (this._barTexType) {
            case ccui.Widget.LOCAL_TEXTURE:
                c.initWithFile(a);
                break;
            case ccui.Widget.PLIST_TEXTURE:
                c.initWithSpriteFrameName(a)
            }
            this._updateChildrenDisplayedRGBA();
            this._progressBarRendererDirty = this._barRendererAdaptDirty = !0;
            this._updateContentSizeWithTextureSize(this._barRenderer.getContentSize());
            this._findLayout();
            this._barTextureSize = this._barRenderer.getContentSize()
        }
    },
    loadProgressBarTexture: function(a, b) {
        if (a) {
            b = b || ccui.Widget.LOCAL_TEXTURE;
            this._progressBarTextureFile = a;
            this._progressBarTexType = b;
            var c = this._progressBarRenderer,
            d = this;
            c._textureLoaded || c.addEventListener("load",
            function() {
                d.loadProgressBarTexture(d._progressBarTextureFile, d._progressBarTexType)
            });
            switch (this._progressBarTexType) {
            case ccui.Widget.LOCAL_TEXTURE:
                c.initWithFile(a);
                break;
            case ccui.Widget.PLIST_TEXTURE:
                c.initWithSpriteFrameName(a)
            }
            this._updateChildrenDisplayedRGBA();
            this._progressBarRenderer.setAnchorPoint(cc.p(0, 0.5));
            c = this._progressBarRenderer.getContentSize();
            this._progressBarTextureSize = {
                width: c.width,
                height: c.height
            };
            this._progressBarRendererDirty = !0;
            this._findLayout()
        }
    },
    setScale9Enabled: function(a) {
        this._scale9Enabled !== a && (this._scale9Enabled = a, this.removeProtectedChild(this._barRenderer, !0), this.removeProtectedChild(this._progressBarRenderer, !0), this._progressBarRenderer = this._barRenderer = null, this._scale9Enabled ? (this._barRenderer = new ccui.Scale9Sprite, this._progressBarRenderer = new ccui.Scale9Sprite) : (this._barRenderer = new cc.Sprite, this._progressBarRenderer = new cc.Sprite), this.loadBarTexture(this._textureFile, this._barTexType), this.loadProgressBarTexture(this._progressBarTextureFile, this._progressBarTexType), this.addProtectedChild(this._barRenderer, ccui.Slider.BASEBAR_RENDERER_ZORDER, -1), this.addProtectedChild(this._progressBarRenderer, ccui.Slider.PROGRESSBAR_RENDERER_ZORDER, -1), this._scale9Enabled ? (a = this._ignoreSize, this.ignoreContentAdaptWithSize(!1), this._prevIgnoreSize = a) : this.ignoreContentAdaptWithSize(this._prevIgnoreSize), this.setCapInsetsBarRenderer(this._capInsetsBarRenderer), this.setCapInsetProgressBarRenderer(this._capInsetsProgressBarRenderer), this._progressBarRendererDirty = this._barRendererAdaptDirty = !0)
    },
    isScale9Enabled: function() {
        return this._scale9Enabled
    },
    ignoreContentAdaptWithSize: function(a) {
        if (!this._scale9Enabled || this._scale9Enabled && !a) ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this, a),
        this._prevIgnoreSize = a
    },
    setCapInsets: function(a) {
        this.setCapInsetsBarRenderer(a);
        this.setCapInsetProgressBarRenderer(a)
    },
    setCapInsetsBarRenderer: function(a) {
        if (a) {
            var b = this._capInsetsBarRenderer;
            b.x = a.x;
            b.y = a.y;
            b.width = a.width;
            b.height = a.height;
            this._scale9Enabled && this._barRenderer.setCapInsets(a)
        }
    },
    getCapInsetsBarRenderer: function() {
        return cc.rect(this._capInsetsBarRenderer)
    },
    setCapInsetProgressBarRenderer: function(a) {
        if (a) {
            var b = this._capInsetsProgressBarRenderer;
            b.x = a.x;
            b.y = a.y;
            b.width = a.width;
            b.height = a.height;
            this._scale9Enabled && this._progressBarRenderer.setCapInsets(a)
        }
    },
    getCapInsetsProgressBarRenderer: function() {
        return cc.rect(this._capInsetsProgressBarRenderer)
    },
    loadSlidBallTextures: function(a, b, c, d) {
        this.loadSlidBallTextureNormal(a, d);
        this.loadSlidBallTexturePressed(b, d);
        this.loadSlidBallTextureDisabled(c, d)
    },
    loadSlidBallTextureNormal: function(a, b) {
        if (a) {
            b = b || ccui.Widget.LOCAL_TEXTURE;
            this._slidBallNormalTextureFile = a;
            this._ballNTexType = b;
            var c = this;
            this._slidBallNormalRenderer._textureLoaded || this._slidBallNormalRenderer.addEventListener("load",
            function() {
                c.loadSlidBallTextureNormal(c._slidBallNormalTextureFile, c._ballNTexType)
            });
            switch (this._ballNTexType) {
            case ccui.Widget.LOCAL_TEXTURE:
                this._slidBallNormalRenderer.initWithFile(a);
                break;
            case ccui.Widget.PLIST_TEXTURE:
                this._slidBallNormalRenderer.initWithSpriteFrameName(a)
            }
            this._updateChildrenDisplayedRGBA();
            this._findLayout()
        }
    },
    loadSlidBallTexturePressed: function(a, b) {
        if (a) {
            b = b || ccui.Widget.LOCAL_TEXTURE;
            this._slidBallPressedTextureFile = a;
            this._ballPTexType = b;
            var c = this;
            this._slidBallPressedRenderer._textureLoaded || this._slidBallPressedRenderer.addEventListener("load",
            function() {
                c.loadSlidBallTexturePressed(c._slidBallPressedTextureFile, c._ballPTexType)
            });
            switch (this._ballPTexType) {
            case ccui.Widget.LOCAL_TEXTURE:
                this._slidBallPressedRenderer.initWithFile(a);
                break;
            case ccui.Widget.PLIST_TEXTURE:
                this._slidBallPressedRenderer.initWithSpriteFrameName(a)
            }
            this._updateChildrenDisplayedRGBA();
            this._findLayout()
        }
    },
    loadSlidBallTextureDisabled: function(a, b) {
        if (a) {
            b = b || ccui.Widget.LOCAL_TEXTURE;
            this._slidBallDisabledTextureFile = a;
            this._ballDTexType = b;
            var c = this;
            this._slidBallDisabledRenderer._textureLoaded || this._slidBallDisabledRenderer.addEventListener("load",
            function() {
                c.loadSlidBallTextureDisabled(c._slidBallDisabledTextureFile, c._ballDTexType)
            });
            switch (this._ballDTexType) {
            case ccui.Widget.LOCAL_TEXTURE:
                this._slidBallDisabledRenderer.initWithFile(a);
                break;
            case ccui.Widget.PLIST_TEXTURE:
                this._slidBallDisabledRenderer.initWithSpriteFrameName(a)
            }
            this._updateChildrenDisplayedRGBA();
            this._findLayout()
        }
    },
    setPercent: function(a) {
        100 < a && (a = 100);
        0 > a && (a = 0);
        this._percent = a;
        a = a / 100 * this._barLength;
        this._slidBallRenderer.setPosition(a, this._contentSize.height / 2);
        if (this._scale9Enabled) this._progressBarRenderer.setPreferredSize(cc.size(a, this._contentSize.height));
        else {
            var b = this._progressBarRenderer,
            c = b.getTextureRect();
            b.setTextureRect(cc.rect(c.x, c.y, a / b._scaleX, c.height), b.isTextureRectRotated())
        }
    },
    hitTest: function(a) {
        a = this._slidBallNormalRenderer.convertToNodeSpace(a);
        var b = this._slidBallNormalRenderer.getContentSize(),
        b = cc.rect(0, 0, b.width, b.height);
        return a.x >= b.x && a.x <= b.x + b.width && a.y >= b.y && a.y <= b.y + b.height
    },
    onTouchBegan: function(a, b) {
        var c = ccui.Widget.prototype.onTouchBegan.call(this, a, b);
        if (this._hit) {
            var d = this.convertToNodeSpace(this._touchBeganPosition);
            this.setPercent(this._getPercentWithBallPos(d.x));
            this._percentChangedEvent()
        }
        return c
    },
    onTouchMoved: function(a, b) {
        var c = a.getLocation(),
        c = this.convertToNodeSpace(c);
        this.setPercent(this._getPercentWithBallPos(c.x));
        this._percentChangedEvent()
    },
    onTouchEnded: function(a, b) {
        ccui.Widget.prototype.onTouchEnded.call(this, a, b)
    },
    onTouchCancelled: function(a, b) {
        ccui.Widget.prototype.onTouchCancelled.call(this, a, b)
    },
    _getPercentWithBallPos: function(a) {
        return a / this._barLength * 100
    },
    addEventListenerSlider: function(a, b) {
        this.addEventListener(a, b)
    },
    addEventListener: function(a, b) {
        this._sliderEventSelector = a;
        this._sliderEventListener = b
    },
    _percentChangedEvent: function() {
        this._sliderEventSelector && (this._sliderEventListener ? this._sliderEventSelector.call(this._sliderEventListener, this, ccui.Slider.EVENT_PERCENT_CHANGED) : this._sliderEventSelector(this, ccui.Slider.EVENT_PERCENT_CHANGED));
        this._ccEventCallback && this._ccEventCallback(this, ccui.Slider.EVENT_PERCENT_CHANGED)
    },
    getPercent: function() {
        return this._percent
    },
    _onSizeChanged: function() {
        ccui.Widget.prototype._onSizeChanged.call(this);
        this._progressBarRendererDirty = this._barRendererAdaptDirty = !0
    },
    _adaptRenderers: function() {
        this._barRendererAdaptDirty && (this._barRendererScaleChangedWithSize(), this._barRendererAdaptDirty = !1);
        this._progressBarRendererDirty && (this._progressBarRendererScaleChangedWithSize(), this._progressBarRendererDirty = !1)
    },
    getVirtualRendererSize: function() {
        return this._barRenderer.getContentSize()
    },
    getVirtualRenderer: function() {
        return this._barRenderer
    },
    _barRendererScaleChangedWithSize: function() {
        if (this._unifySize) this._barLength = this._contentSize.width,
        this._barRenderer.setPreferredSize(this._contentSize);
        else if (this._ignoreSize) this._barRenderer.setScale(1),
        this._barLength = this._contentSize.width;
        else if (this._barLength = this._contentSize.width, this._scale9Enabled) this._barRenderer.setPreferredSize(this._contentSize),
        this._barRenderer.setScale(1);
        else {
            var a = this._barTextureSize;
            if (0 >= a.width || 0 >= a.height) this._barRenderer.setScale(1);
            else {
                var b = this._contentSize.height / a.height;
                this._barRenderer.setScaleX(this._contentSize.width / a.width);
                this._barRenderer.setScaleY(b)
            }
        }
        this._barRenderer.setPosition(this._contentSize.width / 2, this._contentSize.height / 2);
        this.setPercent(this._percent)
    },
    _progressBarRendererScaleChangedWithSize: function() {
        if (this._unifySize) this._progressBarRenderer.setPreferredSize(this._contentSize);
        else if (this._ignoreSize) {
            if (!this._scale9Enabled) {
                var a = this._progressBarTextureSize,
                b = this._contentSize.width / a.width,
                a = this._contentSize.height / a.height;
                this._progressBarRenderer.setScaleX(b);
                this._progressBarRenderer.setScaleY(a)
            }
        } else if (this._scale9Enabled) this._progressBarRenderer.setPreferredSize(this._contentSize),
        this._progressBarRenderer.setScale(1);
        else {
            a = this._progressBarTextureSize;
            if (0 >= a.width || 0 >= a.height) {
                this._progressBarRenderer.setScale(1);
                return
            }
            b = this._contentSize.width / a.width;
            a = this._contentSize.height / a.height;
            this._progressBarRenderer.setScaleX(b);
            this._progressBarRenderer.setScaleY(a)
        }
        this._progressBarRenderer.setPosition(0, this._contentSize.height / 2);
        this.setPercent(this._percent)
    },
    _onPressStateChangedToNormal: function() {
        this._slidBallNormalRenderer.setVisible(!0);
        this._slidBallPressedRenderer.setVisible(!1);
        this._slidBallDisabledRenderer.setVisible(!1);
        this._slidBallNormalRenderer.setScale(this._sliderBallNormalTextureScaleX, this._sliderBallNormalTextureScaleY);
        cc._renderType === cc.game.RENDER_TYPE_WEBGL && (this._slidBallNormalRenderer._renderCmd._shaderProgram = this._getNormalGLProgram())
    },
    _onPressStateChangedToPressed: function() {
        this._slidBallPressedTextureFile ? (this._slidBallNormalRenderer.setVisible(!1), this._slidBallPressedRenderer.setVisible(!0), this._slidBallDisabledRenderer.setVisible(!1)) : this._slidBallNormalRenderer.setScale(this._sliderBallNormalTextureScaleX + this._zoomScale, this._sliderBallNormalTextureScaleY + this._zoomScale);
        cc._renderType === cc.game.RENDER_TYPE_WEBGL && (this._slidBallNormalRenderer._renderCmd._shaderProgram = this._getNormalGLProgram())
    },
    _onPressStateChangedToDisabled: function() {
        this._slidBallDisabledTextureFile ? (this._slidBallNormalRenderer.setVisible(!1), this._slidBallDisabledRenderer.setVisible(!0)) : (this._slidBallNormalRenderer.setVisible(!0), cc._renderType === cc.game.RENDER_TYPE_WEBGL && (this._slidBallNormalRenderer._renderCmd._shaderProgram = this._getGrayGLProgram()));
        this._slidBallNormalRenderer.setScale(this._sliderBallNormalTextureScaleX, this._sliderBallNormalTextureScaleY);
        this._slidBallPressedRenderer.setVisible(!1)
    },
    setZoomScale: function(a) {
        this._zoomScale = a
    },
    getZoomScale: function() {
        return this._zoomScale
    },
    getSlidBallNormalRenderer: function() {
        return this._slidBallNormalRenderer
    },
    getSlidBallPressedRenderer: function() {
        return this._slidBallPressedRenderer
    },
    getSlidBallDisabledRenderer: function() {
        return this._slidBallDisabledRenderer
    },
    getSlidBallRenderer: function() {
        return this._slidBallRenderer
    },
    getDescription: function() {
        return "Slider"
    },
    _createCloneInstance: function() {
        return new ccui.Slider
    },
    _copySpecialProperties: function(a) {
        this._prevIgnoreSize = a._prevIgnoreSize;
        this.setScale9Enabled(a._scale9Enabled);
        this.loadBarTexture(a._textureFile, a._barTexType);
        this.loadProgressBarTexture(a._progressBarTextureFile, a._progressBarTexType);
        this.loadSlidBallTextureNormal(a._slidBallNormalTextureFile, a._ballNTexType);
        this.loadSlidBallTexturePressed(a._slidBallPressedTextureFile, a._ballPTexType);
        this.loadSlidBallTextureDisabled(a._slidBallDisabledTextureFile, a._ballDTexType);
        this.setPercent(a.getPercent());
        this._sliderEventListener = a._sliderEventListener;
        this._sliderEventSelector = a._sliderEventSelector;
        this._zoomScale = a._zoomScale;
        this._ccEventCallback = a._ccEventCallback
    }
});
_p = ccui.Slider.prototype;
cc.defineGetterSetter(_p, "percent", _p.getPercent, _p.setPercent);
_p = null;
ccui.Slider.create = function(a, b, c) {
    return new ccui.Slider(a, b, c)
};
ccui.Slider.EVENT_PERCENT_CHANGED = 0;
ccui.Slider.BASEBAR_RENDERER_ZORDER = -3;
ccui.Slider.PROGRESSBAR_RENDERER_ZORDER = -2;
ccui.Slider.BALL_RENDERER_ZORDER = -1;
ccui.Text = ccui.Widget.extend({
    _touchScaleChangeEnabled: !1,
    _normalScaleValueX: 1,
    _normalScaleValueY: 1,
    _fontName: "Arial",
    _fontSize: 16,
    _onSelectedScaleOffset: 0.5,
    _labelRenderer: null,
    _textAreaSize: null,
    _textVerticalAlignment: 0,
    _textHorizontalAlignment: 0,
    _className: "Text",
    _type: null,
    _labelRendererAdaptDirty: !0,
    ctor: function(a, b, c) {
        this._type = ccui.Text.Type.SYSTEM;
        this._textAreaSize = cc.size(0, 0);
        ccui.Widget.prototype.ctor.call(this);
        void 0 !== c ? (this.setFontName(b), this.setFontSize(c), this.setString(a)) : this.setFontName(this._fontName)
    },
    _initRenderer: function() {
        this._labelRenderer = new cc.LabelTTF;
        this.addProtectedChild(this._labelRenderer, ccui.Text.RENDERER_ZORDER, -1)
    },
    setText: function(a) {
        cc.log("Please use the setString");
        this.setString(a)
    },
    setString: function(a) {
        a !== this._labelRenderer.getString() && (this._setString(a), this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize()))
    },
    _setString: function(a) {
        this._labelRenderer.setString(a);
        this._labelRendererAdaptDirty = !0
    },
    getStringValue: function() {
        cc.log("Please use the getString");
        return this._labelRenderer.getString()
    },
    getString: function() {
        return this._labelRenderer.getString()
    },
    getStringLength: function() {
        return this._labelRenderer.getStringLength()
    },
    setFontSize: function(a) {
        this._setFontSize(a);
        this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize())
    },
    _setFontSize: function(a) {
        this._labelRenderer.setFontSize(a);
        this._fontSize = a;
        this._labelRendererAdaptDirty = !0
    },
    getFontSize: function() {
        return this._fontSize
    },
    setFontName: function(a) {
        this._setFontName(a);
        this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize())
    },
    _setFontName: function(a) {
        this._fontName = a;
        this._labelRenderer.setFontName(a);
        this._labelRendererAdaptDirty = !0
    },
    _updateUITextContentSize: function() {
        this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize())
    },
    getFontName: function() {
        return this._fontName
    },
    _setFont: function(a) {
        var b = cc.LabelTTF._fontStyleRE.exec(a);
        b && (this._fontSize = parseInt(b[1]), this._fontName = b[2], this._labelRenderer._setFont(a), this._labelScaleChangedWithSize())
    },
    _getFont: function() {
        return this._labelRenderer._getFont()
    },
    getType: function() {
        return this._type
    },
    setTextAreaSize: function(a) {
        this._setTextAreaSize(a);
        this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize())
    },
    _setTextAreaSize: function(a) {
        this._labelRenderer.setDimensions(a);
        this._ignoreSize || (this._customSize = a);
        this._labelRendererAdaptDirty = !0
    },
    getTextAreaSize: function() {
        return this._labelRenderer.getDimensions()
    },
    setTextHorizontalAlignment: function(a) {
        this._setTextHorizontalAlignment(a);
        this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize())
    },
    _setTextHorizontalAlignment: function(a) {
        this._labelRenderer.setHorizontalAlignment(a);
        this._labelRendererAdaptDirty = !0
    },
    getTextHorizontalAlignment: function() {
        return this._labelRenderer.getHorizontalAlignment()
    },
    setTextVerticalAlignment: function(a) {
        this._setTextVerticalAlignment(a);
        this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize())
    },
    _setTextVerticalAlignment: function(a) {
        this._labelRenderer.setVerticalAlignment(a);
        this._labelRendererAdaptDirty = !0
    },
    getTextVerticalAlignment: function() {
        return this._labelRenderer.getVerticalAlignment()
    },
    setTouchScaleChangeEnabled: function(a) {
        this._touchScaleChangeEnabled = a
    },
    isTouchScaleChangeEnabled: function() {
        return this._touchScaleChangeEnabled
    },
    _onPressStateChangedToNormal: function() {
        this._touchScaleChangeEnabled && (this._labelRenderer.setScaleX(this._normalScaleValueX), this._labelRenderer.setScaleY(this._normalScaleValueY))
    },
    _onPressStateChangedToPressed: function() {
        this._touchScaleChangeEnabled && (this._labelRenderer.setScaleX(this._normalScaleValueX + this._onSelectedScaleOffset), this._labelRenderer.setScaleY(this._normalScaleValueY + this._onSelectedScaleOffset))
    },
    _onPressStateChangedToDisabled: function() {},
    _onSizeChanged: function() {
        ccui.Widget.prototype._onSizeChanged.call(this);
        this._labelRendererAdaptDirty = !0
    },
    _adaptRenderers: function() {
        this._labelRendererAdaptDirty && (this._labelScaleChangedWithSize(), this._labelRendererAdaptDirty = !1)
    },
    getVirtualRendererSize: function() {
        return this._labelRenderer.getContentSize()
    },
    getVirtualRenderer: function() {
        return this._labelRenderer
    },
    getAutoRenderSize: function() {
        var a = this._labelRenderer.getContentSize();
        this._ignoreSize || (this._labelRenderer.setDimensions(0, 0), a = this._labelRenderer.getContentSize(), this._labelRenderer.setDimensions(this._contentSize.width, this._contentSize.height));
        return a
    },
    _labelScaleChangedWithSize: function() {
        var a = this._contentSize;
        if (this._ignoreSize) this._labelRenderer.setScale(1),
        this._normalScaleValueX = this._normalScaleValueY = 1;
        else {
            this._labelRenderer.setDimensions(cc.size(a.width, a.height));
            var b = this._labelRenderer.getContentSize();
            if (0 >= b.width || 0 >= b.height) {
                this._labelRenderer.setScale(1);
                return
            }
            var c = a.width / b.width,
            b = a.height / b.height;
            this._labelRenderer.setScaleX(c);
            this._labelRenderer.setScaleY(b);
            this._normalScaleValueX = c;
            this._normalScaleValueY = b
        }
        this._labelRenderer.setPosition(a.width / 2, a.height / 2)
    },
    getDescription: function() {
        return "Label"
    },
    enableShadow: function(a, b, c) {
        this._labelRenderer.enableShadow(a, b, c)
    },
    enableOutline: function(a, b) {
        this._labelRenderer.enableStroke(a, b)
    },
    enableGlow: function(a) {
        this._type === ccui.Text.Type.TTF && this._labelRenderer.enableGlow(a)
    },
    disableEffect: function() {
        this._labelRenderer.disableEffect && this._labelRenderer.disableEffect()
    },
    _createCloneInstance: function() {
        return new ccui.Text
    },
    _copySpecialProperties: function(a) {
        a instanceof ccui.Text && (this.setFontName(a._fontName), this.setFontSize(a.getFontSize()), this.setString(a.getString()), this.setTouchScaleChangeEnabled(a.touchScaleEnabled), this.setTextAreaSize(a._textAreaSize), this.setTextHorizontalAlignment(a._labelRenderer.getHorizontalAlignment()), this.setTextVerticalAlignment(a._labelRenderer.getVerticalAlignment()), this.setContentSize(a.getContentSize()), this.setTextColor(a.getTextColor()))
    },
    _setBoundingWidth: function(a) {
        this._textAreaSize.width = a;
        this._labelRenderer._setBoundingWidth(a);
        this._labelScaleChangedWithSize()
    },
    _setBoundingHeight: function(a) {
        this._textAreaSize.height = a;
        this._labelRenderer._setBoundingHeight(a);
        this._labelScaleChangedWithSize()
    },
    _getBoundingWidth: function() {
        return this._textAreaSize.width
    },
    _getBoundingHeight: function() {
        return this._textAreaSize.height
    },
    _changePosition: function() {
        this._adaptRenderers()
    },
    setColor: function(a) {
        cc.ProtectedNode.prototype.setColor.call(this, a);
        this._labelRenderer.setColor(a)
    },
    setTextColor: function(a) {
        this._labelRenderer.setFontFillColor(a)
    },
    getTextColor: function() {
        return this._labelRenderer._getFillStyle()
    }
});
_p = ccui.Text.prototype;
cc.defineGetterSetter(_p, "boundingWidth", _p._getBoundingWidth, _p._setBoundingWidth);
cc.defineGetterSetter(_p, "boundingHeight", _p._getBoundingHeight, _p._setBoundingHeight);
cc.defineGetterSetter(_p, "string", _p.getString, _p.setString);
cc.defineGetterSetter(_p, "stringLength", _p.getStringLength);
cc.defineGetterSetter(_p, "font", _p._getFont, _p._setFont);
cc.defineGetterSetter(_p, "fontSize", _p.getFontSize, _p.setFontSize);
cc.defineGetterSetter(_p, "fontName", _p.getFontName, _p.setFontName);
cc.defineGetterSetter(_p, "textAlign", _p.getTextHorizontalAlignment, _p.setTextHorizontalAlignment);
cc.defineGetterSetter(_p, "verticalAlign", _p.getTextVerticalAlignment, _p.setTextVerticalAlignment);
_p = null;
ccui.Label = ccui.Text.create = function(a, b, c) {
    return new ccui.Text(a, b, c)
};
ccui.Text.RENDERER_ZORDER = -1;
ccui.Text.Type = {
    SYSTEM: 0,
    TTF: 1
};
ccui.TextAtlas = ccui.Widget.extend({
    _labelAtlasRenderer: null,
    _stringValue: "",
    _charMapFileName: "",
    _itemWidth: 0,
    _itemHeight: 0,
    _startCharMap: "",
    _className: "TextAtlas",
    _labelAtlasRendererAdaptDirty: null,
    ctor: function(a, b, c, d, e) {
        ccui.Widget.prototype.ctor.call(this);
        void 0 !== e && this.setProperty(a, b, c, d, e)
    },
    _initRenderer: function() {
        this._labelAtlasRenderer = new cc.LabelAtlas;
        this._labelAtlasRenderer.setAnchorPoint(cc.p(0.5, 0.5));
        this.addProtectedChild(this._labelAtlasRenderer, ccui.TextAtlas.RENDERER_ZORDER, -1);
        this._labelAtlasRenderer.addEventListener("load",
        function() {
            this._updateContentSizeWithTextureSize(this._labelAtlasRenderer.getContentSize());
            this._findLayout()
        },
        this)
    },
    setProperty: function(a, b, c, d, e) {
        this._stringValue = a;
        this._charMapFileName = b;
        this._itemWidth = c;
        this._itemHeight = d;
        this._startCharMap = e;
        this._labelAtlasRenderer.initWithString(a, this._charMapFileName, this._itemWidth, this._itemHeight, this._startCharMap[0]);
        this._updateContentSizeWithTextureSize(this._labelAtlasRenderer.getContentSize());
        this._labelAtlasRendererAdaptDirty = !0
    },
    setString: function(a) {
        a !== this._labelAtlasRenderer.getString() && (this._stringValue = a, this._labelAtlasRenderer.setString(a), this._updateContentSizeWithTextureSize(this._labelAtlasRenderer.getContentSize()), this._labelAtlasRendererAdaptDirty = !0)
    },
    setStringValue: function(a) {
        cc.log("Please use the setString");
        this.setString(a)
    },
    getStringValue: function() {
        cc.log("Please use the getString");
        return this.getString()
    },
    getString: function() {
        return this._labelAtlasRenderer.getString()
    },
    getStringLength: function() {
        return this._labelAtlasRenderer.getStringLength()
    },
    _onSizeChanged: function() {
        ccui.Widget.prototype._onSizeChanged.call(this);
        this._labelAtlasRendererAdaptDirty = !0
    },
    _adaptRenderers: function() {
        this._labelAtlasRendererAdaptDirty && (this._labelAtlasScaleChangedWithSize(), this._labelAtlasRendererAdaptDirty = !1)
    },
    getVirtualRendererSize: function() {
        return this._labelAtlasRenderer.getContentSize()
    },
    getVirtualRenderer: function() {
        return this._labelAtlasRenderer
    },
    _labelAtlasScaleChangedWithSize: function() {
        var a = this._labelAtlasRenderer;
        if (this._ignoreSize) a.setScale(1);
        else {
            var b = a.getContentSize();
            if (0 >= b.width || 0 >= b.height) {
                a.setScale(1);
                return
            }
            a.setScaleX(this._contentSize.width / b.width);
            a.setScaleY(this._contentSize.height / b.height)
        }
        a.setPosition(this._contentSize.width / 2, this._contentSize.height / 2)
    },
    getDescription: function() {
        return "LabelAtlas"
    },
    _copySpecialProperties: function(a) {
        a && this.setProperty(a._stringValue, a._charMapFileName, a._itemWidth, a._itemHeight, a._startCharMap)
    },
    _createCloneInstance: function() {
        return new ccui.TextAtlas
    }
});
_p = ccui.TextAtlas.prototype;
cc.defineGetterSetter(_p, "string", _p.getString, _p.setString);
_p = null;
ccui.TextAtlas.create = function(a, b, c, d, e) {
    return new ccui.TextAtlas(a, b, c, d, e)
};
ccui.TextAtlas.RENDERER_ZORDER = -1;
ccui._TextFieldRenderer = cc.TextFieldTTF.extend({
    _maxLengthEnabled: !1,
    _maxLength: 0,
    _passwordEnabled: !1,
    _passwordStyleText: "",
    _attachWithIME: !1,
    _detachWithIME: !1,
    _insertText: !1,
    _deleteBackward: !1,
    _className: "_TextFieldRenderer",
    ctor: function() {
        cc.TextFieldTTF.prototype.ctor.call(this);
        this._maxLengthEnabled = !1;
        this._maxLength = 0;
        this._passwordEnabled = !1;
        this._passwordStyleText = "*";
        this._deleteBackward = this._insertText = this._detachWithIME = this._attachWithIME = !1
    },
    onEnter: function() {
        cc.TextFieldTTF.prototype.onEnter.call(this);
        cc.TextFieldTTF.prototype.setDelegate.call(this, this)
    },
    onTextFieldAttachWithIME: function(a) {
        this.setAttachWithIME(!0);
        return ! 1
    },
    onTextFieldInsertText: function(a, b, c) {
        if (1 === c && "\n" === b) return ! 1;
        this.setInsertText(!0);
        return this._maxLengthEnabled && cc.TextFieldTTF.prototype.getCharCount.call(this) >= this._maxLength
    },
    onTextFieldDeleteBackward: function(a, b, c) {
        this.setDeleteBackward(!0);
        return ! 1
    },
    onTextFieldDetachWithIME: function(a) {
        this.setDetachWithIME(!0);
        return ! 1
    },
    insertText: function(a, b) {
        "\n" !== a && this._maxLengthEnabled && this.getString().length >= this._maxLength ? this._passwordEnabled && this.setPasswordText(this.getString()) : (cc.TextFieldTTF.prototype.insertText.call(this, a, b), this._passwordEnabled && 0 < cc.TextFieldTTF.prototype.getCharCount.call(this) && this.setPasswordText(this.getString()))
    },
    deleteBackward: function() {
        cc.TextFieldTTF.prototype.deleteBackward.call(this);
        0 < cc.TextFieldTTF.prototype.getCharCount.call(this) && this._passwordEnabled && this.setPasswordText(this._inputText)
    },
    openIME: function() {
        cc.TextFieldTTF.prototype.attachWithIME.call(this)
    },
    closeIME: function() {
        cc.TextFieldTTF.prototype.detachWithIME.call(this)
    },
    setMaxLengthEnabled: function(a) {
        this._maxLengthEnabled = a
    },
    isMaxLengthEnabled: function() {
        return this._maxLengthEnabled
    },
    setMaxLength: function(a) {
        this._maxLength = a
    },
    getMaxLength: function() {
        return this._maxLength
    },
    getCharCount: function() {
        return cc.TextFieldTTF.prototype.getCharCount.call(this)
    },
    setPasswordEnabled: function(a) {
        this._passwordEnabled = a
    },
    isPasswordEnabled: function() {
        return this._passwordEnabled
    },
    setPasswordStyleText: function(a) {
        if (! (1 < a.length)) {
            var b = a.charCodeAt(0);
            33 > b || 126 < b || (this._passwordStyleText = a)
        }
    },
    setPasswordText: function(a) {
        var b = "",
        c = a.length;
        a = c;
        this._maxLengthEnabled && c > this._maxLength && (a = this._maxLength);
        for (c = 0; c < a; ++c) b += this._passwordStyleText;
        cc.LabelTTF.prototype.setString.call(this, b)
    },
    setAttachWithIME: function(a) {
        this._attachWithIME = a
    },
    getAttachWithIME: function() {
        return this._attachWithIME
    },
    setDetachWithIME: function(a) {
        this._detachWithIME = a
    },
    getDetachWithIME: function() {
        return this._detachWithIME
    },
    setInsertText: function(a) {
        this._insertText = a
    },
    getInsertText: function() {
        return this._insertText
    },
    setDeleteBackward: function(a) {
        this._deleteBackward = a
    },
    getDeleteBackward: function() {
        return this._deleteBackward
    },
    onDraw: function(a) {
        return ! 1
    }
});
ccui._TextFieldRenderer.create = function(a, b, c) {
    var d = new ccui._TextFieldRenderer;
    return d && d.initWithString("", b, c) ? (a && d.setPlaceHolder(a), d) : null
};
ccui.TextField = ccui.Widget.extend({
    _textFieldRenderer: null,
    _touchWidth: 0,
    _touchHeight: 0,
    _useTouchArea: !1,
    _textFieldEventListener: null,
    _textFieldEventSelector: null,
    _passwordStyleText: "",
    _textFieldRendererAdaptDirty: !0,
    _fontName: "",
    _fontSize: 12,
    _ccEventCallback: null,
    ctor: function(a, b, c) {
        ccui.Widget.prototype.ctor.call(this);
        this.setTouchEnabled(!0);
        b && this.setFontName(b);
        c && this.setFontSize(c);
        a && this.setPlaceHolder(a)
    },
    onEnter: function() {
        ccui.Widget.prototype.onEnter.call(this);
        this.scheduleUpdate()
    },
    _initRenderer: function() {
        this._textFieldRenderer = ccui._TextFieldRenderer.create("input words here", "Thonburi", 20);
        this.addProtectedChild(this._textFieldRenderer, ccui.TextField.RENDERER_ZORDER, -1)
    },
    setTouchSize: function(a) {
        this._touchWidth = a.width;
        this._touchHeight = a.height
    },
    setTouchAreaEnabled: function(a) {
        this._useTouchArea = a
    },
    hitTest: function(a) {
        if (this._useTouchArea) {
            a = this.convertToNodeSpace(a);
            var b = cc.rect( - this._touchWidth * this._anchorPoint.x, -this._touchHeight * this._anchorPoint.y, this._touchWidth, this._touchHeight);
            return a.x >= b.x && a.x <= b.x + b.width && a.y >= b.y && a.y <= b.y + b.height
        }
        return ccui.Widget.prototype.hitTest.call(this, a)
    },
    getTouchSize: function() {
        return cc.size(this._touchWidth, this._touchHeight)
    },
    setText: function(a) {
        cc.log("Please use the setString");
        this.setString(a)
    },
    setString: function(a) {
        null != a && (a = String(a), this.isMaxLengthEnabled() && (a = a.substr(0, this.getMaxLength())), this.isPasswordEnabled() ? (this._textFieldRenderer.setPasswordText(a), this._textFieldRenderer.setString(""), this._textFieldRenderer.insertText(a, a.length)) : this._textFieldRenderer.setString(a), this._textFieldRendererAdaptDirty = !0, this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize()))
    },
    setPlaceHolder: function(a) {
        this._textFieldRenderer.setPlaceHolder(a);
        this._textFieldRendererAdaptDirty = !0;
        this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize())
    },
    getPlaceHolder: function() {
        return this._textFieldRenderer.getPlaceHolder()
    },
    getPlaceHolderColor: function() {
        return this._textFieldRenderer.getPlaceHolderColor()
    },
    setPlaceHolderColor: function(a) {
        this._textFieldRenderer.setColorSpaceHolder(a)
    },
    setTextColor: function(a) {
        this._textFieldRenderer.setTextColor(a)
    },
    setFontSize: function(a) {
        this._textFieldRenderer.setFontSize(a);
        this._fontSize = a;
        this._textFieldRendererAdaptDirty = !0;
        this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize())
    },
    getFontSize: function() {
        return this._fontSize
    },
    setFontName: function(a) {
        this._textFieldRenderer.setFontName(a);
        this._fontName = a;
        this._textFieldRendererAdaptDirty = !0;
        this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize())
    },
    getFontName: function() {
        return this._fontName
    },
    didNotSelectSelf: function() {
        this._textFieldRenderer.detachWithIME()
    },
    getStringValue: function() {
        cc.log("Please use the getString");
        return this.getString()
    },
    getString: function() {
        return this._textFieldRenderer.getString()
    },
    getStringLength: function() {
        return this._textFieldRenderer.getStringLength()
    },
    onTouchBegan: function(a, b) {
        var c = this,
        d = ccui.Widget.prototype.onTouchBegan.call(c, a, b);
        c._hit ? setTimeout(function() {
            c._textFieldRenderer.attachWithIME()
        },
        0) : setTimeout(function() {
            c._textFieldRenderer.detachWithIME()
        },
        0);
        return d
    },
    setMaxLengthEnabled: function(a) {
        this._textFieldRenderer.setMaxLengthEnabled(a)
    },
    isMaxLengthEnabled: function() {
        return this._textFieldRenderer.isMaxLengthEnabled()
    },
    setMaxLength: function(a) {
        this._textFieldRenderer.setMaxLength(a);
        this.setString(this.getString())
    },
    getMaxLength: function() {
        return this._textFieldRenderer.getMaxLength()
    },
    setPasswordEnabled: function(a) {
        this._textFieldRenderer.setPasswordEnabled(a)
    },
    isPasswordEnabled: function() {
        return this._textFieldRenderer.isPasswordEnabled()
    },
    setPasswordStyleText: function(a) {
        this._textFieldRenderer.setPasswordStyleText(a);
        this._passwordStyleText = a;
        this.setString(this.getString())
    },
    getPasswordStyleText: function() {
        return this._passwordStyleText
    },
    update: function(a) {
        this.getDetachWithIME() && (this._detachWithIMEEvent(), this.setDetachWithIME(!1));
        this.getAttachWithIME() && (this._attachWithIMEEvent(), this.setAttachWithIME(!1));
        this.getInsertText() && (this._textFieldRendererAdaptDirty = !0, this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize()), this._insertTextEvent(), this.setInsertText(!1));
        this.getDeleteBackward() && (this._textFieldRendererAdaptDirty = !0, this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize()), this._deleteBackwardEvent(), this.setDeleteBackward(!1))
    },
    getAttachWithIME: function() {
        return this._textFieldRenderer.getAttachWithIME()
    },
    setAttachWithIME: function(a) {
        this._textFieldRenderer.setAttachWithIME(a)
    },
    getDetachWithIME: function() {
        return this._textFieldRenderer.getDetachWithIME()
    },
    setDetachWithIME: function(a) {
        this._textFieldRenderer.setDetachWithIME(a)
    },
    getInsertText: function() {
        return this._textFieldRenderer.getInsertText()
    },
    setInsertText: function(a) {
        this._textFieldRenderer.setInsertText(a)
    },
    getDeleteBackward: function() {
        return this._textFieldRenderer.getDeleteBackward()
    },
    setDeleteBackward: function(a) {
        this._textFieldRenderer.setDeleteBackward(a)
    },
    _attachWithIMEEvent: function() {
        this._textFieldEventSelector && (this._textFieldEventListener ? this._textFieldEventSelector.call(this._textFieldEventListener, this, ccui.TextField.EVENT_ATTACH_WITH_IME) : this._textFieldEventSelector(this, ccui.TextField.EVENT_ATTACH_WITH_IME));
        this._ccEventCallback && this._ccEventCallback(this, ccui.TextField.EVENT_ATTACH_WITH_IME)
    },
    _detachWithIMEEvent: function() {
        this._textFieldEventSelector && (this._textFieldEventListener ? this._textFieldEventSelector.call(this._textFieldEventListener, this, ccui.TextField.EVENT_DETACH_WITH_IME) : this._textFieldEventSelector(this, ccui.TextField.EVENT_DETACH_WITH_IME));
        this._ccEventCallback && this._ccEventCallback(this, ccui.TextField.EVENT_DETACH_WITH_IME)
    },
    _insertTextEvent: function() {
        this._textFieldEventSelector && (this._textFieldEventListener ? this._textFieldEventSelector.call(this._textFieldEventListener, this, ccui.TextField.EVENT_INSERT_TEXT) : this._textFieldEventSelector(this, ccui.TextField.EVENT_INSERT_TEXT));
        this._ccEventCallback && this._ccEventCallback(this, ccui.TextField.EVENT_INSERT_TEXT)
    },
    _deleteBackwardEvent: function() {
        this._textFieldEventSelector && (this._textFieldEventListener ? this._textFieldEventSelector.call(this._textFieldEventListener, this, ccui.TextField.EVENT_DELETE_BACKWARD) : this._textFieldEventSelector(this, ccui.TextField.EVENT_DELETE_BACKWARD));
        this._ccEventCallback && this._ccEventCallback(this, ccui.TextField.EVENT_DELETE_BACKWARD)
    },
    addEventListenerTextField: function(a, b) {
        this.addEventListener(a, b)
    },
    addEventListener: function(a, b) {
        this._textFieldEventSelector = a;
        this._textFieldEventListener = b
    },
    _onSizeChanged: function() {
        ccui.Widget.prototype._onSizeChanged.call(this);
        this._textFieldRendererAdaptDirty = !0
    },
    _adaptRenderers: function() {
        this._textFieldRendererAdaptDirty && (this._textfieldRendererScaleChangedWithSize(), this._textFieldRendererAdaptDirty = !1)
    },
    _textfieldRendererScaleChangedWithSize: function() {
        this._ignoreSize || this._textFieldRenderer.setDimensions(this._contentSize);
        this._textFieldRenderer.setPosition(this._contentSize.width / 2, this._contentSize.height / 2)
    },
    getAutoRenderSize: function() {
        var a = this._textFieldRenderer.getContentSize();
        this._ignoreSize || (this._textFieldRenderer.setDimensions(0, 0), a = this._textFieldRenderer.getContentSize(), this._textFieldRenderer.setDimensions(this._contentSize.width, this._contentSize.height));
        return a
    },
    getVirtualRendererSize: function() {
        return this._textFieldRenderer.getContentSize()
    },
    getVirtualRenderer: function() {
        return this._textFieldRenderer
    },
    getDescription: function() {
        return "TextField"
    },
    attachWithIME: function() {
        this._textFieldRenderer.attachWithIME()
    },
    _createCloneInstance: function() {
        return new ccui.TextField
    },
    _copySpecialProperties: function(a) {
        this.setString(a._textFieldRenderer.getString());
        this.setPlaceHolder(a.getString());
        this.setFontSize(a._textFieldRenderer.getFontSize());
        this.setFontName(a._textFieldRenderer.getFontName());
        this.setMaxLengthEnabled(a.isMaxLengthEnabled());
        this.setMaxLength(a.getMaxLength());
        this.setPasswordEnabled(a.isPasswordEnabled());
        this.setPasswordStyleText(a._passwordStyleText);
        this.setAttachWithIME(a.getAttachWithIME());
        this.setDetachWithIME(a.getDetachWithIME());
        this.setInsertText(a.getInsertText());
        this.setDeleteBackward(a.getDeleteBackward());
        this._ccEventCallback = a._ccEventCallback;
        this._textFieldEventListener = a._textFieldEventListener;
        this._textFieldEventSelector = a._textFieldEventSelector
    },
    setTextAreaSize: function(a) {
        this.setContentSize(a)
    },
    setTextHorizontalAlignment: function(a) {
        this._textFieldRenderer.setHorizontalAlignment(a)
    },
    setTextVerticalAlignment: function(a) {
        this._textFieldRenderer.setVerticalAlignment(a)
    },
    _setFont: function(a) {
        this._textFieldRenderer._setFont(a);
        this._textFieldRendererAdaptDirty = !0
    },
    _getFont: function() {
        return this._textFieldRenderer._getFont()
    },
    _changePosition: function() {
        this._adaptRenderers()
    }
});
ccui.TextField.create = function(a, b, c) {
    return new ccui.TextField(a, b, c)
};
_p = ccui.TextField.prototype;
cc.defineGetterSetter(_p, "string", _p.getString, _p.setString);
cc.defineGetterSetter(_p, "placeHolder", _p.getPlaceHolder, _p.setPlaceHolder);
cc.defineGetterSetter(_p, "font", _p._getFont, _p._setFont);
cc.defineGetterSetter(_p, "fontSize", _p.getFontSize, _p.setFontSize);
cc.defineGetterSetter(_p, "fontName", _p.getFontName, _p.setFontName);
cc.defineGetterSetter(_p, "maxLengthEnabled", _p.isMaxLengthEnabled, _p.setMaxLengthEnabled);
cc.defineGetterSetter(_p, "maxLength", _p.getMaxLength, _p.setMaxLength);
cc.defineGetterSetter(_p, "passwordEnabled", _p.isPasswordEnabled, _p.setPasswordEnabled);
_p = null;
ccui.TextField.EVENT_ATTACH_WITH_IME = 0;
ccui.TextField.EVENT_DETACH_WITH_IME = 1;
ccui.TextField.EVENT_INSERT_TEXT = 2;
ccui.TextField.EVENT_DELETE_BACKWARD = 3;
ccui.TextField.RENDERER_ZORDER = -1;
ccui.RichElement = ccui.Class.extend({
    _type: 0,
    _tag: 0,
    _color: null,
    _opacity: 0,
    ctor: function(a, b, c) {
        this._type = 0;
        this._tag = a || 0;
        this._color = cc.color(255, 255, 255, 255);
        b && (this._color.r = b.r, this._color.g = b.g, this._color.b = b.b);
        this._opacity = c || 0;
        this._color.a = void 0 === c ? b.a: c
    }
});
ccui.RichElementText = ccui.RichElement.extend({
    _text: "",
    _fontName: "",
    _fontSize: 0,
    _fontDefinition: null,
    ctor: function(a, b, c, d, e, f) {
        var g = b;
        b && b instanceof cc.FontDefinition && (g = b.fillStyle, e = b.fontName, f = b.fontSize, this._fontDefinition = b);
        ccui.RichElement.prototype.ctor.call(this, a, g, c);
        this._type = ccui.RichElement.TEXT;
        this._text = d;
        this._fontName = e;
        this._fontSize = f
    }
});
ccui.RichElementText.create = function(a, b, c, d, e, f) {
    return new ccui.RichElementText(a, b, c, d, e, f)
};
ccui.RichElementImage = ccui.RichElement.extend({
    _filePath: "",
    _textureRect: null,
    _textureType: 0,
    ctor: function(a, b, c, d) {
        ccui.RichElement.prototype.ctor.call(this, a, b, c);
        this._type = ccui.RichElement.IMAGE;
        this._filePath = d || "";
        this._textureRect = cc.rect(0, 0, 0, 0);
        this._textureType = 0
    }
});
ccui.RichElementImage.create = function(a, b, c, d) {
    return new ccui.RichElementImage(a, b, c, d)
};
ccui.RichElementCustomNode = ccui.RichElement.extend({
    _customNode: null,
    ctor: function(a, b, c, d) {
        ccui.RichElement.prototype.ctor.call(this, a, b, c);
        this._type = ccui.RichElement.CUSTOM;
        this._customNode = d || null
    }
});
ccui.RichElementCustomNode.create = function(a, b, c, d) {
    return new ccui.RichElementCustomNode(a, b, c, d)
};
ccui.RichText = ccui.Widget.extend({
    _formatTextDirty: !1,
    _richElements: null,
    _elementRenders: null,
    _leftSpaceWidth: 0,
    _verticalSpace: 0,
    _elementRenderersContainer: null,
    _lineBreakOnSpace: !1,
    _textHorizontalAlignment: null,
    _textVerticalAlignment: null,
    ctor: function() {
        ccui.Widget.prototype.ctor.call(this);
        this._formatTextDirty = !1;
        this._richElements = [];
        this._elementRenders = [];
        this._verticalSpace = this._leftSpaceWidth = 0;
        this._textHorizontalAlignment = cc.TEXT_ALIGNMENT_LEFT;
        this._textVerticalAlignment = cc.VERTICAL_TEXT_ALIGNMENT_TOP
    },
    _initRenderer: function() {
        this._elementRenderersContainer = new cc.Node;
        this._elementRenderersContainer.setAnchorPoint(0.5, 0.5);
        this.addProtectedChild(this._elementRenderersContainer, 0, -1)
    },
    insertElement: function(a, b) {
        this._richElements.splice(b, 0, a);
        this._formatTextDirty = !0
    },
    pushBackElement: function(a) {
        this._richElements.push(a);
        this._formatTextDirty = !0
    },
    removeElement: function(a) {
        cc.isNumber(a) ? this._richElements.splice(a, 1) : cc.arrayRemoveObject(this._richElements, a);
        this._formatTextDirty = !0
    },
    formatText: function() {
        if (this._formatTextDirty) {
            this._elementRenderersContainer.removeAllChildren();
            this._elementRenders.length = 0;
            var a, b, c = this._richElements;
            if (this._ignoreSize) for (this._addNewLine(), a = 0; a < c.length; a++) {
                b = c[a];
                var d = null;
                switch (b._type) {
                case ccui.RichElement.TEXT:
                    d = b._fontDefinition ? new cc.LabelTTF(b._text, b._fontDefinition) : new cc.LabelTTF(b._text, b._fontName, b._fontSize);
                    break;
                case ccui.RichElement.IMAGE:
                    d = new cc.Sprite(b._filePath);
                    break;
                case ccui.RichElement.CUSTOM:
                    d = b._customNode
                }
                d.setColor(b._color);
                d.setOpacity(b._color.a);
                this._pushToContainer(d)
            } else for (this._addNewLine(), a = 0; a < c.length; a++) switch (b = c[a], b._type) {
            case ccui.RichElement.TEXT:
                b._fontDefinition ? this._handleTextRenderer(b._text, b._fontDefinition, b._fontDefinition.fontSize, b._fontDefinition.fillStyle) : this._handleTextRenderer(b._text, b._fontName, b._fontSize, b._color);
                break;
            case ccui.RichElement.IMAGE:
                this._handleImageRenderer(b._filePath, b._color, b._color.a);
                break;
            case ccui.RichElement.CUSTOM:
                this._handleCustomRenderer(b._customNode)
            }
            this.formatRenderers();
            this._formatTextDirty = !1
        }
    },
    _handleTextRenderer: function(a, b, c, d) {
        if ("" !== a) if ("\n" === a) this._addNewLine();
        else {
            var e = b instanceof cc.FontDefinition ? new cc.LabelTTF(a, b) : new cc.LabelTTF(a, b, c),
            f = e.getContentSize().width;
            this._leftSpaceWidth -= f;
            if (0 > this._leftSpaceWidth) {
                var e = a.length * (1 - -this._leftSpaceWidth / f),
                f = a.substr(0, e),
                g = a.substr(e, a.length - 1),
                h = 0 < e;
                this._lineBreakOnSpace && (g = f.lastIndexOf(" "), e = -1 === g ? e: g + 1, g = a.substr(e, a.length - 1), h = 0 < e && " " !== g);
                h && (a = null, b instanceof cc.FontDefinition ? (a = new cc.LabelTTF(f.substr(0, e), b), a.setOpacity(b.fillStyle.a)) : (a = new cc.LabelTTF(f.substr(0, e), b, c), a.setColor(d), a.setOpacity(d.a)), this._pushToContainer(a));
                this._addNewLine();
                this._handleTextRenderer(g, b, c, d)
            } else b instanceof cc.FontDefinition ? e.setOpacity(b.fillStyle.a) : (e.setColor(d), e.setOpacity(d.a)),
            this._pushToContainer(e)
        }
    },
    _handleImageRenderer: function(a, b, c) {
        a = new cc.Sprite(a);
        this._handleCustomRenderer(a)
    },
    _handleCustomRenderer: function(a) {
        var b = a.getContentSize();
        this._leftSpaceWidth -= b.width;
        0 > this._leftSpaceWidth ? (this._addNewLine(), this._pushToContainer(a), this._leftSpaceWidth -= b.width) : this._pushToContainer(a)
    },
    _addNewLine: function() {
        this._leftSpaceWidth = this._customSize.width;
        this._elementRenders.push([])
    },
    formatRenderers: function() {
        var a = 0,
        b = this._elementRenderersContainer,
        c = this._elementRenders,
        d, e, f, g, h, k;
        if (this._ignoreSize) {
            d = 0;
            f = c[0];
            for (e = g = 0; e < f.length; e++) h = f[e],
            h.setAnchorPoint(cc.p(0, 0)),
            h.setPosition(g, 0),
            b.addChild(h, 1, e),
            k = h.getLineHeight ? h.getLineHeight() : a,
            h = h.getContentSize(),
            d += h.width,
            a = Math.max(Math.min(a, k), h.height),
            g += h.width;
            if (this._textHorizontalAlignment !== cc.TEXT_ALIGNMENT_LEFT) for (k = 0, this._textHorizontalAlignment === cc.TEXT_ALIGNMENT_RIGHT ? k = this._contentSize.width - g: this._textHorizontalAlignment === cc.TEXT_ALIGNMENT_CENTER && (k = (this._contentSize.width - g) / 2), e = 0; e < f.length; e++) f[e].x += k;
            b.setContentSize(d, a)
        } else {
            var m = [];
            for (d = 0; d < c.length; d++) {
                f = c[d];
                for (e = g = 0; e < f.length; e++) h = f[e],
                k = h.getLineHeight ? h.getLineHeight() : h.getContentSize().height,
                g = Math.max(Math.min(h.getContentSize().height, k), g);
                m[d] = g;
                a += m[d]
            }
            var r = this._customSize.height;
            for (d = 0; d < c.length; d++) {
                f = c[d];
                g = 0;
                r -= m[d] + this._verticalSpace;
                for (e = 0; e < f.length; e++) h = f[e],
                h.setAnchorPoint(cc.p(0, 0)),
                h.setPosition(cc.p(g, r)),
                b.addChild(h, 1),
                g += h.getContentSize().width;
                if (this._textHorizontalAlignment !== cc.TEXT_ALIGNMENT_LEFT || this._textVerticalAlignment !== cc.VERTICAL_TEXT_ALIGNMENT_TOP) for (k = 0, this._textHorizontalAlignment === cc.TEXT_ALIGNMENT_RIGHT ? k = this._contentSize.width - g: this._textHorizontalAlignment === cc.TEXT_ALIGNMENT_CENTER && (k = (this._contentSize.width - g) / 2), g = 0, this._textVerticalAlignment === cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM ? g = this._customSize.height - a: this._textVerticalAlignment === cc.VERTICAL_TEXT_ALIGNMENT_CENTER && (g = (this._customSize.height - a) / 2), e = 0; e < f.length; e++) h = f[e],
                h.x += k,
                h.y -= g
            }
            b.setContentSize(this._contentSize)
        }
        a = c.length;
        for (d = 0; d < a; d++) c[d].length = 0;
        this._elementRenders.length = 0;
        this.setContentSize(this._ignoreSize ? this.getVirtualRendererSize() : this._customSize);
        this._updateContentSizeWithTextureSize(this._contentSize);
        b.setPosition(0.5 * this._contentSize.width, 0.5 * this._contentSize.height)
    },
    _pushToContainer: function(a) {
        0 >= this._elementRenders.length || this._elementRenders[this._elementRenders.length - 1].push(a)
    },
    _adaptRenderers: function() {
        this.formatText()
    },
    setVerticalSpace: function(a) {
        this._verticalSpace = a
    },
    setAnchorPoint: function(a) {
        ccui.Widget.prototype.setAnchorPoint.call(this, a);
        this._elementRenderersContainer.setAnchorPoint(a)
    },
    _setAnchorX: function(a) {
        ccui.Widget.prototype._setAnchorX.call(this, a);
        this._elementRenderersContainer._setAnchorX(a)
    },
    _setAnchorY: function(a) {
        ccui.Widget.prototype._setAnchorY.call(this, a);
        this._elementRenderersContainer._setAnchorY(a)
    },
    getVirtualRendererSize: function() {
        return this._elementRenderersContainer.getContentSize()
    },
    ignoreContentAdaptWithSize: function(a) {
        this._ignoreSize !== a && (this._formatTextDirty = !0, ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this, a))
    },
    getContentSize: function() {
        this.formatText();
        return cc.Node.prototype.getContentSize.call(this)
    },
    _getWidth: function() {
        this.formatText();
        return cc.Node.prototype._getWidth.call(this)
    },
    _getHeight: function() {
        this.formatText();
        return cc.Node.prototype._getHeight.call(this)
    },
    setContentSize: function(a, b) {
        ccui.Widget.prototype.setContentSize.call(this, void 0 === b ? a.width: a, void 0 === b ? a.height: b);
        this._formatTextDirty = !0
    },
    getDescription: function() {
        return "RichText"
    },
    setCascadeOpacityEnabled: function(a) {
        ccui.Widget.prototype.setCascadeOpacityEnabled.call(this, a);
        this._elementRenderersContainer.setCascadeOpacityEnabled(a)
    },
    setLineBreakOnSpace: function(a) {
        this._lineBreakOnSpace = a;
        this._formatTextDirty = !0;
        this.formatText()
    },
    setTextHorizontalAlignment: function(a) {
        a !== this._textHorizontalAlignment && (this._textHorizontalAlignment = a, this.formatText())
    },
    setTextVerticalAlignment: function(a) {
        a !== this._textVerticalAlignment && (this._textVerticalAlignment = a, this.formatText())
    }
});
ccui.RichText.create = function() {
    return new ccui.RichText
};
ccui.RichElement.TEXT = 0;
ccui.RichElement.IMAGE = 1;
ccui.RichElement.CUSTOM = 2;
cc.Component = cc.Class.extend({
    _owner: null,
    _name: "",
    _enabled: !0,
    ctor: function() {
        this._owner = null;
        this._name = "";
        this._enabled = !0
    },
    init: function() {
        return ! 0
    },
    onEnter: function() {},
    onExit: function() {},
    update: function(a) {},
    serialize: function(a) {},
    isEnabled: function() {
        return this._enabled
    },
    setEnabled: function(a) {
        this._enabled = a
    },
    getName: function() {
        return this._name
    },
    setName: function(a) {
        this._name = a
    },
    setOwner: function(a) {
        this._owner = a
    },
    getOwner: function() {
        return this._owner
    }
});
cc.Component.create = function() {
    return new cc.Component
};
cc.ComponentContainer = cc.Class.extend({
    _components: null,
    _owner: null,
    ctor: function(a) {
        this._components = null;
        this._owner = a
    },
    getComponent: function(a) {
        if (!a) throw Error("cc.ComponentContainer.getComponent(): name should be non-null");
        a = a.trim();
        this._components || (this._components = {});
        return this._components[a]
    },
    add: function(a) {
        if (!a) throw Error("cc.ComponentContainer.add(): component should be non-null");
        if (a.getOwner()) return cc.log("cc.ComponentContainer.add(): Component already added. It can't be added again"),
        !1;
        null == this._components && (this._components = {},
        this._owner.scheduleUpdate());
        if (this._components[a.getName()]) return cc.log("cc.ComponentContainer.add(): Component already added. It can't be added again"),
        !1;
        a.setOwner(this._owner);
        this._components[a.getName()] = a;
        a.onEnter();
        return ! 0
    },
    remove: function(a) {
        if (!a) throw Error("cc.ComponentContainer.remove(): name should be non-null");
        if (!this._components) return ! 1;
        if (a instanceof cc.Component) return this._removeByComponent(a);
        a = a.trim();
        return this._removeByComponent(this._components[a])
    },
    _removeByComponent: function(a) {
        if (!a) return ! 1;
        a.onExit();
        a.setOwner(null);
        delete this._components[a.getName()];
        return ! 0
    },
    removeAll: function() {
        if (this._components) {
            var a = this._components,
            b;
            for (b in a) {
                var c = a[b];
                c.onExit();
                c.setOwner(null);
                delete a[b]
            }
            this._owner.unscheduleUpdate();
            this._components = null
        }
    },
    _alloc: function() {
        this._components = {}
    },
    visit: function(a) {
        if (this._components) {
            var b = this._components,
            c;
            for (c in b) b[c].update(a)
        }
    },
    isEmpty: function() {
        return this._components ? 0 === this._components.length: !0
    }
});
ccui.LayoutComponent_ReferencePoint = {
    BOTTOM_LEFT: 0,
    TOP_LEFT: 1,
    BOTTOM_RIGHT: 2,
    TOP_RIGHT: 3
};
ccui.LayoutComponent_PositionType = {
    Position: 0,
    RelativePosition: 1,
    PreRelativePosition: 2,
    PreRelativePositionEnable: 3
};
ccui.LayoutComponent_SizeType = {
    Size: 0,
    PreSize: 1,
    PreSizeEnable: 2
};
ccui.LayoutComponent = cc.Component.extend({
    _horizontalEdge: 0,
    _verticalEdge: 0,
    _leftMargin: 0,
    _rightMargin: 0,
    _bottomMargin: 0,
    _topMargin: 0,
    _usingPositionPercentX: !1,
    _positionPercentX: 0,
    _usingPositionPercentY: !1,
    _positionPercentY: 0,
    _usingStretchWidth: !1,
    _usingStretchHeight: !1,
    _percentWidth: 0,
    _usingPercentWidth: !1,
    _percentHeight: 0,
    _usingPercentHeight: !1,
    _actived: !0,
    _isPercentOnly: !1,
    ctor: function() {
        this._name = ccui.LayoutComponent.NAME
    },
    init: function() {
        return cc.Component.prototype.init.call(this) ? !0 : !1
    },
    getPercentContentSize: function() {
        return cc.p(this._percentWidth, this._percentHeight)
    },
    setPercentContentSize: function(a) {
        this.setPercentWidth(a.x);
        this.setPercentHeight(a.y)
    },
    setUsingPercentContentSize: function(a) {
        this._usingPercentWidth = this._usingPercentHeight = a
    },
    SetActiveEnable: function(a) {
        this._actived = a
    },
    getUsingPercentContentSize: function() {
        return this._usingPercentWidth && this._usingPercentHeight
    },
    getAnchorPosition: function() {
        return this._owner.getAnchorPoint()
    },
    setAnchorPosition: function(a, b) {
        var c = this._owner.getBoundingBox();
        this._owner.setAnchorPoint(a, b);
        var d = this._owner.getBoundingBox(),
        e = c.x - d.x,
        c = c.y - d.y,
        d = this._owner.getPosition();
        d.x += e;
        d.y += c;
        this.setPosition(d)
    },
    getPosition: function() {
        return this._owner.getPosition()
    },
    setPosition: function(a, b) {
        var c = this._getOwnerParent(),
        d;
        null != c ? (void 0 === b ? (d = a.x, b = a.y) : d = a, c = c.getContentSize(), 0 !== c.width ? this._positionPercentX = d / c.width: (this._positionPercentX = 0, this._usingPositionPercentX && (d = 0)), 0 !== c.height ? this._positionPercentY = b / c.height: (this._positionPercentY = 0, this._usingPositionPercentY && (b = 0)), this._owner.setPosition(d, b), this._refreshHorizontalMargin(), this._refreshVerticalMargin()) : this._owner.setPosition(a, b)
    },
    isPositionPercentXEnabled: function() {
        return this._usingPositionPercentX
    },
    setPositionPercentXEnabled: function(a) {
        if (this._usingPositionPercentX = a) this._horizontalEdge = ccui.LayoutComponent.horizontalEdge.NONE
    },
    getPositionPercentX: function() {
        return this._positionPercentX
    },
    setPositionPercentX: function(a) {
        this._positionPercentX = a;
        a = this._getOwnerParent();
        null !== a && (this._owner.setPositionX(a.width * this._positionPercentX), this._refreshHorizontalMargin())
    },
    isPositionPercentYEnabled: function() {
        return this._usingPositionPercentY
    },
    setPositionPercentYEnabled: function(a) {
        if (this._usingPositionPercentY = a) this._verticalEdge = ccui.LayoutComponent.verticalEdge.NONE
    },
    getPositionPercentY: function() {
        return this._positionPercentY
    },
    setPositionPercentY: function(a) {
        this._positionPercentY = a;
        a = this._getOwnerParent();
        null !== a && (this._owner.setPositionY(a.height * this._positionPercentY), this._refreshVerticalMargin())
    },
    getHorizontalEdge: function() {
        return this._horizontalEdge
    },
    setHorizontalEdge: function(a) {
        this._horizontalEdge = a;
        this._horizontalEdge !== ccui.LayoutComponent.horizontalEdge.NONE && (this._usingPositionPercentX = !1);
        var b = this._getOwnerParent();
        null !== b && (a = this._owner.getPosition(), b = b.getContentSize(), 0 !== b.width ? this._positionPercentX = a.x / b.width: (this._positionPercentX = 0, a.x = 0, this._usingPositionPercentX && this._owner.setPosition(a)), this._refreshHorizontalMargin())
    },
    getVerticalEdge: function() {
        return this._verticalEdge
    },
    setVerticalEdge: function(a) {
        this._verticalEdge = a;
        this._verticalEdge !== ccui.LayoutComponent.verticalEdge.NONE && (this._usingPositionPercentY = !1);
        var b = this._getOwnerParent();
        null !== b && (a = this._owner.getPosition(), b = b.getContentSize(), 0 !== b.height ? this._positionPercentY = a.y / b.height: (this._positionPercentY = 0, a.y = 0, this._usingPositionPercentY && this._owner.setPosition(a)), this._refreshVerticalMargin())
    },
    getLeftMargin: function() {
        return this._leftMargin
    },
    setLeftMargin: function(a) {
        this._leftMargin = a
    },
    getRightMargin: function() {
        return this._rightMargin
    },
    setRightMargin: function(a) {
        this._rightMargin = a
    },
    getTopMargin: function() {
        return this._topMargin
    },
    setTopMargin: function(a) {
        this._topMargin = a
    },
    getBottomMargin: function() {
        return this._bottomMargin
    },
    setBottomMargin: function(a) {
        this._bottomMargin = a
    },
    getSize: function() {
        return this.getOwner().getContentSize()
    },
    setSize: function(a) {
        var b = this._getOwnerParent();
        null !== b ? (b = b.getContentSize(), 0 !== b.width ? this._percentWidth = a.width / b.width: (this._percentWidth = 0, this._usingPercentWidth && (a.width = 0)), 0 !== b.height ? this._percentHeight = a.height / b.height: (this._percentHeight = 0, this._usingPercentHeight && (a.height = 0)), this._owner.setContentSize(a), this._refreshHorizontalMargin(), this._refreshVerticalMargin()) : this._owner.setContentSize(a)
    },
    isPercentWidthEnabled: function() {
        return this._usingPercentWidth
    },
    setPercentWidthEnabled: function(a) {
        if (this._usingPercentWidth = a) this._usingStretchWidth = !1
    },
    getSizeWidth: function() {
        return this._owner.width
    },
    setSizeWidth: function(a) {
        var b = this._owner.getContentSize();
        b.width = a;
        a = this._getOwnerParent();
        null !== a ? (a = a.getContentSize(), 0 !== a.width ? this._percentWidth = b.width / a.width: (this._percentWidth = 0, this._usingPercentWidth && (b.width = 0)), this._owner.setContentSize(b), this._refreshHorizontalMargin()) : this._owner.setContentSize(b)
    },
    getPercentWidth: function() {
        return this._percentWidth
    },
    setPercentWidth: function(a) {
        this._percentWidth = a;
        a = this._getOwnerParent();
        if (null !== a) {
            var b = this._owner.getContentSize();
            b.width = a.width * this._percentWidth;
            this._owner.setContentSize(b);
            this._refreshHorizontalMargin()
        }
    },
    isPercentHeightEnabled: function() {
        return this._usingPercentHeight
    },
    setPercentHeightEnabled: function(a) {
        if (this._usingPercentHeight = a) this._usingStretchHeight = !1
    },
    getSizeHeight: function() {
        return this._owner.height
    },
    setSizeHeight: function(a) {
        var b = this._owner.getContentSize();
        b.height = a;
        a = this._getOwnerParent();
        null !== a ? (a = a.getContentSize(), 0 !== a.height ? this._percentHeight = b.height / a.height: (this._percentHeight = 0, this._usingPercentHeight && (b.height = 0)), this._owner.setContentSize(b), this._refreshVerticalMargin()) : this._owner.setContentSize(b)
    },
    getPercentHeight: function() {
        return this._percentHeight
    },
    setPercentHeight: function(a) {
        this._percentHeight = a;
        a = this._getOwnerParent();
        if (null !== a) {
            var b = this._owner.getContentSize();
            b.height = a.height * this._percentHeight;
            this._owner.setContentSize(b);
            this._refreshVerticalMargin()
        }
    },
    isStretchWidthEnabled: function() {
        return this._usingStretchWidth
    },
    setStretchWidthEnabled: function(a) {
        if (this._usingStretchWidth = a) this._usingPercentWidth = !1
    },
    isStretchHeightEnabled: function() {
        return this._usingStretchHeight
    },
    setStretchHeightEnabled: function(a) {
        if (this._usingStretchHeight = a) this._usingPercentHeight = !1
    },
    setPercentOnlyEnabled: function(a) {
        this._isPercentOnly = a
    },
    setActiveEnabled: function(a) {
        this._actived = a
    },
    refreshLayout: function() {
        if (this._actived) {
            var a = this._getOwnerParent();
            if (null !== a) {
                var a = a.getContentSize(),
                b = this._owner,
                c = b.getAnchorPoint(),
                d = b.getContentSize(),
                e = b.getPosition();
                switch (this._horizontalEdge) {
                case ccui.LayoutComponent.horizontalEdge.NONE:
                    this._usingStretchWidth && !this._isPercentOnly ? (d.width = a.width * this._percentWidth, e.x = this._leftMargin + c.x * d.width) : (this._usingPositionPercentX && (e.x = a.width * this._positionPercentX), this._usingPercentWidth && (d.width = a.width * this._percentWidth));
                    break;
                case ccui.LayoutComponent.horizontalEdge.LEFT:
                    if (this._isPercentOnly) break;
                    if (this._usingPercentWidth || this._usingStretchWidth) d.width = a.width * this._percentWidth;
                    e.x = this._leftMargin + c.x * d.width;
                    break;
                case ccui.LayoutComponent.horizontalEdge.RIGHT:
                    if (this._isPercentOnly) break;
                    if (this._usingPercentWidth || this._usingStretchWidth) d.width = a.width * this._percentWidth;
                    e.x = a.width - (this._rightMargin + (1 - c.x) * d.width);
                    break;
                case ccui.LayoutComponent.horizontalEdge.CENTER:
                    if (this._isPercentOnly) break;
                    this._usingStretchWidth ? (d.width = a.width - this._leftMargin - this._rightMargin, 0 > d.width && (d.width = 0), e.x = this._leftMargin + c.x * d.width) : (this._usingPercentWidth && (d.width = a.width * this._percentWidth), e.x = a.width * this._positionPercentX)
                }
                switch (this._verticalEdge) {
                case ccui.LayoutComponent.verticalEdge.NONE:
                    this._usingStretchHeight && !this._isPercentOnly ? (d.height = a.height * this._percentHeight, e.y = this._bottomMargin + c.y * d.height) : (this._usingPositionPercentY && (e.y = a.height * this._positionPercentY), this._usingPercentHeight && (d.height = a.height * this._percentHeight));
                    break;
                case ccui.LayoutComponent.verticalEdge.BOTTOM:
                    if (this._isPercentOnly) break;
                    if (this._usingPercentHeight || this._usingStretchHeight) d.height = a.height * this._percentHeight;
                    e.y = this._bottomMargin + c.y * d.height;
                    break;
                case ccui.LayoutComponent.verticalEdge.TOP:
                    if (this._isPercentOnly) break;
                    if (this._usingPercentHeight || this._usingStretchHeight) d.height = a.height * this._percentHeight;
                    e.y = a.height - (this._topMargin + (1 - c.y) * d.height);
                    break;
                case ccui.LayoutComponent.verticalEdge.CENTER:
                    if (this._isPercentOnly) break;
                    this._usingStretchHeight ? (d.height = a.height - this._topMargin - this._bottomMargin, 0 > d.height && (d.height = 0), e.y = this._bottomMargin + c.y * d.height) : (this._usingPercentHeight && (d.height = a.height * this._percentHeight), e.y = a.height * this._positionPercentY)
                }
                b.setPosition(e);
                b.setContentSize(d);
                ccui.helper.doLayout(b)
            }
        }
    },
    _getOwnerParent: function() {
        return this._owner ? this._owner.getParent() : null
    },
    _refreshHorizontalMargin: function() {
        var a = this._getOwnerParent();
        if (null !== a) {
            var b = this._owner.getPosition(),
            c = this._owner.getAnchorPoint(),
            d = this._owner.getContentSize(),
            a = a.getContentSize();
            this._leftMargin = b.x - c.x * d.width;
            this._rightMargin = a.width - (b.x + (1 - c.x) * d.width)
        }
    },
    _refreshVerticalMargin: function() {
        var a = this._getOwnerParent();
        if (null !== a) {
            var b = this._owner.getPosition(),
            c = this._owner.getAnchorPoint(),
            d = this._owner.getContentSize(),
            a = a.getContentSize();
            this._bottomMargin = b.y - c.y * d.height;
            this._topMargin = a.height - (b.y + (1 - c.y) * d.height)
        }
    }
});
ccui.LayoutComponent.horizontalEdge = {
    NONE: 0,
    LEFT: 1,
    RIGHT: 2,
    CENTER: 3
};
ccui.LayoutComponent.verticalEdge = {
    NONE: 0,
    BOTTOM: 1,
    TOP: 2,
    CENTER: 3
};
ccui.LayoutComponent.NAME = "__ui_layout";
ccui.LayoutComponent.bindLayoutComponent = function(a) {
    var b = a.getComponent(ccui.LayoutComponent.NAME);
    if (void 0 !== b) return b;
    b = new ccui.LayoutComponent;
    b.init();
    a.addComponent(b);
    a instanceof ccui.Widget || a.addEventListener && a.addEventListener("load",
    function() {
        b.refreshLayout()
    },
    this);
    return b
};
var ccs = ccs || {};
ccs.Class = ccs.Class || cc.Class;
ccs.Class.extend = ccs.Class.extend || cc.Class.extend;
ccs.Node = ccs.Node || cc.Node;
ccs.Node.extend = ccs.Node.extend || cc.Node.extend;
ccs.Sprite = ccs.Sprite || cc.Sprite;
ccs.Sprite.extend = ccs.Sprite.extend || cc.Sprite.extend;
ccs.Component = ccs.Component || cc.Component;
ccs.Component.extend = ccs.Component.extend || cc.Component.extend;
ccs.cocostudioVersion = "v1.3.0.0";
ccs.ActionTimelineData = ccs.Class.extend({
    _actionTag: 0,
    ctor: function(a) {
        this._init(a)
    },
    _init: function(a) {
        this._actionTag = a;
        return ! 0
    },
    setActionTag: function(a) {
        this._actionTag = a
    },
    getActionTag: function() {
        return this._actionTag
    }
});
ccs.AnimationInfo = function(a, b, c) {
    this.name = a;
    this.startIndex = b;
    this.endIndex = c
};
ccs.ComExtensionData = ccs.Component.extend({
    _customProperty: null,
    _timelineData: null,
    _name: "ComExtensionData",
    ctor: function() {
        this._customProperty = "";
        this._timelineData = new ccs.ActionTimelineData(0);
        return ! 0
    },
    setActionTag: function(a) {
        this._timelineData.setActionTag(a)
    },
    getActionTag: function() {
        return this._timelineData.getActionTag()
    },
    setCustomProperty: function(a) {
        this._customProperty = a
    },
    getCustomProperty: function() {
        return this._customProperty
    }
});
ccs.ComExtensionData.create = function() {
    return new ccs.ComExtensionData
};
ccs.ActionTimelineData.create = function(a) {
    return new ccs.ActionTimelineData(a)
};
ccs.ActionTimeline = cc.Action.extend({
    _timelineMap: null,
    _timelineList: null,
    _duration: 0,
    _time: null,
    _timeSpeed: 1,
    _frameInternal: 1 / 60,
    _playing: !1,
    _currentFrame: 0,
    _startFrame: 0,
    _endFrame: 0,
    _loop: null,
    _frameEventListener: null,
    _animationInfos: null,
    _lastFrameListener: null,
    ctor: function() {
        cc.Action.prototype.ctor.call(this);
        this._timelineMap = {};
        this._timelineList = [];
        this._animationInfos = {};
        this.init()
    },
    _gotoFrame: function(a) {
        for (var b = this._timelineList.length,
        c = 0; c < b; c++) this._timelineList[c]._gotoFrame(a)
    },
    _stepToFrame: function(a) {
        for (var b = this._timelineList.length,
        c = 0; c < b; c++) this._timelineList[c]._stepToFrame(a)
    },
    _emitFrameEvent: function(a) {
        this._frameEventListener && this._frameEventListener(a)
    },
    init: function() {
        return ! 0
    },
    gotoFrameAndPlay: function(a, b, c, d) {
        var e = 0,
        f = arguments.length,
        g = [],
        h;
        for (e; e < f; e++)"boolean" === typeof arguments[e] ? h = arguments[e] : g.push(arguments[e]);
        a = g[0];
        b = void 0 !== g[1] ? g[1] : this._duration;
        c = g[2] || a;
        this._startFrame = a;
        this._endFrame = b;
        this._currentFrame = c;
        this._loop = null != h ? h: !0;
        this._time = this._currentFrame * this._frameInternal;
        this.resume();
        this._gotoFrame(this._currentFrame)
    },
    gotoFrameAndPause: function(a) {
        this._startFrame = this._currentFrame = a;
        this._time = this._currentFrame * this._frameInternal;
        this.pause();
        this._gotoFrame(this._currentFrame)
    },
    pause: function() {
        this._playing = !1
    },
    resume: function() {
        this._playing = !0
    },
    isPlaying: function() {
        return this._playing
    },
    setTimeSpeed: function(a) {
        this._timeSpeed = a
    },
    getTimeSpeed: function() {
        return this._timeSpeed
    },
    setDuration: function(a) {
        this._duration = a
    },
    getDuration: function() {
        return this._duration
    },
    getStartFrame: function() {
        return this._startFrame
    },
    getEndFrame: function() {
        return this._endFrame
    },
    setCurrentFrame: function(a) {
        a >= this._startFrame && a <= this._endFrame ? (this._currentFrame = a, this._time = this._currentFrame * this._frameInternal) : cc.log("frame index is not between start frame and end frame")
    },
    getCurrentFrame: function() {
        return this._currentFrame
    },
    addTimeline: function(a) {
        var b = a.getActionTag();
        this._timelineMap[b] || (this._timelineMap[b] = []); - 1 === this._timelineMap[b].indexOf(a) && (this._timelineList.push(a), this._timelineMap[b].push(a), a.setActionTimeline(this))
    },
    removeTimeline: function(a) {
        var b = a.getActionTag();
        this._timelineMap[b] && this._timelineMap[b].some(function(b) {
            if (b === a) return ! 0
        }) && (cc.arrayRemoveObject(this._timelineMap[b], a), cc.arrayRemoveObject(this._timelineList, a), a.setActionTimeline(null))
    },
    getTimelines: function() {
        return this._timelineList
    },
    setFrameEventCallFunc: function(a) {
        this._frameEventListener = a
    },
    clearFrameEventCallFunc: function() {
        this._frameEventListener = null
    },
    clone: function() {
        var a = new ccs.ActionTimeline;
        a.setDuration(this._duration);
        a.setTimeSpeed(this._timeSpeed);
        for (var b in this._timelineMap) {
            var c = this._timelineMap[b],
            d;
            for (d in c) {
                var e = c[d].clone();
                a.addTimeline(e)
            }
        }
        return a
    },
    reverse: function() {
        return null
    },
    step: function(a) {
        this._playing && 0 !== this._timelineMap.length && 0 !== this._duration && (this._time += a * this._timeSpeed, a = this._time - this._endFrame * this._frameInternal, a < this._frameInternal ? (this._currentFrame = Math.floor(this._time / this._frameInternal), this._stepToFrame(this._currentFrame), 0 <= a && this._lastFrameListener && this._lastFrameListener()) : (this._playing = this._loop) ? this.gotoFrameAndPlay(this._startFrame, this._endFrame, this._loop) : (this._time = this._endFrame * this._frameInternal, this._currentFrame != this._endFrame && (this._currentFrame = this._endFrame, this._stepToFrame(this._currentFrame), this._lastFrameListener && this._lastFrameListener())))
    },
    _foreachNodeDescendant: function(a, b) {
        b(a);
        for (var c = a.getChildren(), d = 0; d < c.length; d++) this._foreachNodeDescendant(c[d], b)
    },
    startWithTarget: function(a) {
        cc.Action.prototype.startWithTarget.call(this, a);
        var b = this;
        this._foreachNodeDescendant(a,
        function(a) {
            var d = a.getComponent("ComExtensionData");
            if (d && (d = d.getActionTag(), b._timelineMap[d])) for (var d = b._timelineMap[d], e = 0; e < d.length; e++) d[e].setNode(a)
        })
    },
    isDone: function() {
        return ! 1
    },
    play: function(a, b) {
        var c = this._animationInfos[a];
        if (!c) return cc.log("Can't find animation info for %s", a);
        this.gotoFrameAndPlay(c.startIndex, c.endIndex, b)
    },
    addAnimationInfo: function(a) {
        this._animationInfos[a.name] = a
    },
    removeAnimationInfo: function(a) {
        delete this._animationInfos[a]
    },
    isAnimationInfoExists: function(a) {
        return this._animationInfos[a]
    },
    getAnimationInfo: function(a) {
        return this._animationInfos[a]
    },
    setLastFrameCallFunc: function(a) {
        this._lastFrameListener = a
    },
    clearLastFrameCallFunc: function() {
        this._lastFrameListener = null
    }
});
ccs.ActionTimeline.create = function() {
    return new ccs.ActionTimeline
};
ccs.Frame = ccs.Class.extend({
    _frameIndex: null,
    _tween: null,
    _timeline: null,
    _node: null,
    _tweenType: null,
    _easingParam: null,
    _enterWhenPassed: null,
    ctor: function() {
        this._frameIndex = 0;
        this._tween = !0;
        this._node = this._timeline = null;
        this._enterWhenPassed = !1;
        this._easingParam = []
    },
    _emitEvent: function() {
        this._timeline && this._timeline.getActionTimeline()._emitFrameEvent(this)
    },
    _cloneProperty: function(a) {
        this._frameIndex = a.getFrameIndex();
        this._tween = a.isTween();
        this._tweenType = a.getTweenType();
        this.setEasingParams(a.getEasingParams())
    },
    setFrameIndex: function(a) {
        this._frameIndex = a
    },
    getFrameIndex: function() {
        return this._frameIndex
    },
    setTimeline: function(a) {
        this._timeline = a
    },
    getTimeline: function(a) {
        return this._timeline
    },
    setNode: function(a) {
        this._node = a
    },
    getNode: function() {
        return this._node
    },
    setTween: function(a) {
        this._tween = a
    },
    isTween: function() {
        return this._tween
    },
    onEnter: function(a) {},
    apply: function(a) {
        this._tween && (this._tweenType !== ccs.FrameEaseType.TWEEN_EASING_MAX && this._tweenType !== ccs.FrameEaseType.LINEAR && (a = this.tweenPercent(a)), this._onApply(a))
    },
    _onApply: function(a) {},
    clone: function() {},
    tweenPercent: function(a) {
        var b = ccs.Frame.tweenToMap[this._tweenType];
        return b ? b(a, this._easingParam) : a
    },
    setEasingParams: function(a) {
        if (a) for (var b = this._easingParam.length = 0; b < a.length; b++) this._easingParam[b] = a[b]
    },
    getEasingParams: function() {
        return this._easingParam
    },
    setTweenType: function(a) {
        this._tweenType = a
    },
    getTweenType: function() {
        return this._tweenType
    },
    isEnterWhenPassed: function() {
        return this._enterWhenPassed
    }
});
ccs.Frame.tweenToMap = {
    "-1": function(a, b) {
        if (b) {
            var c = 1 - a;
            return b[1] * c * c * c + 3 * b[3] * a * c * c + 3 * b[5] * a * a * c + b[7] * a * a * a
        }
        return a
    },
    1 : cc._easeSineInObj.easing,
    2 : cc._easeSineOutObj.easing,
    3 : cc._easeSineInOutObj.easing,
    4 : cc._easeQuadraticActionIn.easing,
    5 : cc._easeQuadraticActionOut.easing,
    6 : cc._easeQuadraticActionInOut.easing,
    7 : cc._easeCubicActionIn.easing,
    8 : cc._easeCubicActionOut.easing,
    9 : cc._easeCubicActionInOut.easing,
    10 : cc._easeCubicActionIn.easing,
    11 : cc._easeCubicActionOut.easing,
    12 : cc._easeCubicActionInOut.easing,
    13 : cc._easeQuinticActionIn.easing,
    14 : cc._easeQuinticActionOut.easing,
    15 : cc._easeQuinticActionInOut.easing,
    16 : cc._easeExponentialInObj.easing,
    17 : cc._easeExponentialOutObj.easing,
    18 : cc._easeExponentialInOutObj.easing,
    19 : cc._easeCircleActionIn.easing,
    20 : cc._easeCircleActionOut.easing,
    21 : cc._easeCircleActionInOut.easing,
    22 : function(a, b) {
        var c = 0.3;
        null != b && (c = b[0]);
        return cc.easeElasticIn(c).easing(a)
    },
    23 : function(a, b) {
        var c = 0.3;
        null != b && (c = b[0]);
        return cc.easeElasticOut(c).easing(a)
    },
    24 : function(a, b) {
        var c = 0.3;
        null != b && (c = b[0]);
        return cc.easeElasticInOut(c).easing(a)
    },
    25 : cc._easeBackInObj.easing,
    26 : cc._easeBackOutObj.easing,
    27 : cc._easeBackInOutObj.easing,
    28 : cc._easeBounceInObj.easing,
    29 : cc._easeBounceOutObj.easing,
    30 : cc._easeBounceInOutObj.easing
};
ccs.VisibleFrame = ccs.Frame.extend({
    _visible: !0,
    ctor: function() {
        ccs.Frame.prototype.ctor.call(this);
        this._visible = !0
    },
    onEnter: function(a) {
        this._node && this._node.setVisible(this._visible)
    },
    clone: function() {
        var a = new ccs.VisibleFrame;
        a.setVisible(this._visible);
        a._cloneProperty(this);
        return a
    },
    setVisible: function(a) {
        this._visible = a
    },
    isVisible: function() {
        return this._visible
    }
});
ccs.VisibleFrame.create = function() {
    return new ccs.VisibleFrame
};
ccs.TextureFrame = ccs.Frame.extend({
    _sprite: null,
    _textureName: null,
    ctor: function() {
        ccs.Frame.prototype.ctor.call(this);
        this._textureName = ""
    },
    setNode: function(a) {
        ccs.Frame.prototype.setNode.call(this, a);
        this._sprite = a
    },
    onEnter: function(a) {
        if (this._sprite) {
            a = this._sprite.getBlendFunc();
            var b = cc.spriteFrameCache._spriteFrames[this._textureName];
            null != b ? this._sprite.setSpriteFrame(b) : this._sprite.setTexture(this._textureName);
            this._sprite.getBlendFunc() !== a && this._sprite.setBlendFunc(a)
        }
    },
    clone: function() {
        var a = new ccs.TextureFrame;
        a.setTextureName(this._textureName);
        a._cloneProperty(this);
        return a
    },
    setTextureName: function(a) {
        this._textureName = a
    },
    getTextureName: function() {
        return this._textureName
    }
});
ccs.TextureFrame.create = function() {
    return new ccs.TextureFrame
};
ccs.RotationFrame = ccs.Frame.extend({
    _rotation: null,
    _betwennRotation: null,
    ctor: function() {
        ccs.Frame.prototype.ctor.call(this);
        this._rotation = 0
    },
    onEnter: function(a) {
        this._node && (this._node.setRotation(this._rotation), this._tween && (this._betwennRotation = a._rotation - this._rotation))
    },
    _onApply: function(a) {
        0 !== this._betwennRotation && this._node.setRotation(this._rotation + a * this._betwennRotation)
    },
    clone: function() {
        var a = new ccs.RotationFrame;
        a.setRotation(this._rotation);
        a._cloneProperty(this);
        return a
    },
    setRotation: function(a) {
        this._rotation = a
    },
    getRotation: function() {
        return this._rotation
    }
});
ccs.RotationFrame.create = function() {
    return new ccs.RotationFrame
};
ccs.SkewFrame = ccs.Frame.extend({
    _skewX: null,
    _skewY: null,
    _betweenSkewX: null,
    _betweenSkewY: null,
    ctor: function() {
        ccs.Frame.prototype.ctor.call(this);
        this._skewY = this._skewX = 0
    },
    onEnter: function(a) {
        this._node && (this._node.setSkewX(this._skewX), this._node.setSkewY(this._skewY), this._tween && (this._betweenSkewX = a._skewX - this._skewX, this._betweenSkewY = a._skewY - this._skewY))
    },
    _onApply: function(a) {
        if (0 !== this._betweenSkewX || 0 !== this._betweenSkewY) {
            var b = this._skewY + a * this._betweenSkewY;
            this._node.setSkewX(this._skewX + a * this._betweenSkewX);
            this._node.setSkewY(b)
        }
    },
    clone: function() {
        var a = new ccs.SkewFrame;
        a.setSkewX(this._skewX);
        a.setSkewY(this._skewY);
        a._cloneProperty(this);
        return a
    },
    setSkewX: function(a) {
        this._skewX = a
    },
    getSkewX: function() {
        return this._skewX
    },
    setSkewY: function(a) {
        this._skewY = a
    },
    getSkewY: function() {
        return this._skewY
    }
});
ccs.SkewFrame.create = function() {
    return new ccs.SkewFrame
};
ccs.RotationSkewFrame = ccs.SkewFrame.extend({
    onEnter: function(a) {
        this._node && (this._node.setRotationX(this._skewX), this._node.setRotationY(this._skewY), this._tween && (this._betweenSkewX = a._skewX - this._skewX, this._betweenSkewY = a._skewY - this._skewY))
    },
    _onApply: function(a) {
        if (this._node && (0 !== this._betweenSkewX || 0 !== this._betweenSkewY)) {
            var b = this._skewY + a * this._betweenSkewY;
            this._node.setRotationX(this._skewX + a * this._betweenSkewX);
            this._node.setRotationY(b)
        }
    },
    clone: function() {
        var a = new ccs.RotationSkewFrame;
        a.setSkewX(this._skewX);
        a.setSkewY(this._skewY);
        a._cloneProperty(this);
        return a
    }
});
ccs.RotationSkewFrame.create = function() {
    return new ccs.RotationSkewFrame
};
ccs.PositionFrame = ccs.Frame.extend({
    _position: null,
    _betweenX: null,
    _betweenY: null,
    ctor: function() {
        ccs.Frame.prototype.ctor.call(this);
        this._position = cc.p(0, 0)
    },
    onEnter: function(a) {
        this._node && (this._node.setPosition(this._position), this._tween && (this._betweenX = a._position.x - this._position.x, this._betweenY = a._position.y - this._position.y))
    },
    _onApply: function(a) {
        if (this._node && (0 !== this._betweenX || 0 !== this._betweenY)) {
            var b = cc.p(0, 0);
            b.x = this._position.x + this._betweenX * a;
            b.y = this._position.y + this._betweenY * a;
            this._node.setPosition(b)
        }
    },
    clone: function() {
        var a = new ccs.PositionFrame;
        a.setPosition(this._position);
        a._cloneProperty(this);
        return a
    },
    setPosition: function(a) {
        this._position = a
    },
    getPosition: function() {
        return this._position
    },
    setX: function(a) {
        this._position.x = a
    },
    getX: function() {
        return this._position.x
    },
    setY: function(a) {
        this._position.y = a
    },
    getY: function() {
        return this._position.y
    }
});
ccs.PositionFrame.create = function() {
    return new ccs.PositionFrame
};
ccs.ScaleFrame = ccs.Frame.extend({
    _scaleX: null,
    _scaleY: null,
    _betweenScaleX: null,
    _betweenScaleY: null,
    ctor: function() {
        ccs.Frame.prototype.ctor.call(this);
        this._scaleY = this._scaleX = 1
    },
    onEnter: function(a) {
        this._node && (this._node.setScaleX(this._scaleX), this._node.setScaleY(this._scaleY), this._tween && (this._betweenScaleX = a._scaleX - this._scaleX, this._betweenScaleY = a._scaleY - this._scaleY))
    },
    _onApply: function(a) {
        if (this._node && (0 !== this._betweenScaleX || 0 !== this._betweenScaleY)) {
            var b = this._scaleY + this._betweenScaleY * a;
            this._node.setScaleX(this._scaleX + this._betweenScaleX * a);
            this._node.setScaleY(b)
        }
    },
    clone: function() {
        var a = new ccs.ScaleFrame;
        a.setScaleX(this._scaleX);
        a.setScaleY(this._scaleY);
        a._cloneProperty(this);
        return a
    },
    setScale: function(a) {
        this._scaleY = this._scaleX = a
    },
    setScaleX: function(a) {
        this._scaleX = a
    },
    getScaleX: function() {
        return this._scaleX
    },
    setScaleY: function(a) {
        this._scaleY = a
    },
    getScaleY: function() {
        return this._scaleY
    }
});
ccs.ScaleFrame.create = function() {
    return new ccs.ScaleFrame
};
ccs.AnchorPointFrame = ccs.Frame.extend({
    _anchorPoint: null,
    ctor: function() {
        ccs.Frame.prototype.ctor.call(this);
        this._anchorPoint = cc.p(0, 0)
    },
    onEnter: function(a) {
        this._node && this._node.setAnchorPoint(this._anchorPoint)
    },
    clone: function() {
        var a = new ccs.AnchorPointFrame;
        a.setAnchorPoint(this._anchorPoint);
        a._cloneProperty(this);
        return a
    },
    setAnchorPoint: function(a) {
        this._anchorPoint = a
    },
    getAnchorPoint: function() {
        return this._anchorPoint
    }
});
ccs.AnchorPointFrame.create = function() {
    return new ccs.AnchorPointFrame
};
ccs.InnerActionType = {
    LoopAction: 0,
    NoLoopAction: 1,
    SingleFrame: 2
};
ccs.InnerActionFrame = ccs.Frame.extend({
    _innerActionType: null,
    _startFrameIndex: null,
    _endFrameIndex: 0,
    _singleFrameIndex: 0,
    _enterWithName: null,
    _animationName: "",
    ctor: function() {
        ccs.Frame.prototype.ctor.call(this);
        this._enterWithName = !1;
        this._innerActionType = ccs.InnerActionType.LoopAction;
        this._startFrameIndex = 0
    },
    onEnter: function(a) {
        if (this._node && (a = this._node.getActionByTag(this._node.getTag()))) if (ccs.InnerActionType.SingleFrame === this._innerActionType) a.gotoFrameAndPause(this._singleFrameIndex);
        else {
            var b = this._startFrameIndex,
            c = this._endFrameIndex;
            this._enterWithName && ("-- ALL --" === this._animationName ? (b = 0, c = a.getDuration()) : a.isAnimationInfoExists(this._animationName) ? (c = a.getAnimationInfo(this._animationName), b = c.startIndex, c = c.endIndex) : cc.log("Animation %s not exists!", this._animationName));
            var d = this._timeline.getActionTimeline().getDuration() - this._frameIndex - c + b;
            0 > d && (c += d);
            ccs.InnerActionType.NoLoopAction === this._innerActionType ? a.gotoFrameAndPlay(b, c, !1) : ccs.InnerActionType.LoopAction === this._innerActionType && a.gotoFrameAndPlay(b, c, !0)
        }
    },
    setAnimationName: function(a) {
        this._animationName = a
    },
    setSingleFrameIndex: function(a) {
        this._singleFrameIndex = a
    },
    getSingleFrameIndex: function() {
        return this._startFrameIndex
    },
    setEnterWithName: function(a) {
        this._enterWithName = a
    },
    getEnterWithName: function() {
        return this._enterWithName
    },
    clone: function() {
        var a = new ccs.InnerActionFrame;
        a.setInnerActionType(this._innerActionType);
        a.setStartFrameIndex(this._startFrameIndex);
        a.setEnterWithName(this._enterWithName);
        a.setAnimationName(this._animationName);
        a.setSingleFrameIndex(this._singleFrameIndex);
        a._cloneProperty(this);
        return a
    },
    setInnerActionType: function(a) {
        this._innerActionType = a
    },
    getInnerActionType: function() {
        return this._innerActionType
    },
    setStartFrameIndex: function(a) {
        this._startFrameIndex = a
    },
    getStartFrameIndex: function() {
        return this._startFrameIndex
    }
});
ccs.InnerActionFrame.create = function() {
    return new ccs.InnerActionFrame
};
ccs.ColorFrame = ccs.Frame.extend({
    _alpha: null,
    _color: null,
    _betweenAlpha: null,
    _betweenRed: null,
    _betweenGreen: null,
    _betweenBlue: null,
    ctor: function() {
        ccs.Frame.prototype.ctor.call(this);
        this._color = cc.color(255, 255, 255)
    },
    onEnter: function(a) {
        this._node && (this._node.setColor(this._color), this._tween && (a = a._color, this._betweenRed = a.r - this._color.r, this._betweenGreen = a.g - this._color.g, this._betweenBlue = a.b - this._color.b))
    },
    _onApply: function(a) {
        if (this._node && this._tween && (0 !== this._betweenAlpha || 0 !== this._betweenRed || 0 !== this._betweenGreen || 0 !== this._betweenBlue)) {
            var b = cc.color(255, 255, 255);
            b.r = this._color.r + this._betweenRed * a;
            b.g = this._color.g + this._betweenGreen * a;
            b.b = this._color.b + this._betweenBlue * a;
            this._node.setColor(b);
            null !== this._alpha && this._node.setOpacity(this._alpha + this._betweenAlpha * a)
        }
    },
    clone: function() {
        var a = new ccs.ColorFrame;
        a.setColor(this._color);
        a._cloneProperty(this);
        return a
    },
    setColor: function(a) {
        this._color = a
    },
    getColor: function() {
        return this._color
    }
});
ccs.ColorFrame.create = function() {
    return new ccs.ColorFrame
};
ccs.AlphaFrame = ccs.Frame.extend({
    _alpha: null,
    _betweenAlpha: null,
    ctor: function() {
        ccs.Frame.prototype.ctor.call(this);
        this._alpha = 255
    },
    onEnter: function(a) {
        this._node && (this._node.setOpacity(this._alpha), this._tween && (this._betweenAlpha = a._alpha - this._alpha))
    },
    _onApply: function(a) {
        this._node && this._node.setOpacity(this._alpha + this._betweenAlpha * a)
    },
    setAlpha: function(a) {
        this._alpha = a
    },
    getAlpha: function() {
        return this._alpha
    },
    clone: function() {
        var a = new ccs.AlphaFrame;
        a.setAlpha(this._alpha);
        a._cloneProperty(this);
        return a
    }
});
ccs.EventFrame = ccs.Frame.extend({
    _event: null,
    ctor: function() {
        ccs.Frame.prototype.ctor.call(this);
        this._event = "";
        this._enterWhenPassed = !0
    },
    onEnter: function(a) {
        this._emitEvent()
    },
    clone: function() {
        var a = new ccs.EventFrame;
        a.setEvent(this._event);
        a._cloneProperty(this);
        return a
    },
    setEvent: function(a) {
        this._event = a
    },
    getEvent: function() {
        return this._event
    }
});
ccs.EventFrame.create = function() {
    return new ccs.EventFrame
};
ccs.ZOrderFrame = ccs.Frame.extend({
    _zorder: 0,
    onEnter: function(a) {
        this._node && this._node.setLocalZOrder(this._zorder)
    },
    clone: function() {
        var a = new ccs.ZOrderFrame;
        a.setZOrder(this._zorder);
        a._cloneProperty(this);
        return a
    },
    setZOrder: function(a) {
        this._zorder = a
    },
    getZOrder: function() {
        return this._zorder
    }
});
ccs.ZOrderFrame.create = function() {
    return new ccs.ZOrderFrame
};
ccs.BlendFuncFrame = ccs.Frame.extend({
    ctor: function() {
        this._super();
        this._blendFunc = null
    },
    onEnter: function(a, b) {
        this._node && this._blendFunc && this._node.setBlendFunc(this._blendFunc)
    },
    clone: function() {
        var a = new ccs.BlendFuncFrame;
        a.setBlendFunc(this._blendFunc);
        a._cloneProperty(this);
        return a
    },
    setBlendFunc: function(a) {
        a && a.src && a.dst && (this._blendFunc = a)
    },
    getBlendFunc: function() {
        return this._blendFunc
    }
});
ccs.BlendFuncFrame.create = function() {
    return new ccs.BlendFuncFrame
};
ccs.Timeline = ccs.Class.extend({
    _frames: null,
    _currentKeyFrame: null,
    _currentKeyFrameIndex: null,
    _fromIndex: null,
    _toIndex: null,
    _betweenDuration: null,
    _actionTag: null,
    _ActionTimeline: null,
    _node: null,
    ctor: function() {
        this._frames = [];
        this._currentKeyFrame = null;
        this._actionTag = this._betweenDuration = this._toIndex = this._fromIndex = this._currentKeyFrameIndex = 0;
        this._node = this._ActionTimeline = null
    },
    _gotoFrame: function(a) {
        0 !== this._frames.length && (this._binarySearchKeyFrame(a), this._apply(a))
    },
    _stepToFrame: function(a) {
        0 !== this._frames.length && (this._updateCurrentKeyFrame(a), this._apply(a))
    },
    getFrames: function() {
        return this._frames
    },
    addFrame: function(a) {
        this._frames.push(a);
        a.setTimeline(this)
    },
    insertFrame: function(a, b) {
        this._frames.splice(b, 0, a);
        a.setTimeline(this)
    },
    removeFrame: function(a) {
        cc.arrayRemoveObject(this._frames, a);
        a.setTimeline(null)
    },
    setActionTag: function(a) {
        this._actionTag = a
    },
    getActionTag: function() {
        return this._actionTag
    },
    setNode: function(a) {
        for (var b = 0; b < this._frames.length; b++) this._frames[b].setNode(a)
    },
    getNode: function() {
        return this._node
    },
    setActionTimeline: function(a) {
        this._ActionTimeline = a
    },
    getActionTimeline: function() {
        return this._ActionTimeline
    },
    clone: function() {
        var a = new ccs.Timeline;
        a._actionTag = this._actionTag;
        for (var b = 0; b < this._frames.length; b++) {
            var c = this._frames[b].clone();
            a.addFrame(c)
        }
        return a
    },
    _apply: function(a) {
        this._currentKeyFrame && this._currentKeyFrame.apply(0 >= this._betweenDuration ? 0 : (a - this._currentKeyFrameIndex) / this._betweenDuration)
    },
    _binarySearchKeyFrame: function(a) {
        var b = null,
        c = null,
        d = this._frames.length,
        e = !1;
        do
        if (a < this._frames[0].getFrameIndex()) this._currentKeyFrameIndex >= this._frames[0].getFrameIndex() && (e = !0),
        this._toIndex = this._fromIndex = 0,
        b = c = this._frames[0],
        this._currentKeyFrameIndex = 0,
        this._betweenDuration = this._frames[0].getFrameIndex();
        else if (a >= this._frames[d - 1].getFrameIndex()) this._fromIndex = d - 1,
        this._toIndex = 0,
        b = c = this._frames[d - 1],
        this._currentKeyFrameIndex = this._frames[d - 1].getFrameIndex(),
        this._betweenDuration = 0;
        else {
            for (var f = -1,
            b = 0,
            c = d - 1,
            g = 0; b <= c;) {
                g = Math.ceil((b + c) / 2);
                if (a >= this._frames[g].getFrameIndex() && a < this._frames[g + 1].getFrameIndex()) {
                    f = g;
                    break
                }
                this._frames[g].getFrameIndex() > a ? c = g - 1 : b = g + 1
            }
            this._fromIndex = f;
            this._toIndex = 1 < d ? f + 1 | 0 : f | 0;
            b = this._frames[f];
            c = this._frames[f + 1];
            0 === f && this._currentKeyFrameIndex < b.getFrameIndex() && (e = !0);
            this._currentKeyFrameIndex = b.getFrameIndex();
            this._betweenDuration = c.getFrameIndex() - b.getFrameIndex()
        }
        while (0);
        if (e || this._currentKeyFrame != b) this._currentKeyFrame = b,
        this._currentKeyFrame.onEnter(c)
    },
    _updateCurrentKeyFrame: function(a) {
        if (a < this._currentKeyFrameIndex || a >= this._currentKeyFrameIndex + this._betweenDuration) {
            var b = null,
            c = null;
            do {
                var d = this._frames.length;
                if (a < this._frames[0].getFrameIndex()) b = c = this._frames[0], this._currentKeyFrameIndex = 0, this._betweenDuration = this._frames[0].getFrameIndex();
                else {
                    if (a >= this._frames[d - 1].getFrameIndex() && (a = this._frames[d - 1].getFrameIndex(), this._currentKeyFrameIndex >= a)) return;
                    do {
                        this._fromIndex = this._toIndex;
                        b = this._frames[this._fromIndex];
                        this._currentKeyFrameIndex = b.getFrameIndex();
                        this._toIndex = this._fromIndex + 1;
                        this._toIndex >= d && (this._toIndex = 0);
                        c = this._frames[this._toIndex];
                        if (a === b.getFrameIndex()) break;
                        if (a > b.getFrameIndex() && a < c.getFrameIndex()) break;
                        if (b.isEnterWhenPassed()) b.onEnter(c)
                    } while ( 1 );
                    this._betweenDuration = c.getFrameIndex() - b.getFrameIndex()
                }
            } while ( 0 );
            this._currentKeyFrame = b;
            this._currentKeyFrame.onEnter(c)
        }
    }
});
ccs.Timeline.create = function() {
    return new ccs.Timeline
};
ccs._load = function() {
    var a = function(a, d, h) {
        var k = cc.loader.getRes(a);
        if (!k) return cc.log("%s does not exist", a);
        var m = a.match(c); (m && m[1] ? m[1] : null).toLocaleLowerCase();
        var r;
        d ? r = b[d] : k.widgetTree ? r = b.ccui: k.nodeTree ? r = b.timeline: k.Content && k.Content.Content ? r = b.timeline: k.gameobjects && (r = b.scene);
        if (!r) return cc.log("Can't find the parser : %s", a),
        new cc.Node;
        d = k.version || k.Version;
        return ! d && k.armature_data ? (cc.warn("%s is armature. please use:", a), cc.warn("    ccs.armatureDataManager.addArmatureFileInfoAsync(%s);", a), cc.warn("    var armature \x3d new ccs.Armature('name');"), new cc.Node) : (r = e(r, d)) ? r.parse(a, k, h) || null: new cc.Node
    },
    b = {
        ccui: {},
        timeline: {},
        action: {},
        scene: {}
    };
    a.registerParser = function(a, c, d) {
        if (!a || !c || !d) return cc.log("register parser error");
        b[a] || (b[a] = {});
        b[a][c] = d
    };
    a.getParser = function(a, c) {
        return a && c ? b[a] ? b[a][c] : void 0 : a ? b[a] : b
    };
    var c = /\.([^\.]+)$/,
    d = /([^\.](\.\*)?)*$/,
    e = function(a, b) {
        return a[b] ? a[b] : "*" === b ? null: e(a, b.replace(d, "*"))
    };
    return a
} ();
ccs._parser = cc.Class.extend({
    ctor: function() {
        this.parsers = {}
    },
    _dirnameReg: /\S*\//,
    _dirname: function(a) {
        return (a = a.match(this._dirnameReg)) && a[0] ? a[0] : ""
    },
    getClass: function(a) {
        return a.classname
    },
    getNodeJson: function(a) {
        return a.widgetTree
    },
    parse: function(a, b, c) {
        c = c || this._dirname(a);
        this.pretreatment(b, c);
        var d = this.parseNode(this.getNodeJson(b), c, a);
        d && this.deferred(b, c, d, a);
        return d
    },
    pretreatment: function(a, b, c) {},
    deferred: function(a, b, c, d) {},
    parseNode: function(a, b) {
        var c = this.parsers[this.getClass(a)],
        d = null;
        c ? d = c.call(this, a, b) : cc.log("Can't find the parser : %s", this.getClass(a));
        return d
    },
    registerParser: function(a, b) {
        this.parsers[a] = b
    }
});
ccs.load = function(a, b) {
    var c = {
        node: null,
        action: null
    };
    c.node = ccs._load(a, null, b);
    c.action = ccs._load(a, "action", b);
    c.action && -1 === c.action.tag && c.node && (c.action.tag = c.node.tag);
    return c
};
ccs.load.validate = {};
ccs.load.preload = !0;
ccs.loadWithVisibleSize = function(a, b) {
    var c = ccs.load(a, b),
    d = cc.director.getVisibleSize();
    c.node && d && (c.node.setContentSize(d.width, d.height), ccui.helper.doLayout(c.node));
    return c
};
ccs.actionTimelineCache = {
    createAction: function(a) {
        return ccs._load(a, "action")
    }
};
ccs.csLoader = {
    createNode: function(a) {
        return ccs._load(a)
    }
};
cc.loader.register(["json"], {
    load: function(a, b, c, d) {
        cc.loader.loadJson(a,
        function(a, b) {
            d(a, b)
        })
    }
}); (function(a, b) {
    var c = new(b.extend({
        parse: function(a, b, c) {
            c = void 0 !== c ? c: this._dirname(a);
            this.pretreatment(b, c, a);
            var d = this.parseNode(this.getNodeJson(b), c);
            this.deferred(b, c, d, a);
            return d
        },
        getNodeJson: function(a) {
            a = a.Content;
            return a.ObjectData ? a.ObjectData: a.Content.ObjectData
        },
        getClass: function(a) {
            return a.ctype
        }
    })),
    d = function(a, b) {
        return void 0 === a ? b: a
    };
    c.generalAttributes = function(a, b) {
        null != b.Name && a.setName(b.Name);
        var c = b.Position;
        null == c || null == c.X && null == c.Y || a.setPosition(cc.p(c.X || 0, c.Y || 0));
        c = b.Scale;
        null != c && (null != c.ScaleX && a.setScaleX(c.ScaleX), null != c.ScaleY && a.setScaleY(c.ScaleY));
        c = b.RotationSkewX;
        null != c && a.setRotationX(c);
        c = b.RotationSkewY;
        null != b.RotationSkewY && a.setRotationY(c);
        c = b.AnchorPoint;
        null != c && (null == c.ScaleX && (c.ScaleX = 0), null == c.ScaleY && (c.ScaleY = 0), 0.5 == c.ScaleX && 0.5 == c.ScaleY || a.setAnchorPoint(cc.p(c.ScaleX, c.ScaleY)));
        null != b.ZOrder && a.setLocalZOrder(b.ZOrder);
        c = d(b.VisibleForFrame, !0);
        a.setVisible(c); (c = b.Size) && t(a, c);
        null != b.Alpha && a.setOpacity(b.Alpha);
        a.setTag(b.Tag || 0);
        var c = b.ActionTag || 0,
        e = new ccs.ComExtensionData,
        g = b.UserData;
        void 0 !== g && e.setCustomProperty(g);
        e.setActionTag(c);
        a.getComponent("ComExtensionData") && a.removeComponent("ComExtensionData");
        a.addComponent(e);
        a.setCascadeColorEnabled(!0);
        a.setCascadeOpacityEnabled(!0);
        f(a, b)
    };
    c.parseChild = function(a, b, c) {
        if (a && b) for (var d = 0; d < b.length; d++) {
            var e = this.parseNode(b[d], c);
            if (e) {
                if (! (a instanceof ccui.Layout) && e instanceof ccui.Widget && e.getPositionType() === ccui.Widget.POSITION_PERCENT) {
                    var f = e.getPositionPercent(),
                    g = a.getAnchorPoint();
                    e.setPositionPercent(cc.p(f.x + g.x, f.y + g.y))
                }
                a.addChild(e)
            }
        }
    };
    c.initSingleNode = function(a) {
        var b = new cc.Node;
        this.generalAttributes(b, a);
        a = a.CColor;
        null != a && b.setColor(s(a));
        return b
    };
    c.initSprite = function(a, b) {
        var c = new cc.Sprite;
        r(a.FileData, b,
        function(a, b) {
            if (0 === b) c.setTexture(a);
            else if (1 === b) {
                var d = cc.spriteFrameCache.getSpriteFrame(a);
                d && c.setSpriteFrame(d)
            }
        });
        var d = a.BlendFunc;
        if (a.BlendFunc) {
            var e = cc.BlendFunc.ALPHA_PREMULTIPLIED;
            void 0 !== d.Src && (e.src = d.Src);
            void 0 !== d.Dst && (e.dst = d.Dst);
            c.setBlendFunc(e)
        }
        a.FlipX && c.setFlippedX(!0);
        a.FlipY && c.setFlippedY(!0);
        this.generalAttributes(c, a);
        d = a.CColor;
        null != d && c.setColor(s(d));
        return c
    };
    c.initParticle = function(a, b) {
        var c, d = this;
        r(a.FileData, b,
        function(b, e) {
            cc.loader.getRes(b) || cc.log("%s need to be preloaded", b);
            c = new cc.ParticleSystem(b);
            d.generalAttributes(c, a);
            c.setPositionType(cc.ParticleSystem.TYPE_GROUPED); ! cc.sys.isNative && c.setDrawMode(cc.ParticleSystem.TEXTURE_MODE);
            var f = a.BlendFunc;
            if (a.BlendFunc) {
                var g = cc.BlendFunc.ALPHA_PREMULTIPLIED;
                void 0 !== f.Src && (g.src = f.Src);
                void 0 !== f.Dst && (g.dst = f.Dst);
                c.setBlendFunc(g)
            }
        });
        return c
    };
    c.widgetAttributes = function(a, b, c) {
        a.setCascadeColorEnabled(!0);
        a.setCascadeOpacityEnabled(!0);
        a.setUnifySizeEnabled(!1);
        a.ignoreContentAdaptWithSize(!1); ! c && t(a, b.Size); (c = b.Name) && a.setName(c);
        c = b.ActionTag || 0;
        a.setActionTag(c);
        var g = new ccs.ComExtensionData,
        h = b.UserData;
        void 0 !== h && g.setCustomProperty(h);
        g.setActionTag(c);
        a.getComponent("ComExtensionData") && a.removeComponent("ComExtensionData");
        a.addComponent(g); (c = b.RotationSkewX) && a.setRotationX(c); (c = b.RotationSkewY) && a.setRotationY(c);
        b.FlipX && a.setFlippedX(!0);
        b.FlipY && a.setFlippedY(!0);
        c = b.zOrder;
        null != c && a.setLocalZOrder(c);
        c = d(b.VisibleForFrame, !0);
        a.setVisible(c);
        c = b.Alpha;
        null != c && a.setOpacity(c);
        a.setTag(b.Tag || 0);
        a.setTouchEnabled(b.TouchEnable || !1);
        c = b.CallBackType;
        null != c && a.setCallbackType(c); (c = b.CallBackName) && a.setCallbackName(c);
        c = b.Position;
        null != c && a.setPosition(c.X || 0, c.Y || 0);
        g = b.Scale;
        null != g && (c = d(g.ScaleX, 1), g = d(g.ScaleY, 1), a.setScaleX(c), a.setScaleY(g));
        c = b.AnchorPoint;
        null != c && a.setAnchorPoint(c.ScaleX || 0, c.ScaleY || 0);
        c = b.CColor;
        null != c && a.setColor(s(c));
        f(a, b);
        e(a, b)
    };
    var e = function(a, b) {
        var c = b.CallBackType,
        d = b.CallBackName,
        e = function(b) {
            if ("function" === typeof a[d]) a[d](b)
        };
        "Click" === c ? a.addClickEventListener(e) : "Touch" === c ? a.addTouchEventListener(e) : "Event" === c && a.addCCSEventListener(e)
    },
    f = function(a, b) {
        var c = ccui.LayoutComponent.bindLayoutComponent(a);
        if (c) {
            var d = b.PositionPercentXEnable || b.PositionPercentXEnabled || !1,
            e = b.PositionPercentYEnable || b.PositionPercentYEnabled || !1,
            f = 0,
            g = 0,
            h = b.PrePosition;
            null != h && (f = h.X || 0, g = h.Y || 0);
            var k = b.PercentWidthEnable || b.PercentWidthEnabled || !1,
            m = b.PercentHeightEnable || b.PercentHeightEnabled || !1,
            r = 0,
            s = 0,
            t = b.PreSize;
            null != h && (r = t.X || 0, s = t.Y || 0);
            var F = b.StretchWidthEnable || !1,
            G = b.StretchHeightEnable || !1,
            I = b.HorizontalEdge,
            h = b.VerticalEdge,
            t = b.LeftMargin || 0,
            K = b.RightMargin || 0,
            L = b.TopMargin || 0,
            J = b.BottomMargin || 0;
            c.setPositionPercentXEnabled(d);
            c.setPositionPercentYEnabled(e);
            c.setPositionPercentX(f);
            c.setPositionPercentY(g);
            c.setPercentWidthEnabled(k);
            c.setPercentHeightEnabled(m);
            c.setPercentWidth(r);
            c.setPercentHeight(s);
            c.setPercentWidthEnabled(k || m);
            c.setStretchWidthEnabled(F);
            c.setStretchHeightEnabled(G);
            d = ccui.LayoutComponent.horizontalEdge.NONE;
            "LeftEdge" === I ? d = ccui.LayoutComponent.horizontalEdge.LEFT: "RightEdge" === I ? d = ccui.LayoutComponent.horizontalEdge.RIGHT: "BothEdge" === I && (d = ccui.LayoutComponent.horizontalEdge.CENTER);
            c.setHorizontalEdge(d);
            d = ccui.LayoutComponent.verticalEdge.NONE;
            "TopEdge" === h ? d = ccui.LayoutComponent.verticalEdge.TOP: "BottomEdge" === h ? d = ccui.LayoutComponent.verticalEdge.BOTTOM: "BothEdge" === h && (d = ccui.LayoutComponent.verticalEdge.CENTER);
            c.setVerticalEdge(d);
            c.setTopMargin(L);
            c.setBottomMargin(J);
            c.setLeftMargin(t);
            c.setRightMargin(K);
            c.setVerticalEdge(d);
            c.setTopMargin(L);
            c.setBottomMargin(J);
            c.setLeftMargin(t);
            c.setRightMargin(K)
        }
    },
    g = function(a, b, c, d) {
        2 === a.getBackGroundColorType() ? (c = c || {},
        d = d || {},
        a.setBackGroundColor(s(c), s(d))) : (b = b || {},
        a.setBackGroundColor(s(b)))
    },
    h = function(a, b) {
        a.setBackGroundColorVector(cc.p(b.ScaleX || 0, b.ScaleY || 0))
    };
    c.initPanel = function(a, b) {
        var c = new ccui.Layout;
        this.widgetAttributes(c, a);
        var e = a.ClipAble || !1;
        null != e && c.setClippingEnabled(e);
        e = d(a.ComboBoxIndex, 0);
        c.setBackGroundColorType(e);
        e = d(a.BackColorAlpha, 255);
        null != e && c.setBackGroundColorOpacity(e);
        e = a.Scale9Enable;
        null != e && c.setBackGroundImageScale9Enabled(e);
        var f = d(a.Alpha, 255);
        c.setOpacity(f);
        r(a.FileData, b,
        function(a, b) {
            c.setBackGroundImage(a, b)
        });
        e ? (c.setBackGroundImageCapInsets(cc.rect(a.Scale9OriginX || 0, a.Scale9OriginY || 0, a.Scale9Width || 0, a.Scale9Height || 0)), t(c, a.Size)) : c.isIgnoreContentAdaptWithSize() || t(c, a.Size);
        g(c, a.SingleColor, a.FirstColor, a.EndColor);
        h(c, a.ColorVector);
        return c
    };
    c.initText = function(a, b) {
        var c = new ccui.Text,
        e = a.TouchScaleChangeAble;
        null != e && c.setTouchScaleChangeEnabled(e);
        e = a.LabelText;
        null != e && c.setString(e);
        e = a.FontSize;
        null != e && c.setFontSize(e);
        e = a.FontName;
        null != e && c.setFontName(e);
        var e = a.AreaWidth,
        f = a.areaHeight;
        e && f && c.setTextAreaSize(cc.size(e, f));
        e = a.HorizontalAlignmentType || "HT_Left";
        switch (e) {
        case "HT_Right":
            e = 2;
            break;
        case "HT_Center":
            e = 1;
            break;
        default:
            e = 0
        }
        c.setTextHorizontalAlignment(e);
        e = a.VerticalAlignmentType || "VT_Top";
        switch (e) {
        case "VT_Bottom":
            e = 2;
            break;
        case "VT_Center":
            e = 1;
            break;
        default:
            e = 0
        }
        c.setTextVerticalAlignment(e);
        e = a.FontResource;
        null != e && (e = e.Path, null != e && (e = cc.sys.isNative ? cc.path.join(cc.loader.resPath, b, e) : (e = e.match(/([^\/]+)\.(\S+)/)) ? e[1] : "", c.setFontName(e)));
        a.OutlineEnabled && a.OutlineColor && c.enableOutline && c.enableOutline(s(a.OutlineColor), d(a.OutlineSize, 1));
        a.ShadowEnabled && a.ShadowColor && c.enableShadow && c.enableShadow(s(a.ShadowColor), cc.size(d(a.ShadowOffsetX, 2), d(a.ShadowOffsetY, -2)), a.ShadowBlurRadius || 0);
        e = a.IsCustomSize;
        null != e && c.ignoreContentAdaptWithSize(!e);
        c.setUnifySizeEnabled(!1);
        e = a.CColor;
        a.CColor = null;
        c.setTextColor(s(e));
        this.widgetAttributes(c, a, c.isIgnoreContentAdaptWithSize());
        a.CColor = e;
        return c
    };
    c.initButton = function(a, b) {
        var c = new ccui.Button;
        r(a.NormalFileData, b,
        function(a, b) {
            c.loadTextureNormal(a, b)
        });
        r(a.PressedFileData, b,
        function(a, b) {
            c.loadTexturePressed(a, b)
        });
        r(a.DisabledFileData, b,
        function(a, b) {
            c.loadTextureDisabled(a, b)
        });
        var e = d(a.Scale9Enable, !1);
        e && c.setScale9Enabled(e);
        var f = a.ButtonText;
        null != f && c.setTitleText(f);
        f = a.FontSize;
        null != f && c.setTitleFontSize(f);
        f = a.FontName;
        null != f && c.setTitleFontName(f);
        f = a.TextColor;
        null != f && c.setTitleColor(s(f));
        f = d(a.DisplayState, !0);
        c.setBright(f);
        c.setEnabled(f);
        f = a.FontResource;
        null != f && (f = f.Path, null != f && (f = cc.sys.isNative ? cc.path.join(cc.loader.resPath, b, f) : (f = f.match(/([^\/]+)\.(\S+)/)) ? f[1] : "", c.setTitleFontName(f))); (f = c.getTitleRenderer()) && a.ShadowEnabled && a.ShadowColor && f.enableShadow && f.enableShadow(s(a.ShadowColor), cc.size(d(a.ShadowOffsetX, 2), d(a.ShadowOffsetY, -2)), a.ShadowBlurRadius || 0);
        f && a.OutlineEnabled && a.OutlineColor && f.enableStroke && f.enableStroke(s(a.OutlineColor), d(a.OutlineSize, 1));
        this.widgetAttributes(c, a);
        e && (c.setUnifySizeEnabled(!1), c.ignoreContentAdaptWithSize(!1), e = cc.rect(a.Scale9OriginX || 0, a.Scale9OriginY || 0, a.Scale9Width || 0, a.Scale9Height || 0), c.setCapInsets(e));
        t(c, a.Size);
        return c
    };
    c.initCheckBox = function(a, b) {
        var c = new ccui.CheckBox;
        this.widgetAttributes(c, a); [{
            name: "NormalBackFileData",
            handle: c.loadTextureBackGround
        },
        {
            name: "PressedBackFileData",
            handle: c.loadTextureBackGroundSelected
        },
        {
            name: "NodeNormalFileData",
            handle: c.loadTextureFrontCross
        },
        {
            name: "DisableBackFileData",
            handle: c.loadTextureBackGroundDisabled
        },
        {
            name: "NodeDisableFileData",
            handle: c.loadTextureFrontCrossDisabled
        }].forEach(function(d) {
            r(a[d.name], b,
            function(a, b) {
                d.handle.call(c, a, b)
            })
        });
        var e = d(a.CheckedState, !1);
        c.setSelected(e);
        e = d(a.DisplayState, !0);
        c.setBright(e);
        c.setEnabled(e);
        return c
    };
    c.initScrollView = function(a, b) {
        var c = new ccui.ScrollView;
        this.widgetAttributes(c, a);
        r(a.FileData, b,
        function(a, b) {
            c.setBackGroundImage(a, b)
        });
        c.setClippingEnabled(a.ClipAble || !1);
        var e = d(a.ComboBoxIndex, 0);
        c.setBackGroundColorType(e);
        e = a.BackColorAlpha;
        null != e && c.setBackGroundColorOpacity(e);
        a.Scale9Enable ? (c.setBackGroundImageScale9Enabled(!0), c.setBackGroundImageCapInsets(cc.rect(a.Scale9OriginX || 0, a.Scale9OriginY || 0, a.Scale9Width || 0, a.Scale9Height || 0)), t(c, a.Size)) : c.isIgnoreContentAdaptWithSize() || t(c, a.Size);
        g(c, a.SingleColor, a.FirstColor, a.EndColor);
        h(c, a.ColorVector);
        e = a.InnerNodeSize;
        e = cc.size(e.Width || 0, e.Height || 0);
        c.setInnerContainerSize(e);
        e = 0;
        "Vertical" === a.ScrollDirectionType && (e = 1);
        "Horizontal" === a.ScrollDirectionType && (e = 2);
        "Vertical_Horizontal" === a.ScrollDirectionType && (e = 3);
        c.setDirection(e);
        e = d(a.IsBounceEnabled, !1);
        c.setBounceEnabled(e);
        return c
    };
    c.initImageView = function(a, b) {
        var c = new ccui.ImageView;
        r(a.FileData, b,
        function(a, b) {
            c.loadTexture(a, b)
        });
        r(a.ImageFileData, b,
        function(a, b) {
            c.loadTexture(a, b)
        });
        a.Scale9Enable ? (c.setScale9Enabled(!0), c.setUnifySizeEnabled(!1), c.ignoreContentAdaptWithSize(!1), c.setCapInsets(cc.rect(a.Scale9OriginX || 0, a.Scale9OriginY || 0, a.Scale9Width || 0, a.Scale9Height || 0))) : t(c, a.Size);
        this.widgetAttributes(c, a);
        return c
    };
    c.initLoadingBar = function(a, b) {
        var c = new ccui.LoadingBar;
        this.widgetAttributes(c, a);
        r(a.ImageFileData, b,
        function(a, b) {
            c.loadTexture(a, b)
        });
        c.setDirection("Right_To_Left" === a.ProgressType ? 1 : 0);
        var e = d(a.ProgressInfo, 80);
        null != e && c.setPercent(e);
        return c
    };
    c.initSlider = function(a, b) {
        var c = new ccui.Slider,
        e = cc.loader;
        this.widgetAttributes(c, a); [{
            name: "BackGroundData",
            handle: c.loadBarTexture
        },
        {
            name: "BallNormalData",
            handle: c.loadSlidBallTextureNormal
        },
        {
            name: "BallPressedData",
            handle: c.loadSlidBallTexturePressed
        },
        {
            name: "BallDisabledData",
            handle: c.loadSlidBallTextureDisabled
        },
        {
            name: "ProgressBarData",
            handle: c.loadProgressBarTexture
        }].forEach(function(d) {
            r(a[d.name], b,
            function(a, b) {
                0 !== b || e.getRes(a) || cc.log("%s need to be preloaded", a);
                d.handle.call(c, a, b)
            })
        });
        c.setPercent(a.PercentInfo || 0);
        var f = d(a.DisplayState, !0);
        c.setBright(f);
        c.setEnabled(f);
        return c
    };
    c.initPageView = function(a, b) {
        var c = new ccui.PageView;
        this.widgetAttributes(c, a);
        r(a.FileData, b,
        function(a, b) {
            c.setBackGroundImage(a, b)
        });
        c.setClippingEnabled(a.ClipAble || !1);
        a.Scale9Enable && (c.setBackGroundImageScale9Enabled(!0), c.setBackGroundImageCapInsets(cc.rect(a.Scale9OriginX || 0, a.Scale9OriginY || 0, a.Scale9Width || 0, a.Scale9Height || 0)));
        var e = d(a.ComboBoxIndex, 0);
        c.setBackGroundColorType(e);
        g(c, a.SingleColor, a.FirstColor, a.EndColor);
        h(c, a.ColorVector);
        e = a.BackColorAlpha;
        null != e && c.setBackGroundColorOpacity(e);
        t(c, a.Size);
        return c
    };
    c.initListView = function(a, b) {
        var c = new ccui.ListView;
        this.widgetAttributes(c, a);
        r(a.FileData, b,
        function(a, b) {
            c.setBackGroundImage(a, b)
        });
        c.setClippingEnabled(a.ClipAble || !1);
        var e = d(a.ComboBoxIndex, 0);
        c.setBackGroundColorType(e);
        e = d(a.BackColorAlpha, 255);
        a.Scale9Enable && (c.setBackGroundImageScale9Enabled(!0), c.setBackGroundImageCapInsets(cc.rect(a.Scale9OriginX || 0, a.Scale9OriginY || 0, a.Scale9Width || 0, a.Scale9Height || 0)));
        var f = d(a.DirectionType, ccui.ListView.DIR_HORIZONTAL),
        k = d(a.VerticalType, "Align_Left"),
        m = d(a.HorizontalType, "Align_Top");
        f ? "Vertical" === f && (c.setDirection(ccui.ScrollView.DIR_VERTICAL), "" === m ? c.setGravity(ccui.ListView.GRAVITY_LEFT) : "Align_Right" === m ? c.setGravity(ccui.ListView.GRAVITY_RIGHT) : "Align_HorizontalCenter" === m && c.setGravity(ccui.ListView.GRAVITY_CENTER_HORIZONTAL)) : (c.setDirection(ccui.ScrollView.DIR_HORIZONTAL), "Align_Bottom" === k ? c.setGravity(ccui.ListView.GRAVITY_BOTTOM) : "Align_VerticalCenter" === k ? c.setGravity(ccui.ListView.GRAVITY_CENTER_VERTICAL) : c.setGravity(ccui.ListView.GRAVITY_TOP));
        f = d(a.IsBounceEnabled, !1);
        c.setBounceEnabled(f);
        c.setItemsMargin(a.ItemMargin || 0);
        f = a.InnerNodeSize;
        null != f && c.setInnerContainerSize(cc.size(f.Widget || 0, f.Height || 0));
        g(c, a.SingleColor, a.FirstColor, a.EndColor);
        h(c, a.ColorVector);
        null != e && c.setBackGroundColorOpacity(e);
        t(c, a.Size);
        return c
    };
    c.initTextAtlas = function(a, b) {
        var c = new ccui.TextAtlas,
        d = a.LabelText,
        e = a.CharWidth,
        f = a.CharHeight,
        g = a.StartChar;
        r(a.LabelAtlasFileImage_CNB, b,
        function(a, b) {
            cc.loader.getRes(a) || cc.log("%s need to be preloaded", a);
            0 === b && c.setProperty(d, a, e, f, g)
        });
        this.widgetAttributes(c, a);
        c.ignoreContentAdaptWithSize(!0);
        return c
    };
    c.initTextBMFont = function(a, b) {
        var c = new ccui.TextBMFont;
        this.widgetAttributes(c, a);
        r(a.LabelBMFontFile_CNB, b,
        function(a, b) {
            cc.loader.getRes(a) || cc.log("%s need to be pre loaded", a);
            c.setFntFile(a)
        });
        c.setString(a.LabelText);
        c.ignoreContentAdaptWithSize(!0);
        return c
    };
    c.initTextField = function(a, b) {
        var c = new ccui.TextField;
        a.PasswordEnable && (c.setPasswordEnabled(!0), c.setPasswordStyleText(a.PasswordStyleText || "*"));
        var d = a.PlaceHolderText;
        null != d && c.setPlaceHolder(d);
        d = a.FontSize;
        null != d && c.setFontSize(d);
        d = a.FontName;
        null != d && c.setFontName(d);
        a.MaxLengthEnable && (c.setMaxLengthEnabled(!0), c.setMaxLength(a.MaxLengthText || 0));
        this.widgetAttributes(c, a);
        d = a.LabelText;
        null != d && c.setString(d);
        d = a.FontResource;
        null != d && (d = d.Path, null != d && (d = cc.sys.isNative ? cc.path.join(cc.loader.resPath, b, d) : (d = d.match(/([^\/]+)\.(\S+)/)) ? d[1] : "", c.setFontName(d)));
        c.setUnifySizeEnabled(!1);
        c.ignoreContentAdaptWithSize(!1);
        d = a.CColor;
        null != d && c.setTextColor(s(d));
        c.isIgnoreContentAdaptWithSize() || (t(c, a.Size), cc.sys.isNative && c.getVirtualRenderer().setLineBreakWithoutSpace(!0));
        return c
    };
    c.initSimpleAudio = function(a, b) {
        var c = new ccs.ComAudio;
        c.setLoop(a.Loop || !1);
        r(a.FileData, b,
        function(a, b) {
            c.setFile(a)
        })
    };
    c.initGameMap = function(a, b) {
        var d = null;
        r(a.FileData, b,
        function(b, e) {
            0 === e && (d = new cc.TMXTiledMap(b));
            c.generalAttributes(d, a)
        });
        return d
    };
    c.initProjectNode = function(a, b) {
        var d = a.FileData;
        if (null != d && d.Path) {
            d = b + d.Path;
            if (cc.loader.getRes(d)) {
                d = ccs.load(d, b);
                c.generalAttributes(d.node, a);
                if (d.action && d.node) {
                    d.action.tag = d.node.tag;
                    var e = a.InnerActionSpeed;
                    void 0 !== e && d.action.setTimeSpeed(e);
                    d.node.runAction(d.action);
                    d.action.gotoFrameAndPause(0)
                }
                return d.node
            }
            cc.log("%s need to be preloaded", d)
        }
    };
    var k = function(a) {
        return a ? (a = a.match(/([^\/]+)\.[^\/]+$/)) && a[1] ? a[1] : "": ""
    };
    c.initArmature = function(a, b) {
        var d = new ccs.Armature,
        e = a.IsLoop,
        f = a.IsAutoPlay,
        g = a.CurrentAnimationName;
        r(a.FileData, b,
        function(a, b) {
            var c, h, m = cc.loader.getRes(a);
            m ? (c = m.config_file_path, h = m.config_png_path, c.forEach(function(a, b) {
                h[b] && cc.spriteFrameCache.addSpriteFrames(a, h[b])
            })) : cc.log("%s need to be preloaded", a);
            ccs.armatureDataManager.addArmatureFileInfo(a);
            d.init(k(a));
            f ? d.getAnimation().play(g, -1, e) : (d.getAnimation().play(g), d.getAnimation().gotoAndPause(0))
        });
        delete a.AnchorPoint;
        delete a.Size;
        c.generalAttributes(d, a);
        d.setColor(s(a.CColor));
        return d
    };
    c.initBoneNode = function(a, b) {
        var d = new ccs.BoneNode,
        e = a.Length;
        void 0 !== e && d.setDebugDrawLength(e); (e = a.BlendFunc) && void 0 !== e.Src && void 0 !== e.Dst && d.setBlendFunc(new cc.BlendFunc(e.Src, e.Dst));
        c.generalAttributes(d, a);
        e = a.CColor; ! e || void 0 === e.R && void 0 === e.G && void 0 === e.B || d.setColor(s(e));
        return d
    };
    c.initSkeletonNode = function(a) {
        var b = new ccs.SkeletonNode;
        c.generalAttributes(b, a);
        a = a.CColor; ! a || void 0 === a.R && void 0 === a.G && void 0 === a.B || b.setColor(s(a));
        return b
    };
    var m = {},
    r = function(a, b, c) {
        if (null != a) {
            var d = a.Path,
            e;
            e = "Default" === a.Type || "Normal" === a.Type ? 0 : 1;
            if (a = a.Plist) cc.loader.getRes(b + a) ? (m[b + a] = !0, cc.spriteFrameCache.addSpriteFrames(b + a)) : m[b + a] || cc.spriteFrameCache.getSpriteFrame(d) || cc.log("%s need to be preloaded", b + a);
            0 !== e ? cc.spriteFrameCache.getSpriteFrame(d) ? c(d, e) : cc.log("failed to get spriteFrame: %s", d) : c(b + d, e)
        }
    },
    s = function(a) {
        if (a) return cc.color(null != a.R ? a.R: 255, null != a.G ? a.G: 255, null != a.B ? a.B: 255, null != a.A ? a.A: 255)
    },
    t = function(a, b) {
        var c = b.X || 0,
        d = b.Y || 0;
        b && a.setContentSize(cc.size(c, d))
    }; [{
        name: "SingleNodeObjectData",
        handle: c.initSingleNode
    },
    {
        name: "NodeObjectData",
        handle: c.initSingleNode
    },
    {
        name: "LayerObjectData",
        handle: c.initSingleNode
    },
    {
        name: "GameNodeObjectData",
        handle: c.initSingleNode
    },
    {
        name: "GameLayerObjectData",
        handle: c.initSingleNode
    },
    {
        name: "SpriteObjectData",
        handle: c.initSprite
    },
    {
        name: "ParticleObjectData",
        handle: c.initParticle
    },
    {
        name: "PanelObjectData",
        handle: c.initPanel
    },
    {
        name: "TextObjectData",
        handle: c.initText
    },
    {
        name: "ButtonObjectData",
        handle: c.initButton
    },
    {
        name: "CheckBoxObjectData",
        handle: c.initCheckBox
    },
    {
        name: "ScrollViewObjectData",
        handle: c.initScrollView
    },
    {
        name: "ImageViewObjectData",
        handle: c.initImageView
    },
    {
        name: "LoadingBarObjectData",
        handle: c.initLoadingBar
    },
    {
        name: "SliderObjectData",
        handle: c.initSlider
    },
    {
        name: "PageViewObjectData",
        handle: c.initPageView
    },
    {
        name: "ListViewObjectData",
        handle: c.initListView
    },
    {
        name: "TextAtlasObjectData",
        handle: c.initTextAtlas
    },
    {
        name: "TextBMFontObjectData",
        handle: c.initTextBMFont
    },
    {
        name: "TextFieldObjectData",
        handle: c.initTextField
    },
    {
        name: "SimpleAudioObjectData",
        handle: c.initSimpleAudio
    },
    {
        name: "GameMapObjectData",
        handle: c.initGameMap
    },
    {
        name: "ProjectNodeObjectData",
        handle: c.initProjectNode
    },
    {
        name: "ArmatureNodeObjectData",
        handle: c.initArmature
    },
    {
        name: "BoneNodeObjectData",
        handle: c.initBoneNode
    },
    {
        name: "SkeletonNodeObjectData",
        handle: c.initSkeletonNode
    }].forEach(function(a) {
        c.registerParser(a.name,
        function(b, c) {
            var d = a.handle.call(this, b, c);
            this.parseChild(d, b.Children, c);
            return d
        })
    });
    a.registerParser("timeline", "2.*", c);
    a.registerParser("timeline", "*", c)
})(ccs._load, ccs._parser); (function() {
    ccs.uiReader = {
        _fileDesignSizes: {},
        widgetFromJsonFile: function(a) {
            var b = cc.loader.getRes(a);
            b && (this._fileDesignSizes[a] = cc.size(b.designWidth || 0, b.designHeight || 0));
            var b = b.Version || b.version,
            c = ccs.uiReader.getVersionInteger(b);
            return ! b || 1700 <= c ? (cc.warn("Not supported file types, Please try use the ccs.load"), null) : ccs._load(a, "ccui")
        },
        registerTypeAndCallBack: function(a, b, c, d) {
            var e = ccs._load.getParser("ccui")["*"],
            f = d.bind(c);
            e.registerParser(a,
            function(d, e) {
                var k = new b,
                m = d.options;
                c.setPropsFromJsonDictionary && c.setPropsFromJsonDictionary(k, m);
                this.generalAttributes(k, m);
                var r = m.customProperty,
                r = r ? JSON.parse(r) : {};
                f(a, k, r);
                this.colorAttributes(k, m);
                this.anchorPointAttributes(k, m);
                this.parseChild.call(this, k, d, e);
                return k
            })
        },
        getVersionInteger: function(a) {
            if (!a || "string" !== typeof a) return 0;
            a = a.split(".");
            if (4 !== a.length) return 0;
            var b = 0;
            a.forEach(function(a, d) {
                b += a * Math.pow(10, 3 - d)
            });
            return b
        },
        storeFileDesignSize: function(a, b) {
            this._fileDesignSizes[a] = b
        },
        getFileDesignSize: function(a) {
            return this._fileDesignSizes[a]
        },
        getFilePath: function() {
            return this._filePath
        },
        setFilePath: function(a) {
            this._filePath = a
        },
        getParseObjectMap: function() {
            return ccs._load.getParser("ccui")["*"].parsers
        },
        getParseCallBackMap: function() {
            return ccs._load.getParser("ccui")["*"].parsers
        },
        clear: function() {}
    }
})(); (function() {
    ccs.sceneReader = {
        _node: null,
        createNodeWithSceneFile: function(a) {
            return this._node = a = ccs._load(a, "scene")
        },
        getNodeByTag: function(a) {
            return null == this._node ? null: this._node.getTag() === a ? this._node: this._nodeByTag(this._node, a)
        },
        _nodeByTag: function(a, b) {
            if (null == a) return null;
            for (var c = null,
            d = a.getChildren(), e = 0; e < d.length && (!(c = d[e]) || c.getTag() !== b) && !(c = this._nodeByTag(c, b)); e++);
            return c
        },
        version: function() {
            return "*"
        },
        setTarget: function() {},
        clear: function() {
            ccs.triggerManager.removeAll();
            cc.audioEngine.end()
        }
    }
})();
var isTest = !1,
serverUrl = "https://popstone.9191youxi.com:8080/popstone?";
switch (sdkName) {
case "FaceBookTest":
    serverUrl = "https://pandatest.9191youxi.com:8080/popstone?";
    break;
case "FaceBook":
    serverUrl = "https://popstone.9191youxi.com:8080/popstone?"
};
for (var gameSaveDataKey = "PopStone2",
petMaxLevel = 60,
gameWidth = 720,
gameHigh = 1280,
gameLayout = cc.ResolutionPolicy.SHOW_ALL,
gameSeep = 1,
language = "en",
langueArr = ["en", "es"], languageIndex = 0, loadResCount = 100, connectedTxt = "\u7f51\u7edc\u4e2d\u65ad\u70b9\u51fb\u91cd\u8fde!", n = 0; n < langueArr.length; n++) language == langueArr[n] && (languageIndex = n);
var playEffectMinTime = 50,
languagePath = "res/data/" + language + ".json",
animationPath = "res/data/animation.json",
defaultTxt = "Microsoft YaHei",
defaultBottonSound = "",
escapeTxt = {
    "/": "gang",
    "\u20ac": "ou",
    "+": "jia",
    "%": "bai",
    x: "x"
},
mappingSDK = {},
helpTestLanguage = ["Color stones: \ncan be eliminated with \nany stone.", "Colorless stones: \ncolor will change and can \nbe eliminated with stones \nin the same color.", "Clear stones: \nexplode when falling down \nat the bottom. Gain high \nscores during explosion.", "Operation switch: Single \nclick - click to eliminate \nDouble click - First click to \nselect, and click again to \neliminate."];
var artWordNo = 0,
artWordMiddle = 1,
artWordLeft = 2,
artWordRight = 3,
artWordToRight = 4,
artWordToMiddle = 5,
GameArtWord = cc.Node.extend({
    text: null,
    txtWidth: null,
    fontName: null,
    alignmentType: null,
    contentSprite: null,
    stringSize: null,
    ctor: function(a, b, c) {
        this.alignmentType = artWordNo;
        this.txtWidth = b;
        this.txtHight = c;
        this.stringSize = cc.size(0, 0);
        this.fontName = a;
        this._super();
        this.scheduleUpdate()
    },
    update: function() {},
    setString: function(a) {
        if (a != this.text) {
            null == this.contentSprite ? (this.contentSprite = new cc.Sprite, this.addChild(this.contentSprite)) : this.contentSprite.removeAllChildren();
            this.text = a;
            for (var b = 0,
            c = 0; c < a.length; c++) {
                var d = a[c];
                null != escapeTxt[d] && (d = escapeTxt[d]);
                d = new cc.Sprite("#fnt/" + this.fontName + "_" + d + ".png");
                d.setAnchorPoint(0, 0.5);
                d.x = b;
                if (null != this.txtWidth) b += this.txtWidth;
                else {
                    var e = d.getContentSize();
                    this.stringSize.width = e.width;
                    b += e.width
                }
                this.contentSprite.addChild(d)
            }
            this.stringSize.width = b;
            switch (this.alignmentType) {
            case artWordMiddle:
                this.contentSprite.x = -b / 2;
                break;
            case artWordLeft:
                this.contentSprite.x = 0;
                break;
            case artWordRight:
                this.contentSprite.x = -b;
                break;
            case artWordToRight:
                this.contentSprite.x = -b + e.width;
                break;
            case artWordToMiddle:
                this.contentSprite.x = -b / 2 + 0.5 * e.width
            }
        }
    }
}),
creatGameArtWord = function(a, b) {
    var c = new GameArtWord;
    c.fontName = a;
    c.txtWidth = b;
    return c
};
var currentScene = null,
GameScene = cc.Scene.extend({
    sceneName: null,
    onEnter: function() {
        currentScene = this;
        this._super()
    },
    initialize: function() {
        this.scheduleUpdate()
    },
    update: function(a) {
        engine.engineuUpdate(a)
    }
}),
transitions = function(a, b, c, d) {
    null == b && (b = []);
    null == c && (c = LoadScene);
    loaderRes(b,
    function() {
        engine.gameUpdate.cleanUpdate();
        null != a && cc.director.runScene(new a)
    },
    c, d)
};
var createMaskLayer = function(a, b) {
    var c = new cc.Layer;
    if (null != b) c.addChild(b);
    else {
        var d = new cc.DrawNode;
        d.drawRect(cc.p(0, 0), cc.p(gameWidth, gameHigh), cc.color(0, 0, 0, 120), 0, cc.color(0, 0, 0, 120));
        var e = new cc.Sprite;
        e.addChild(d);
        c.addChild(e)
    }
    a.maskLayer = c;
    a.addChild(c, -1);
    engine.gameEvent.createMouseDown(c,
    function() {},
    null, cc.rect(0, 0, gameWidth, gameHigh));
    return a
},
createAlphaMaskLayer = function(a, b) {
    var c = new cc.Layer;
    if (null != b) c.addChild(b);
    else {
        var d = new cc.DrawNode;
        d.drawRect(cc.p(0, 0), cc.p(gameWidth, gameHigh), cc.color(0, 0, 0, 0), 0, cc.color(0, 0, 0, 0));
        var e = new cc.Sprite;
        e.addChild(d);
        c.addChild(e)
    }
    a.maskLayer = c;
    a.addChild(c, -1);
    engine.gameEvent.createMouseDown(c,
    function() {},
    null, cc.rect(0, 0, gameWidth, gameHigh));
    return a
},
createMaskRectLayer = function(a, b, c) {
    null == c && (c = []);
    for (var d = new cc.Layer,
    e = 0; e < b.length; e++) {
        var f = b[e],
        g = new cc.DrawNode;
        g.drawRect(cc.p(0, 0), cc.p(f.width, f.height), cc.color(0, 0, 0, 90), 0, cc.color(0, 0, 0, 0));
        var h = new cc.Sprite;
        h.addChild(g);
        h.x = f.x;
        h.y = f.y;
        d.addChild(h)
    }
    for (e = 0; e < c.length; e++) f = c[e],
    g = new cc.DrawNode,
    g.drawRect(cc.p(0, 0), cc.p(f.width, f.height), cc.color(0, 0, 0, 1), 0, cc.color(0, 0, 0, 0)),
    h = new cc.Sprite,
    h.addChild(g),
    h.x = f.x,
    h.y = f.y,
    d.addChild(h);
    d.checkClick = function(a, c) {
        for (var d = c.getCurrentTarget().convertToNodeSpace(a.getLocation()), e = 0; e < b.length; e++) if (cc.rectContainsPoint(b[e], d)) return ! 0;
        return ! 1
    };
    engine.gameEvent.createMouseDown(d,
    function() {},
    null);
    a.maskLayer = d;
    a.addChild(d, -1);
    return a
},
createPageLayer = function(a) {
    var b = new GamePageLayer;
    b.addChild(a.ui);
    b.initialize(a);
    return b
},
landscapePage = 1,
portaitPage = 2,
GamePageLayer = cc.Layer.extend({
    mouseDownPoint: null,
    isMove: null,
    pageIndex: null,
    pageWidth: null,
    pageHeight: null,
    pageMax: null,
    turnPageState: null,
    pageIconList: null,
    pageList: null,
    pageItemCount: null,
    isPlayPageEffect: null,
    pageEffectFun: null,
    setPageInfo: null,
    moveToPoint: null,
    ctor: function() {
        this.isMove = !1;
        this.pageIndex = 0;
        this.isPlayPageEffect = !1;
        this._super()
    },
    initialize: function(a) {
        this.pageMax = a.pageMax;
        this.pageWidth = a.pageWidth;
        this.turnPageState = null == a.turnPageState ? landscapePage: a.turnPageState;
        this.pageIconList = null != a.pageIconList ? a.pageIconList: [];
        this.pageList = null != a.pageList ? a.pageList: [];
        this.pageList = a.pageList;
        this.pageComplete = a.pageComplete;
        this.pageItemCount = a.pageItemCount;
        this.pageEffectFun = a.pageEffectFun;
        this.setPageInfo = a.setPageInfo;
        this.isUpCheck = !1;
        engine.gameEvent.createMouseDown(this, this.mouseDown, null, a.clickRect);
        engine.gameEvent.createMouseMove(this, this.mouseMove, null, a.clickRect);
        engine.gameEvent.createMouseUp(this, this.mouseUp, null, a.clickRect);
        this.setPageIndexNoEffect(0);
        this.setPageIcons()
    },
    hiddenNoCheckedPage: function() {
        for (var a = 0; a < this.pageList.length; a++) a >= this.pageIndex * this.pageItemCount && a < (this.pageIndex + 1) * this.pageItemCount ? this.pageList[a].setVisible(!0) : this.pageList[a].setVisible(!1)
    },
    mouseUp: function(a, b) {
        this.isMove = !1;
        this.mouseDownPoint = null;
        switch (this.turnPageState) {
        case landscapePage:
            var c = Math.ceil(( - this.x - this.pageWidth / 2) / this.pageWidth);
            0 > c && (c = 0);
            c >= this.pageMax && (c = this.pageMax - 1);
            this.setPageIndex(c);
            break;
        case portaitPage:
            this.y += pos.y - this.mouseDownPoint.y
        }
    },
    mouseDown: function(a, b) {
        this.isMove = !1;
        var c = b.getCurrentTarget();
        c.getClickRect();
        this.mouseDownPoint = c.convertToNodeSpace(a.getLocation())
    },
    mouseMove: function(a, b) {
        var c = b.getCurrentTarget();
        c.getClickRect();
        c = c.convertToNodeSpace(a.getLocation());
        if (null != this.mouseDownPoint) switch (30 <= cc.pDistance(this.mouseDownPoint, c) && (this.isMove = !0), this.stopAllActions(), this.turnPageState) {
        case landscapePage:
            this.x += c.x - this.mouseDownPoint.x;
            break;
        case portaitPage:
            this.y += c.y - this.mouseDownPoint.y
        }
    },
    nextPage: function() {
        this.pageIndex + 1 < this.pageMax && (this.pageIndex++, this.setPageIndex(this.pageIndex))
    },
    lastPage: function() {
        0 <= this.pageIndex - 1 && (this.pageIndex--, this.setPageIndex(this.pageIndex))
    },
    setPageIndexNoEffect: function(a) {
        this.stopAllActions();
        this.pageIndex = a;
        this.x = -this.pageIndex * this.pageWidth;
        this.setPageIcons()
    },
    setPageIndex: function(a) {
        switch (this.turnPageState) {
        case 1:
            this.stopAllActions();
            this.pageIndex = a;
            a = cc.moveTo(0.5, cc.p( - 1 * this.pageIndex * this.pageWidth, this.y));
            this.runAction(a);
            this.setPageIcons();
            null != this.setPageInfo && this.setPageInfo(this.pageIndex);
            break;
        case 2:
            this.stopAllActions(),
            this.pageIndex = a,
            a = cc.moveTo(0.5, cc.p( - 1 * this.pageIndex * this.pageHeight, this.y)),
            this.runAction(a),
            this.setPageIcons(),
            null != this.setPageInfo && this.setPageInfo(this.pageIndex)
        }
    },
    setPageIcons: function() {
        if (! (0 >= this.pageIconList.length)) {
            for (var a = 0; a < this.pageIconList.length; a++) this.pageIconList[a].setVisible(!1);
            this.pageIconList[this.pageIndex].setVisible(!0)
        }
    }
}),
GameLayer = cc.Class.extend({
    isInit: null,
    createMaskLayer: null,
    createPageLayer: null,
    ctor: function() {
        this.isInit = !1
    },
    initialize: function() { ! 0 != this.isInit && (this.isInit = !0, this.createMaskLayer = createMaskLayer, this.createPageLayer = createPageLayer)
    }
});
var LoadSprite = cc.Sprite.extend({
    loadComplete: null,
    setPNGUrl: function(a, b) {
        if (null != cc.spriteFrameCache.getSpriteFrame(a)) this.setSpriteFrame(a),
        this.setScale(b / this.getContentSize().width);
        else {
            var c = this,
            d = new Image;
            d.crossOrigin = "anonymous";
            d.src = a;
            d.onload = function() {
                null != c.loadComplete && c.loadComplete(d)
            }
        }
    }
});
var GameCustomImage = cc.Class.extend({
    width: null,
    height: null,
    pngData: null,
    fontData: null,
    drawFun: null,
    drawCompleteFun: null,
    initialize: function(a) {
        this.pngData = null != a.pngData ? a.pngData: [];
        this.fontData = null != a.fontData ? a.fontData: [];
        this.width = a.width;
        this.height = a.height;
        this.getBase64Image(a)
    },
    getBase64Image: function(a) {
        var b = this;
        for (a = 0; a < this.pngData.length; a++) {
            var c = this.pngData[a],
            d = new Image;
            c.playImage = d;
            d.crossOrigin = "anonymous";
            d.imgHeight = c.imgHeight;
            d.imgWidth = c.imgWidth;
            d.src = c.url;
            d.isLoad = !1;
            d.onload = function() {
                this.width = this.imgWidth;
                this.height = this.imgHeight;
                this.isLoad = !0;
                b.drawImage()
            }
        }
    },
    drawImage: function() {
        for (var a = 0; a < this.pngData.length; a++) {
            var b = this.pngData[a];
            if (!1 == b.playImage.isLoad) return
        }
        if (null != this.drawFun) this.drawFun();
        else {
            a = document.createElement("canvas");
            a.width = this.width;
            a.height = this.height;
            for (var c = 0; c < this.pngData.length; c++) {
                var b = this.pngData[c],
                d = a.getContext("2d");
                d.drawImage(b.playImage, b.posX, b.posY, b.playImage.width, b.playImage.height)
            }
            for (b = 0; b < this.fontData.length; b++) c = this.fontData[b],
            d.font = c.font,
            d.lineWidth = c.lineWidth,
            d.fillStyle = c.fillStyle,
            d.textAlign = c.textAlign,
            d.strokeStyle = c.strokeStyle,
            d.strokeText(c.des.toString(), c.posX, c.posY),
            d.fillText(c.des.toString(), c.posX, c.posY);
            d = a.toDataURL("image/png");
            null != this.drawCompleteFun && this.drawCompleteFun(d)
        }
    }
});
var LoadControl = cc.Class.extend({
    cb: null,
    resources: null,
    originalResources: null,
    isInit: null,
    loadClassName: null,
    analysisFun: null,
    isloadBefore: null,
    loadBeforeValue: null,
    loadMC: null,
    loadTotalCount: null,
    initialize: function(a) {
        this.cb = a.cb;
        this.analysisFun = a.analysisFun;
        this.loadClassName = a.loadClassName;
        this.loadBeforeValue = a.loadBeforeValue;
        this.isloadBefore = a.isloadBefore;
        this.loadTotalCount = 0;
        null == this.loadBeforeValue && (this.loadBeforeValue = 0);
        this.originalResources = this.getMustLoadResources(a.resources);
        0 == this.originalResources.length ? this.loadEnd() : (this.loadMC = new this.loadClassName(this), !0 != this.isloadBefore && this.load(0.1))
    },
    loadEnd: function() {
        null != this.analysisFun && this.analysisFun();
        null != this.cb && this.cb()
    },
    load: function(a) {
        this.loadTotalCount++;
        if (! (10 < this.loadTotalCount)) {
            var b = this.getCheckLoadResources(this.originalResources, !0);
            0 < b.length ? (this.resources = b, b = this.loadMC.loadCount, this.loadMC = new this.loadClassName(this), this.loadMC.loadCount = b, this.loadMC.showLoad(), this.loadMC.load(a)) : this.loadEnd()
        }
    },
    setLoadPercent: function(a) {
        this.loadMC.setLoadPercent(a)
    },
    getLoadCount: function() {
        return this.originalResources.length - this.getLoadResourcesCount(this.originalResources).length
    },
    getLoadResourcesCount: function(a) {
        for (var b = [], c = 0; c < a.length; c++) if (null != a[c].type && "font" == a[c].type) for (var d = 0; d < a[c].srcs.length; d++) null == cc.loader.getRes(getUrlByVersion(a[c].srcs[d])) && b.push(getUrlByVersion(a[c].srcs[d]));
        else a[c].indexOf("mp3"),
        null == cc.loader.getRes(a[c]) && b.push(a[c]);
        return b
    },
    getCheckLoadResources: function(a) {
        for (var b = [], c = 0; c < a.length; c++) if (null != a[c].type && "font" == a[c].type) for (var d = 0; d < a[c].srcs.length; d++) null == cc.loader.getRes(getUrlByVersion(a[c].srcs[d])) && b.push(getUrlByVersion(a[c].srcs[d]));
        else a[c].indexOf("mp3"),
        null == cc.loader.getRes(a[c]) && b.push(a[c]);
        return b
    },
    getMustLoadResources: function(a) {
        for (var b = [], c = 0; c < a.length; c++) if (null != a[c].type && "font" == a[c].type) for (var d = 0; d < a[c].srcs.length; d++) null == cc.loader.getRes(getUrlByVersion(a[c].srcs[d])) && b.push(getUrlByVersion(a[c].srcs[d]));
        else if (0 <= a[c].indexOf("mp3")) null == cc.loader.getRes(a[c]) && b.push(a[c]);
        else if (null == cc.loader.getRes(a[c])) {
            if (0 <= a[c].indexOf(".plist")) {
                var d = a[c],
                e = d.split("/"),
                e = e[e.length - 1],
                f = e.split(".")[0] + ".png",
                d = d.substring(0, d.length - e.length) + f;
                if (null != cc.loader.getRes(getUrlByVersion(d))) continue
            }
            b.push(a[c])
        }
        return b
    }
}),
loadSoundDic = {},
LoadSound = cc.Class.extend({
    playSound: null,
    loadEffectSound: function(a) {
        null == loadSoundDic[a] && (loadSoundDic[a] = !0, cc.loader.load(a,
        function() {}))
    },
    loadBackgroundSound: function(a) {
        null == loadSoundDic[a] && (loadSoundDic[a] = {},
        loadSoundDic[a].loadCount = 1, loadSoundDic[a].isNowLoad = !1);
        if (! (10 <= loadSoundDic[a].loadCount)) {
            var b = cc.loader.getRes(a);
            null != b && null == b._element && (b = null, cc.loader.release(a));
            if (null == b) {
                if (!1 == loadSoundDic[a].isNowLoad) {
                    var c = this;
                    null == b && (loadSoundDic[a].isNowLoad = !0, loadSoundDic[a].loadCount++, setTimeout(function() {
                        cc.loader.load(a,
                        function() {
                            loadSoundDic[a].isNowLoad = !1;
                            c.loadBackgroundSound(a)
                        })
                    },
                    2))
                }
            } else this.playSound(a)
        }
    }
}),
LoadScene = GameScene.extend({
    label: null,
    isInit: null,
    loadCount: null,
    loadControl: null,
    loadBeforeValue: null,
    mustLoadConnt: null,
    ctor: function(a) {
        this.sceneName = "LoadScene";
        this.isInit = !1;
        this.loadCount = 0;
        this.loadBefore = null;
        this.loadBeforeValue = 0;
        this.mustLoadConnt = a.originalResources.length;
        this.loadControl = a;
        this.loadBeforeValue = a.loadBeforeValue;
        cc.director.runScene(this);
        this._super();
        this.setLoadStyle()
    },
    initialize: function() {
        this._super()
    },
    load: function(a) {
        var b = this;
        this.scheduleOnce(function() {
            cc.loader.load(this.loadControl.resources,
            function(a, d, e) {
                b.loadCount = b.loadControl.getLoadCount();
                b.showLoad()
            },
            function() {
                b.loadControl.load(0.2)
            })
        },
        a)
    },
    setLoadStyle: function() {
        this.label = new cc.LabelTTF("Loading...", defaultTxt, 24);
        this.label.setPosition(375, 87);
        this.label.setColor(cc.color(255, 255, 255));
        this.addChild(this.label, 100)
    },
    computationsLoadProgress: function() {
        return Math.floor(this.loadCount / this.mustLoadConnt * 100) | 0
    },
    showLoad: function() {
        if (null != this.loadprogress) {
            var a = this.computationsLoadProgress();
            this.setLoadPercent(a)
        }
    },
    setLoadPercent: function(a) {
        this.label.setString("Loading..." + a + "%")
    }
}),
loaderRes = function(a, b, c, d, e, f) {
    var g = {};
    g.resources = a;
    g.cb = b;
    g.analysisFun = d;
    g.loadClassName = c;
    g.isloadBefore = e;
    g.loadBeforeValue = f;
    a = new LoadControl;
    a.initialize(g);
    return a
};
var GameSound = cc.Class.extend({
    isInit: null,
    soundVolume: null,
    stopSound: null,
    playMusicUrl: null,
    lastTimeDic: null,
    ctor: function() {
        this.isInit = !1;
        this.soundVolume = 100;
        this.stopSound = !1;
        this.playMusicUrl = "";
        this.lastTimeDic = {}
    },
    initialize: function() { ! 0 != this.isInit && (this.isInit = !0)
    },
    stopMusic: function() {
        this.stopSound = !0;
        cc.audioEngine.setMusicVolume(0);
        cc.audioEngine.setEffectsVolume(0);
        gameLocalData.musicVolume = 0;
        saveLocalUserData()
    },
    openMusic: function() {
        this.stopSound = !1;
        cc.audioEngine.setMusicVolume(this.soundVolume);
        cc.audioEngine.setEffectsVolume(this.soundVolume);
        gameLocalData.musicVolume = 1;
        saveLocalUserData()
    },
    changeMusicState: function() { ! 0 == this.stopSound ? this.openMusic() : this.stopMusic()
    },
    setSoundVolume: function(a) {
        this.soundVolume = a; ! 1 == this.stopSound && (cc.audioEngine.setMusicVolume(a), cc.audioEngine.setEffectsVolume(this.soundVolume))
    },
    playEffect: function(a) {
        var b = engineGameRunTime();
        null != this.lastTimeDic[a] && b - playEffectMinTime <= this.lastTimeDic[a] || (this.lastTimeDic[a] = b, (new LoadSound).loadEffectSound(a), cc.audioEngine.playEffect(a))
    },
    playMusic: function(a, b) {
        null == b && (b = !0);
        this.playMusicUrl = a;
        var c = this,
        d = new LoadSound;
        d.playSound = function(a) {
            a == c.playMusicUrl && cc.audioEngine.playMusic(a, b)
        };
        d.loadBackgroundSound(a)
    }
});
var cocosUIAction = {},
GameCocosStudio = cc.Class.extend({
    isInit: null,
    loadCSS: null,
    ctor: function() {
        this.isInit = !1
    },
    initialize: function() { ! 0 != this.isInit && (this.isInit = !0, this.loadCSS = loadCSS)
    },
    setChangeString: function(a) {
        a.txtValue = "";
        a.setString = function(b) {
            a.txtValue != b && (a.txtValue = b, a.setString(b))
        }
    }
}),
createMouseMove = function(a, b, c, d) {
    a.mouseDownTypeList = c;
    null != a.addTouchEventListener ? createCCSTouchEventListener(a) : createTouchEventListener(a, d);
    a.mouseMovefun = b;
    a.mouseMove = function(b, c) {
        if (!1 == a.visible) return ! 1;
        null != a.mouseMovefun && a.mouseMovefun(b, c)
    }
},
createMouseDown = function(a, b, c, d) {
    a.mouseDownTypeList = c;
    null != a.addTouchEventListener ? createCCSTouchEventListener(a) : createTouchEventListener(a, d);
    a.mouseDownfun = b;
    a.mouseDown = function(b, c) {
        if (!1 == a.visible) return ! 1;
        null != a.mouseDownTypeList && 0 <= a.mouseDownTypeList.indexOf(buttonScalingType) && (null == a.bottonSound && 0 < defaultBottonSound.length && engine.gameSound.playEffect(defaultBottonSound), null != a.realScale ? a.setScale(0.9 * a.realScale) : a.setScale(0.9));
        null != a.mouseDownfun && a.mouseDownfun(b, c)
    };
    null == a.mouseUp && (a.mouseUp = function(b, c) {
        if (!1 == a.visible) return ! 1;
        null != a.mouseDownTypeList && 0 <= a.mouseDownTypeList.indexOf(buttonScalingType) && (null != a.realScale ? a.setScale(a.realScale) : a.setScale(1))
    })
},
createMouseUp = function(a, b, c, d) {
    null != c && (a.mouseDownTypeList = c);
    null != a.addTouchEventListener ? createCCSTouchEventListener(a) : createTouchEventListener(a, d);
    a.mouseUpfun = b;
    a.mouseUp = function(b, c) {
        if (!1 == a.visible) return ! 1;
        null != a.mouseDownTypeList && 0 <= a.mouseDownTypeList.indexOf(buttonScalingType) && (null != a.realScale ? a.setScale(a.realScale) : a.setScale(1));
        if (!1 != a.isUpCheck && null != a.checkClick && !1 == a.checkClick(b, c)) return ! 1;
        null != a.mouseUpfun && a.mouseUpfun(b, c)
    };
    null == a.mouseDown && (a.mouseDown = function(b, c) {
        if (!1 == a.visible) return ! 1;
        null != a.mouseDownTypeList && 0 <= a.mouseDownTypeList.indexOf(buttonScalingType) && (null == a.bottonSound && 0 < defaultBottonSound.length && engine.gameSound.playEffect(defaultBottonSound), null != a.realScale ? a.setScale(0.9 * a.realScale) : a.setScale(0.9))
    })
},
createTouchEventListener = function(a, b) {
    if (null == a.checkClick) {
        if (null != b) a.getClickRect = function() {
            return b
        };
        else if (a.constructor == cc.Node) {
            var c = null,
            c = findClickSize(a, c);
            a.getClickRect = null != c ?
            function() {
                return cc.rect(1 * -c.width / 2, 1 * -c.height / 2, c.width, c.height)
            }: function() {
                var b = a.getContentSize();
                return cc.rect(cc.rect(0, 0, b.width, b.height))
            }
        } else a.getClickRect = function() {
            var b = a.getContentSize();
            return cc.rect(cc.rect(0, 0, b.width, b.height))
        };
        a.checkClick = function(a, b) {
            var c = b.getCurrentTarget(),
            d = c.getClickRect(),
            c = c.convertToNodeSpace(a.getLocation());
            return cc.rectContainsPoint(d, c) ? !0 : !1
        }
    }
    a.eventMouseDown = function(b, c) {
        if (!1 == a.checkClick(b, c)) return ! 1;
        null != a.mouseDown && a.mouseDown(b, c);
        return ! 0
    };
    a.eventMouseMove = function(b, c) {
        null != a.mouseMove && a.mouseMove(b, c)
    };
    a.eventMouseUp = function(b, c) {
        null != a.mouseUp && a.mouseUp(b, c)
    };
    var d = !0;
    null != a.isSwallowTouches && (d = a.isSwallowTouches);
    a.uiListener = cc.eventManager.addListener({
        event: cc.EventListener.TOUCH_ONE_BY_ONE,
        swallowTouches: d,
        onTouchBegan: a.eventMouseDown,
        onTouchMoved: a.eventMouseMove,
        onTouchEnded: a.eventMouseUp,
        onTouchCancelled: null
    },
    a);
    a.uiRemoveListener = function() {
        null != a.uiListener && cc.eventManager.removeListener(a.uiListener)
    }
},
createCCSTouchEventListener = function(a) {
    null == a.touchEvent && (a.touchEvent = function(b, c) {
        switch (c) {
        case ccui.Widget.TOUCH_BEGAN:
            null != a.mouseDown && a.mouseDown();
            break;
        case ccui.Widget.TOUCH_MOVED:
            null != a.mouseMove && a.mouseMove();
            break;
        case ccui.Widget.TOUCH_ENDED:
            null != a.mouseUp && a.mouseUp()
        }
    },
    a.addTouchEventListener(a.touchEvent, a), a.uiRemoveListener = function() {})
},
findClickSize = function(a, b) {
    var c = a.getContentSize();
    if (0 != c.width && 0 != c.height) b = c;
    else for (var c = a.getChildren(), d = 0; d < c.length; d++) b = findClickSize(c[d], b);
    return b
},
setCCSSprite = function(a, b) {
    var c = a.getName(),
    d = cocosUIAction[b[c]].clone();
    a.runAction(d);
    a.gotoStop = function(a) {
        d.gotoFrameAndPlay(a, a, !1)
    }
},
setCCSSpriteText = function(a, b) {
    var c = a.getName(),
    d = cocosUIAction[b[c]].clone();
    a.runAction(d);
    a.gotoStop = function(a) {
        d.gotoFrameAndPlay(a, a, !1)
    };
    a.gotoStop(languageIndex)
},
setCCSSpriteArtWord = function(a) {
    var b = a.getName().split("_"),
    b = creatGameArtWord(b[1]);
    switch (a.getTextHorizontalAlignment()) {
    case cc.TEXT_ALIGNMENT_CENTER:
        b.alignmentType = artWordMiddle;
        break;
    case cc.TEXT_ALIGNMENT_LEFT:
        b.alignmentType = artWordLeft;
        break;
    case cc.TEXT_ALIGNMENT_RIGHT:
        b.alignmentType = artWordRight
    }
    b.x = a.x;
    b.y = a.y;
    null != a.parent && (a.parent.addChild(b), a.removeFromParent());
    return b
},
setCCSTxtLanguage = function(a) {
    var b = a.getName().split("_");
    0 < b.length ? a.setString(engine.gameData.getLanguageByKey(b[1])) : printLog("\u4f60\u6240\u914d\u7f6e\u7684\u6587\u672c\u6ca1\u6709\u6307\u5b9a\u591a\u8bed\u8a00\u914d\u7f6e\u6587\u4ef6\u6240\u9700\u8981\u7684\u952e\u503c!!!")
},
setCCSAllUI = function(a, b) {
    var c = a.getChildren(),
    d = c.length,
    e = a.getName();
    a.getChildByName = function(b) {
        return b = findChildByName(a, b, null)
    };
    if (0 <= e.indexOf("txt_")) {
        var f = e.split("_");
        setCCSTxtLanguage(a, f[1])
    }
    0 <= e.indexOf("sp_") && setCCSSprite(a, b);
    0 <= e.indexOf("spt_") && setCCSSpriteText(a, b);
    0 <= e.indexOf("_sound") && setCCSSound(a, b);
    0 <= e.indexOf("_df") && a.setFontName(defaultTxt);
    0 <= e.indexOf("aw_") && (a = setCCSSpriteArtWord(a));
    null != a.parent && (null == a.parent[e] ? a.parent[e] = a: printLog("\u4f60\u5728UI\u91cc\u9762\u8d77\u7684\u540d\u5b57\u662f\u5173\u952e\u5b57\u6216\u91cd\u590d\uff01\u8bf7\u68c0\u67e5CCS"));
    for (d -= 1; 0 <= d; d--) setCCSAllUI(c[d], b)
},
loadCSS = function(a, b) {
    null == b && (b = !0);
    var c = ccs.load(a).node,
    d = {};
    if (!0 == b) {
        loadAction(a);
        var e = cc.loader.getRes(a).Content.Content.ObjectData.Children,
        d = getChildrenNodePath(e, d)
    }
    setCCSAllUI(c, d);
    return c
},
loadAction = function(a) {
    if (null != cocosUIAction) {
        ccs.load(a);
        cocosUIAction[a] = ccs.load(a).action;
        a = cc.loader.getRes(a).Content.Content.UsedResources;
        for (var b = 0; b < a.length; b++) 0 < a[b].indexOf(".json") && loadAction("res/" + a[b])
    }
};
function getChildrenNodePath(a, b) {
    for (var c = 0; c < a.length; c++) {
        var d = a[c].Name;
        if (0 <= d.indexOf("sp_") || 0 <= d.indexOf("spt_")) b[d] = "res/" + a[c].FileData.Path;
        null != a[c].Children && (b = getChildrenNodePath(a[c].Children, b));
        0 > d.indexOf("sp_") && 0 > d.indexOf("spt_") && null != a[c].FileData && null != a[c].FileData.Path && 0 <= a[c].FileData.Path.indexOf(".json") && (a = cc.loader.getRes("res/" + a[c].FileData.Path).Content.Content.ObjectData.Children, b = getChildrenNodePath(a, b))
    }
    return b
}
var findChildByName = function(a, b, c) {
    a = a.getChildren();
    for (var d = 0; d < a.length; d++) c = b == a[d].getName() ? a[d] : findChildByName(a[d], b, c);
    return c
},
createClippingNode = function(a, b, c, d, e, f, g) {
    var h = new cc.ClippingNode;
    h.anchorX = a;
    h.anchorY = b;
    h.x = c;
    h.y = d;
    h.alphaThreshold = e;
    h.inverted = f;
    h.stencil = g;
    return h
};
var buttonScalingType = "1";
function setCCSSound(a, b) {
    a.setUIState = function() {
        engine.gameSound.stopSound ? (a.closesound.setVisible(!0), a.opensound.setVisible(!1)) : (a.closesound.setVisible(!1), a.opensound.setVisible(!0))
    };
    engine.gameEvent.createMouseDown(a,
    function(b, d) {
        engine.gameSound.changeMusicState();
        a.setUIState()
    },
    buttonScalingType, b)
}
var createSoundByPNGURL = function(a, b, c) {
    var d = new cc.Sprite;
    d.setSpriteFrame(a);
    a = new cc.Sprite;
    a.setSpriteFrame(b);
    return createSoundByPNG(d, a, c)
},
createSoundByPNG = function(a, b, c) {
    var d = new cc.Sprite;
    d.addChild(a);
    d.addChild(b);
    d.closesound = a;
    d.opensound = b;
    setCCSSound(d, c);
    return d
};
var dataPathDic = {},
GameData = cc.Class.extend({
    isInit: null,
    dataDic: null,
    isCreateJsonData: null,
    languageDic: null,
    animationDic: null,
    ctor: function() {
        this.isCreateJsonData = this.isInit = !1;
        this.dataDic = {}
    },
    addDataDic: function(a, b) {
        this.dataDic[a] = b
    },
    initialize: function() { ! 0 != this.isInit && (this.isInit = !0)
    },
    createJsonData: function() {
        if (!this.isCreateJsonData) {
            this.isCreateJsonData = !0;
            for (var a in dataPathDic) this.dataDic[a] = this.analysisJsonData(cc.loader.getRes(dataPathDic[a]), a);
            this.languageDic = {};
            this.languageDic = this.analysisJsonData(cc.loader.getRes(languagePath), languagePath)
        }
    },
    getLanguageByKey: function(a) {
        if (null != this.languageDic[a]) return this.languageDic[a].content;
        printLog("\u914d\u7f6e\u7684\u591a\u8bed\u8a00" + a + "\u7f3a\u5c11\u5bf9\u5e94\u7684\u952e\u503c");
        return ""
    },
    analysisJsonData: function(a, b) {
        if (null == a) printLog("\u914d\u7f6e\u7684" + b + "JSON\u6587\u4ef6\u7f3a\u5931");
        else {
            for (var c = {},
            d = 1; d < a.length; d++) {
                for (var e = {},
                f = 0; f < a[d].length; f++) e[a[0][f]] = "null" != a[d][f] ? a[d][f] : "";
                c[a[d][0]] = e
            }
            return c
        }
    }
}),
GameDataDic = cc.Class.extend({
    dataDic: null,
    num: null,
    ctor: function() {
        this.dataDic = {};
        this.num = 0
    },
    addData: function(a, b) {
        this.dataDic[a] = b;
        this.num++
    },
    deleteData: function(a) {
        this.dataDic[a] = null;
        delete this.dataDic[a];
        this.num--
    },
    getDataByKey: function(a) {
        return this.dataDic[a]
    },
    getDataNum: function() {
        return this.num
    }
});
var gameUserData, gameLocalData, readGameUserData = function() {
    var a;
    try {
        a = cc.sys.localStorage.getItem(gameSaveDataKey),
        a = JSON.parse(a)
    } catch(b) {}
    return a
},
saveLocalUserData = function() {
    try {
        cc.sys.localStorage.setItem(gameSaveDataKey, JSON.stringify(gameLocalData))
    } catch(a) {}
},
initGameLocalData = function() {
    null == gameLocalData && (gameLocalData = {
        musicVolume: 1
    });
    var a = readGameUserData(),
    b;
    for (b in a) gameLocalData[b] = a[b]
};
var TileMap = cc.Class.extend({
    offsetX: null,
    offsetY: null,
    gridWidth: null,
    gridHeight: null,
    gridMaxX: null,
    gridMaxY: null,
    isInit: null,
    gridArr: null,
    defaultGridValue: null,
    initialize: function(a) {
        if (!0 != this.isInit) for (this.isInit = !0, this.offsetX = a.offsetX, this.offsetY = a.offsetY, this.gridWidth = a.gridWidth, this.gridHeight = a.gridHeight, this.gridMaxX = a.gridMaxX, this.gridMaxY = a.gridMaxY, this.defaultGridValue = a.defaultGridValue, this.gridArr = [], a = 0; a < this.gridMaxX; a++) {
            for (var b = [], c = 0; c < this.gridMaxY; c++) b.push(this.defaultGridValue);
            this.gridArr.push(b)
        }
    },
    setTileMapAttribute: function(a) {
        this.offsetX = a.offsetX;
        this.offsetY = a.offsetY;
        this.gridWidth = a.gridWidth;
        this.gridHeight = a.gridHeight;
        this.gridMaxX = a.gridMaxX;
        this.gridMaxY = a.gridMaxY;
        this.defaultGridValue = a.defaultGridValue;
        this.gridArr = [];
        for (a = 0; a < this.gridMaxX; a++) {
            for (var b = [], c = 0; c < this.gridMaxY; c++) b.push(this.defaultGridValue);
            this.gridArr.push(b)
        }
    },
    clearGridInfo: function(a, b) {
        this.setGridInfo(a, b, this.defaultGridValue)
    },
    setGridInfo: function(a, b, c) {
        if (null != c) {
            if (c.isDespose) {
                printLog("\u6d88\u9664\u6389\u7684\u5143\u7d20");
                return
            }
            c.gridX = a;
            c.gridY = b
        }
        this.gridArr[a][b] = c
    },
    getGridByGridPoint: function(a, b) {
        return 0 > a || 0 > b || a >= this.gridMaxX || b >= this.gridMaxY ? null: this.gridArr[a][b]
    },
    getGridByScenePoint: function(a, b) {
        var c = this.getScenePointByGridPoint(a, b);
        return this.getGridByGridPoint(c.x, c.y)
    },
    getScenePointByGridPoint: function(a, b) {
        return cc.p(Math.floor((a - this.offsetX) / this.gridWidth), this.gridMaxY - 1 - Math.floor((b - this.offsetY) / this.gridHeight))
    },
    getGridPointByScenePoint: function(a, b) {
        var c = cc.p(a * this.gridWidth + this.gridWidth / 2, (this.gridMaxY - 1 - b) * this.gridHeight + this.gridHeight / 2);
        c.x += this.offsetX;
        c.y += this.offsetY;
        return c
    },
    settingGridByScene: function(a) {
        for (var b = 0; b < a.length; b++) {
            var c = this.getScenePointByGridPoint(a[b].x, a[b].y),
            c = this.getGridPointByScenePoint(c.x, c.y);
            a[b].x = c.x;
            a[b].y = c.y
        }
    },
    settingGridByAStar: function(a) {
        for (a = 0; a < this.gridArr.length; a++) for (var b = 0; b < this.gridArr[a].length; b++) {
            var c = this.gridArr[a][b];
            if (null != c) {
                var d = this.getGridPointByScenePoint(a, b);
                c.x = d.x;
                c.y = d.y
            }
        }
    },
    getRectGridsPointByFour: function(a, b) {
        var c = [];
        a + 1 < this.gridMaxX && c.push(cc.p(a + 1, b));
        0 <= a - 1 && c.push(cc.p(a - 1, b));
        0 <= b - 1 && c.push(cc.p(a, b - 1));
        b + 1 < this.gridMaxY && c.push(cc.p(a, b + 1));
        return c
    }
});
var GameAnimation = cc.Sprite.extend({
    frameIndex: null,
    frameMaxIndex: null,
    lastFrameTime: null,
    frameIntervalTime: null,
    imgeUrls: null,
    isInit: null,
    playCount: null,
    curPlayCount: null,
    isStop: null,
    isRemoveFromComplete: null,
    frameFun: null,
    frameCompleteFun: null,
    selectorTargetInfo: null,
    folderName: null,
    playFrameIndex: null,
    fromFrameIndex: null,
    isPool: !1,
    onEnter: function() {
        this._super()
    },
    ctor: function() {
        this._super();
        this.folderName = "";
        this.resetAttribute()
    },
    resetAttribute: function() {
        this.isPool = !1;
        this.frameIntervalTime = this.lastFrameTime = this.frameMaxIndex = this.frameIndex = 0;
        this.imgeUrls = [];
        this.isInit = !1;
        this.playCount = -1;
        this.curPlayCount = 0;
        this.isRemoveFromComplete = this.isStop = !1;
        this.selectorTargetInfo = this.frameCompleteFun = this.frameFun = null
    },
    reuse: function() {
        this.resetAttribute()
    },
    initialize: function(a) { ! 0 != this.isInit && (this.setInfo(a), this.scheduleUpdate())
    },
    update: function() {
        this.playFrame()
    },
    playFrame: function() {
        if (!0 != this.isStop && engineGameRunTime() - this.lastFrameTime > this.frameIntervalTime) {
            if (this.frameIndex > this.playFrameIndex) if (this.curPlayCount++, -1 == this.playCount) this.frameIndex = this.fromFrameIndex;
            else if (this.curPlayCount < this.playCount) this.frameIndex = this.fromFrameIndex;
            else {
                this.gotoAndStop(this.playFrameIndex);
                null != this.frameCompleteFun && this.frameCompleteFun(); ! 0 == this.isRemoveFromComplete && this.dispose();
                return
            }
            this.lastFrameTime = engineGameRunTime();
            this.setSpriteFrame(this.folderName + "/" + this.imgeUrls[this.frameIndex] + ".png");
            null != this.frameFun && this.frameFun(this.frameIndex, this.selectorTargetInfo);
            this.frameIndex++
        }
    },
    setFrameIntervalTime: function(a) {
        this.frameIntervalTime = parseInt(1 / a * 1E3)
    },
    gotoAndPlay: function(a) {
        this.isStop = !1;
        this.lastFrameTime = 0;
        this.frameIndex = a;
        this.setSpriteFrame(this.folderName + "/" + this.imgeUrls[this.frameIndex] + ".png")
    },
    fromFrameIndexToPlayFrameIndex: function(a, b) {
        this.isStop = !1;
        this.frameIndex = this.fromFrameIndex = a;
        this.lastFrameTime = 0;
        this.setSpriteFrame(this.folderName + "/" + this.imgeUrls[this.frameIndex] + ".png");
        this.playFrameIndex = b
    },
    gotoAndStop: function(a) {
        this.isStop = !0;
        this.lastFrameTime = 0;
        this.frameIndex = a;
        this.setSpriteFrame(this.folderName + "/" + this.imgeUrls[this.frameIndex] + ".png")
    },
    setIsStop: function(a) {
        this.isStop = a
    },
    resetInfo: function(a) {
        this.setInfo(a)
    },
    setInfo: function(a) {
        this.folderName = a.folderName;
        this.fromFrameIndex = this.lastFrameTime = this.frameIndex = this.curPlayCount = 0;
        this.frameMaxIndex = a.frameMaxIndex;
        this.playFrameIndex = this.frameMaxIndex - 1;
        null != a.isRemoveFromComplete && (this.isRemoveFromComplete = a.isRemoveFromComplete);
        null != a.playCount && (this.playCount = a.playCount);
        this.imgeUrls = a.framesBitmapList;
        this.gotoAndPlay(this.frameIndex)
    },
    dispose: function() {
        this.isPool && engine.gamePool.putInPool(this);
        this.removeFromParent()
    }
}),
createGameAnimation = function(a, b, c, d, e) {
    var f = skeletalAnimation[a + "|" + b];
    null == f && (multipleAnimation(a, a), f = skeletalAnimation[a + "|" + b]);
    a = !0 == e ? engine.gamePool.popOut(GameAnimation) : new GameAnimation;
    f.folderName = d;
    a.initialize(f);
    a.setFrameIntervalTime(c);
    return a
};
var skeletalAnimation = {},
GameSkeletalAnimation = cc.Node.extend({
    frameIndex: null,
    lastFrameTime: null,
    frameIntervalTime: null,
    isInit: null,
    framesData: null,
    framesBitmapUrlList: null,
    playCount: null,
    isRemoveFromComplete: null,
    curPlayCount: null,
    frameMaxIndex: null,
    playFrameIndex: null,
    fromFrameIndex: null,
    isStop: null,
    frameCompleteFun: null,
    isPool: !1,
    frameFun: null,
    jsonName: null,
    folderName: null,
    onEnter: function() {
        this._super();
        this.scheduleUpdate()
    },
    ctor: function() {
        this._super();
        this.lastFrameTime = this.frameIndex = 0;
        this.playCount = -1;
        this.frameMaxIndex = this.curPlayCount = 0;
        this.playFrameIndex = 1;
        this.frameBitmapList = [];
        this.isRemoveFromComplete = this.isStop = this.isInit = !1;
        this.folderName = "";
        this.isPool = !1
    },
    initialize: function(a) { ! 0 != this.isInit && this.setInfo(a)
    },
    update: function() {
        if (!0 != this.isStop && engineGameRunTime() - this.lastFrameTime > this.frameIntervalTime) {
            this.lastFrameTime = engineGameRunTime();
            if (this.frameIndex > this.playFrameIndex) if (this.curPlayCount++, -1 == this.playCount) this.frameIndex = this.fromFrameIndex;
            else if (this.curPlayCount < this.playCount) this.frameIndex = this.fromFrameIndex;
            else {
                this.gotoAndStop(this.playFrameIndex);
                null != this.frameCompleteFun && this.frameCompleteFun(); ! 0 == this.isRemoveFromComplete && this.removeFromParent();
                return
            }
            for (var a = 0; a < this.frameBitmapList.length; a++) this.frameBitmapList[a].setBitmapInfo(this.frameIndex),
            255 != this.opacity && (this.frameBitmapList[a].opacity = this.opacity);
            null != this.frameFun && this.frameFun(this.frameIndex);
            this.frameIndex++
        }
    },
    dispose: function() {
        for (var a = 0; a < this.frameBitmapList.length; a++) engine.gamePool.putInPool(this.frameBitmapList[a]);
        this.removeFromParent()
    },
    steFrameComplete: function(a) {
        this.frameCompleteFun = a
    },
    setFrameIntervalTime: function(a) {
        this.frameIntervalTime = parseInt(1 / a * 1E3)
    },
    gotoAndPlay: function(a) {
        this.isStop = !1;
        this.frameIndex = a;
        for (a = 0; a < this.frameBitmapList.length; a++) this.frameBitmapList[a].setBitmapInfo(this.frameIndex)
    },
    gotoAndStop: function(a) {
        this.isStop = !0;
        this.frameIndex = a;
        for (a = 0; a < this.frameBitmapList.length; a++) this.frameBitmapList[a].setBitmapInfo(this.frameIndex)
    },
    fromFrameIndexToPlayFrameIndex: function(a, b) {
        this.isStop = !1;
        this.frameIndex = this.fromFrameIndex = a;
        for (var c = 0; c < this.frameBitmapList.length; c++) this.frameBitmapList[c].setBitmapInfo(this.frameIndex);
        this.playFrameIndex = b
    },
    setIsStop: function(a) {
        this.isStop = a
    },
    resetInfo: function(a) {
        this.setInfo(a)
    },
    setInfo: function(a) {
        for (var b = this.getChildren(), c = b.length - 1; 0 <= c; c--) b[c].removeFromParent();
        this.jsonName = a.jsonName;
        this.folderName = a.folderName;
        this.curPlayCount = this.frameIndex = this.fromFrameIndex = 0;
        this.frameBitmapList = [];
        null != a.isRemoveFromComplete && (this.isRemoveFromComplete = a.isRemoveFromComplete);
        null != a.playCount && (this.playCount = a.playCount);
        this.frameMaxIndex = a.frameMaxIndex;
        this.playFrameIndex = this.frameMaxIndex - 1;
        this.frameIntervalTime = null == a.frameIntervalTime ? parseInt(1 / cc.game.config[cc.game.CONFIG_KEY.frameRate] * 1E3) : a.frameIntervalTime;
        this.framesBitmapList = a.framesBitmapList;
        this.framesData = a.framesBitmapInfo;
        for (a = 0; a < this.framesBitmapList.length; a++) b = {},
        b.url = this.framesBitmapList[a].url,
        b.imgeData = this.framesData[this.framesBitmapList[a].url + "|" + a],
        b.px = this.framesBitmapList[a].px,
        b.py = this.framesBitmapList[a].py,
        b.jsonName = this.jsonName,
        b.folderName = this.folderName,
        b.isPool = this.isPool,
        b = createGameBitmap(b),
        this.addChild(b, this.framesBitmapList[a].zIndex),
        b.setBitmapInfo(this.frameIndex),
        this.frameBitmapList.push(b)
    },
    getBitmapByUrl: function(a) {
        for (var b = 0; b < this.frameBitmapList.length; b++) {
            var c = this.frameBitmapList[b];
            if (c.url == a) return c
        }
        return null
    },
    setBlendFunc: function(a, b) {
        for (var c = 0; c < this.frameBitmapList.length; c++) this.frameBitmapList[c].setBlendFunc(a, b)
    }
}),
createGameBitmap = function(a) {
    var b;
    "im::" == a.url.substr(0, 4) ? (b = a.url.substr(4, a.url.length).split("."), b = createGameAnimation(a.jsonName, b[0], 60, a.folderName, a.isPool), b.setAnchorPoint(cc.p(a.px, a.py)), b.unscheduleUpdate(), b.imgeData = a.imgeData, b.url = a.url, b.setBitmapInfo = function(a) {
        var b = this.imgeData[a];
        this.setSpriteFrame(this.folderName + "/" + this.imgeUrls[a] + ".png");
        this.opacity != b.opacity && this.setOpacity(b.opacity);
        this.x = b.x;
        this.y = -b.y;
        this.skewY != b.skewY && (this.skewY = b.skewY);
        this.skewX != b.skewX && (this.skewX = b.skewX);
        this.scaleY != b.scaleY && this.setScaleY(b.scaleY);
        this.setRotation(b.rotation)
    }) : (b = !0 == a.isPool ? engine.gamePool.popOut(cc.Sprite) : new cc.Sprite, b.setAnchorPoint(cc.p(a.px, a.py)), b.setSpriteFrame(a.folderName + "/" + a.url), b.url = a.url, b.imgeData = a.imgeData, b.setBitmapInfo = function(a) {
        a = this.imgeData[a];
        this.opacity != a.opacity && this.setOpacity(a.opacity);
        this.x = a.x;
        this.y = -a.y;
        this.skewY != a.skewY && (this.skewY = a.skewY);
        this.skewX != a.skewX && (this.skewX = a.skewX);
        this.scaleX != a.scaleX && this.setScaleX(a.scaleX);
        this.scaleY != a.scaleY && this.setScaleY(a.scaleY);
        this.setRotation(a.rotation)
    });
    return b
},
multipleAnimation = function(a, b) {
    for (var c = 0,
    d = cc.loader.getRes(b); null != d["mc" + c.toString()] || null != d["im" + c.toString()];) {
        var e = "";
        null != d["mc" + c.toString()] && (e = a + "|" + d["mc" + c.toString()].name, analysisSkeletalAnimation(e, d["mc" + c.toString()]));
        null != d["im" + c.toString()] && (e = a + "|" + d["im" + c.toString()].name, analysisAnimation(e, d["im" + c.toString()]));
        c++
    }
},
analysisAnimation = function(a, b) {
    null == skeletalAnimation[a] && (skeletalAnimation[a] = {},
    skeletalAnimation[a].frameMaxIndex = b.max, skeletalAnimation[a].folderName = b.folderName, skeletalAnimation[a].framesBitmapList = b.bi.split("|"))
},
analysisSkeletalAnimation = function(a, b) {
    if (null == skeletalAnimation[a] && (skeletalAnimation[a] = {},
    skeletalAnimation[a].frameMaxIndex = b.max, skeletalAnimation[a].framesBitmapList = [], skeletalAnimation[a].framesBitmapInfo = {},
    skeletalAnimation[a].type = b.type, skeletalAnimation[a].folderName = b.folderName, null != b)) for (var c = 0; null != b["mcdata" + c.toString()];) {
        var d = b["mcdata" + c.toString()],
        e = {};
        e.url = d.url + ".png";
        e.zIndex = d.zi;
        e.px = parseFloat(d.px);
        e.py = parseFloat(d.py);
        e.bonename = d.bonename;
        skeletalAnimation[a].framesBitmapList.push(e);
        skeletalAnimation[a].framesBitmapInfo[e.url + "|" + c] = [];
        for (var d = d.bi.split("|"), f = 0; f < d.length; f++) {
            var g = d[f].split(","),
            h = {};
            h.x = "" == g[0] ? 0 : parseFloat(g[0]);
            h.y = "" == g[1] ? 0 : parseFloat(g[1]);
            h.scaleX = "" == g[2] ? 1 : parseFloat(g[2]);
            h.scaleY = "" == g[3] ? 1 : parseFloat(g[3]);
            h.opacity = "" == g[4] ? 255 : 255 * parseFloat(g[4]);
            h.rotation = "" == g[5] ? 0 : parseFloat(g[5]);
            h.skewX = "" == g[6] ? 0 : parseFloat(g[6]);
            h.skewY = "" == g[7] ? 0 : parseFloat(g[7]);
            skeletalAnimation[a].framesBitmapInfo[e.url + "|" + c].push(h)
        }
        c++
    }
},
createGameSkeletalAnimation = function(a, b, c, d) {
    var e = skeletalAnimation[a + "|" + b];
    null == e && (printLog(a + "|" + b + "\u8d44\u6e90\u9700\u8981\u52a0\u8f7d"), multipleAnimation(a, a), e = skeletalAnimation[a + "|" + b]);
    b = new GameSkeletalAnimation; ! 0 == d && (b.isPool = !0);
    e.folderName = e.folderName;
    e.jsonName = a;
    b.initialize(e);
    b.setFrameIntervalTime(c);
    return b
};
var GameTime = cc.Class.extend({
    nowDate: null,
    isInit: null,
    gameRunTime: null,
    isPause: null,
    lastTime: null,
    ctor: function() {
        this.isPause = this.isInit = !1;
        this.gameRunTime = 0;
        this.lastTime = this.nowDate = (new Date).getTime()
    },
    initialize: function() { ! 0 != this.isInit && (this.isInit = !0)
    },
    updateTime: function(a) { ! 1 == this.isPause && (this.gameRunTime += 1E3 * a)
    }
}),
engineGameRunTime = function() {
    return engine.gameTime.gameRunTime
},
engineGamePause = function(a) {
    engine.gameTime.isPause = a
},
gameUpdateType = 2,
sceneUpdateType = 1,
GameUpdate = cc.Class.extend({
    gameUpdateList: null,
    sceneUpdateList: null,
    isInit: null,
    ctor: function() {
        this.gameUpdateList = [];
        this.sceneUpdateList = [];
        this.isInit = !1
    },
    initialize: function() { ! 0 != this.isInit && (this.isInit = !0)
    },
    update: function() {
        for (var a = this.gameUpdateList.length - 1; 0 <= a; a--) this.gameUpdateList[a].update(),
        !0 == this.gameUpdateList[a].isEnd && this.gameUpdateList.splice(a, 1);
        for (a = this.sceneUpdateList.length - 1; 0 <= a; a--) this.sceneUpdateList[a].update(),
        !0 == this.sceneUpdateList[a].isEnd && this.sceneUpdateList.splice(a, 1)
    },
    addUpdate: function(a, b) {
        null == b && (b = sceneUpdateType);
        switch (b) {
        case gameUpdateType:
            this.gameUpdateList.push(a);
            break;
        case sceneUpdateType:
            this.sceneUpdateList.push(a)
        }
    },
    cleanUpdate: function(a) {
        switch (a) {
        case gameUpdateType:
            this.sceneUpdateList = [];
            break;
        case sceneUpdateType:
            this.gameUpdateList = []
        }
    }
}),
TimeOut = cc.Class.extend({
    endTime: null,
    isInit: null,
    callFuntion: null,
    data: null,
    isEnd: null,
    ctor: function() {
        this.isEnd = this.isInit = !1
    },
    initialize: function(a) { ! 0 != this.isInit && (this.isInit = !0, this.endTime = a.endTime, this.callFuntion = a.callFuntion, this.endTime = a.endTime, this.data = a.data)
    },
    update: function() { ! 0 != this.isEnd && 0 <= engineGameRunTime() - this.endTime && (this.callFuntion.call(this.data), this.isEnd = !0)
    }
}),
engineSetTimeOut = function(a, b, c, d) {
    var e = new TimeOut,
    f = {};
    f.callFuntion = a;
    f.endTime = engineGameRunTime() + 1E3 * b;
    f.data = c;
    e.initialize(f);
    engine.gameUpdate.addUpdate(e, d)
};
var author = "yx",
printLog = function(a) {
    cc.log(author + ":" + a)
},
getAngle = function(a, b) {
    var c = 0,
    c = Math.atan2(b.y - a.y, b.x - a.x),
    c = 180 / Math.PI * c;
    0 > c && (c += 360);
    return c % 360
},
getRadian = function(a, b) {
    var c = 0,
    c = Math.atan2(b.x - a.x, b.y - a.y);
    0 > c && (c += 2 * Math.PI);
    return c
},
beginPointTodistance = function(a, b, c) {
    b *= Math.PI / 180;
    return cc.pAdd(a, cc.p(c * Math.cos(b), c * Math.sin(b)))
},
cloneObject = function(a) {
    var b = {},
    c;
    for (c in a) b[c] = a[c];
    return b
},
leftSetting = "leftSetting",
rightSetting = "rightSetting",
centerSetting = "centerSetting",
verticalCenterSetting = "verticalCenterSetting",
gameSpSettingFun = function(a) {
    var b = a.spArr,
    c = a.spWidth,
    d = a.p;
    switch (a.settingType) {
    case leftSetting:
        for (a = 0; a < b.length; a++) b[a].x = d.x - c * a,
        b[a].y = d.y;
        break;
    case rightSetting:
        for (a = 0; a < b.length; a++) b[a].x = d.x + c * a,
        b[a].y = d.y;
        break;
    case centerSetting:
        if (0 < b.length % 2) {
            var e = Math.floor(b.length / 2) + 1;
            for (a = 0; a < b.length; a++) b[a].y = d.y,
            b[a].x = a <= e - 1 ? d.x - a * c: d.x + (a - Math.floor(b.length / 2)) * c
        } else for (a = 0; a < b.length; a++) b[a].y = d.y,
        b[a].x = a < Math.floor(b.length / 2) ? d.x - (Math.floor(b.length / 2) - a) * c + b[a].anchorX * c: d.x + (a - Math.floor(b.length / 2)) * c + b[a].anchorX * c;
        break;
    case verticalCenterSetting:
        if (0 < b.length % 2) for (e = Math.floor(b.length / 2), a = 0; a < b.length; a++) b[a].x = d.x,
        b[a].y = a <= e ? d.y + (e - a) * c: d.y - (a - e) * c;
        else for (a = 0; a < b.length; a++) b[a].x = d.x,
        b[a].y = a < Math.floor(b.length / 2) ? d.y + (Math.floor(b.length / 2) - a) * c - 0.5 * c: d.y - (a - Math.floor(b.length / 2)) * c - 0.5 * c
    }
},
getDirByPointFour = function(a, b) {
    var c = 4;
    a.x < b.x && (c = 6);
    a.x > b.x && (c = 4);
    a.x == b.x && (c = a.y < b.y ? 6 : 4);
    return c
};
var beforeEnterGame = "beforeEnterGame",
afterEnterGame = "afterEnterGame",
GameLog = cc.Class.extend({
    bugLimitCount: null,
    isInit: null,
    gameErrorType: null,
    initialize: function() {
        if (!0 != this.isInit) {
            this.isInit = !0;
            this.bugLimitCount = 0;
            this.gameErrorType = beforeEnterGame;
            var a = this;
            window.onerror = function(b, c, d, e, f) {
                null != f && null != f.stack && 30 >= a.bugLimitCount && (a.bugLimitCount++, a.bugInfoHttp(f.stack.toString()))
            }
        }
    },
    bugInfoHttp: function(a) {
        var b = new Date,
        c = b.getFullYear() + "." + (b.getMonth() + 1) + "." + b.getDate(),
        b = {},
        d = "";
        null != gameSDK && null != gameSDK.sdkPlayInfo && null != gameSDK.sdkPlayInfo.id && (d = gameSDK.sdkPlayInfo.id);
        b.playerid = d;
        b.emsg = this.gameErrorType + "|\u7248\u672c\u53f7\uff1a" + gameServerVersion;
        b.date = c;
        b.emsg2 = a;
        a = serverUrl + "opcode\x3d90001";
        b = JSON.stringify(b);
        c = cc.loader.getXMLHttpRequest();
        c.open("POST", a);
        c.setRequestHeader("Content-Type", "text/plain;charset\x3dUTF-8");
        c.send(b);
        cc.log("\u53d1\u9001\u7ed9\u670d\u52a1\u5668\u9519\u8bef\u4fe1\u606f\uff1a" + b)
    },
    updateGameErrorType: function(a) {
        this.gameErrorType = a
    }
});
var gameEngineVersion = "2.1",
gameVersion = "20160311",
getUrlByVersion = function(a) {
    return cc.sys.isNative ? a: a + "?version\x3d" + gameVersion
};
var GameEvent = cc.Class.extend({
    isInit: null,
    createMouseMove: null,
    createMouseDown: null,
    createMouseUp: null,
    ctor: function() {
        this.isInit = !1
    },
    initialize: function() { ! 0 != this.isInit && (this.isInit = !0, this.createMouseMove = createMouseMove, this.createMouseDown = createMouseDown, this.createMouseUp = createMouseUp)
    }
});
var engine = null,
Engine = cc.Class.extend({
    isInit: null,
    gameTime: null,
    gameData: null,
    gameSound: null,
    gameUpdate: null,
    gameEvent: null,
    gameCocosStudio: null,
    gameLayer: null,
    gameLog: null,
    ctor: function() {
        this.isInit = !1
    },
    initialize: function() { ! 0 != this.isInit && (printLog("\u6e38\u620f\u5f15\u64ce" + gameEngineVersion), cc.view.resizeWithBrowserSize(!0), this.isInit = !0, this.gameTime = new GameTime, this.gameTime.initialize(), this.gameData = new GameData, this.gameData.initialize(), this.gameSound = new GameSound, this.gameSound.initialize(), this.gameUpdate = new GameUpdate, this.gameUpdate.initialize(), this.gameEvent = new GameEvent, this.gameEvent.initialize(), this.gameLayer = new GameLayer, this.gameLayer.initialize(), this.gameLog = new GameLog, this.gameLog.initialize(), this.gameCocosStudio = new GameCocosStudio, this.gameCocosStudio.initialize())
    },
    engineuUpdate: function(a) {
        engine.gameTime.updateTime(a);
        engine.gameUpdate.update()
    }
}),
initEngine = function() {
    null == engine && (engine = new Engine, engine.initialize())
};
function sendHttp(a, b, c) { (new Date).getTime();
    var d = cc.loader.getXMLHttpRequest();
    d.open("POST", a);
    d.setRequestHeader("Content-Type", "text/plain;charset\x3dUTF-8");
    d.htttpType = c.htttpType;
    d.callfun = c.callFun;
    d.onreadystatechange = function() {
        if (4 == d.readyState && 200 <= d.status && 207 >= d.status) {
            printLog(d.htttpType);
            printLog(d.responseText);
            try {
                var a = JSON.parse(d.responseText)
            } catch(b) {}
            switch (d.htttpType) {
            case HttpID.createPlayrID:
                getPlayerInfo();
                break;
            case HttpID.getPlayerInfoID:
                isGetSelfInfoSend = !1
            }
            null != d.callfun && d.callfun(a)
        }
    };
    null == b ? engine.gameLog.bugInfoHttp("\u51fa\u73b0\u53d1\u9001null\u5305\u4f53,url:" + a + ",type:" + c.htttpType) : d.send(b)
};
HttpID = {
    createPlayrID: 10001,
    savePlayrInfoID: 10002,
    getPlayerInfoID: 10003,
    savePlayerNameAndPhoto: 10004,
    rewardGiftID: 10005,
    getDiamondGift: 10006,
    getFriendRankInfoID: 10007,
    getWorldRankID: 10008,
    getTodayRankID: 10009,
    inviteFriendInfo: 10010,
    getWeekRankID: 10011,
    getRobotID: 10012,
    recordPlayerActionID: 10014
};
var isGetSelfInfoSend = !0;
function GetRequest() {
    var a = location.search,
    b = {};
    if ( - 1 != a.indexOf("?")) for (var a = a.substr(1).split("\x26"), c = 0; c < a.length; c++) b[a[c].split("\x3d")[0]] = decodeURI(a[c].split("\x3d")[1]);
    return b
}
var createPlayer = function() {
    var a = {};
    a.playerid = heroData.playerid;
    a.nickname = heroData.nickname;
    a.image = gameSDK.sdkPlayInfo.photo;
    var b = serverUrl + "opcode\x3d" + HttpID.createPlayrID,
    a = JSON.stringify(a),
    c = {};
    c.htttpType = HttpID.createPlayrID;
    sendHttp(b, a, c)
},
saveUserData = function() {
    var a = {};
    a.playerid = heroData.playerid;
    a.clickModel = gamePlayerData.clickModel;
    a.isFirstLogin = gamePlayerData.isFirstLogin;
    a.currentPage = gamePlayerData.currentPage;
    a.isOpenSound = gamePlayerData.isOpenSound;
    a.maxScore = gamePlayerData.maxScore;
    5E5 <= gamePlayerData.maxScore && (a.maxScore = 0);
    a.currentScore = gamePlayerData.currentScore;
    a.baseScore = gamePlayerData.baseScore;
    a.timeOutScore = gamePlayerData.timeOutScore;
    a.timeBaseScore = gamePlayerData.timeBaseScore;
    a.targetScore = gamePlayerData.targetScore;
    a.diamondValue = gamePlayerData.diamondValue;
    a.relifevalueCount = gamePlayerData.relifevalueCount;
    a.timeRelifeCount = gamePlayerData.timeRelifeCount;
    a.relifeBase = gamePlayerData.relifeBase;
    a.relifevalue = gamePlayerData.relifevalue;
    a.loopCount = gamePlayerData.loopCount;
    a.timeLoopCount = gamePlayerData.timeLoopCount;
    a.loop_value = gamePlayerData.loop_value;
    a.brushCount = gamePlayerData.brushCount;
    a.timeBrushCount = gamePlayerData.timeBrushCount;
    a.brush_value = gamePlayerData.brush_value;
    a.hammerCount = gamePlayerData.hammerCount;
    a.timeHammerCount = gamePlayerData.timeHammerCount;
    a.hammer_value = gamePlayerData.hammer_value;
    a.timePage = gamePlayerData.timePage;
    a.useHammer = gamePlayerData.useHammer;
    a.useBrush = gamePlayerData.useBrush;
    a.useLoop = gamePlayerData.useLoop;
    a.myGameDate = gamePlayerData.myGameDate;
    a.hasGameData = gamePlayerData.hasGameData;
    a.clearIceStone = gamePlayerData.clearIceStone;
    a.clearColorStone = gamePlayerData.clearColorStone;
    a.percentPage = gamePlayerData.percentPage;
    a.clearLessStone = gamePlayerData.clearLessStone;
    a.playerRankingLv = gamePlayerData.playerRankingLv;
    a.achieveData = gamePlayerData.achieveData;
    a.relifeWatchNum = gamePlayerData.relifeWatchNum;
    a.adRewards = gamePlayerData.adRewards;
    a.hammerNum = gamePlayerData.hammerNum;
    a.brushNum = gamePlayerData.brushNum;
    a.loopNum = gamePlayerData.loopNum;
    a.relifeTimes = gamePlayerData.relifeTimes;
    a.otherString = heroData.watchNum + "|" + heroData.gameTimes + "|" + heroData.showAdTimes + "|" + heroData.itemGiftTimes + "|" + heroData.showSurpassRobot;
    a.diamondGiftStu = gamePlayerData.diamondGiftStu;
    a.targetArr = [heroData.getNextTargetPerson(), heroData.getTargetBeiTai()];
    a.lastDate = (new Date).getDate();
    a.getTitleArr = gamePlayerData.getTitleArr;
    save_to_fb_local(a)
},
getPlayerInfo = function(a) {
    var b = GetRequest(),
    c = gameSDK.getPlayerInfo();
    heroData.playerid = null == b.playerid ? c.id: b.playerid;
    null == b.pname && (heroData.nickname = c.name);
    switch (sdkName) {
    case "FaceBook":
        heroData.playerid = c.id,
        heroData.nickname = c.name
    }
    c = {};
    cc.log("\u5c1d\u8bd5\u767b\u5f55playerid:", heroData.playerid);
    c.playerid = heroData.playerid;
    var b = serverUrl + "opcode\x3d" + HttpID.getPlayerInfoID,
    c = JSON.stringify(c),
    d = {};
    d.htttpType = HttpID.getPlayerInfoID;
    d.callFun = a;
    sendHttp(b, c, d);
    setTimeout(function() { ! 0 == isGetSelfInfoSend && engine.gameLog.bugInfoHttp("\u7b2c\u4e00\u6b21\u53d1\u9001\u534f\u8bae\u8d85\u65f6-------")
    },
    5E3)
},
saveHeroNameAndPhoto = function() {
    var a = {};
    a.playerid = heroData.playerid;
    a.nickname = heroData.pname;
    a.image = heroData.image;
    var b = serverUrl + "opcode\x3d" + HttpID.savePlayerNameAndPhoto,
    a = JSON.stringify(a),
    c = {};
    c.htttpType = HttpID.savePlayerNameAndPhoto;
    sendHttp(b, a, c)
},
http_rewardGift = function(a) {
    var b = {};
    b.playerid = heroData.playerid;
    var c = serverUrl + "opcode\x3d" + HttpID.rewardGiftID,
    b = JSON.stringify(b),
    d = {};
    d.htttpType = HttpID.rewardGiftID;
    d.callFun = a;
    sendHttp(c, b, d)
},
http_sewDiamondAD = function(a) {
    var b = {};
    b.playerid = heroData.playerid;
    b.relifeWatchNum = gamePlayerData.relifeWatchNum;
    b.adRewards = gamePlayerData.adRewards;
    var c = serverUrl + "opcode\x3d" + HttpID.getDiamondGift,
    b = JSON.stringify(b),
    d = {};
    d.htttpType = HttpID.getDiamondGift;
    d.callFun = a;
    sendHttp(c, b, d)
},
http_getFriendRankInfoList = function(a) {
    if (0 < heroData.friendRankInfoList.length) a && a();
    else {
        var b = {};
        b.playerid = heroData.playerid;
        b.OpenKeyList = gameSDK.getFriendOpenKeyByFriendList();
        var c = serverUrl + "opcode\x3d" + HttpID.getFriendRankInfoID,
        b = JSON.stringify(b),
        d = {};
        d.htttpType = HttpID.getFriendRankInfoID;
        d.callFun = a;
        sendHttp(c, b, d)
    }
},
http_getWorldRankInfo = function(a) {
    if (0 < heroData.worldRankInfoList.length) a && a();
    else {
        var b = {};
        b.playerid = heroData.playerid;
        var c = serverUrl + "opcode\x3d" + HttpID.getWorldRankID,
        b = JSON.stringify(b),
        d = {};
        d.htttpType = HttpID.getWorldRankID;
        d.callFun = a;
        sendHttp(c, b, d)
    }
},
http_getTodayRankInfo = function(a) {
    if (0 < heroData.todayRankInfoList.length) a && a();
    else {
        var b = {};
        b.playerid = heroData.playerid;
        var c = serverUrl + "opcode\x3d" + HttpID.getTodayRankID,
        b = JSON.stringify(b),
        d = {};
        d.htttpType = HttpID.getTodayRankID;
        d.callFun = a;
        sendHttp(c, b, d)
    }
},
http_inviteFriend = function(a) {
    var b = {};
    b.playerid = heroData.playerid;
    b.toplayerid = a[0];
    b.currentScore = a[1];
    b.operate = a[2];
    a = serverUrl + "opcode\x3d" + HttpID.inviteFriendInfo;
    var b = JSON.stringify(b),
    c = {};
    c.htttpType = HttpID.inviteFriendInfo;
    sendHttp(a, b, c)
},
http_getRobotInfo = function(a) {
    if (! (0 < heroData.robotList.length)) {
        var b = {};
        b.playerid = heroData.playerid;
        var c = serverUrl + "opcode\x3d" + HttpID.getRobotID,
        b = JSON.stringify(b),
        d = {};
        d.htttpType = HttpID.getRobotID;
        d.callFun = a;
        sendHttp(c, b, d)
    }
},
playerActionType = {
    playRoundInfo: 1,
    giftAD: 2,
    diamondAD: 3
},
http_recordPlayerAction = function(a, b) {
    var c = {};
    c.playerid = heroData.playerid;
    c.type = a;
    1 == a ? (c.round = Global.dataEyeOb.round, c.scroe = Global.dataEyeOb.score, c.item = Global.dataEyeOb.item, c.gem = Global.dataEyeOb.diamond, c.relive = Global.dataEyeOb.relife, c.parachute = Global.dataEyeOb.patachute, c.scoreadd = Global.dataEyeOb.passscorre) : c.round = b;
    var d = serverUrl + "opcode\x3d" + HttpID.recordPlayerActionID,
    c = JSON.stringify(c),
    e = {};
    e.htttpType = HttpID.recordPlayerActionID;
    sendHttp(d, c, e)
};
var PurityLoadScene = LoadScene.extend({
    showPNG: function() {},
    setLoadStyle: function() {
        this.label = new cc.LabelTTF("Loading...", defaultTxt, 24);
        this.label.setPosition(375, 87);
        this.label.setColor(cc.color(255, 255, 255));
        this.addChild(this.label, 100);
        this.label.setVisible(!1);
        var a = new cc.LabelTTF("Loading takes a little longer for the 1st time.", defaultTxt, 24);
        a.setPosition(360, 140);
        a.setColor(cc.color(255, 255, 255));
        a.enableStroke(cc.color(0, 0, 0), 2);
        this.addChild(a, 100)
    },
    showLoad: function() {},
    setLoadPercent: function(a) {}
});
var FacebookLoadScene = LoadScene.extend({
    showPNG: function() {
        null != this.loadpng1 && this.loadpng2 && (this.loadpng1.setVisible(!0), this.loadpng2.setVisible(!0))
    },
    setLoadStyle: function() {},
    showLoad: function() {
        var a = this.computationsLoadProgress();
        this.setLoadPercent(a)
    },
    setLoadPercent: function(a) {
        gameSDK.setLoadingProgress(a)
    }
});
var gameSDK, GameSDK = cc.Class.extend({
    isFirstStartGame: null,
    sdkPlayInfo: null,
    entriesLeaderboard: null,
    playerEntriesboard: null,
    nearbyEntriesboard: null,
    entryPointData: null,
    ctor: function() {
        this.sdkPlayInfo = {};
        this.sdkPlayInfo.friendsList = {};
        this.isFirstStartGame = !0;
        this.entriesLeaderboard = {};
        this.playerEntriesboard = {};
        this.nearbyEntriesboard = {};
        this.entryPointData = null;
        this.sdkPlayInfo.rank = -1
    },
    runSDK: function() {},
    getPlayerInfo: function() {},
    startGame: function() {},
    getLoadScene: function() {
        return PurityLoadScene
    },
    getfriendsList: function() {},
    shareGame: function() {},
    setHeroData: function(a) {}
}),
initGameSDK = function() {
    switch (sdkName) {
    case "FaceBook":
        gameSDK = new FaceBookSDK;
        break;
    case "FaceBookTest":
        gameSDK = new FaceBookSDK;
        break;
    default:
        console.log("not find init sdk")
    }
};
var rewardedVideoID1 = "1394792680649041_1468295866632055",
rewardedVideoID2 = "1394792680649041_1477667009028274",
rewardedVideoID3 = "1394792680649041_1477667425694899",
rewardedVideoID4 = "1394792680649041_1491305220997786",
rewardedVideoID5 = "1394792680649041_1491305504331091",
rewardedVideoID6 = "1394792680649041_1491306820997626",
adMaskLayerId = 10001,
FaceBookSDK = GameSDK.extend({
    isFaceBookInvitation: null,
    isCreatShortCut: !1,
    ctor: function() {
        this.isFirstStartGame = !0;
        this.isFaceBookInvitation = !1;
        this._super()
    },
    runSDK: function(a) {
        switch (sdkName) {
        case "FaceBookTest":
            var b = GetRequest();
            null != b.serverUrl && (serverUrl = b.serverUrl); ! 0 == isNaN(b.playerid) || null == b.playerid ? this.sdkPlayInfo.id = "7687684561": this.sdkPlayInfo.id = b.playerid;
            this.sdkPlayInfo.name = null == b.pname ? "doubi" + this.sdkPlayInfo.id: b.pname; ! 0 == isNaN(b.sex) || null == b.sex ? this.sdkPlayInfo.sex = 0 : this.sdkPlayInfo.sex = parseInt(b.sex);
            this.sdkPlayInfo.photo = "https://fb-s-d-a.akamaihd.net/h-ak-fbx/v/t1.0-1/p320x320/24131500_889798657851941_1372837406836141609_n.jpg?oh\x3ded5b223b3690d182d3fa533108c5ac93\x26oe\x3d5AB4557C\x26__gda__\x3d1523177196_1b37aa2716ae1692cef393d4f1b796b8";
            a();
            break;
        case "FaceBook":
            var c = this;
            cc.log("\u83b7\u53d6\u7528\u6237\u767b\u5f55\u4fe1\u606f------:FBInstant.initializeAsync");
            FBInstant.initializeAsync().then(function() {
                c.sdkPlayInfo.name = FBInstant.player.getName();
                c.sdkPlayInfo.photo = FBInstant.player.getPhoto();
                c.sdkPlayInfo.id = FBInstant.player.getID();
                cc.log("\u83b7\u53d6\u7528\u6237\u767b\u5f55\u4fe1\u606f------:FBInstant.initializeAsync\u56de\u8c03", c.sdkPlayInfo.id);
                a()
            })
        }
    },
    setHeroData: function(a) {
        a.playerid = 0;
        a.openKey = this.sdkPlayInfo.id;
        a.pname = this.sdkPlayInfo.name;
        a.image = this.sdkPlayInfo.photo;
        a.sex = this.sdkPlayInfo.sex
    },
    getFirstLoadScene: function() {
        switch (sdkName) {
        case "FaceBookTest":
            return PurityLoadScene;
        case "FaceBook":
            return FacebookLoadScene
        }
    },
    getLoadScene: function() {
        switch (sdkName) {
        case "FaceBookTest":
            return PurityLoadScene;
        case "FaceBook":
            return PurityLoadScene
        }
    },
    getPlayerInfo: function() {
        return this.sdkPlayInfo
    },
    setLoadingProgress: function(a) {
        switch (sdkName) {
        case "FaceBook":
            FBInstant.setLoadingProgress(a)
        }
    },
    getfriendsList: function(a) {
        var b = this;
        cc.log(" \u83b7\u53d6\u597d\u53cb\u5217\u8868------:FBInstant.player.getConnectedPlayersAsync");
        FBInstant.player.getConnectedPlayersAsync().then(function(c) {
            for (var d = 0; d < c.length; d++) {
                var e = c[d],
                f = {};
                f.name = e.getName();
                f.id = e.getID();
                f.img = e.getPhoto();
                b.sdkPlayInfo.friendsList[f.id] = f;
                cc.log(" \u83b7\u53d6\u597d\u53cb\u5217\u8868------:\u540d\u5b57" + f.name + "----\u73a9\u5bb6id:" + f.id)
            }
            c = {};
            c.name = b.sdkPlayInfo.name;
            c.id = b.sdkPlayInfo.id;
            c.img = b.sdkPlayInfo.photo;
            b.sdkPlayInfo.friendsList[c.id] = c;
            cc.log(" \u83b7\u53d6\u597d\u53cb\u5217\u8868------:FBInstant.player.getConnectedPlayersAsync\u56de\u8c03");
            null != a && a()
        })
    },
    writeGameUserDataToPlayerImg: function() {
        for (var a in this.sdkPlayInfo.friendsList) if (null != gameUserData && null != gameUserData.friendsInfo) {
            var b = this.sdkPlayInfo.friendsList[a];
            null != b.img && null == gameUserData.friendsInfo[b.id] && (gameUserData.friendsInfo[b.id] = b.img)
        }
        saveUserData()
    },
    getFriendOpenKeyByFriendList: function() {
        switch (sdkName) {
        case "FaceBookTest":
            this.sdkPlayInfo.friendsList = {};
            for (var a = ["doubi265264001", "doubi265264002", "doubi265264003"], b = ["265264001", "265264002", "265264003"], c = 0; c < b.length; c++) {
                var d = {};
                d.name = a[c];
                d.id = b[c];
                d.img = "https://fb-s-d-a.akamaihd.net/h-ak-fbx/v/t1.0-1/p320x320/24131500_889798657851941_1372837406836141609_n.jpg?oh\x3ded5b223b3690d182d3fa533108c5ac93\x26oe\x3d5AB4557C\x26__gda__\x3d1523177196_1b37aa2716ae1692cef393d4f1b796b8";
                this.sdkPlayInfo.friendsList[d.id] = d
            }
            a = {};
            a.name = this.sdkPlayInfo.name;
            a.id = this.sdkPlayInfo.id;
            a.img = this.sdkPlayInfo.photo;
            this.sdkPlayInfo.friendsList[a.id] = a
        }
        var a = [],
        e;
        for (e in this.sdkPlayInfo.friendsList) b = this.sdkPlayInfo.friendsList[e],
        a.push(b.id),
        cc.log("\u597d\u53cbid\uff1a---------------------------------" + b.id);
        return a
    },
    getBreedFriendOpenKeyByFriendList: function() {
        switch (sdkName) {
        case "FaceBookTest":
            this.sdkPlayInfo.friendsList = {};
            for (var a = "ttttds;doubi2;kiss ll5;kiss ll4;kiss ll3;kiss ll2;kiss ll;aabbbdd;aabbbdd;zhou".split(";"), b = "444667161 2222222222 90087 90088 90089 90090 90091 90092 90093 1728227987251837".split(" "), c = 0; c < b.length; c++) {
                var d = {};
                d.name = a[c];
                d.id = b[c];
                d.img = "https://fb-s-d-a.akamaihd.net/h-ak-fbx/v/t1.0-1/p320x320/24131500_889798657851941_1372837406836141609_n.jpg?oh\x3ded5b223b3690d182d3fa533108c5ac93\x26oe\x3d5AB4557C\x26__gda__\x3d1523177196_1b37aa2716ae1692cef393d4f1b796b8";
                this.sdkPlayInfo.friendsList[d.id] = d
            }
            a = {};
            a.name = this.sdkPlayInfo.name;
            a.id = this.sdkPlayInfo.id;
            a.img = this.sdkPlayInfo.photo;
            this.sdkPlayInfo.friendsList[a.id] = a
        }
        var a = [],
        e;
        for (e in this.sdkPlayInfo.friendsList) b = this.sdkPlayInfo.friendsList[e],
        c = {},
        c.OpenKey = b.id,
        c.IsNeedImage = 2,
        a.push(c),
        cc.log("\u597d\u53cbid\uff1a---------------------------------" + b.id);
        return a
    },
    updateFriendImage: function() {
        for (var a in gameUserData.friendsInfo) {
            var b = gameUserData.friendsInfo[a];
            null != this.sdkPlayInfo.friendsList[a] && (this.sdkPlayInfo.friendsList[a].img = b)
        }
    },
    appointFaceBookFriend: function(a, b) {
        switch (sdkName) {
        case "FaceBookTest":
            null != a && a();
            var c = new GameCustomImage;
            c.initialize(b);
            c.drawCompleteFun = function(a) {
                var b = new Image;
                b.crossOrigin = "anonymous";
                b.src = a;
                b.onload = function() {
                    var a = new cc.Sprite(b);
                    currentScene.addChild(a, 999999);
                    a.x = cc.winSize.width / 2;
                    a.y = cc.winSize.height / 2;
                    engine.gameEvent.createMouseUp(a,
                    function() {
                        a.removeFromParent()
                    },
                    buttonScalingType)
                }
            };
            break;
        case "FaceBook":
            cc.log("\u8c03\u7528appointFaceBookFriend\u65b9\u6cd5,\u9080\u8bf7\u6307\u5b9a\u73a9\u5bb6id\uff1a" + b.playerid),
            FBInstant.context.createAsync(b.playerid).then(function() {
                cc.log("appointFaceBookFriend\u65b9\u6cd5\u56de\u8c03");
                null == b.data && (b.data = {});
                var c = new GameCustomImage;
                c.initialize(b);
                c.drawCompleteFun = function(c) {
                    cc.log("\u9080\u8bf7\u6307\u5b9a\u73a9\u5bb6\u56fe\u7247\u52a0\u8f7d\u5b8c\u6210\uff0c\u8c03\u7528FBInstant.updateAsync\u65b9\u6cd5");
                    FBInstant.updateAsync({
                        action: "CUSTOM",
                        cta: "Play",
                        template: b.updateAsyncTemplate,
                        image: c,
                        text: b.updateAsyncText,
                        data: b.data,
                        strategy: "LAST",
                        notification: "PUSH"
                    }).then(function() {});
                    null != a && (cc.log("\u6307\u5b9a\u597d\u53cb\u9080\u8bf7\u6210\u529f\uff01"), a())
                }
            }).
            catch(function(b) {
                "SAME_CONTEXT" == b.code && null != a && (cc.log("\u5df2\u7ecf\u9080\u8bf7\u8fc7\uff0c\u76f4\u63a5\u8fdb\u5bf9\u6218"), a())
            })
        }
    },
    sendFaceBookFriend: function(a) {
        var b = this;
        switch (sdkName) {
        case "FaceBookTest":
            null != a && a(265265352);
            var c = {
                pngArr: [{
                    url: "res/imageicon.png",
                    posX: 0,
                    posY: 0,
                    imgWidth: 750,
                    imgHeight: 340
                },
                {
                    url: "res/tihuan.png",
                    posX: 225,
                    posY: 155,
                    imgWidth: 110,
                    imgHeight: 114
                },
                {
                    url: "res/imageicon1.png",
                    posX: 220,
                    posY: 150,
                    imgWidth: 120,
                    imgHeight: 126
                }]
            };
            c.fontData = [{
                des: gamePlayerData.maxScore.toString(),
                posX: 375,
                posY: 265,
                font: "55px Microsoft YaHei",
                fillStyle: "rgb(255,255,255)",
                textAlign: "left"
            },
            {
                des: this.sdkPlayInfo.name,
                posX: 375,
                posY: 190,
                font: "38px Microsoft YaHei",
                fillStyle: "rgb(255,255,255)",
                textAlign: "left"
            }];
            c.canvasWidth = 750;
            c.canvasHeight = 340;
            this.getBase64Image(c);
            break;
        case "FaceBook":
            FBInstant.context.chooseAsync({
                filters:
                ["NEW_CONTEXT_ONLY", "INCLUDE_EXISTING_CHALLENGES", "NEW_PLAYERS_ONLY"]
            }).then(function() {
                cc.log("\u9080\u8bf7\u73a9\u5bb6id\uff1a------------------------" + FBInstant.context.getID());
                var c = {};
                c.pngArr = [{
                    url: "res/imageicon.png",
                    posX: 0,
                    posY: 0,
                    imgWidth: 750,
                    imgHeight: 340
                },
                {
                    url: b.sdkPlayInfo.photo,
                    posX: 225,
                    posY: 155,
                    imgWidth: 110,
                    imgHeight: 114
                },
                {
                    url: "res/imageicon1.png",
                    posX: 220,
                    posY: 150,
                    imgWidth: 120,
                    imgHeight: 126
                }];
                c.fontData = [{
                    des: gamePlayerData.maxScore.toString(),
                    posX: 375,
                    posY: 265,
                    font: "55px Microsoft YaHei",
                    fillStyle: "rgb(255,255,255)",
                    textAlign: "left"
                },
                {
                    des: b.sdkPlayInfo.name,
                    posX: 375,
                    posY: 190,
                    font: "38px Microsoft YaHei",
                    fillStyle: "rgb(255,255,255)",
                    textAlign: "left"
                }];
                c.canvasWidth = 750;
                c.canvasHeight = 340;
                b.getBase64Image(c);
                null != a && (cc.log("\u67e5\u627e\u597d\u53cb\u56de\u8c03---------------------------------5"), a(FBInstant.context.getID()))
            })
        }
    },
    getBase64Image: function(a) {
        this.loadPng(a, 0, [])
    },
    loadPng: function(a, b, c) {
        var d = this;
        if (a.pngArr.length <= b) {
            var e = document.createElement("canvas");
            e.width = a.canvasWidth;
            e.height = a.canvasHeight;
            for (var f = 0; f < c.length; f++) {
                var g = c[f],
                h = e.getContext("2d");
                h.drawImage(g, a.pngArr[f].posX, a.pngArr[f].posY, g.width, g.height)
            }
            if (null != a.fontData) for (f = 0; f < a.fontData.length; f++) g = a.fontData[f],
            h.font = g.font,
            h.lineWidth = 5,
            h.fillStyle = g.fillStyle,
            h.textAlign = g.textAlign,
            h.strokeStyle = "#120500",
            h.strokeText("" + g.des, g.posX, g.posY),
            h.fillText("" + g.des, g.posX, g.posY);
            e = e.toDataURL("image/png");
            switch (sdkName) {
            case "FaceBookTest":
                var k = new Image;
                k.crossOrigin = "anonymous";
                k.src = e;
                k.onload = function() {
                    var a = new cc.Sprite(k);
                    currentScene.addChild(a);
                    a.x = 375;
                    a.y = 667
                };
                break;
            case "FaceBook":
                cc.log("\u67e5\u627e\u597d\u53cb---------------------------------\u53d1\u9001 FBInstant.updateAsync"),
                FBInstant.updateAsync({
                    action: "CUSTOM",
                    cta: "Play",
                    template: "play_turn",
                    image: e,
                    text: "Your friends is challenging you",
                    data: {},
                    strategy: "LAST",
                    notification: "PUSH"
                }).then(function() {})
            }
        } else {
            var m = new Image;
            m.crossOrigin = "anonymous";
            m.src = a.pngArr[b].url;
            m.onload = function() {
                m.width = a.pngArr[b].imgWidth;
                m.height = a.pngArr[b].imgHeight;
                c.push(m);
                b++;
                d.loadPng(a, b, c)
            }
        }
    },
    startGame: function(a) {
        switch (sdkName) {
        case "FaceBookTest":
            this.sdkPlayInfo.friendsList = {};
            var b = {};
            b.name = heroData.nickname;
            b.id = heroData.playerid;
            b.img = gameSDK.sdkPlayInfo.photo;
            heroData.pname = b.name;
            heroData.image = "uipng/achieve_icon2.png";
            this.sdkPlayInfo.friendsList[this.sdkPlayInfo.id] = b;
            null != a && a();
            break;
        case "FaceBook":
            var c = this;
            cc.log("-------------------isFirstStartGame"); ! 0 == this.isFirstStartGame && (cc.log("-------------------isFirstStartGame----true"), this.isFirstStartGame = !1, FBInstant.startGameAsync().then(function() {
                cc.log("-------------------isFirstStartGame--------------------Callfun1");
                c.sdkPlayInfo.name = FBInstant.player.getName();
                cc.log("-------------------isFirstStartGame--------------------Callfun1" + c.sdkPlayInfo.name);
                c.sdkPlayInfo.photo = FBInstant.player.getPhoto();
                c.sdkPlayInfo.friendsList = {};
                var b = {};
                b.name = c.sdkPlayInfo.name;
                b.id = c.sdkPlayInfo.id;
                b.img = c.sdkPlayInfo.photo;
                cc.log("-------------------isFirstStartGame--------------------Callfun2");
                c.sdkPlayInfo.friendsList[c.sdkPlayInfo.id] = b;
                cc.log("-------------------isFirstStartGame--------------------Callfun3");
                heroData.pname = c.sdkPlayInfo.name;
                heroData.image = c.sdkPlayInfo.photo;
                engine.gameLog.bugInfoHttp("\u73a9\u5bb6\u5df2\u8fdb\u5165\u6e38\u620f-------");
                c.sdkPlayInfo.entryPointData = FBInstant.getEntryPointData();
                null != a && a()
            }))
        }
    },
    shareGame: function(a) {
        switch (sdkName) {
        case "FaceBook":
            var b = document.createElement("img");
            b.crossOrigin = "anonymous";
            b.src = "res/loadimage.jpg";
            b.onload = function() {
                var a = document.createElement("canvas");
                a.width = b.width;
                a.height = b.height;
                a.getContext("2d").drawImage(b, 0, 0, b.width, b.height);
                a = a.toDataURL("image/jpeg");
                FBInstant.shareAsync({
                    intent: "SHARE",
                    image: a,
                    text: "invites you to play together",
                    data: {
                        myReplayData: "..."
                    }
                }).then(function() {})
            }
        }
        null != a && a()
    },
    showInterstitialAd: function(a, b) {
        switch (sdkName) {
        case "FaceBook":
            var c = null;
            FBInstant.getInterstitialAdAsync("546661508998943_597390903926003").then(function(a) {
                cc.log("InterstitialAd\u5f00\u59cb\u52a0\u8f7d");
                c = a;
                return c.loadAsync()
            }).then(function() {
                cc.log("InterstitialAd\u52a0\u8f7d\u6210\u529f\u56de\u8c03");
                return c.showAsync()
            }).then(function() {
                cc.log("InterstitialAd\u5e7f\u544a\u663e\u793a\u6210\u529f")
            }).
            catch(function(a) {
                cc.log("InterstitialAd\u5e7f\u544a\u663e\u793a\u5931\u8d25")
            })
        }
    },
    showRewardVideoAd: function(a, b, c) {
        switch (sdkName) {
        case "FaceBookTest":
            null != b && b();
            heroData.watchNum += 1;
            break;
        case "FaceBook":
            var d = null,
            e = null;
            FBInstant.getRewardedVideoAsync(a).then(function(a) {
                cc.log("RewardedVideo\u5f00\u59cb\u52a0\u8f7d");
                e = new ADMaskLayer;
                e.initialize({
                    isCanClick: !0
                });
                e.setTag(adMaskLayerId);
                null != currentScene && currentScene.addChild(e, 99999);
                d = a;
                return d.loadAsync()
            }).then(function() {
                cc.log("RewardedVideo\u52a0\u8f7d\u6210\u529f\u56de\u8c03");
                return d.showAsync()
            }).then(function() {
                cc.log("RewardedVideo\u5e7f\u544a\u663e\u793a\u6210\u529f");
                null != currentScene && null != currentScene.getChildByTag(adMaskLayerId) && currentScene.getChildByTag(adMaskLayerId).removeFromParent();
                heroData.watchNum += 1;
                null != b && b()
            }).
            catch(function(b) {
                cc.log("RewardedVideo\u5e7f\u544a\u663e\u793a\u5931\u8d25-----------1");
                null != currentScene && null != currentScene.getChildByTag(adMaskLayerId) && currentScene.getChildByTag(adMaskLayerId).removeFromParent();
                var d = !1;
                null != c && null != c.onClose && (c.onClose(), d = !0);
                var e = {};
                e.txt = "CLIENT_UNSUPPORTED_OPERATION" == b.code ? "Failed:Sorry, the ad is currently only available on messenger!": "We're sorry, but there are no available videos to show right now. Please try again later!";
                e.isPause = d;
                a == rewardedVideoID6 ? heroData.isFailToGetAD = !0 : (b = new ShowTipsWindow(e), currentScene.addChild(b, 9999999));
                cc.log("RewardedVideo\u5e7f\u544a\u663e\u793a\u5931\u8d25------------2")
            })
        }
    },
    createShortcut: function(a) {
        switch (sdkName) {
        case "FaceBookTest":
            cc.log("\u521b\u5efa\u684c\u9762\u5feb\u6377\u65b9\u5f0f\u3002");
            null != a && a(null);
            break;
        case "FaceBook":
            if (this.isCreatShortCut) break;
            this.isCreatShortCut = !0;
            cc.log("\u521b\u5efa\u684c\u9762\u5feb\u6377\u65b9\u5f0fsdk\u3002");
            FBInstant.player.getDataAsync(["shortcut"]).then(function(b) {
                cc.log("\u83b7\u53d6\u5230\u7684data\u3002", b);
                null != b && null != b.shortcut && 1 == b.shortcut || FBInstant.canCreateShortcutAsync().then(function(b) {
                    cc.log("........\u521b\u5efa\u503ccanCreateShortcut\uff1a" + b);
                    cc.log(b);
                    b && FBInstant.createShortcutAsync().then(function() {
                        FBInstant.player.setDataAsync({
                            shortcut: 1
                        }).then(function() {});
                        cc.log("\u521b\u5efa\u6210\u529f\u3002");
                        null != a && a(null)
                    }).
                    catch(function(a) {
                        cc.log("\u521b\u5efa\u5931\u8d25\u3002");
                        cc.log(a)
                    })
                }).
                catch(function(a) {
                    cc.log("\u4e0d\u53ef\u4ee5\u521b\u5efa\u3002");
                    cc.log(a)
                })
            }).
            catch(function(a) {
                cc.log("\u83b7\u53d6\u6570\u636e\u5931\u8d25\u3002");
                cc.log(a)
            })
        }
    },
    getUserData: function(a, b) {
        switch (sdkName) {
        case "FaceBookTest":
            var c = JSON.parse(cc.sys.localStorage.getItem(faceBookDataKey));
            cc.log("\u53d6\u5230\u7f13\u5b58\u6570\u636e:");
            cc.log(c);
            b(c);
            break;
        case "FaceBook":
            cc.log("\u5c1d\u8bd5\u83b7\u53d6\u7f13\u5b58\u6570\u636e:");
            var d = this;
            this.logEvent("getDataAsync", 1, {
                getDataAsync: "getDataAsync"
            });
            FBInstant.player.getDataAsync(a).then(function(a) {
                d.logEvent("getDataAsyncOK", 1, {
                    getDataAsyncOK: "getDataAsyncOK"
                });
                cc.log("\u53d6\u5230FB\u7684\u6570\u636e:");
                cc.log(a);
                var c = 0,
                g;
                for (g in a) null != a[g] && c++;
                0 == c ? b(null) : b(a)
            }).
            catch(function(a) {
                cc.log("\u83b7\u53d6\u6570\u636e\u5931\u8d25\u3002");
                cc.log(a)
            })
        }
    },
    saveUserData: function(a, b) {
        switch (sdkName) {
        case "FaceBookTest":
            cc.warn("\u5b58\u6863\u6210\u529f");
            var c = JSON.parse(cc.sys.localStorage.getItem(faceBookDataKey));
            if (null == c) c = a;
            else for (var d in a) c[d] = a[d];
            cc.sys.localStorage.setItem(faceBookDataKey, JSON.stringify(c));
            break;
        case "FaceBook":
            FBInstant.player.setDataAsync(a).then(function() {
                cc.log("\u6e38\u620f\u5b58\u6863\u6210\u529f\uff01");
                null != b && b()
            })
        }
    },
    logEvent: function(a, b, c) {
        switch (sdkName) {
        case "FaceBookTest":
            cc.log("\u6253\u70b9:", a, b, c);
            break;
        case "FaceBook":
            FBInstant.logEvent(a, b, c)
        }
    },
    setScoreAsync: function(a, b, c, d) {
        switch (sdkName) {
        case "FaceBookTest":
            null != d && d();
            break;
        case "FaceBook":
            FBInstant.getLeaderboardAsync(a).then(function(a) {
                5E5 <= b && (b = 0);
                cc.log("\u6dfb\u52a0\u81ea\u5df1\u6392\u884c\u699c\u3002", b);
                return a.setScoreAsync(b, JSON.stringify(c))
            }).then(function(a) {
                null != d && d(a)
            }).
            catch(function(a) {
                cc.log("\u4e0a\u4f20\u6392\u884c\u5931\u8d25\u3002");
                cc.log(a);
                null != d && d(null)
            })
        }
    },
    getPlayerEntryAsync: function(a, b) {
        switch (sdkName) {
        case "FaceBook":
            var c = this;
            FBInstant.getLeaderboardAsync(a).then(function(a) {
                return a.getPlayerEntryAsync()
            }).then(function(a) {
                cc.log("getPlayerEntryAsync\u83b7\u53d6\u81ea\u5df1\u6392\u884c\u699c\u6210\u529f\uff1a");
                cc.log(a);
                c.sdkPlayInfo.rank = null != a ? a.getRank() : null;
                null != b && b()
            })
        }
    },
    getEntriesLeaderboardDataByPlayer: function(a, b) {
        if (null == this.entriesLeaderboard[a]) switch (sdkName) {
        case "FaceBook":
            var c = this;
            this.getPlayerEntryAsync(a,
            function() {
                if (null != c.sdkPlayInfo.rank && 0 < c.sdkPlayInfo.rank) {
                    var d = c.sdkPlayInfo.rank - 15;
                    0 >= d && (d = 0);
                    c.getEntriesAsync(a, b, d, !0)
                } else c.getEntriesAsync(a, b, 0, !0)
            })
        }
    },
    getEntriesAsync: function(a, b, c, d) {
        if (d || null == this.entriesLeaderboard[a]) if (!d || null == this.nearbyEntriesboard[a]) switch (sdkName) {
        case "FaceBook":
            var e = this;
            FBInstant.getLeaderboardAsync(a).then(function(a) {
                return a.getEntriesAsync(b, c)
            }).then(function(b) {
                cc.log("getEntriesAsync\u83b7\u53d6\u4e16\u754c\u6392\u884c\u699c\u6210\u529f\uff1a");
                cc.log(b);
                for (var c = [], h = 0; h < b.length; h++) {
                    var k = {};
                    k.id = b[h].getPlayer().getID();
                    k.photo = b[h].getPlayer().getPhoto();
                    k.name = b[h].getPlayer().getName();
                    k.score = b[h].getScore();
                    5E5 < k.score && (k.score = 5E5);
                    k.rank = b[h].getRank();
                    k.data = b[h].getExtraData();
                    c.push(k)
                }
                d ? e.nearbyEntriesboard[a] = c: e.entriesLeaderboard[a] = c
            })
        }
    },
    getConnectedPlayerEntriesAsync: function(a, b, c) {
        if (null == this.playerEntriesboard[a]) switch (sdkName) {
        case "FaceBook":
            var d = this;
            FBInstant.getLeaderboardAsync(a).then(function(a) {
                return a.getConnectedPlayerEntriesAsync(b, c)
            }).then(function(b) {
                cc.log("getEntriesAsync\u83b7\u53d6\u597d\u53cb\u6392\u884c\u699c\u6210\u529f\uff1a");
                cc.log(b);
                for (var c = [], g = 0; g < b.length; g++) {
                    var h = {};
                    h.id = b[g].getPlayer().getID();
                    h.photo = b[g].getPlayer().getPhoto();
                    h.name = b[g].getPlayer().getName();
                    h.score = b[g].getScore();
                    5E5 < h.score && (h.score = 5E5);
                    h.rank = b[g].getRank();
                    h.data = b[g].getExtraData();
                    c.push(h)
                }
                d.playerEntriesboard[a] = c
            })
        }
    },
    getEntriesLeaderboardData: function(a) {
        switch (sdkName) {
        case "FaceBookTest":
            return getFaceBookTestEntriesLeaderboardData();
        case "FaceBook":
            return this.entriesLeaderboard[a]
        }
    },
    getEntriesNearByData: function(a) {
        switch (sdkName) {
        case "FaceBookTest":
            return getFaceBookTestNearbyData();
        case "FaceBook":
            return this.nearbyEntriesboard[a]
        }
    },
    setEntriesLeaderboardData: function(a, b) {
        this.entriesLeaderboard[a] = b
    },
    getPlayerEntriesboardLeaderboardData: function(a) {
        switch (sdkName) {
        case "FaceBookTest":
            return getFaceBookTestPlayerEntriesboardLeaderboardData();
        case "FaceBook":
            return this.playerEntriesboard[a]
        }
    },
    setPlayerEntriesboardLeaderboardData: function(a, b) {
        this.playerEntriesboard[a] = b
    },
    setNearbyEntryData: function(a, b) {
        this.nearbyEntriesboard[a] = b
    }
});
var res = {
    achieve_layer_json: "res/achieve_layer.json",
    gameover_layer_json: "res/gameover_layer.json",
    home_layer_json: "res/home_layer.json",
    main_layer_json: "res/main_layer.json",
    pause_layer_json: "res/pause_layer.json",
    prompt_layer_json: "res/prompt_layer.json",
    ranking_layer_json: "res/ranking_layer.json",
    relife_layer_json: "res/relife_layer.json",
    award_layer_json: "res/award_layer.json",
    imgfnt_plist: "res/imgpng/imgfntplist.plist",
    imgfnt_png: "res/imgpng/imgfntplist.png",
    imgpngplist0_plist: "res/imgpng/imgpngplist0.plist",
    imgpngplist0_png: "res/imgpng/imgpngplist0.png",
    imgpngplist1_plist: "res/imgpng/imgpngplist1.plist",
    imgpngplist1_png: "res/imgpng/imgpngplist1.png",
    imgpngplist2_plist: "res/imgpng/imgpngplist2.plist",
    imgpngplist2_png: "res/imgpng/imgpngplist2.png",
    imgpngplist3_plist: "res/imgpng/imgpngplist3.plist",
    imgpngplist3_png: "res/imgpng/imgpngplist3.png",
    imgpngplist4_plist: "res/imgpng/imgpngplist4.plist",
    imgpngplist4_png: "res/imgpng/imgpngplist4.png",
    imgpngplist5_plist: "res/imgpng/imgpngplist5.plist",
    imgpngplist5_png: "res/imgpng/imgpngplist5.png",
    imgpngplist6_plist: "res/imgpng/imgpngplist6.plist",
    imgpngplist6_png: "res/imgpng/imgpngplist6.png",
    imgpngplist6_plist: "res/imgpng/imgpngplist6.plist",
    imgpngplist6_png: "res/imgpng/imgpngplist6.png",
    title_out_json: "res/pngdata/title_out/title_out.json",
    title_layer: "res/title_layer.json",
    imgpngplist7_plist: "res/imgpng/imgpngplist7.plist",
    imgpngplist7_png: "res/imgpng/imgpngplist7.png",
    scaleimglist_plist: "res/imgpng/scaleimglist.plist",
    scaleimglist_png: "res/imgpng/scaleimglist.png",
    rank_layer: "res/rank_layer.json",
    up_rank_layer: "res/up_rank_layer.json",
    up_rank_node: "res/up_rank_node.json",
    result_layer: "res/result_layer.json",
    reward_layer: "res/reward_layer.json",
    img1_plist: "res/imgpng/img1.plist",
    img1_png: "res/imgpng/img1.png",
    img2_plist: "res/imgpng/img2.plist",
    img2_png: "res/imgpng/img2.png"
},
scale_png = {
    scalesprite1: "other/scalesprite1.png",
    scalesprite2: "other/scalesprite2.png",
    scalesprite3: "other/scalesprite3.png",
    scalesprite4: "other/scalesprite4.png"
},
game_sound = {
    res_sound_fireworks_01: "res/sound/fireworks_01.mp3",
    res_sound_fireworks_02: "res/sound/fireworks_02.mp3",
    res_sound_fireworks_03: "res/sound/fireworks_03.mp3",
    res_sound_applause: "res/sound/applause.mp3",
    res_sound_applause_1: "res/sound/applause_1.mp3",
    res_sound_applause_2: "res/sound/applause_2.mp3",
    res_sound_closeview: "res/sound/closeview.mp3",
    res_sound_exp_sound: "res/sound/exp_sound.mp3",
    res_sound_exp_color: "res/sound/exp_sound_color.mp3",
    res_sound_exp_ice: "res/sound/exp_sound_ice.mp3",
    res_sound_exp_less: "res/sound/exp_sound_less.mp3",
    res_sound_gameover: "res/sound/gameover.mp3",
    res_sound_gamewin: "res/sound/gamewin.mp3",
    res_sound_hammer: "res/sound/hammer.mp3",
    res_sound_hammer_do: "res/sound/hammer_do.mp3",
    res_sound_home: "res/sound/home.mp3",
    res_sound_home_btn: "res/sound/home_btn.mp3",
    res_sound_landing: "res/sound/landing.mp3",
    res_sound_onland: "res/sound/onland.mp3",
    res_sound_timeout: "res/sound/timeout.mp3",
    res_sound_bg_sound: "res/sound/bg_sound.mp3",
    res_sound_brush_sound: "res/sound/brush_sound.mp3",
    res_sound_get_award: "res/sound/get_award.mp3",
    res_sound_relife: "res/sound/relife_sound.mp3",
    res_buy_life: "res/sound/gold_success.mp3"
},
Stone_Explosion_Sound = "res/sound/exp_sound_0.mp3 res/sound/exp_sound_1.mp3 res/sound/exp_sound_2.mp3 res/sound/exp_sound_3.mp3 res/sound/exp_sound_4.mp3 res/sound/exp_sound_5.mp3".split(" "),
g_resources = [],
i;
for (i in res) g_resources.push(res[i]);
for (i in Stone_Explosion_Sound) g_resources.push(Stone_Explosion_Sound[i]);
var heroData, initHeroData = function() {
    heroData = new HeroData
},
HeroData = cc.Class.extend({
    playerid: null,
    nickname: null,
    image: null,
    friendRankInfoList: null,
    todayRankInfoList: null,
    worldRankInfoList: null,
    invitePlayerInfo: null,
    weekRankInfoList: null,
    friendTodayRank: null,
    surpassPlayer: null,
    watchNum: null,
    gameTimes: null,
    showAdTimes: null,
    itemGiftTimes: null,
    isFailToGetAD: null,
    isShowParachute: null,
    parachuteIndex: null,
    clickParaGameIndex: null,
    localGameTimes: null,
    robotList: null,
    showSurpassRobot: null,
    lastGrade: null,
    robotIndex: null,
    ctor: function() {
        this.playerid = 0;
        this.image = this.nickname = "";
        this.friendRankInfoList = [];
        this.todayRankInfoList = [];
        this.worldRankInfoList = [];
        this.weekRankInfoList = [];
        this.friendTodayRank = [];
        this.surpassPlayer = this.invitePlayerInfo = null;
        this.itemGiftTimes = this.showAdTimes = this.gameTimes = this.watchNum = 0;
        this.isShowParachute = this.isFailToGetAD = !1;
        this.localGameTimes = this.clickParaGameIndex = this.parachuteIndex = 0;
        this.robotList = [];
        this.robotIndex = this.lastGrade = this.showSurpassRobot = 0
    },
    updateRobotList: function(a) {
        this.robotList = [];
        for (var b = 0; b < a.length; b++) if (a[b].nickname != heroData.nickname) {
            var c = {};
            c.nickname = (debugtest.showRobotWithR ? "R.": "") + a[b].nickname;
            c.image = a[b].image;
            c.isSurpass = !1;
            this.robotList.push(c)
        }
    },
    updateServerInfo: function(a) {
        this.invitePlayerInfo = a.fightInfo;
        if (null != this.invitePlayerInfo && 0 != this.invitePlayerInfo.length) {
            if (null == this.invitePlayerInfo.image || "nil" == this.invitePlayerInfo.image) this.invitePlayerInfo.image = "uipng/achieve_icon2.png";
            this.invitePlayerInfo.nickname = this.invitePlayerInfo.nickname.replace(/--/g, " ")
        }
        a = a.otherString;
        if ("" == a || null == a) a = "0|0|0|0|0";
        a = a.split("|");
        this.watchNum = parseInt(a[0]);
        this.gameTimes = parseInt(a[1]);
        this.showAdTimes = parseInt(a[2]);
        this.itemGiftTimes = parseInt(a[3]);
        this.showSurpassRobot = parseInt(a[4]);
        if (null == this.showSurpassRobot || !0 == isNaN(this.showSurpassRobot)) this.showSurpassRobot = 0
    },
    updateTodayRankInfo: function(a) {
        this.todayRankInfoList = [];
        for (var b = 0; b < a.length; b++) {
            var c = a[b],
            d = {};
            5E5 <= c.currentScore || (d.name = c.nickname.replace(/--/g, " "), d.num = c.currentScore, d.img = null == c.image || "nil" == c.image ? "uipng/achieve_icon2.png": c.image, d.playerid = c.playerid, this.todayRankInfoList.push(d))
        }
        this.todayRankInfoList.sort(function(a, b) {
            return b.num - a.num
        });
        for (b = 0; b < this.todayRankInfoList.length; b++) this.todayRankInfoList[b].rank = b + 1
    },
    getOwnRankInTodayRank: function() {
        for (var a = 0; a < this.todayRankInfoList.length; a++) if (this.todayRankInfoList[a].playerid == this.playerid) return a + 1;
        return 0
    },
    getOwnGradeInTodayRank: function() {
        for (var a = 0; a < this.todayRankInfoList.length; a++) if (this.todayRankInfoList[a].playerid == this.playerid) return getGradeByScore(this.todayRankInfoList[a].num);
        return 0
    },
    updateWorldRankInfo: function(a) {
        this.worldRankInfoList = [];
        for (var b = 0; b < a.length; b++) {
            var c = a[b];
            if (! (5E5 <= c.maxScore)) {
                var d = {};
                d.name = c.nickname.replace(/--/g, " ");
                d.num = c.maxScore;
                d.img = null == c.image || "nil" == c.image ? "uipng/achieve_icon2.png": c.image;
                d.playerid = c.playerid;
                this.worldRankInfoList.push(d)
            }
        }
        this.worldRankInfoList.sort(function(a, b) {
            return b.num - a.num
        });
        for (b = 0; b < this.worldRankInfoList.length; b++) this.worldRankInfoList[b].rank = b + 1
    },
    getOwnRankInWorldRank: function(a) {
        var b = null,
        b = null != a ? a: this.playerid;
        for (a = 0; a < this.worldRankInfoList.length; a++) if (this.worldRankInfoList[a].playerid == b) return a + 1;
        return 0
    },
    getOwnGradeInWorldRank: function() {
        for (var a = 0; a < this.worldRankInfoList.length; a++) if (this.worldRankInfoList[a].playerid == this.playerid) return getGradeByScore(this.worldRankInfoList[a].num);
        return 0
    },
    updateFriendRankInfo: function(a) {
        this.friendRankInfoList = [];
        this.friendTodayRank = [];
        this.weekRankInfoList = [];
        for (var b = 0; b < a.length; b++) {
            var c = a[b],
            d = {};
            d.name = c.nickname.replace(/--/g, " ");
            d.num = c.maxScore;
            d.img = null == c.image || "nil" == c.image ? "uipng/achieve_icon2.png": c.image;
            d.playerid = c.playerid;
            var e = {};
            e.name = c.nickname.replace(/--/g, " ");
            e.img = null == c.image || "nil" == c.image ? "uipng/achieve_icon2.png": c.image;
            e.playerid = c.playerid;
            var f = {};
            f.name = c.nickname.replace(/--/g, " ");
            f.img = null == c.image || "nil" == c.image ? "uipng/achieve_icon2.png": c.image;
            f.playerid = c.playerid;
            this.weekRankInfoList.push(f);
            this.friendTodayRank.push(e);
            this.friendRankInfoList.push(d)
        }
        a = function(a, b) {
            return b.num - a.num
        };
        this.friendRankInfoList.sort(a);
        this.friendTodayRank.sort(a);
        this.weekRankInfoList.sort(a);
        for (b = 0; b < this.friendRankInfoList.length; b++) this.friendRankInfoList[b].rank = b + 1;
        this.friendTodayRank.sort(a);
        for (b = 0; b < this.friendTodayRank.length; b++) this.friendTodayRank[b].rank = b + 1;
        this.weekRankInfoList.sort(a);
        for (b = 0; b < this.weekRankInfoList.length; b++) this.weekRankInfoList[b].rank = b + 1
    },
    getOwnRankInFriendRank: function() {
        for (var a = 0; a < this.friendRankInfoList.length; a++) if (this.friendRankInfoList[a].playerid == this.playerid) return a + 1;
        return 0
    },
    getOwnGradeInFriendRank: function() {
        for (var a = 0; a < this.friendRankInfoList.length; a++) if (this.friendRankInfoList[a].playerid == this.playerid) return getGradeByScore(this.friendRankInfoList[a].num);
        return 0
    },
    getOwnRankInFriendTodayRank: function() {
        for (var a = 0; a < this.friendTodayRank.length; a++) if (this.friendTodayRank[a].playerid == this.playerid) return a + 1;
        return 0
    },
    getOwnRankInWeekRank: function() {
        for (var a = 0; a < this.weekRankInfoList.length; a++) if (this.weekRankInfoList[a].playerid == this.playerid) return a + 1;
        return 0
    },
    updateRankInfoByOwn: function(a) {
        if (! (0 >= a)) for (var b = [this.friendRankInfoList, this.todayRankInfoList, this.worldRankInfoList, this.weekRankInfoList, this.friendTodayRank], c = 0; c < b.length; c++) {
            var d = b[c];
            if (! (0 >= d.length)) {
                for (var e = !1,
                f = !1,
                g = 0; g < d.length; g++) if (d[g].playerid == this.playerid) {
                    a > d[g].num && (d[g].num = a, e = !0);
                    f = !0;
                    break
                } ! 1 == f && (f = {},
                f.name = this.pname ? this.pname.replace(/--/g, " ") : "noname", f.num = a, f.img = this.image, f.playerid = this.playerid, 50 > d.length ? (d.push(f), e = !0) : a > d[d.length - 1].num && (d[d.length - 1] = f, e = !0));
                if (!0 == e) for (d.sort(function(a, b) {
                    return b.num - a.num
                }), g = 0; g < d.length; g++) d[g].rank = g + 1
            }
        }
    },
    updateInvitePlayerInfo: function(a, b) {
        this.invitePlayerInfo = !0 == b ? null: a
    },
    updateSurpassPlayerInfo: function(a, b) {
        if (!0 == b) this.surpassPlayer = null;
        else if (null == a) {
            this.surpassPlayer = null;
            var c = this.getOwnRankInWorldRank(),
            d = null;
            0 == c && 0 < this.worldRankInfoList.length ? (cc.log("........\u4e0d\u5728\u699c\u4e0a.........."), d = this.worldRankInfoList[this.worldRankInfoList.length - 1]) : (cc.log("........\u81ea\u5df1\u6392\u540d.........." + c), 1 < c && (d = this.worldRankInfoList[c - 2]));
            if (null != d && 0 < this.lastGrade) {
                cc.log("..........\u8d85\u8d8a\u4eba\u5206\u6570...\u81ea\u5df1\u4e0a\u5427\u5206\u6570..." + d.num + "........." + this.lastGrade);
                c = !1;
                if (d.num > this.lastGrade + 1E3) {
                    var e = null;
                    0 < this.robotList.length && (e = this.robotList[this.robotIndex], this.robotIndex += 1, this.robotIndex >= this.robotList.length && (this.robotIndex = 0));
                    null != e && (cc.log("................\u83b7\u53d6\u5230\u673a\u5668\u4eba\u4fe1\u606f.......\u540d\u5b57......." + e.nickname), a = {},
                    a.image = e.image, a.nickname = e.nickname, a.currentScore = parseInt(this.lastGrade + 400 + 600 * Math.random()), this.surpassPlayer = a, c = !0)
                } ! 1 == c && (cc.log("................\u6ca1\u6709\u673a\u5668\u4eba......."), a = {},
                a.image = d.img, a.nickname = d.name, a.currentScore = d.num, a.rank = d.rank, a.playerid = d.playerid, this.surpassPlayer = a)
            }
        } else cc.log("..............\u7528\u7684\u81ea\u5df1\u9009\u7684\u4eba\u7684\u6570\u636e........"),
        this.surpassPlayer = a
    },
    currentTargetScore: 0,
    _nextTargetPerson: null,
    setNextTargetPerson: function(a) {
        a && (this._nextTargetPerson = a)
    },
    getNextTargetPerson: function() {
        return this._nextTargetPerson
    },
    _nextTargetPersonBeiTai: null,
    setTargetBeiTai: function(a) {
        this._nextTargetPersonBeiTai = a
    },
    getTargetBeiTai: function() {
        return this._nextTargetPersonBeiTai
    }
}),
getGradeByScore = function(a) {
    for (var b = Global.gradeData.length - 1; 0 <= b; b--) if (a > Global.gradeData[b].gradeValue) return Global.gradeData[b].id;
    return 1
};
window.fbSaveDataKey = "datapopstone";
var RANK_WORLD = "popstone2_world_1",
faceBookDataKey = "popstone2_save_fb_cm95271123",
gamePlayerData = null,
initPlayerData = function(a) {
    var b = new Date;
    null == a ? gamePlayerData = {
        getTitleArr: [0, 0, 0, 0, 0, 0, 0, 0, 0],
        clearIceStone: 0,
        currentScore: 0,
        isOpenSound: 1,
        clearColorStone: 0,
        myGameDate: [],
        isFirstLogin: 1,
        rankingData: [],
        useBrush: 0,
        timeOutScore: 0,
        relifeBase: 50,
        timeHammerCount: 1,
        hammerNum: 1,
        hasGameData: 0,
        currentPage: 1,
        targetScore: 0,
        relifevalueCount: 1,
        otherString: "",
        WeekMaxScore: 0,
        relifeTimes: 0,
        loopNum: 0,
        baseScore: 0,
        brush_value: 100,
        diamondValue: 0,
        brushCount: 1,
        timePage: 1,
        hammer_value: 50,
        resulst: 0,
        adRewards: 0,
        fightInfo: [],
        diamondGiftStu: 0,
        lastLoginDay: ~~ (b.getTime() / 1E3),
        useHammer: 0,
        timeRelifeCount: 1,
        clearLessStone: 0,
        achieveData: [],
        loop_value: 25,
        playerRankingLv: -1,
        useLoop: 0,
        relifeWatchNum: 3,
        percentPage: 0,
        clickModel: 1,
        timeLoopCount: 1,
        brushNum: 0,
        maxScore: 0,
        loopCount: 1,
        relifevalue: 50,
        timeBaseScore: 0,
        hammerCount: 1,
        timeBrushCount: 1
    }: (a.getTitleArr && (gamePlayerData.getTitleArr = a.getTitleArr), gamePlayerData.clickModel = a.clickModel, gamePlayerData.isFirstLogin = a.isFirstLogin, gamePlayerData.currentPage = a.currentPage, gamePlayerData.timePage = a.timePage, gamePlayerData.isOpenSound = a.isOpenSound, gamePlayerData.maxScore = a.maxScore, debugtest.selfMuchScore && (gamePlayerData.maxScore = 6E5), gamePlayerData.currentScore = a.currentScore, gamePlayerData.baseScore = a.baseScore, gamePlayerData.timeOutScore = a.timeOutScore, gamePlayerData.timeBaseScore = a.timeBaseScore, gamePlayerData.targetScore = a.targetScore, gamePlayerData.diamondValue = a.diamondValue, debugtest.very_diamond && (gamePlayerData.diamondValue = 88888), gamePlayerData.relifevalueCount = a.relifevalueCount, gamePlayerData.timeRelifeCount = a.timeRelifeCount, gamePlayerData.relifeBase = a.relifeBase, gamePlayerData.relifevalue = a.relifevalue, gamePlayerData.loopCount = a.loopCount, gamePlayerData.timeLoopCount = a.timeLoopCount, gamePlayerData.loop_value = a.loop_value, gamePlayerData.brushCount = a.brushCount, gamePlayerData.timeBrushCount = a.timeBrushCount, gamePlayerData.brush_value = a.brush_value, gamePlayerData.hammerCount = a.hammerCount, gamePlayerData.timeHammerCount = a.timeHammerCount, gamePlayerData.hammer_value = a.hammer_value, gamePlayerData.useHammer = a.useHammer, gamePlayerData.useBrush = a.useBrush, gamePlayerData.useLoop = a.useLoop, gamePlayerData.myGameDate = a.myGameDate, gamePlayerData.hasGameData = a.hasGameData, gamePlayerData.clearIceStone = a.clearIceStone, gamePlayerData.clearColorStone = a.clearColorStone, gamePlayerData.percentPage = a.percentPage, gamePlayerData.clearLessStone = a.clearLessStone, gamePlayerData.playerRankingLv = a.playerRankingLv, gamePlayerData.achieveData = a.achieveData, gamePlayerData.relifeWatchNum = a.relifeWatchNum, gamePlayerData.diamondGiftStu = a.diamondGiftStu, gamePlayerData.adRewards = a.adRewards, gamePlayerData.fightInfo = a.fightInfo, gamePlayerData.hammerNum = a.hammerNum, gamePlayerData.brushNum = a.brushNum, debugtest.very_brush && (gamePlayerData.brushNum = 88888), gamePlayerData.loopNum = a.loopNum, gamePlayerData.relifeTimes = a.relifeTimes, gamePlayerData.otherString = a.otherString, a.targetArr && a.targetArr[0] && a.targetArr[1] && (heroData.setNextTargetPerson(a.targetArr[0]), heroData.setTargetBeiTai(a.targetArr[1]), heroData.currentTargetScore = a.targetArr[0].score), b = new Date, b.getDate() != a.lastDate && (cc.warn("\u6b21\u65e5\u767b\u9646\uff0c\u66f4\u65b0\u6570\u636e"), gamePlayerData.diamondGiftStu = 0, gamePlayerData.adRewards = 0));
    initGameLocalData()
},
resetPlayerData = function(a) {
    var b = Math.max(gamePlayerData.maxScore, Global.currentScore);
    gamePlayerData.maxScore = b;
    gamePlayerData.useHammer = 0;
    gamePlayerData.useBrush = 0;
    gamePlayerData.useLoop = 0;
    a && (0 == Global.gameModel ? (gamePlayerData.relifevalueCount = 1, gamePlayerData.loopCount = 1, gamePlayerData.brushCount = 1, gamePlayerData.hammerCount = 1) : (gamePlayerData.timeRelifeCount = 1, gamePlayerData.timeLoopCount = 1, gamePlayerData.timeBrushCount = 1, gamePlayerData.timeHammerCount = 1))
},
getCurrentTime = function() {
    return (new Date).getTime()
},
save_to_fb_local = function(a) {
    var b = {};
    b[fbSaveDataKey] = a;
    gameSDK.saveUserData(b)
},
getFaceBookTestEntriesLeaderboardData = function() {
    var a = [];
    a.push({
        id: gameSDK.sdkPlayInfo.id,
        name: gameSDK.sdkPlayInfo.name,
        score: gamePlayerData.maxScore,
        photo: gameSDK.sdkPlayInfo.photo,
        rank: 1
    });
    a.push({
        id: 464654654,
        name: "world1",
        score: 500004,
        photo: "facebook_ad/weikin_png.png",
        rank: 2
    });
    a.push({
        id: 4684645,
        name: "world2",
        score: 32,
        photo: "facebook_ad/weikin_png.png",
        rank: 3
    });
    a.push({
        id: 9689464,
        name: "world3",
        score: 19,
        photo: "facebook_ad/weikin_png.png",
        rank: 4
    });
    return a
},
getFaceBookTestPlayerEntriesboardLeaderboardData = function() {
    var a = [];
    a.push({
        id: gameSDK.sdkPlayInfo.id,
        name: gameSDK.sdkPlayInfo.name,
        score: gamePlayerData.maxScore,
        photo: gameSDK.sdkPlayInfo.photo,
        rank: 1
    });
    a.push({
        id: 7687684561,
        name: "friend1",
        score: 102,
        photo: "facebook_ad/weikin_png.png",
        rank: 2
    });
    a.push({
        id: 156415154,
        name: "friend2",
        score: 79,
        photo: "facebook_ad/weikin_png.png",
        rank: 3
    });
    return a
},
getFaceBookTestNearbyData = function() {
    var a = [];
    a.push({
        id: gameSDK.sdkPlayInfo.id,
        name: gameSDK.sdkPlayInfo.name,
        score: gamePlayerData.maxScore,
        photo: gameSDK.sdkPlayInfo.photo,
        rank: 1
    });
    a.push({
        id: 7687684561,
        name: "near1",
        score: 102,
        photo: "facebook_ad/weikin_png.png",
        rank: 2
    });
    for (var b = 0; 30 > b; b++) a.push({
        id: 156415154,
        name: "near2",
        score: 79,
        photo: "facebook_ad/weikin_png.png",
        rank: 3
    });
    return a
};
var COL = 10,
ROW = 10,
RANDOM_LENGTH = 100,
initGameConfigData = function() {
    0 == gamePlayerData.achieveData.length && (gamePlayerData.achieveData = Array(Global.gameAchieveLength), handleAchieveData())
},
handleAchieveData = function() {
    for (var a = Global.gameAchieveLength,
    b = 0,
    c = 0,
    d = 0; d < a; d++) {
        0 < d && 0 == d % 5 && b++;
        var e = new AchieveData,
        f = Global.gameAchieveConfig[d];
        e.awardValue = f.awardValue;
        e.score = f.score;
        e.pass = f.pass;
        e.stoneType = f.stoneType;
        e.clear = f.clear;
        e.id = f.id;
        var g = Global.gameAchieveInfoConfig[b];
        switch (b) {
        case 0:
            g = g.replace("$value$", f.score.toString());
            break;
        case 1:
            g = g.replace("$value$", f.pass.toString());
            break;
        case 2:
        case 3:
        case 4:
            g = g.replace("$value$", f.clear.toString())
        }
        e.content = g;
        gamePlayerData.achieveData[5 * c + b] = e;
        c++;
        0 == c % 5 && (c = 0)
    }
},
randomNameID = function(a) {
    var b = 65 + Math.floor(26 * Math.random()),
    b = String.fromCharCode(b),
    c = Math.floor(1E3 * Math.random()),
    c = getNumString(c);
    a.nameID = "#" + b + c;
    checkNameID(a)
},
checkNameID = function(a) {
    for (var b = Global.gameAchieveLength,
    c = 0; c < b; c++) if (c < gamePlayerData.achieveData.length) {
        var d = gamePlayerData.achieveData[c];
        if (a.id != d.id && a.nameID == d.nameID) {
            randomNameID(a);
            break
        }
    }
},
getNumString = function(a) {
    return 10 > a ? "00" + a.toString() : 100 > a ? "0" + a.toString() : a.toString()
},
sortAchieveData = function() {
    for (var a = Global.gameAchieveLength,
    b = [], c = [], d = [], e = 0; e < a; e++) {
        var f = gamePlayerData.achieveData[e];
        f.isCanAward ? c.push(f) : f.isGetAward ? d.push(f) : b.push(f)
    }
    for (gamePlayerData.achieveData = []; c.length;) f = c.shift(),
    gamePlayerData.achieveData.push(f);
    for (; b.length;) f = b.shift(),
    gamePlayerData.achieveData.push(f);
    for (; d.length;) f = d.shift(),
    gamePlayerData.achieveData.push(f)
},
checkAchieveData = function() {
    if (0 == Global.gameModel) for (var a = 1; 5 >= a; a++) {
        var b = getAchieveData(a); ! b.isGetAward && !b.isCanAward && Global.currentScore >= b.score && (b.isCanAward = !0)
    } else for (a = 6; 10 >= a; a++) b = getAchieveData(a),
    !b.isGetAward && !b.isCanAward && Global.currentLv >= b.pass && (b.isCanAward = !0)
},
hasAwardAchieve = function() {
    for (var a = Global.gameAchieveLength,
    b = 0; b < a; b++) if (!0 == gamePlayerData.achieveData[b].isCanAward) return ! 0;
    return ! 1
},
getAchieveData = function(a) {
    for (var b = Global.gameAchieveLength,
    c = 0; c < b; c++) {
        var d = gamePlayerData.achieveData[c];
        if (d.id == a) return d
    }
},
checkClearStone = function(a) {
    switch (a) {
    case Global.STONE_TYPE.STONE_ICE:
        gamePlayerData.clearIceStone++;
        checkClearStoneAchieve(Global.STONE_TYPE.STONE_ICE);
        break;
    case Global.STONE_TYPE.STONE_COLOR:
        gamePlayerData.clearColorStone++;
        checkClearStoneAchieve(Global.STONE_TYPE.STONE_COLOR);
        break;
    case Global.STONE_TYPE.STONE_LESS:
    case Global.STONE_TYPE.STONE_RED_LESS:
    case Global.STONE_TYPE.STONE_YELLOW_LESS:
    case Global.STONE_TYPE.STONE_BLUE_LESS:
    case Global.STONE_TYPE.STONE_GREEN_LESS:
    case Global.STONE_TYPE.STONE_PURPLE_LESS:
        gamePlayerData.clearLessStone++,
        checkClearStoneAchieve(Global.STONE_TYPE.STONE_LESS)
    }
},
checkClearStoneAchieve = function(a) {
    var b, c, d;
    switch (a) {
    case Global.STONE_TYPE.STONE_ICE:
        b = 21;
        c = 25;
        d = gamePlayerData.clearIceStone;
        break;
    case Global.STONE_TYPE.STONE_COLOR:
        b = 16;
        c = 20;
        d = gamePlayerData.clearColorStone;
        break;
    case Global.STONE_TYPE.STONE_LESS:
        b = 11,
        c = 15,
        d = gamePlayerData.clearLessStone
    }
    for (a = b; a <= c; a++) b = getAchieveData(a),
    !b.isGetAward && !b.isCanAward && d >= b.clear && (b.isCanAward = !0)
},
AchieveData = cc.Class.extend({
    isGetAward: !1,
    isCanAward: !1,
    awardValue: 0,
    score: 0,
    pass: 0,
    stoneType: 0,
    clear: 0,
    content: null,
    id: 0,
    ctor: function() {
        this.id = 0;
        this.isCanAward = this.isGetAward = !1;
        this.clear = this.stoneType = this.pass = this.score = this.awardValue = 0
    }
});
var Global = Global || {};
Global.runStartGame = !1;
Global.dataEyeOb = {
    round: 0,
    score: 0,
    item1: 0,
    item2: 0,
    item3: 0,
    diamond: 0,
    relife: 0,
    patachute: 0,
    passscorre: 0
};
Global.needSaveScoreToRank = !1;
Global.old_grade = 0;
Global.isUseHammer = !1;
Global.isCanClick = !1;
Global.isCanClean = !0;
Global.isPlayEffect = !1;
Global.AUTO_SELECTED = 5;
Global.gameStatus = 0;
Global.gameModel = 0;
Global.currentScore = 0;
Global.targetScore = 0;
Global.currentLv = 1;
Global.isBackHome = !0;
Global.isLookRanking = !1;
Global.TimeOutCount = 10;
Global.TimeOutRate = 0.1;
Global.STONE_TYPE = {
    STONE_RED: 0,
    STONE_YELLOW: 1,
    STONE_BLUE: 2,
    STONE_GREEN: 3,
    STONE_PURPLE: 4,
    STONE_ICE: 5,
    STONE_COLOR: 6,
    STONE_LESS: 7,
    STONE_RED_LESS: 8,
    STONE_YELLOW_LESS: 9,
    STONE_BLUE_LESS: 10,
    STONE_GREEN_LESS: 11,
    STONE_PURPLE_LESS: 12
};
Global.STONE_EXPLOSION = "red_exp yellow_exp blue_exp green_exp purple_exp color_exp color_exp colorless_exp red_exp yellow_exp blue_exp green_exp purple_exp".split(" ");
Global.STONE_TEXT = ["good", "very_nice", "cool", "great"];
Global.StoneWinAwardScore = 2E3;
Global.StoneWinBScoreRate = 20;
Global.StoneBaseScore = 10;
Global.StoneBaseRate = 5;
Global.StoneRandomBaseRate = [0.01, 0.01, 0.03];
Global.StoneRandomFireRate = 0.01;
Global.GameTargetFixedLv = 10;
Global.GameFixedRate = 4E3;
Global.gameRankingLength = 50;
Global.RANKING_LIST_MAX_Y = 4530;
Global.gameAchieveLength = 25;
Global.ACHIEVE_LIST_MAX_Y = 3600;
Global.BASE_STONE_NUM = 2;
Global.SHOW_TEXT_BASENUMBER = 6;
Global.StoneTypeTwo = 8;
Global.TIMEOUT_RATE = 1.5;
Global.ADDLIFE_CONTENT = ["REFILL ONE UNITS", "REFILL ALL UNITS"];
Global.TargetPos = cc.p(360, 1100);
Global.GameLevelConfig = [{
    level: 1,
    target: 1200,
    timeTarget: 2500,
    rateStoneType: [Global.STONE_TYPE.STONE_COLOR]
},
{
    level: 2,
    target: 3E3,
    timeTarget: 5E3,
    mustStoneType: [Global.STONE_TYPE.STONE_LESS]
},
{
    level: 3,
    target: 5E3,
    timeTarget: 8E3,
    mustStoneType: [Global.STONE_TYPE.STONE_COLOR, Global.STONE_TYPE.STONE_LESS]
},
{
    level: 4,
    target: 7500,
    timeTarget: 12E3,
    mustStoneType: [Global.STONE_TYPE.STONE_ICE]
},
{
    level: 5,
    target: 1E4,
    timeTarget: 15E3,
    rateStoneType: [Global.STONE_TYPE.STONE_ICE, Global.STONE_TYPE.STONE_COLOR, Global.STONE_TYPE.STONE_LESS]
},
{
    level: 6,
    target: 12500,
    timeTarget: 18E3,
    rateStoneType: [Global.STONE_TYPE.STONE_ICE, Global.STONE_TYPE.STONE_COLOR, Global.STONE_TYPE.STONE_LESS]
},
{
    level: 7,
    target: 15E3,
    timeTarget: 21E3,
    rateStoneType: [Global.STONE_TYPE.STONE_ICE, Global.STONE_TYPE.STONE_COLOR, Global.STONE_TYPE.STONE_LESS]
},
{
    level: 8,
    target: 18E3,
    timeTarget: 24E3,
    rateStoneType: [Global.STONE_TYPE.STONE_ICE, Global.STONE_TYPE.STONE_COLOR, Global.STONE_TYPE.STONE_LESS]
},
{
    level: 9,
    target: 2E4,
    timeTarget: 27E3,
    rateStoneType: [Global.STONE_TYPE.STONE_ICE, Global.STONE_TYPE.STONE_COLOR, Global.STONE_TYPE.STONE_LESS]
},
{
    level: 10,
    target: 22E3,
    timeTarget: 3E4,
    rateStoneType: [Global.STONE_TYPE.STONE_ICE, Global.STONE_TYPE.STONE_COLOR, Global.STONE_TYPE.STONE_LESS]
}];
Global.gameAchieveInfoConfig = ["Classic mode\uff1aAchieve $value$ points", "Time mode: complete the $value$", "Eliminate $value$ colorless stones", "Eliminate $value$ color stones", "Eliminate $value$ ice cubes"];
Global.PROMPT = "You already have a record. Do you want to start a new game?";
Global.gameAchieveConfig = [{
    id: 1,
    awardValue: 10,
    score: 5E3
},
{
    id: 2,
    awardValue: 15,
    score: 8E3
},
{
    id: 3,
    awardValue: 20,
    score: 1E4
},
{
    id: 4,
    awardValue: 25,
    score: 15E3
},
{
    id: 5,
    awardValue: 30,
    score: 2E4
},
{
    id: 6,
    awardValue: 10,
    pass: 5
},
{
    id: 7,
    awardValue: 15,
    pass: 8
},
{
    id: 8,
    awardValue: 20,
    pass: 10
},
{
    id: 9,
    awardValue: 25,
    pass: 15
},
{
    id: 10,
    awardValue: 30,
    pass: 20
},
{
    id: 11,
    awardValue: 5,
    stoneType: Global.STONE_TYPE.STONE_LESS,
    clear: 10
},
{
    id: 12,
    awardValue: 10,
    stoneType: Global.STONE_TYPE.STONE_LESS,
    clear: 20
},
{
    id: 13,
    awardValue: 15,
    stoneType: Global.STONE_TYPE.STONE_LESS,
    clear: 30
},
{
    id: 14,
    awardValue: 20,
    stoneType: Global.STONE_TYPE.STONE_LESS,
    clear: 40
},
{
    id: 15,
    awardValue: 25,
    stoneType: Global.STONE_TYPE.STONE_LESS,
    clear: 50
},
{
    id: 16,
    awardValue: 5,
    stoneType: Global.STONE_TYPE.STONE_COLOR,
    clear: 10
},
{
    id: 17,
    awardValue: 10,
    stoneType: Global.STONE_TYPE.STONE_COLOR,
    clear: 20
},
{
    id: 18,
    awardValue: 15,
    stoneType: Global.STONE_TYPE.STONE_COLOR,
    clear: 30
},
{
    id: 19,
    awardValue: 20,
    stoneType: Global.STONE_TYPE.STONE_COLOR,
    clear: 40
},
{
    id: 20,
    awardValue: 25,
    stoneType: Global.STONE_TYPE.STONE_COLOR,
    clear: 50
},
{
    id: 21,
    awardValue: 5,
    stoneType: Global.STONE_TYPE.STONE_ICE,
    clear: 10
},
{
    id: 22,
    awardValue: 10,
    stoneType: Global.STONE_TYPE.STONE_ICE,
    clear: 20
},
{
    id: 23,
    awardValue: 15,
    stoneType: Global.STONE_TYPE.STONE_ICE,
    clear: 30
},
{
    id: 24,
    awardValue: 20,
    stoneType: Global.STONE_TYPE.STONE_ICE,
    clear: 40
},
{
    id: 25,
    awardValue: 25,
    stoneType: Global.STONE_TYPE.STONE_ICE,
    clear: 50
}];
Global.highScoreChange = !1;
Global.globalTips = "You'll be removed from the ranking list if log out for a long time!";
Global.gradeData = [{
    id: 1,
    gradeValue: 0,
    gradeName: "Infant",
    gradeIcon: ""
},
{
    id: 2,
    gradeValue: 2E3,
    gradeName: "Pupil",
    gradeIcon: ""
},
{
    id: 3,
    gradeValue: 5E3,
    gradeName: "Junior",
    gradeIcon: ""
},
{
    id: 4,
    gradeValue: 8E3,
    gradeName: "Undergraduate",
    gradeIcon: ""
},
{
    id: 5,
    gradeValue: 12E3,
    gradeName: "Postgraduate",
    gradeIcon: ""
},
{
    id: 6,
    gradeValue: 2E4,
    gradeName: "Doctor",
    gradeIcon: ""
},
{
    id: 7,
    gradeValue: 3E4,
    gradeName: "Professor",
    gradeIcon: ""
},
{
    id: 8,
    gradeValue: 5E4,
    gradeName: "Savant",
    gradeIcon: ""
},
{
    id: 9,
    gradeValue: 1E5,
    gradeName: "Sophist",
    gradeIcon: ""
}];
var EVENTMGR_ID = {
    addBoradCast: 1
},
EventMgr = {
    events: {},
    register: function(a, b, c) {
        a && b ? this.checkIsExist(a, c) ? cc.log("already exist in event!!!") : (c = {},
        c.func = b, this.events[a] || (this.events[a] = []), this.events[a].push(c)) : cc.log("register error param !!!")
    },
    checkIsExist: function(a, b) {
        var c = this.events[a];
        if (!c) return ! 1;
        for (var d = 0; d < c.length; ++d) if (_.isEqual(c[d].self, b)) return ! 0;
        return ! 1
    },
    emit: function(a, b) {
        var c = this.events[a];
        if (c) for (var d = 0; d < c.length; ++d) this.callBack(c[d], b || null);
        else cc.log("event num is out !!!", a)
    },
    broad: function(a) {
        for (var b in this.events) for (var c = 0; c < this.events[b].length; ++c) this.callBack(this.events[b][c], a)
    },
    callBack: function(a, b) {
        var c = a.self,
        d = a.func;
        c && c.func ? c.func(b) : d.call(c, b)
    },
    remove: function(a, b) {
        var c = this.events[a];
        if (c) for (var d = 0; d < c.length; ++d) _.isEqual(c[d].self, b) && c.splice(d, 1)
    },
    clean: function() {
        this.events = {}
    }
}; (function() {
    var a = "object" == typeof self && self.self === self && self || "object" == typeof global && global.global === global && global || this,
    b = a._,
    c = Array.prototype,
    d = Object.prototype,
    e = "undefined" !== typeof Symbol ? Symbol.prototype: null,
    f = c.push,
    g = c.slice,
    h = d.toString,
    k = d.hasOwnProperty,
    m = Array.isArray,
    r = Object.keys,
    s = Object.create,
    t = function() {},
    p = function(a) {
        if (a instanceof p) return a;
        if (! (this instanceof p)) return new p(a);
        this._wrapped = a
    };
    "undefined" == typeof exports || exports.nodeType ? a._ = p: ("undefined" != typeof module && !module.nodeType && module.exports && (exports = module.exports = p), exports._ = p);
    p.VERSION = "1.8.3";
    var v = function(a, b, c) {
        if (void 0 === b) return a;
        switch (null == c ? 3 : c) {
        case 1:
            return function(c) {
                return a.call(b, c)
            };
        case 3:
            return function(c, d, e) {
                return a.call(b, c, d, e)
            };
        case 4:
            return function(c, d, e, f) {
                return a.call(b, c, d, e, f)
            }
        }
        return function() {
            return a.apply(b, arguments)
        }
    },
    u,
    x = function(a, b, c) {
        return p.iteratee !== u ? p.iteratee(a, b) : null == a ? p.identity: p.isFunction(a) ? v(a, b, c) : p.isObject(a) ? p.matcher(a) : p.property(a)
    };
    p.iteratee = u = function(a, b) {
        return x(a, b, Infinity)
    };
    var y = function(a, b) {
        b = null == b ? a.length - 1 : +b;
        return function() {
            for (var c = Math.max(arguments.length - b, 0), d = Array(c), e = 0; e < c; e++) d[e] = arguments[e + b];
            switch (b) {
            case 0:
                return a.call(this, d);
            case 1:
                return a.call(this, arguments[0], d);
            case 2:
                return a.call(this, arguments[0], arguments[1], d)
            }
            c = Array(b + 1);
            for (e = 0; e < b; e++) c[e] = arguments[e];
            c[b] = d;
            return a.apply(this, c)
        }
    },
    w = function(a) {
        if (!p.isObject(a)) return {};
        if (s) return s(a);
        t.prototype = a;
        a = new t;
        t.prototype = null;
        return a
    },
    B = function(a) {
        return function(b) {
            return null == b ? void 0 : b[a]
        }
    },
    z = Math.pow(2, 53) - 1,
    A = B("length"),
    D = function(a) {
        a = A(a);
        return "number" == typeof a && 0 <= a && a <= z
    };
    p.each = p.forEach = function(a, b, c) {
        b = v(b, c);
        var d;
        if (D(a)) for (c = 0, d = a.length; c < d; c++) b(a[c], c, a);
        else {
            var e = p.keys(a);
            c = 0;
            for (d = e.length; c < d; c++) b(a[e[c]], e[c], a)
        }
        return a
    };
    p.map = p.collect = function(a, b, c) {
        b = x(b, c);
        c = !D(a) && p.keys(a);
        for (var d = (c || a).length, e = Array(d), f = 0; f < d; f++) {
            var g = c ? c[f] : f;
            e[f] = b(a[g], g, a)
        }
        return e
    };
    var C = function(a) {
        return function(b, c, d, e) {
            var f = 3 <= arguments.length,
            g = v(c, e, 4),
            h = d,
            k = !D(b) && p.keys(b),
            m = (k || b).length,
            r = 0 < a ? 0 : m - 1;
            f || (h = b[k ? k[r] : r], r += a);
            for (; 0 <= r && r < m; r += a) f = k ? k[r] : r,
            h = g(h, b[f], f, b);
            return h
        }
    };
    p.reduce = p.foldl = p.inject = C(1);
    p.reduceRight = p.foldr = C( - 1);
    p.find = p.detect = function(a, b, c) {
        b = (D(a) ? p.findIndex: p.findKey)(a, b, c);
        if (void 0 !== b && -1 !== b) return a[b]
    };
    p.filter = p.select = function(a, b, c) {
        var d = [];
        b = x(b, c);
        p.each(a,
        function(a, c, e) {
            b(a, c, e) && d.push(a)
        });
        return d
    };
    p.reject = function(a, b, c) {
        return p.filter(a, p.negate(x(b)), c)
    };
    p.every = p.all = function(a, b, c) {
        b = x(b, c);
        c = !D(a) && p.keys(a);
        for (var d = (c || a).length, e = 0; e < d; e++) {
            var f = c ? c[e] : e;
            if (!b(a[f], f, a)) return ! 1
        }
        return ! 0
    };
    p.some = p.any = function(a, b, c) {
        b = x(b, c);
        c = !D(a) && p.keys(a);
        for (var d = (c || a).length, e = 0; e < d; e++) {
            var f = c ? c[e] : e;
            if (b(a[f], f, a)) return ! 0
        }
        return ! 1
    };
    p.contains = p.includes = p.include = function(a, b, c, d) {
        D(a) || (a = p.values(a));
        if ("number" != typeof c || d) c = 0;
        return 0 <= p.indexOf(a, b, c)
    };
    p.invoke = y(function(a, b, c) {
        var d = p.isFunction(b);
        return p.map(a,
        function(a) {
            var e = d ? b: a[b];
            return null == e ? e: e.apply(a, c)
        })
    });
    p.pluck = function(a, b) {
        return p.map(a, p.property(b))
    };
    p.where = function(a, b) {
        return p.filter(a, p.matcher(b))
    };
    p.findWhere = function(a, b) {
        return p.find(a, p.matcher(b))
    };
    p.max = function(a, b, c) {
        var d = -Infinity,
        e = -Infinity,
        f;
        if (null == b || "number" == typeof b && "object" != typeof a[0] && null != a) {
            a = D(a) ? a: p.values(a);
            for (var g = 0,
            h = a.length; g < h; g++) c = a[g],
            null != c && c > d && (d = c)
        } else b = x(b, c),
        p.each(a,
        function(a, c, g) {
            f = b(a, c, g);
            if (f > e || -Infinity === f && -Infinity === d) d = a,
            e = f
        });
        return d
    };
    p.min = function(a, b, c) {
        var d = Infinity,
        e = Infinity,
        f;
        if (null == b || "number" == typeof b && "object" != typeof a[0] && null != a) {
            a = D(a) ? a: p.values(a);
            for (var g = 0,
            h = a.length; g < h; g++) c = a[g],
            null != c && c < d && (d = c)
        } else b = x(b, c),
        p.each(a,
        function(a, c, g) {
            f = b(a, c, g);
            if (f < e || Infinity === f && Infinity === d) d = a,
            e = f
        });
        return d
    };
    p.shuffle = function(a) {
        return p.sample(a, Infinity)
    };
    p.sample = function(a, b, c) {
        if (null == b || c) return D(a) || (a = p.values(a)),
        a[p.random(a.length - 1)];
        a = D(a) ? p.clone(a) : p.values(a);
        c = A(a);
        b = Math.max(Math.min(b, c), 0);
        c -= 1;
        for (var d = 0; d < b; d++) {
            var e = p.random(d, c),
            f = a[d];
            a[d] = a[e];
            a[e] = f
        }
        return a.slice(0, b)
    };
    p.sortBy = function(a, b, c) {
        var d = 0;
        b = x(b, c);
        return p.pluck(p.map(a,
        function(a, c, e) {
            return {
                value: a,
                index: d++,
                criteria: b(a, c, e)
            }
        }).sort(function(a, b) {
            var c = a.criteria,
            d = b.criteria;
            if (c !== d) {
                if (c > d || void 0 === c) return 1;
                if (c < d || void 0 === d) return - 1
            }
            return a.index - b.index
        }), "value")
    };
    C = function(a, b) {
        return function(c, d, e) {
            var f = b ? [[], []] : {};
            d = x(d, e);
            p.each(c,
            function(b, e) {
                var g = d(b, e, c);
                a(f, b, g)
            });
            return f
        }
    };
    p.groupBy = C(function(a, b, c) {
        p.has(a, c) ? a[c].push(b) : a[c] = [b]
    });
    p.indexBy = C(function(a, b, c) {
        a[c] = b
    });
    p.countBy = C(function(a, b, c) {
        p.has(a, c) ? a[c]++:a[c] = 1
    });
    var H = /[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;
    p.toArray = function(a) {
        return a ? p.isArray(a) ? g.call(a) : p.isString(a) ? a.match(H) : D(a) ? p.map(a, p.identity) : p.values(a) : []
    };
    p.size = function(a) {
        return null == a ? 0 : D(a) ? a.length: p.keys(a).length
    };
    p.partition = C(function(a, b, c) {
        a[c ? 0 : 1].push(b)
    },
    !0);
    p.first = p.head = p.take = function(a, b, c) {
        return null == a || 1 > a.length ? void 0 : null == b || c ? a[0] : p.initial(a, a.length - b)
    };
    p.initial = function(a, b, c) {
        return g.call(a, 0, Math.max(0, a.length - (null == b || c ? 1 : b)))
    };
    p.last = function(a, b, c) {
        return null == a || 1 > a.length ? void 0 : null == b || c ? a[a.length - 1] : p.rest(a, Math.max(0, a.length - b))
    };
    p.rest = p.tail = p.drop = function(a, b, c) {
        return g.call(a, null == b || c ? 1 : b)
    };
    p.compact = function(a) {
        return p.filter(a, Boolean)
    };
    var E = function(a, b, c, d) {
        d = d || [];
        for (var e = d.length,
        f = 0,
        g = A(a); f < g; f++) {
            var h = a[f];
            if (D(h) && (p.isArray(h) || p.isArguments(h))) if (b) for (var k = 0,
            m = h.length; k < m;) d[e++] = h[k++];
            else E(h, b, c, d),
            e = d.length;
            else c || (d[e++] = h)
        }
        return d
    };
    p.flatten = function(a, b) {
        return E(a, b, !1)
    };
    p.without = y(function(a, b) {
        return p.difference(a, b)
    });
    p.uniq = p.unique = function(a, b, c, d) {
        p.isBoolean(b) || (d = c, c = b, b = !1);
        null != c && (c = x(c, d));
        d = [];
        for (var e = [], f = 0, g = A(a); f < g; f++) {
            var h = a[f],
            k = c ? c(h, f, a) : h;
            b ? (f && e === k || d.push(h), e = k) : c ? p.contains(e, k) || (e.push(k), d.push(h)) : p.contains(d, h) || d.push(h)
        }
        return d
    };
    p.union = y(function(a) {
        return p.uniq(E(a, !0, !0))
    });
    p.intersection = function(a) {
        for (var b = [], c = arguments.length, d = 0, e = A(a); d < e; d++) {
            var f = a[d];
            if (!p.contains(b, f)) {
                var g;
                for (g = 1; g < c && p.contains(arguments[g], f); g++);
                g === c && b.push(f)
            }
        }
        return b
    };
    p.difference = y(function(a, b) {
        b = E(b, !0, !0);
        return p.filter(a,
        function(a) {
            return ! p.contains(b, a)
        })
    });
    p.unzip = function(a) {
        for (var b = a && p.max(a, A).length || 0, c = Array(b), d = 0; d < b; d++) c[d] = p.pluck(a, d);
        return c
    };
    p.zip = y(p.unzip);
    p.object = function(a, b) {
        for (var c = {},
        d = 0,
        e = A(a); d < e; d++) b ? c[a[d]] = b[d] : c[a[d][0]] = a[d][1];
        return c
    };
    C = function(a) {
        return function(b, c, d) {
            c = x(c, d);
            d = A(b);
            for (var e = 0 < a ? 0 : d - 1; 0 <= e && e < d; e += a) if (c(b[e], e, b)) return e;
            return - 1
        }
    };
    p.findIndex = C(1);
    p.findLastIndex = C( - 1);
    p.sortedIndex = function(a, b, c, d) {
        c = x(c, d, 1);
        b = c(b);
        d = 0;
        for (var e = A(a); d < e;) {
            var f = Math.floor((d + e) / 2);
            c(a[f]) < b ? d = f + 1 : e = f
        }
        return d
    };
    C = function(a, b, c) {
        return function(d, e, f) {
            var h = 0,
            k = A(d);
            if ("number" == typeof f) 0 < a ? h = 0 <= f ? f: Math.max(f + k, h) : k = 0 <= f ? Math.min(f + 1, k) : f + k + 1;
            else if (c && f && k) return f = c(d, e),
            d[f] === e ? f: -1;
            if (e !== e) return f = b(g.call(d, h, k), p.isNaN),
            0 <= f ? f + h: -1;
            for (f = 0 < a ? h: k - 1; 0 <= f && f < k; f += a) if (d[f] === e) return f;
            return - 1
        }
    };
    p.indexOf = C(1, p.findIndex, p.sortedIndex);
    p.lastIndexOf = C( - 1, p.findLastIndex);
    p.range = function(a, b, c) {
        null == b && (b = a || 0, a = 0);
        c || (c = b < a ? -1 : 1);
        b = Math.max(Math.ceil((b - a) / c), 0);
        for (var d = Array(b), e = 0; e < b; e++, a += c) d[e] = a;
        return d
    };
    p.chunk = function(a, b) {
        if (null == b || 1 > b) return [];
        for (var c = [], d = 0, e = a.length; d < e;) c.push(g.call(a, d, d += b));
        return c
    };
    var F = function(a, b, c, d, e) {
        if (! (d instanceof b)) return a.apply(c, e);
        b = w(a.prototype);
        a = a.apply(b, e);
        return p.isObject(a) ? a: b
    };
    p.bind = y(function(a, b, c) {
        if (!p.isFunction(a)) throw new TypeError("Bind must be called on a function");
        var d = y(function(e) {
            return F(a, d, b, this, c.concat(e))
        });
        return d
    });
    p.partial = y(function(a, b) {
        var c = p.partial.placeholder,
        d = function() {
            for (var e = 0,
            f = b.length,
            g = Array(f), h = 0; h < f; h++) g[h] = b[h] === c ? arguments[e++] : b[h];
            for (; e < arguments.length;) g.push(arguments[e++]);
            return F(a, d, this, this, g)
        };
        return d
    });
    p.partial.placeholder = p;
    p.bindAll = y(function(a, b) {
        b = E(b, !1, !1);
        var c = b.length;
        if (1 > c) throw Error("bindAll must be passed function names");
        for (; c--;) {
            var d = b[c];
            a[d] = p.bind(a[d], a)
        }
    });
    p.memoize = function(a, b) {
        var c = function(d) {
            var e = c.cache,
            f = "" + (b ? b.apply(this, arguments) : d);
            p.has(e, f) || (e[f] = a.apply(this, arguments));
            return e[f]
        };
        c.cache = {};
        return c
    };
    p.delay = y(function(a, b, c) {
        return setTimeout(function() {
            return a.apply(null, c)
        },
        b)
    });
    p.defer = p.partial(p.delay, p, 1);
    p.throttle = function(a, b, c) {
        var d, e, f, g, h = 0;
        c || (c = {});
        var k = function() {
            h = !1 === c.leading ? 0 : p.now();
            d = null;
            g = a.apply(e, f);
            d || (e = f = null)
        },
        m = function() {
            var m = p.now();
            h || !1 !== c.leading || (h = m);
            var r = b - (m - h);
            e = this;
            f = arguments;
            0 >= r || r > b ? (d && (clearTimeout(d), d = null), h = m, g = a.apply(e, f), d || (e = f = null)) : d || !1 === c.trailing || (d = setTimeout(k, r));
            return g
        };
        m.cancel = function() {
            clearTimeout(d);
            h = 0;
            d = e = f = null
        };
        return m
    };
    p.debounce = function(a, b, c) {
        var d, e, f = function(b, c) {
            d = null;
            c && (e = a.apply(b, c))
        },
        g = y(function(g) {
            d && clearTimeout(d);
            if (c) {
                var h = !d;
                d = setTimeout(f, b);
                h && (e = a.apply(this, g))
            } else d = p.delay(f, b, this, g);
            return e
        });
        g.cancel = function() {
            clearTimeout(d);
            d = null
        };
        return g
    };
    p.wrap = function(a, b) {
        return p.partial(b, a)
    };
    p.negate = function(a) {
        return function() {
            return ! a.apply(this, arguments)
        }
    };
    p.compose = function() {
        var a = arguments,
        b = a.length - 1;
        return function() {
            for (var c = b,
            d = a[b].apply(this, arguments); c--;) d = a[c].call(this, d);
            return d
        }
    };
    p.after = function(a, b) {
        return function() {
            if (1 > --a) return b.apply(this, arguments)
        }
    };
    p.before = function(a, b) {
        var c;
        return function() {
            0 < --a && (c = b.apply(this, arguments));
            1 >= a && (b = null);
            return c
        }
    };
    p.once = p.partial(p.before, 2);
    p.restArgs = y;
    var G = !{
        toString: null
    }.propertyIsEnumerable("toString"),
    I = "valueOf isPrototypeOf toString propertyIsEnumerable hasOwnProperty toLocaleString".split(" "),
    K = function(a, b) {
        var c = I.length,
        e = a.constructor,
        e = p.isFunction(e) && e.prototype || d,
        f = "constructor";
        for (p.has(a, f) && !p.contains(b, f) && b.push(f); c--;) f = I[c],
        f in a && a[f] !== e[f] && !p.contains(b, f) && b.push(f)
    };
    p.keys = function(a) {
        if (!p.isObject(a)) return [];
        if (r) return r(a);
        var b = [],
        c;
        for (c in a) p.has(a, c) && b.push(c);
        G && K(a, b);
        return b
    };
    p.allKeys = function(a) {
        if (!p.isObject(a)) return [];
        var b = [],
        c;
        for (c in a) b.push(c);
        G && K(a, b);
        return b
    };
    p.values = function(a) {
        for (var b = p.keys(a), c = b.length, d = Array(c), e = 0; e < c; e++) d[e] = a[b[e]];
        return d
    };
    p.mapObject = function(a, b, c) {
        b = x(b, c);
        c = p.keys(a);
        for (var d = c.length,
        e = {},
        f = 0; f < d; f++) {
            var g = c[f];
            e[g] = b(a[g], g, a)
        }
        return e
    };
    p.pairs = function(a) {
        for (var b = p.keys(a), c = b.length, d = Array(c), e = 0; e < c; e++) d[e] = [b[e], a[b[e]]];
        return d
    };
    p.invert = function(a) {
        for (var b = {},
        c = p.keys(a), d = 0, e = c.length; d < e; d++) b[a[c[d]]] = c[d];
        return b
    };
    p.functions = p.methods = function(a) {
        var b = [],
        c;
        for (c in a) p.isFunction(a[c]) && b.push(c);
        return b.sort()
    };
    C = function(a, b) {
        return function(c) {
            var d = arguments.length;
            b && (c = Object(c));
            if (2 > d || null == c) return c;
            for (var e = 1; e < d; e++) for (var f = arguments[e], g = a(f), h = g.length, k = 0; k < h; k++) {
                var m = g[k];
                b && void 0 !== c[m] || (c[m] = f[m])
            }
            return c
        }
    };
    p.extend = C(p.allKeys);
    p.extendOwn = p.assign = C(p.keys);
    p.findKey = function(a, b, c) {
        b = x(b, c);
        c = p.keys(a);
        for (var d, e = 0,
        f = c.length; e < f; e++) if (d = c[e], b(a[d], d, a)) return d
    };
    var L = function(a, b, c) {
        return b in c
    };
    p.pick = y(function(a, b) {
        var c = {},
        d = b[0];
        if (null == a) return c;
        p.isFunction(d) ? (1 < b.length && (d = v(d, b[1])), b = p.allKeys(a)) : (d = L, b = E(b, !1, !1), a = Object(a));
        for (var e = 0,
        f = b.length; e < f; e++) {
            var g = b[e],
            h = a[g];
            d(h, g, a) && (c[g] = h)
        }
        return c
    });
    p.omit = y(function(a, b) {
        var c = b[0],
        d;
        p.isFunction(c) ? (c = p.negate(c), 1 < b.length && (d = b[1])) : (b = p.map(E(b, !1, !1), String), c = function(a, c) {
            return ! p.contains(b, c)
        });
        return p.pick(a, c, d)
    });
    p.defaults = C(p.allKeys, !0);
    p.create = function(a, b) {
        var c = w(a);
        b && p.extendOwn(c, b);
        return c
    };
    p.clone = function(a) {
        return p.isObject(a) ? p.isArray(a) ? a.slice() : p.extend({},
        a) : a
    };
    p.tap = function(a, b) {
        b(a);
        return a
    };
    p.isMatch = function(a, b) {
        var c = p.keys(b),
        d = c.length;
        if (null == a) return ! d;
        for (var e = Object(a), f = 0; f < d; f++) {
            var g = c[f];
            if (b[g] !== e[g] || !(g in e)) return ! 1
        }
        return ! 0
    };
    var J, N;
    J = function(a, b, c, d) {
        if (a === b) return 0 !== a || 1 / a === 1 / b;
        if (null == a || null == b) return a === b;
        if (a !== a) return b !== b;
        var e = typeof a;
        return "function" !== e && "object" !== e && "object" != typeof b ? !1 : N(a, b, c, d)
    };
    N = function(a, b, c, d) {
        a instanceof p && (a = a._wrapped);
        b instanceof p && (b = b._wrapped);
        var f = h.call(a);
        if (f !== h.call(b)) return ! 1;
        switch (f) {
        case "[object RegExp]":
        case "[object String]":
            return "" + a === "" + b;
        case "[object Number]":
            return + a !== +a ? +b !== +b: 0 === +a ? 1 / +a === 1 / b: +a === +b;
        case "[object Date]":
        case "[object Boolean]":
            return + a === +b;
        case "[object Symbol]":
            return e.valueOf.call(a) === e.valueOf.call(b)
        }
        f = "[object Array]" === f;
        if (!f) {
            if ("object" != typeof a || "object" != typeof b) return ! 1;
            var g = a.constructor,
            k = b.constructor;
            if (g !== k && !(p.isFunction(g) && g instanceof g && p.isFunction(k) && k instanceof k) && "constructor" in a && "constructor" in b) return ! 1
        }
        c = c || [];
        d = d || [];
        for (g = c.length; g--;) if (c[g] === a) return d[g] === b;
        c.push(a);
        d.push(b);
        if (f) {
            g = a.length;
            if (g !== b.length) return ! 1;
            for (; g--;) if (!J(a[g], b[g], c, d)) return ! 1
        } else {
            f = p.keys(a);
            g = f.length;
            if (p.keys(b).length !== g) return ! 1;
            for (; g--;) if (k = f[g], !p.has(b, k) || !J(a[k], b[k], c, d)) return ! 1
        }
        c.pop();
        d.pop();
        return ! 0
    };
    p.isEqual = function(a, b) {
        return J(a, b)
    };
    p.isEmpty = function(a) {
        return null == a ? !0 : D(a) && (p.isArray(a) || p.isString(a) || p.isArguments(a)) ? 0 === a.length: 0 === p.keys(a).length
    };
    p.isElement = function(a) {
        return ! (!a || 1 !== a.nodeType)
    };
    p.isArray = m ||
    function(a) {
        return "[object Array]" === h.call(a)
    };
    p.isObject = function(a) {
        var b = typeof a;
        return "function" === b || "object" === b && !!a
    };
    p.each("Arguments Function String Number Date RegExp Error Symbol Map WeakMap Set WeakSet".split(" "),
    function(a) {
        p["is" + a] = function(b) {
            return h.call(b) === "[object " + a + "]"
        }
    });
    p.isArguments(arguments) || (p.isArguments = function(a) {
        return p.has(a, "callee")
    });
    m = a.document && a.document.childNodes;
    "function" != typeof / . / &&"object" != typeof Int8Array && "function" != typeof m && (p.isFunction = function(a) {
        return "function" == typeof a || !1
    });
    p.isFinite = function(a) {
        return ! p.isSymbol(a) && isFinite(a) && !isNaN(parseFloat(a))
    };
    p.isNaN = function(a) {
        return p.isNumber(a) && isNaN(a)
    };
    p.isBoolean = function(a) {
        return ! 0 === a || !1 === a || "[object Boolean]" === h.call(a)
    };
    p.isNull = function(a) {
        return null === a
    };
    p.isUndefined = function(a) {
        return void 0 === a
    };
    p.has = function(a, b) {
        return null != a && k.call(a, b)
    };
    p.noConflict = function() {
        a._ = b;
        return this
    };
    p.identity = function(a) {
        return a
    };
    p.constant = function(a) {
        return function() {
            return a
        }
    };
    p.noop = function() {};
    p.property = B;
    p.propertyOf = function(a) {
        return null == a ?
        function() {}: function(b) {
            return a[b]
        }
    };
    p.matcher = p.matches = function(a) {
        a = p.extendOwn({},
        a);
        return function(b) {
            return p.isMatch(b, a)
        }
    };
    p.times = function(a, b, c) {
        var d = Array(Math.max(0, a));
        b = v(b, c, 1);
        for (c = 0; c < a; c++) d[c] = b(c);
        return d
    };
    p.random = function(a, b) {
        null == b && (b = a, a = 0);
        return a + Math.floor(Math.random() * (b - a + 1))
    };
    p.now = Date.now ||
    function() {
        return (new Date).getTime()
    };
    B = {
        "\x26": "\x26amp;",
        "\x3c": "\x26lt;",
        "\x3e": "\x26gt;",
        '"': "\x26quot;",
        "'": "\x26#x27;",
        "`": "\x26#x60;"
    };
    m = p.invert(B);
    C = function(a) {
        var b = function(b) {
            return a[b]
        },
        c = "(?:" + p.keys(a).join("|") + ")",
        d = RegExp(c),
        e = RegExp(c, "g");
        return function(a) {
            a = null == a ? "": "" + a;
            return d.test(a) ? a.replace(e, b) : a
        }
    };
    p.escape = C(B);
    p.unescape = C(m);
    p.result = function(a, b, c) {
        b = null == a ? void 0 : a[b];
        void 0 === b && (b = c);
        return p.isFunction(b) ? b.call(a) : b
    };
    var O = 0;
    p.uniqueId = function(a) {
        var b = ++O + "";
        return a ? a + b: b
    };
    p.templateSettings = {
        evaluate: /<%([\s\S]+?)%>/g,
        interpolate: /<%=([\s\S]+?)%>/g,
        escape: /<%-([\s\S]+?)%>/g
    };
    var M = /(.)^/,
    P = {
        "'": "'",
        "\\": "\\",
        "\r": "r",
        "\n": "n",
        "\u2028": "u2028",
        "\u2029": "u2029"
    },
    Q = /\\|'|\r|\n|\u2028|\u2029/g,
    R = function(a) {
        return "\\" + P[a]
    };
    p.template = function(a, b, c) { ! b && c && (b = c);
        b = p.defaults({},
        b, p.templateSettings);
        c = RegExp([(b.escape || M).source, (b.interpolate || M).source, (b.evaluate || M).source].join("|") + "|$", "g");
        var d = 0,
        e = "__p+\x3d'";
        a.replace(c,
        function(b, c, f, g, h) {
            e += a.slice(d, h).replace(Q, R);
            d = h + b.length;
            c ? e += "'+\n((__t\x3d(" + c + "))\x3d\x3dnull?'':_.escape(__t))+\n'": f ? e += "'+\n((__t\x3d(" + f + "))\x3d\x3dnull?'':__t)+\n'": g && (e += "';\n" + g + "\n__p+\x3d'");
            return b
        });
        e += "';\n";
        b.variable || (e = "with(obj||{}){\n" + e + "}\n");
        var e = "var __t,__p\x3d'',__j\x3dArray.prototype.join,print\x3dfunction(){__p+\x3d__j.call(arguments,'');};\n" + e + "return __p;\n",
        f;
        try {
            f = new Function(b.variable || "obj", "_", e)
        } catch(g) {
            throw g.source = e,
            g;
        }
        c = function(a) {
            return f.call(this, a, p)
        };
        c.source = "function(" + (b.variable || "obj") + "){\n" + e + "}";
        return c
    };
    p.chain = function(a) {
        a = p(a);
        a._chain = !0;
        return a
    };
    var S = function(a, b) {
        return a._chain ? p(b).chain() : b
    };
    p.mixin = function(a) {
        p.each(p.functions(a),
        function(b) {
            var c = p[b] = a[b];
            p.prototype[b] = function() {
                var a = [this._wrapped];
                f.apply(a, arguments);
                return S(this, c.apply(p, a))
            }
        });
        return p
    };
    p.mixin(p);
    p.each("pop push reverse shift sort splice unshift".split(" "),
    function(a) {
        var b = c[a];
        p.prototype[a] = function() {
            var c = this._wrapped;
            b.apply(c, arguments);
            "shift" !== a && "splice" !== a || 0 !== c.length || delete c[0];
            return S(this, c)
        }
    });
    p.each(["concat", "join", "slice"],
    function(a) {
        var b = c[a];
        p.prototype[a] = function() {
            return S(this, b.apply(this._wrapped, arguments))
        }
    });
    p.prototype.value = function() {
        return this._wrapped
    };
    p.prototype.valueOf = p.prototype.toJSON = p.prototype.value;
    p.prototype.toString = function() {
        return String(this._wrapped)
    };
    "function" == typeof define && define.amd && define("underscore", [],
    function() {
        return p
    })
})();
var ACHIEVE_LIST_WIDTH = 700,
ACHIEVE_LIST_HEIGHT = 860,
AchieveLater = cc.Layer.extend({
    bg_effect_layer: null,
    mainView: null,
    listView: null,
    home_btn: null,
    add_btn: null,
    moveY: 0,
    index: 0,
    ctor: function() {
        this._super();
        this.mainView = this.listView = this.bg_effect_layer = null;
        this.moveY = 0;
        this.add_btn = this.home_btn = null;
        this.index = 0
    },
    onEnter: function() {
        this._super();
        this.initView();
        currentScene.addChild(new BroadCastLayer, 999)
    },
    initView: function() {
        sortAchieveData();
        var a = cc.winSize;
        this.bg_effect_layer = new GameBgLayer;
        this.addChild(this.bg_effect_layer);
        this.mainView = loadCSS(res.achieve_layer_json, !1);
        this.addChild(this.mainView);
        this.listView = new cc.Sprite;
        this.listView.self = this;
        this.listView.swallowTouches = !1;
        this.handleAchieveList();
        var b = cc.fadeTo(0.5, 150),
        c = cc.fadeTo(0.5, 255),
        d = cc.delayTime(0.5);
        this.mainView.achieve_color_bg.runAction(cc.sequence(b, c, d).repeatForever());
        this.mainView.aw_fntc_moneyLab.alignmentType = artWordToMiddle;
        engine.gameEvent.createMouseDown(this.listView, this.clickListViewDown, null, cc.rect(58, -5E3, 680, 1E4));
        engine.gameEvent.createMouseMove(this.listView, this.clickListViewMove, null, cc.rect(58, -5E3, 680, 1E4));
        b = new cc.LayerColor(cc.color.WHITE, ACHIEVE_LIST_WIDTH, ACHIEVE_LIST_HEIGHT);
        c = new cc.ClippingNode;
        c.alphaThreshold = 1;
        c.setAnchorPoint(0.5, 0.5);
        c.inverted = !1;
        c.stencil = b;
        c.setContentSize(ACHIEVE_LIST_WIDTH, ACHIEVE_LIST_HEIGHT);
        c.addChild(this.listView);
        this.addChild(c);
        c.setPosition(0.5 * a.width, 0.5 * a.height - 20);
        this.home_btn = new cc.Sprite("#uipng/home_btn.png");
        this.addChild(this.home_btn);
        this.home_btn.setPosition(360, 56);
        engine.gameEvent.createMouseUp(this.home_btn, this.onClickHomeBtn.bind(this), buttonScalingType);
        this.add_btn = new cc.Sprite("#uipng/main_addbtn.png");
        this.add_btn.setPosition(683, 1228);
        engine.gameEvent.createMouseUp(this.add_btn, this.onClickAddBtn.bind(this), buttonScalingType);
        this.mainView.aw_fntc_moneyLab.setString(gamePlayerData.diamondValue.toString());
        this.bg_effect_layer.showFireWorksEffect()
    },
    handleAchieveList: function() {
        for (var a = 0; a < Global.gameAchieveLength; a++) {
            var b = new AchieveItem(gamePlayerData.achieveData[a]);
            this.listView.addChild(b);
            b.setPosition(360, ACHIEVE_LIST_HEIGHT - 72 - 180 * a)
        }
    },
    changeMoney: function() {
        var a = new AwardLayer;
        currentScene.addChild(a)
    },
    moneyAfter: function() {
        var a = cc.scaleTo(0.2, 1.5).easing(cc.easeBackInOut()),
        b = cc.scaleTo(0.2, 1);
        this.mainView.aw_fntc_moneyLab.setString(gamePlayerData.diamondValue.toString());
        this.mainView.aw_fntc_moneyLab.runAction(cc.sequence(a, b))
    },
    clickListViewDown: function(a, b) {
        this.moveY = a.getLocation().y
    },
    clickListViewMove: function(a, b) {
        var c = a.getLocation(),
        d = this.y - (this.moveY - c.y);
        this.moveY = c.y;
        this.self.moveSetY(d)
    },
    moveSetY: function(a) {
        0 > a && (a = 0);
        a > Global.ACHIEVE_LIST_MAX_Y && (a = Global.ACHIEVE_LIST_MAX_Y);
        this.listView.y = a
    },
    onClickHomeBtn: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        engine.gameSound.playEffect(game_sound.res_sound_closeview);
        transitions(HomeScene)
    },
    onClickAddBtn: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn)
    },
    refreshView: function() {}
}),
AchieveScene = GameScene.extend({
    layer: null,
    ctor: function() {
        this._super();
        this.layer = null
    },
    onEnter: function() {
        this._super();
        this.initialize();
        this.initView()
    },
    initialize: function() {
        this._super()
    },
    initView: function() {
        this.layer = new AchieveLater;
        this.addChild(this.layer)
    }
});
var HomeLayer = cc.Layer.extend({
    bg_effect_layer: null,
    mainView: null,
    timeout_lab: null,
    curScore: 0,
    ctor: function() {
        this._super();
        this.timeout_lab = this.mainView = this.bg_effect_layer = null;
        this.curScore = 0
    },
    onEnter: function() {
        this._super();
        this.initView();
        currentScene.addChild(new BroadCastLayer, 999);
        0 < gamePlayerData.maxScore && gameSDK.createShortcut()
    },
    initView: function() {
        this.bg_effect_layer = new GameBgLayer;
        this.addChild(this.bg_effect_layer);
        this.mainView = loadCSS(res.home_layer_json, !1);
        this.addChild(this.mainView);
        this.timeout_lab = this.mainView.timeout;
        this.mainView.btnsound_sound.setUIState();
        engine.gameEvent.createMouseUp(this.mainView.home_newbtn, this.clickNewGame.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainView.home_conbtn, this.clickContinue.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainView.home_timemodebtn, this.clickGameModel.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainView.home_achievebtn, this.clickAchieve.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainView.home_rankbtn, this.clickRank.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainView.giftbox, this.clickGiftBoxRank.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainView.titlebox, this.clickTitleBoxRank.bind(this), buttonScalingType);
        this.mainView.aw_fntb_maxscore.setString(gamePlayerData.maxScore.toString());
        this.showAnimation();
        this.bg_effect_layer.showFireWorksEffect();
        gamePlayerData.isFirstLogin = 0;
        gamePlayerData.timePage = 1;
        Global.isBackHome = !0;
        engine.gameSound.playMusic(game_sound.res_sound_home, !1);
        this.checkRankAndAchieve();
        this.refreshView();
        this.passText();
        this.updateGiftBtn()
    },
    updateGiftBtn: function() {
        1 != gamePlayerData.diamondGiftStu ? this.mainView.giftbox.runAction(cc.sequence(cc.scaleTo(1, 0.8, 0.8), cc.scaleTo(1, 1.2, 1.2)).repeatForever()) : this.mainView.giftbox.stopAllActions()
    },
    getRobotListData: function(a) {
        1 == a ? cc.log("\u673a\u5668\u4eba\u83b7\u53d6\u5931\u8d25") : null != a && heroData.updateRobotList(a.RobotList)
    },
    getWorldRankData: function(a) {
        1 == a ? cc.log("\u4e16\u754c\u6392\u884c\u83b7\u53d6\u5931\u8d25") : null != a && heroData.updateWorldRankInfo(a.levelList)
    },
    clickNewGame: function() {
        heroData.invitePlayerInfo = heroData.getNextTargetPerson();
        Global.old_grade = getGradeByScore(gamePlayerData.maxScore);
        gamePlayerData.hasGameData = 0;
        Global.gameModel = 0;
        gamePlayerData.relifeTimes = 0;
        heroData.isShowParachute = !1;
        Global.dataEyeOb = {
            round: 0,
            score: 0,
            item1: 0,
            item2: 0,
            item3: 0,
            diamond: 0,
            relife: 0,
            patachute: 0,
            passscorre: 0
        };
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        this.checkStartGame(1)
    },
    clickContinue: function() {
        Global.old_grade = getGradeByScore(gamePlayerData.maxScore);
        Global.gameModel = 0;
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        gamePlayerData.myGameDate.length && (gamePlayerData.hasGameData = 1, this.mainView.home_conbtn.stopAllActions(), this.mainView.home_conbtn.runAction(cc.sequence(cc.blink(0.5, 5), cc.callFunc(function() {
            transitions(MainScene)
        }))))
    },
    clickGameModel: function() {
        gamePlayerData.hasGameData = 0;
        Global.gameModel = 1;
        gamePlayerData.relifeTimes = 0;
        heroData.isShowParachute = !1;
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        this.checkStartGame(3)
    },
    clickAchieve: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        engine.gameSound.playEffect(game_sound.res_sound_closeview);
        transitions(AchieveScene)
    },
    clickTitleBoxRank: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        if (null == currentScene.getChildByName("titleLayer")) {
            var a = new TitleLayer;
            a.setName("titleLayer");
            currentScene.addChild(a)
        }
    },
    clickGiftBoxRank: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        if (null == currentScene.getChildByName("giftLayer")) {
            var a = new GiftLayer;
            a.initUI(0);
            a.setName("giftLayer");
            currentScene.addChild(a)
        }
    },
    clickRank: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        engine.gameSound.playEffect(game_sound.res_sound_closeview);
        transitions(RankingScene)
    },
    showPrompt: function() {
        var a = new PromptLayer;
        this.addChild(a)
    },
    clickExit: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        cc.sys.isNative && cc.director.end();
        gamePlayerData.isFirstLogin = 1;
        saveUserData()
    },
    showAnimation: function() {
        var a = this.mainView.home_light,
        b = cc.rotateBy(5, 360);
        a.setPosition(360, 930);
        a.runAction(b.repeatForever());
        var c = this.mainView.home_logo,
        b = cc.moveBy(1, cc.p(0, 20)),
        a = b.reverse();
        c.runAction(cc.sequence(b, a).repeatForever());
        c = this.mainView.home_newbtn;
        b = cc.scaleTo(2, 1.1);
        a = cc.scaleTo(2, 1);
        c.runAction(cc.sequence(b, a).repeatForever())
    },
    checkRankAndAchieve: function() { ! 0 == Global.isLookRanking ? this.mainView.home_rankbtn.red_star.setVisible(!1) : this.mainView.home_rankbtn.red_star.setVisible(!0);
        hasAwardAchieve() ? this.mainView.home_achievebtn.red_star.setVisible(!0) : this.mainView.home_achievebtn.red_star.setVisible(!1);
        for (var a = getGradeByScore(gamePlayerData.maxScore), b = gamePlayerData.getTitleArr, c = !1, d = 0; d < a; d++) if ("0" == b[d]) {
            c = !0;
            break
        }
        this.mainView.titlebox.red_star.setVisible(c)
    },
    checkStartGame: function(a) {
        var b = null;
        switch (a) {
        case 1:
            b = this.mainView.home_newbtn;
            gamePlayerData.currentScore = gamePlayerData.baseScore = Global.currentScore = 0;
            gamePlayerData.currentPage = Global.currentLv = 1;
            gamePlayerData.myGameDate = [];
            break;
        case 2:
            b = this.mainView.home_conbtn;
            break;
        case 3:
            b = this.mainView.home_timemodebtn,
            gamePlayerData.timeOutScore = gamePlayerData.timeBaseScore = Global.currentScore = 0,
            gamePlayerData.timePage = Global.currentLv = 1
        }
        b.stopAllActions();
        b.runAction(cc.sequence(cc.blink(0.5, 5), cc.callFunc(function() {
            transitions(MainScene)
        }.bind(this))))
    },
    refreshView: function(a) {
        a = gamePlayerData.myGameDate.length ? cc.spriteFrameCache.getSpriteFrame("uipng/home_continuebtn.png") : cc.spriteFrameCache.getSpriteFrame("uipng/home_continuebtn2.png");
        this.mainView.home_conbtn.setSpriteFrame(a)
    },
    beginGameUpdate: function() {},
    passText: function() {
        if (Global.highScoreChange) {
            Global.highScoreChange = !1;
            this.mainView.aw_fntb_maxscore.setString("0");
            this.schedule(this.runMaxScore, 0.03);
            this.mainView.percent_text.setVisible(!0);
            var a = 0;
            1E4 > gamePlayerData.maxScore ? a = Math.floor(gamePlayerData.maxScore / 20 * 0.1) : (a = 50 + Math.floor(0.1 * (gamePlayerData.maxScore - 1E4)), a = 100 < a ? 100 : a);
            this.mainView.percent_text.aw_fnttype2_num.setString(a.toString());
            this.mainView.percent_text.runAction(cc.sequence(cc.blink(0.5, 3), cc.scaleTo(0.2, 1.3), cc.scaleTo(0.2, 1)))
        } else this.mainView.percent_text.setVisible(!1),
        this.mainView.aw_fntb_maxscore.setString(gamePlayerData.maxScore.toString())
    },
    runMaxScore: function() {
        this.curScore += 100;
        this.curScore > gamePlayerData.maxScore && (this.curScore = gamePlayerData.maxScore, this.unschedule(this.runMaxScore.bind(this)));
        this.mainView.aw_fntb_maxscore.setString(this.curScore.toString())
    }
}),
HomeScene = GameScene.extend({
    layer: null,
    ctor: function() {
        this._super();
        this.sceneName = "HomeScene";
        this.layer = null
    },
    onEnter: function() {
        this._super();
        engine.gameLog.updateGameErrorType(afterEnterGame);
        Global.runStartGame || (Global.runStartGame = !0, gameSDK.startGame(function() {
            gameSDK.setScoreAsync(RANK_WORLD, gamePlayerData.maxScore, {
                p: ""
            },
            function(a) {
                null != a && null != a.getRank && (gameSDK.sdkPlayInfo.rank = a.getRank())
            });
            cc.log("FB_name:", gameSDK.sdkPlayInfo.name);
            cc.log("FB_photo:", gameSDK.sdkPlayInfo.photo);
            cc.log("FB_id:", gameSDK.sdkPlayInfo.id);
            cc.log("gameStart--------------");
            heroData.nickname = gameSDK.sdkPlayInfo.name;
            heroData.image = gameSDK.sdkPlayInfo.photo.replace('"', "").replace(/[\\]/g, "");
            cc.log(".........\u83b7\u53d6\u5230\u7684\u540d\u5b57..........." + heroData.nickname);
            cc.log(".........\u83b7\u53d6\u5230\u7684\u5934\u50cf..........." + heroData.image);
            cc.log("...........\u7248\u672c\u53f7.........." + gameServerVersion);
            debugtest.forceMustShowTarget && (heroData.invitePlayerInfo = {
                name: "\u6d4b\u8bd5",
                score: 555,
                photo: "cc"
            });
            cc.log("\u9080\u8bf7\u4fe1\u606f\uff1a", gameSDK.sdkPlayInfo.entryPointData);
            gameSDK.sdkPlayInfo.entryPointData && (heroData.invitePlayerInfo = gameSDK.sdkPlayInfo.entryPointData, heroData.setNextTargetPerson(heroData.invitePlayerInfo));
            if (null != heroData.invitePlayerInfo && null != currentScene) {
                var a = new CompetitionLayer;
                currentScene.addChild(a, 99999999)
            }
            0 == gameLocalData.musicVolume ? engine.gameSound.stopMusic() : engine.gameSound.openMusic()
        }));
        this.initialize();
        this.initView()
    },
    initialize: function() {
        this._super()
    },
    initView: function() {
        this.layer = new HomeLayer;
        this.addChild(this.layer)
    }
});
var GAME_NORMAL = 0,
GAME_SUCCESS = 1,
GAME_FAIL = 2,
MainLayer = cc.Layer.extend({
    bg_effect_Layer: null,
    stoneLayer: null,
    ui_layer: null,
    effectLayer: null,
    isNeedUpdate: !1,
    timeCount: 0,
    timeRate: 0,
    frameImg: null,
    clipper: null,
    nameTxt: null,
    scoreTxt: null,
    rankText: null,
    surpassPlayerInfo: null,
    isAddParachute: null,
    targetContainer: null,
    ctor: function() {
        this._super();
        this.effectLayer = this.stoneLayer = this.ui_layer = this.bg_effect_Layer = null;
        this.isNeedUpdate = !1;
        this.surpassPlayerInfo = this.rankText = this.scoreTxt = this.nameTxt = this.clipper = this.frameImg = null;
        this.isAddParachute = !1
    },
    onEnter: function() {
        this._super();
        this.initView();
        currentScene.addChild(new BroadCastLayer, 999)
    },
    initView: function() {
        this.bg_effect_Layer = new GameBgLayer;
        this.addChild(this.bg_effect_Layer);
        this.stoneLayer = new StoneLayer;
        this.addChild(this.stoneLayer);
        this.ui_layer = loadCSS(res.main_layer_json, !1);
        this.addChild(this.ui_layer);
        this.effectLayer = new EffectLayer;
        this.addChild(this.effectLayer);
        engine.gameEvent.createMouseUp(this.ui_layer.pause_btn, this.clickPauseBtn.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.ui_layer.loop_btn, this.clickLoopBtn.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.ui_layer.add_btn, this.clickAddBtn.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.ui_layer.brush_btn, this.clickBrushBtn.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.ui_layer.hammer_btn, this.clickHammerBtn.bind(this), buttonScalingType);
        this.ui_layer.aw_fntb_looplab.setScale(0.8);
        this.ui_layer.aw_fntb_brushlab.setScale(0.8);
        this.ui_layer.aw_fntb_hammerlab.setScale(0.8);
        this.ui_layer.score_info.setVisible(!1);
        this.ui_layer.aw_fnta_scorelab.alignmentType = artWordToMiddle;
        this.createBeginAnimal();
        this.scheduleUpdate();
        this.schedule(this.showMeteorEffect, 15, cc.REPEAT_FOREVER, 5);
        engine.gameSound.playMusic(game_sound.res_sound_bg_sound);
        Global.isCanClick = !1;
        this.pauseGameUpdate();
        this.updateDemPush()
    },
    updateDemPush: function() {
        3 > gamePlayerData.adRewards ? (this.ui_layer.add_btn.adddemtip.setVisible(!0), this.ui_layer.add_btn.adddemtip.runAction(cc.sequence(cc.scaleTo(1, 0.8, 0.8), cc.scaleTo(1, 1.2, 1.2)).repeatForever())) : (this.ui_layer.add_btn.adddemtip.setVisible(!1), this.ui_layer.add_btn.adddemtip.stopAllActions())
    },
    addInvitePlayerInfo: function() {
        null != this.frameImg && (this.frameImg.removeFromParent(), this.frameImg = null, this.clipper.removeFromParent(), this.nameTxt.removeFromParent(), this.scoreTxt.removeFromParent(), null != this.rankText && (this.rankText.removeFromParent(), this.rankText = null));
        if (heroData.getNextTargetPerson() && 0 == Global.gameModel) {
            var a = new TargetLayer;
            currentScene.addChild(a)
        }
    },
    addShowSurpassPlayer: function(a, b) {
        var c = heroData.getNextTargetPerson();
        if (c) {
            var d = new cc.Node;
            this.frameImg = new cc.Sprite("#other/playerbg.png");
            this.frameImg.x = 270;
            this.frameImg.y = 1010;
            d.addChild(this.frameImg);
            var e = new LoadSprite,
            f = c.photo;
            e.loadComplete = function(a) {
                a = new cc.Sprite(a);
                a.setScale(80 / a.getContentSize().width);
                this.addChild(a)
            };
            e.setPNGUrl(f, 80);
            f = new cc.Sprite("#rank/black.png");
            this.clipper = new cc.ClippingNode;
            this.clipper.stencil = f;
            this.clipper.setAlphaThreshold(0.05);
            this.clipper.addChild(e);
            this.clipper.x = this.frameImg.x;
            this.clipper.y = this.frameImg.y - 2;
            d.addChild(this.clipper);
            this.nameTxt = new cc.LabelTTF(c.name, "res/font/font.ttf", 32);
            this.nameTxt.x = this.frameImg.x + 50;
            this.nameTxt.y = this.frameImg.y + 18;
            this.nameTxt.setAnchorPoint(cc.p(0, 0.5));
            this.nameTxt.setHorizontalAlignment(cc.TEXT_ALIGNMENT_LEFT);
            d.addChild(this.nameTxt);
            this.scoreTxt = new cc.LabelTTF("" + c.score, defaultTxt, 30);
            this.scoreTxt.setAnchorPoint(cc.p(0, 0.5));
            this.scoreTxt.x = this.frameImg.x + 50;
            this.scoreTxt.y = this.frameImg.y - 18;
            c = 176 / this.scoreTxt.getContentSize().width;
            this.scoreTxt.setScale(1 <= c ? 1 : c);
            d.addChild(this.scoreTxt);
            this.addChild(d);
            d.x = 56 + (75.7 - this.nameTxt.width) / 2;
            this.targetContainer = d
        }
    },
    update: function() {
        this.updateUI(); ! 1 != this.isNeedUpdate && (this.checkGetSuccess() ? !1 == Global.isPlayEffect ? this.handleSuccess() : !1 != Global.isCanClean || !Global.isCanClick || 0 < this.stoneLayer.selectedStoneNum || this.handleSuccessClean() : 0 < this.stoneLayer.selectedStoneNum || !1 == Global.isCanClean && !1 == Global.isPlayEffect && this.handleFailClean())
    },
    autoSelected: function() { ! 1 == this.isNeedUpdate || !1 == Global.isCanClick || !0 == this.checkClickStatus() || 0 < this.stoneLayer.selectedStoneNum || 0 < this.stoneLayer.cleanStoneArr.length ? this.resetDelayTime() : this.stoneLayer.autoSelected()
    },
    resetDelayTime: function() {
        0 == this.stoneLayer.cleanStoneArr.length && this.stoneLayer.clearSelectedStone();
        this.unschedule(this.autoSelected);
        this.scheduleOnce(this.autoSelected, Global.AUTO_SELECTED)
    },
    checkGetSuccess: function() {
        return Global.currentScore >= Global.targetScore ? !0 : !1
    },
    handleSuccess: function() {
        Global.isPlayEffect = !0;
        engine.gameSound.playEffect(game_sound.res_sound_gamewin);
        this.effectLayer.onShowEffect("pass_effect", 0, 11, cc.p(360, 900), 2, 1);
        this.ui_layer.main_success_bg.setVisible(!0)
    },
    handleSuccessClean: function() {
        this.pauseGameUpdate();
        Global.isCanClick = !1;
        Global.gameStatus = GAME_SUCCESS;
        this.stoneLayer.clearLastStone()
    },
    handleFailClean: function() {
        this.pauseGameUpdate();
        Global.isCanClick = !1;
        Global.isPlayEffect = !0;
        Global.gameStatus = GAME_FAIL;
        this.stoneLayer.clearLastStone()
    },
    updateProgress: function() {
        this.ui_layer.timeOutView.progresssBg.loadingBar.percent -= this.timeRate
    },
    updateTimeOut: function() {
        this.timeCount -= 0.01;
        var a = this.timeCount.toFixed(2);
        0 >= this.timeCount && (this.handleFailClean(), a = "00.00");
        a = a.split(".");
        2 > a[0].toString().length && (a[0] = "0" + a[0]);
        this.ui_layer.timeOutView.timepng.aw_fntf_timecount1.setString(a[0]);
        this.ui_layer.timeOutView.timepng.aw_fntf_timecount2.setString(a[1])
    },
    showReLifeView: function() {
        var a = new RelifeLayer;
        currentScene.addChild(a)
    },
    clickAddBtn: function() { ! 1 != Global.isCanClick && (engine.gameSound.playEffect(game_sound.res_sound_home_btn), gamePlayerData.useHammer = 0, gamePlayerData.useBrush = 0, gamePlayerData.useLoop = 0, this.changeBtnStatus(), this.resetDelayTime(), this.createDiamondLayer())
    },
    createDiamondLayer: function() {
        var a = new RewardLayer;
        createAlphaMaskLayer(a);
        this.addChild(a, 1001)
    },
    clickBrushBtn: function() {
        if (debugtest.brushTestUpRank) {
            var a = new UpRankLayer({
                currentScore: 555,
                rank: 5,
                nickname: "test",
                image: "https://fb-s-d-a.akamaihd.net/h-ak-fbx/v/t1.0-1/p320x320/24131500_889798657851941_1372837406836141609_n.jpg?oh\x3ded5b223b3690d182d3fa533108c5ac93\x26oe\x3d5AB4557C\x26__gda__\x3d1523177196_1b37aa2716ae1692cef393d4f1b796b8"
            });
            currentScene.addChild(a)
        } else ! 1 != Global.isCanClick && (engine.gameSound.playEffect(game_sound.res_sound_home_btn), 0 < gamePlayerData.brushNum ? (gamePlayerData.useBrush = 1 == gamePlayerData.useBrush ? 0 : 1, gamePlayerData.useHammer = 0, gamePlayerData.useLoop = 0, this.changeBtnStatus()) : gamePlayerData.diamondValue >= (0 == Global.gameModel ? gamePlayerData.brush_value * gamePlayerData.brushCount: gamePlayerData.brush_value * gamePlayerData.timeBrushCount) ? (gamePlayerData.useBrush = 1 == gamePlayerData.useBrush ? 0 : 1, gamePlayerData.useHammer = 0, gamePlayerData.useLoop = 0, this.changeBtnStatus()) : this.clickAddBtn(), this.resetDelayTime())
    },
    clickHammerBtn: function() { ! 1 != Global.isCanClick && (engine.gameSound.playEffect(game_sound.res_sound_hammer), 0 < gamePlayerData.hammerNum ? (gamePlayerData.useHammer = 1 == gamePlayerData.useHammer ? 0 : 1, gamePlayerData.useBrush = 0, gamePlayerData.useLoop = 0, this.changeBtnStatus()) : gamePlayerData.diamondValue >= (0 == Global.gameModel ? gamePlayerData.hammer_value * gamePlayerData.hammerCount: gamePlayerData.hammer_value * gamePlayerData.timeHammerCount) ? (gamePlayerData.useHammer = 1 == gamePlayerData.useHammer ? 0 : 1, gamePlayerData.useBrush = 0, gamePlayerData.useLoop = 0, this.changeBtnStatus()) : this.clickAddBtn(), this.resetDelayTime())
    },
    clickPauseBtn: function() {
        if (debugtest.pauseBtnTest_fail) Global.isCanClick = !1,
        this.handleFail();
        else if (!1 != Global.isCanClick) {
            this.pauseGameUpdate();
            engine.gameSound.playEffect(game_sound.res_sound_home_btn);
            gamePlayerData.useHammer = 0;
            gamePlayerData.useBrush = 0;
            gamePlayerData.useLoop = 0;
            this.changeBtnStatus();
            var a = new PauseLayer;
            currentScene.addChild(a);
            this.resetDelayTime()
        }
    },
    clickLoopBtn: function() {
        if (debugtest.exchange_jiangluosan) heroData.isShowParachute = !1,
        this.addParachute();
        else if (!1 != Global.isCanClick) {
            engine.gameSound.playEffect(game_sound.res_sound_home_btn);
            if (0 < gamePlayerData.loopNum) gamePlayerData.useHammer = 0,
            gamePlayerData.useBrush = 0,
            gamePlayerData.useLoop = 1,
            gamePlayerData.loopNum -= 1,
            Global.dataEyeOb.item3++,
            this.changeBtnStatus(),
            this.stoneLayer.refreshStone();
            else {
                var a = 0 == Global.gameModel ? gamePlayerData.loop_value * gamePlayerData.loopCount: gamePlayerData.loop_value * gamePlayerData.timeLoopCount;
                gamePlayerData.diamondValue >= a ? (gamePlayerData.useHammer = 0, gamePlayerData.useBrush = 0, gamePlayerData.useLoop = 1, 0 == Global.gameModel ? gamePlayerData.loopCount++:gamePlayerData.timeLoopCount++, this.changeBtnStatus(), gamePlayerData.diamondValue -= a, Global.dataEyeOb.item3++, this.stoneLayer.refreshStone()) : this.clickAddBtn()
            }
            this.resetDelayTime()
        }
    },
    changeBtnStatus: function() {
        var a = 0 == gamePlayerData.useBrush ? "main_brushbtn": "main_brushselected",
        a = cc.spriteFrameCache.getSpriteFrame("uipng/" + a + ".png");
        this.ui_layer.brush_btn.setSpriteFrame(a);
        a = 0 == gamePlayerData.useHammer ? "main_hammerbtn": "main_hammerselected";
        a = cc.spriteFrameCache.getSpriteFrame("uipng/" + a + ".png");
        this.ui_layer.hammer_btn.setSpriteFrame(a);
        a = 0 == gamePlayerData.useLoop ? "main_loopbtn": "main_loopbtnselected";
        a = cc.spriteFrameCache.getSpriteFrame("uipng/" + a + ".png");
        this.ui_layer.loop_btn.setSpriteFrame(a)
    },
    saveGameData: function() {
        checkAchieveData();
        Global.highScoreChange = Global.currentScore > gamePlayerData.maxScore;
        var a = Math.max(gamePlayerData.maxScore, Global.currentScore);
        gamePlayerData.maxScore = a;
        if (0 == Global.gameModel) {
            gamePlayerData.myGameDate = [];
            for (a = 0; a < ROW; a++) {
                gamePlayerData.myGameDate[a] = [];
                for (var b = 0; b < COL; b++) {
                    var c = this.stoneLayer.stoneTileMap.getGridByGridPoint(b, a);
                    c ? (gamePlayerData.myGameDate[a].push({
                        col: c.gridX,
                        row: c.gridY,
                        type: c.stoneType
                    }), c.cleanStone()) : gamePlayerData.myGameDate[a].push(null);
                    this.stoneLayer.stoneTileMap.setGridInfo(b, a, null)
                }
            }
            gamePlayerData.currentScore = Global.currentScore;
            gamePlayerData.currentPage = Global.currentLv;
            heroData.updateRankInfoByOwn(Global.currentScore);
            saveUserData()
        } else gamePlayerData.timePage = 1,
        gamePlayerData.timeBaseScore = gamePlayerData.timeOutScore = 0,
        resetPlayerData(!1)
    },
    reLifeGame: function() {
        resetPlayerData(!1);
        this.checkGotoGame()
    },
    gotoLastPass: function() {
        var a = this.ui_layer.getChildByName("parachute");
        null != a && a.removeFromParent();
        this.isAddParachute = !1;
        a = Math.max(gamePlayerData.maxScore, Global.currentScore);
        gamePlayerData.maxScore = a;
        heroData.updateRankInfoByOwn(Global.currentScore);
        if (0 == Global.gameModel) {
            for (gamePlayerData.currentPage++; Global.currentScore >= getTargetScore(gamePlayerData.currentPage);) gamePlayerData.currentPage++;
            gamePlayerData.baseScore = gamePlayerData.currentScore = Global.currentScore;
            gamePlayerData.myGameDate = []
        } else {
            for (gamePlayerData.timePage++; Global.currentScore >= getTargetScore(gamePlayerData.timePage);) gamePlayerData.timePage++;
            gamePlayerData.timeBaseScore = gamePlayerData.timeOutScore = Global.currentScore
        }
        resetPlayerData(!1);
        this.checkGotoGame()
    },
    showAddScoreEffect: function() {
        this.ui_layer.aw_fnta_scorelab.setVisible(!0);
        this.ui_layer.aw_fnta_scorelab.stopAllActions();
        this.ui_layer.aw_fnta_scorelab.setScale(1);
        var a = cc.scaleTo(0.2, 1.5).easing(cc.easeBackInOut()),
        b = cc.scaleTo(0.2, 1);
        this.ui_layer.aw_fnta_scorelab.runAction(cc.sequence(a, b));
        this.stoneLayer.selectedStoneNum--;
        this.addParachute()
    },
    updateUI: function() {
        this.ui_layer.aw_fntb_lvlab.setString(Global.currentLv.toString());
        this.ui_layer.aw_fnta_scorelab.setString(Global.currentScore.toString());
        this.ui_layer.aw_fntb_targetlab.setString(Global.targetScore.toString());
        this.ui_layer.aw_fntb_moneylab.alignmentType = artWordToMiddle;
        this.ui_layer.aw_fntb_moneylab.setString(gamePlayerData.diamondValue.toString());
        if (0 < gamePlayerData.loopNum) this.ui_layer.aw_fntb_looplab.x = 645,
        this.ui_layer.dia_bar_2_10.setSpriteFrame("uipng/main_lvbg.png"),
        this.ui_layer.dia_bar_2_10.setScale(0.7),
        this.ui_layer.aw_fntb_looplab.setString(gamePlayerData.loopNum.toString());
        else {
            this.ui_layer.aw_fntb_looplab.x = 656;
            this.ui_layer.dia_bar_2_10.setSpriteFrame("uipng/main_moneybg2.png");
            this.ui_layer.dia_bar_2_10.setScale(1);
            var a = 0 == Global.gameModel ? gamePlayerData.loop_value * gamePlayerData.loopCount: gamePlayerData.loop_value * gamePlayerData.timeLoopCount;
            this.ui_layer.aw_fntb_looplab.setString(a.toString())
        }
        0 < gamePlayerData.brushNum ? (this.ui_layer.aw_fntb_brushlab.x = 85, this.ui_layer.dia_bar_2_9.setSpriteFrame("uipng/main_lvbg.png"), this.ui_layer.dia_bar_2_9.setScale(0.7), this.ui_layer.aw_fntb_brushlab.setString(gamePlayerData.brushNum.toString())) : (this.ui_layer.aw_fntb_brushlab.x = 94, this.ui_layer.dia_bar_2_9.setSpriteFrame("uipng/main_moneybg2.png"), this.ui_layer.dia_bar_2_9.setScale(1), a = 0 == Global.gameModel ? gamePlayerData.brush_value * gamePlayerData.brushCount: gamePlayerData.brush_value * gamePlayerData.timeBrushCount, this.ui_layer.aw_fntb_brushlab.setString(a.toString()));
        0 < gamePlayerData.hammerNum ? (this.ui_layer.aw_fntb_hammerlab.x = 645, this.ui_layer.dia_bar_2_11.setSpriteFrame("uipng/main_lvbg.png"), this.ui_layer.dia_bar_2_11.setScale(0.7), this.ui_layer.aw_fntb_hammerlab.setString(gamePlayerData.hammerNum.toString())) : (this.ui_layer.aw_fntb_hammerlab.x = 656, this.ui_layer.dia_bar_2_11.setSpriteFrame("uipng/main_moneybg2.png"), this.ui_layer.dia_bar_2_11.setScale(1), a = 0 == Global.gameModel ? gamePlayerData.hammer_value * gamePlayerData.hammerCount: gamePlayerData.hammer_value * gamePlayerData.timeHammerCount, this.ui_layer.aw_fntb_hammerlab.setString(a.toString()))
    },
    createBeginAnimal: function() {
        Global.isBackHome = !0;
        this.ui_layer.timeOutView.setVisible(!1);
        this.ui_layer.main_success_bg.setVisible(!1);
        1 == Global.gameModel && (this.timeCount = Global.TimeOutCount, this.timeRate = Global.TimeOutRate, this.ui_layer.timeOutView.timepng.aw_fntf_timecount1.alignmentType = artWordToMiddle, this.ui_layer.timeOutView.timepng.aw_fntf_timecount2.alignmentType = artWordToMiddle, this.ui_layer.timeOutView.timepng.aw_fntf_timecount1.setString(this.timeCount.toString()), this.ui_layer.timeOutView.timepng.aw_fntf_timecount2.setString("00"), this.ui_layer.timeOutView.progresssBg.loadingBar.setPercent(100));
        1 == Global.currentLv && this.addShowItemAd();
        this.effectLayer.showStartEffect();
        var a = cc.scaleTo(0.2, 1.5).easing(cc.easeBackInOut()),
        b = cc.scaleTo(0.2, 1),
        a = cc.sequence(a, b);
        this.ui_layer.aw_fntb_lvlab.runAction(cc.sequence(cc.delayTime(1.5), a));
        this.ui_layer.aw_fntb_targetlab.runAction(cc.sequence(cc.delayTime(2), a.clone()));
        this.runAction(cc.sequence(cc.delayTime(3.5), cc.callFunc(function() {
            this.stoneLayer.startCreateStones()
        }.bind(this))))
    },
    canShowParachute: function() {
        return 0 == (gamePlayerData.currentPage - 1) % 2
    },
    addParachute: function() {
        var a = this.stoneLayer.computeSurplusScore(),
        b = this.ui_layer.getChildByName("parachute"); ! debugtest.exchange_jiangluosan && (null != b || this.isAddParachute || !this.canShowParachute() || Global.currentScore >= Global.targetScore || !this.stoneLayer.checkStoneNum() || a + Global.currentScore >= Global.targetScore || null == Global.currentLv || 3 > Global.currentLv) || heroData.isShowParachute || 0 != Global.gameModel || (this.isAddParachute = !0, b = [{
            type: 1,
            num: Global.targetScore - Global.currentScore,
            url: "#result/score.png"
        },
        {
            type: 2,
            num: 1,
            url: "#watchad/imgbrush.png"
        },
        {
            type: 3,
            num: 2,
            url: "#watchad/imghammer.png"
        },
        {
            type: 4,
            num: 2,
            url: "#watchad/imgloop.png"
        }], a = b[~~ (Math.random() * b.length)], debugtest.lock_jiangluosan_skiplevel && (a = b[0]), b = new cc.Sprite("#watchad/imggift.png"), b.x = -80, b.y = 840, b.setName("parachute"), b.reward = a, this.ui_layer.addChild(b, 10), engine.gameEvent.createMouseUp(b, this.clickParachuteFun, buttonScalingType), b.runAction(cc.moveBy(5, cc.p(900, 0))), heroData.parachuteIndex += 1)
    },
    clickParachuteFun: function() {
        var a = new ParachuteRewardLayer(this);
        currentScene.addChild(a);
        this.removeFromParent()
    },
    addShowItemAd: function() {
        this.targetContainer && this.targetContainer.removeFromParent();
        if (1 == heroData.gameTimes && 0 == heroData.itemGiftTimes && 0 == heroData.watchNum) {
            var a = new GiftLayer;
            a.initUI(1);
            currentScene.addChild(a)
        } else this.addInvitePlayerInfo()
    },
    showGameFail: function(a) {
        Global.dataEyeOb.round = Global.currentLv;
        Global.dataEyeOb.score = Global.currentScore;
        Global.dataEyeOb.item = [Global.dataEyeOb.item1, Global.dataEyeOb.item2, Global.dataEyeOb.item3];
        Global.dataEyeOb.diamond = gamePlayerData.diamondValue;
        Global.dataEyeOb.relife = gamePlayerData.relifeTimes;
        http_recordPlayerAction(playerActionType.playRoundInfo);
        a = Math.max(gamePlayerData.maxScore, Global.currentScore);
        gamePlayerData.maxScore = a;
        gamePlayerData.relifeTimes = 0;
        heroData.gameTimes += 1;
        heroData.localGameTimes += 1;
        heroData.isShowParachute = !1;
        heroData.updateRankInfoByOwn(Global.currentScore);
        0 == Global.gameModel && (gamePlayerData.currentPage = 1, gamePlayerData.baseScore = 0, gamePlayerData.currentScore = 0, gamePlayerData.myGameDate = []);
        resetPlayerData(!0);
        engine.gameSound.playEffect(game_sound.res_sound_gameover);
        this.effectLayer.onShowTextEffect("gameover", cc.p(360, 640));
        this.runAction(cc.sequence(cc.delayTime(1.5), cc.callFunc(function() {
            if (0 == Global.gameModel) {
                var a = new ResultLayer(this.surpassPlayerInfo);
                this.addChild(a, 1001)
            } else this.showGameOverView()
        }.bind(this))))
    },
    startProgress: function() {
        1 == Global.gameModel && (this.ui_layer.timeOutView.setVisible(!0), this.schedule(this.updateTimeOut, 0.01), this.schedule(this.updateProgress, 0.01))
    },
    addSecond: function(a) {
        this.timeCount += a;
        this.timeCount >= Global.TimeOutCount && (this.timeCount = Global.TimeOutCount);
        this.ui_layer.timeOutView.progresssBg.loadingBar.percent += 100 * this.timeRate * a
    },
    showGameOverView: function() {
        var a = new GameOverLayer;
        currentScene.addChild(a)
    },
    handleFail: function() {
        var a = this.ui_layer.getChildByName("parachute");
        null != a && a.removeFromParent();
        this.isAddParachute = !1;
        Global.highScoreChange = Global.currentScore > gamePlayerData.maxScore;
        a = Math.max(gamePlayerData.maxScore, Global.currentScore);
        gamePlayerData.maxScore = a;
        1 == Global.currentLv ? this.showGameFail() : this.showReLifeView()
    },
    checkClickStatus: function() {
        return 0 == gamePlayerData.useBrush || 0 == gamePlayerData.useHammer || 0 == gamePlayerData.useLoop ? !1 : !0
    },
    checkGotoGame: function() {
        this.startGame()
    },
    startGame: function() {
        this.stoneLayer.reLifeStone();
        this.createBeginAnimal()
    },
    refreshView: function() {
        this.startProgress()
    },
    beginGameUpdate: function() {
        this.isNeedUpdate = !0;
        this.startProgress()
    },
    pauseGameUpdate: function() {
        this.isNeedUpdate = !1;
        1 == Global.gameModel && (this.unschedule(this.updateTimeOut), this.unschedule(this.updateProgress))
    },
    showMeteorEffect: function() {
        var a = new cc.Sprite("#uipng/meteor.png");
        this.bg_effect_Layer.addChild(a);
        a.setRotation( - 30);
        var b = 900 + Math.floor(400 * Math.random());
        a.setPosition(800, b);
        b = cc.moveBy(0.5, cc.p( - 900, -900 * Math.tan(30 * 0.017453293)));
        a.runAction(cc.sequence(b, cc.removeSelf()))
    }
}),
getEffect = function(a, b, c) {
    for (var d = new cc.Animation; b <= c; b++) {
        var e = cc.spriteFrameCache.getSpriteFrame("effects/" + a + "_" + b + ".png");
        d.addSpriteFrame(e)
    }
    "pass_effect" == a || "game_over" == a || -1 != Global.STONE_TEXT.indexOf(a) ? d.setDelayPerUnit(0.1) : d.setDelayPerUnit(1 / 24);
    return cc.animate(d)
},
MainScene = GameScene.extend({
    layer: null,
    ctor: function() {
        this._super();
        this.sceneName = "MainScene";
        this.layer = null
    },
    onEnter: function() {
        this._super();
        this.initialize();
        this.initView()
    },
    initialize: function() {
        this._super()
    },
    initView: function() {
        this.layer = new MainLayer;
        this.addChild(this.layer)
    }
});
var RankingScene = GameScene.extend({
    ctor: function() {
        this._super()
    },
    onEnter: function() {
        this._super();
        this.initialize();
        this.initView()
    },
    initialize: function() {
        this._super()
    },
    initView: function() {
        var a = new RankingLayer;
        this.addChild(a)
    }
}),
RankingLayer = cc.Layer.extend({
    mainUI: null,
    index: 1,
    data: null,
    tableView1: null,
    tableView2: null,
    tableView3: null,
    upClipping: null,
    ctor: function() {
        this._super();
        this.initData()
    },
    initData: function() {
        this.mainUI = null;
        this.index = 2;
        this.upClipping = this.tableView3 = this.tableView2 = this.tableView1 = this.data = null
    },
    onEnter: function() {
        this._super();
        this.initUI();
        currentScene.addChild(new BroadCastLayer, 999)
    },
    onExit: function() {
        this._super();
        this.unscheduleAllCallbacks()
    },
    initUI: function() {
        Global.isLookRanking = !0;
        var a = new GameBgLayer;
        this.addChild(a);
        this.mainUI = loadCSS(res.rank_layer, !1);
        a.addChild(this.mainUI, -1);
        a.bg1.setLocalZOrder( - 2);
        a.bg2.setLocalZOrder( - 2);
        var b = new ccui.ImageView(scale_png.scalesprite1, ccui.Widget.PLIST_TEXTURE);
        b.setScale9Enabled(!0);
        b.setContentSize(cc.size(670, 1070));
        b.x = 370;
        b.y = 590;
        this.mainUI.addChild(b, -1);
        b = new ccui.ImageView(scale_png.scalesprite3, ccui.Widget.PLIST_TEXTURE);
        b.setScale9Enabled(!0);
        b.setContentSize(cc.size(582, 786));
        b.x = 370;
        b.y = 600;
        this.mainUI.addChild(b, -1);
        a.showFireWorksEffect();
        this.refreshChooseBtnState();
        a = new cc.DrawNode;
        a.drawRect(cc.p(75, 220), cc.p(680, 985), cc.color(0, 0, 0, 120), 0, cc.color(0, 0, 0, 120));
        this.upClipping = createClippingNode(0.5, 0.5, 0, 0, 1, !1, a);
        this.mainUI.addChild(this.upClipping);
        this.upClipping.isSwallowTouches = !1;
        engine.gameEvent.createMouseDown(this.upClipping, this.clickDownFun.bind(this), null, cc.rect(75, 220, 605, 765));
        engine.gameEvent.createMouseMove(this.upClipping, this.clickMoveFun.bind(this), null, cc.rect(75, 220, 605, 765));
        engine.gameEvent.createMouseUp(this.upClipping, this.clickUpFun.bind(this), null, cc.rect(75, 220, 605, 765));
        engine.gameEvent.createMouseUp(this.mainUI.btnClose, this.onClose.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainUI.btnAdd, this.onAdd.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainUI.select1, this.onSelect.bind(this));
        engine.gameEvent.createMouseUp(this.mainUI.select2, this.onSelect.bind(this));
        engine.gameEvent.createMouseUp(this.mainUI.select3, this.onSelect.bind(this));
        this.onSelect(null, null);
        this.schedule(this.checkGetRankData.bind(this), 0.1);
        gameSDK.getEntriesNearByData(RANK_WORLD) || (this.nearbyRankNeedGet = !0, gameSDK.getEntriesLeaderboardDataByPlayer(RANK_WORLD, 30));
        gameSDK.getEntriesLeaderboardData(RANK_WORLD) || (this.worldRankNeedGet = !0, gameSDK.getEntriesAsync(RANK_WORLD, 50, 0));
        gameSDK.getPlayerEntriesboardLeaderboardData(RANK_WORLD) || (this.friendRankNeedGet = !0, gameSDK.getConnectedPlayerEntriesAsync(RANK_WORLD, 50, 0))
    },
    onClose: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        transitions(HomeScene)
    },
    onAdd: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        gameSDK.sendFaceBookFriend(function(a) {})
    },
    onSelect: function(a, b) {
        if (null != a) {
            var c = b.getCurrentTarget();
            if (c.getTag() == this.index) return;
            this.index = c.getTag();
            this.refreshChooseBtnState()
        }
        c = null;
        switch (this.index) {
        case 1:
            c = gameSDK.getEntriesNearByData(RANK_WORLD);
            break;
        case 2:
            c = gameSDK.getEntriesLeaderboardData(RANK_WORLD);
            break;
        case 3:
            c = gameSDK.getPlayerEntriesboardLeaderboardData(RANK_WORLD)
        }
        null != c && this.createTableView(c);
        this.refreshTableView()
    },
    nearbyRankNeedGet: !1,
    worldRankNeedGet: !1,
    friendRankNeedGet: !1,
    checkGetRankData: function() {
        if (this.nearbyRankNeedGet) {
            var a = gameSDK.getEntriesNearByData(RANK_WORLD);
            a && (this.nearbyRankNeedGet = !1, this.rankDataInitialize(a, 1), cc.log("\u9644\u8fd1\u6392\u884c\u699c\u62c9\u5230\u4e86\u3002"))
        }
        this.worldRankNeedGet && (a = gameSDK.getEntriesLeaderboardData(RANK_WORLD)) && (this.worldRankNeedGet = !1, this.rankDataInitialize(a, 2), cc.log("\u4e16\u754c\u6392\u884c\u699c\u62c9\u5230\u4e86\u3002"));
        this.friendRankNeedGet && (a = gameSDK.getPlayerEntriesboardLeaderboardData(RANK_WORLD)) && (this.friendRankNeedGet = !1, this.rankDataInitialize(a, 3), cc.log("\u597d\u53cb\u6392\u884c\u699c\u62c9\u5230\u4e86\u3002"))
    },
    rankDataInitialize: function(a, b) {
        cc.warn(b, "\u663e\u793a\u6392\u884c\u699c\u6570\u636e:", a);
        switch (b) {
        case 1:
            this.nearbyRankData = a;
            break;
        case 2:
            this.worldRankData = a;
            break;
        case 3:
            this.friendRankData = a
        }
        this.index == b && this.createTableView(a)
    },
    refreshTableView: function() {
        for (var a = 1; 3 >= a; ++a) {
            var b = this["tableView" + a];
            if (null !== b || this.index === a) this.index === a ? null !== b && b.setVisible(!0) : (this["tableView" + a].setVisible(!1), this["tableView" + a].y = 0)
        }
    },
    refreshChooseBtnState: function() {
        for (var a = 1; 3 >= a; ++a) {
            var b = this.mainUI["select" + a];
            a === this.index ? (b.setSpriteFrame("rank/select2.png"), b.text.setSpriteFrame("rank/choose" + a + "_2.png")) : (b.setSpriteFrame("rank/select1.png"), b.text.setSpriteFrame("rank/choose" + a + "_1.png"))
        }
    },
    listLength: 0,
    toggleItemArr: [],
    createTableView: function(a) {
        this["tableView" + this.index] = new cc.Layer;
        var b = this["tableView" + this.index];
        b.x = 90;
        this.upClipping.addChild(b);
        this.toggleItemArr = [];
        this.listLength = a.length;
        for (var c = 0,
        d = 0; d < a.length; d++) if (! (5E5 <= a[d].score)) {
            var e = this.createItem(a[d], c);
            e.y = 930 - 110 * c;
            c++;
            b.addChild(e);
            this.toggleItemArr.push(e)
        }
    },
    clickDownFun: function(a, b) {
        this.isClick = !0;
        this.touchY = a.getLocation().y;
        this.clickDownPoint = b.getCurrentTarget().convertToNodeSpace(a.getLocation())
    },
    clickMoveFun: function(a, b) {
        var c = a.getLocation(),
        d = this.touchY - c.y,
        e = b.getCurrentTarget().convertToNodeSpace(a.getLocation());
        5 <= cc.pDistance(this.clickDownPoint, e) && (this.isClick = !1);
        this["tableView" + this.index] && (d = this["tableView" + this.index].y - d, this.touchY = c.y, this.moveSetX(d))
    },
    moveDistancDiejia: 0,
    moveSetX: function(a) {
        0 > a && (a = 0);
        var b = this.listLength - 7;
        0 > b && (b = 0);
        a > 110 * b + 80 && (a = 110 * b + 80);
        this.moveDistancDiejia += Math.abs(this["tableView" + this.index].y - a);
        this["tableView" + this.index].y = a;
        if (100 < this.moveDistancDiejia) {
            var c = this.moveDistancDiejia = 0;
            this.toggleItemArr.forEach(function(a) {
                var b = a.parent.convertToWorldSpaceAR(a.getPosition());
                a.visible = 780 < b.y && 1700 > b.y;
                a.visible && c++
            })
        }
    },
    clickUpFun: function() {},
    createItem: function(a, b) {
        var c = "#rank/frame1.png";
        gameSDK.sdkPlayInfo.id == a.id ? c = "#rank/frame3.png": 0 === b % 2 && (c = "#rank/frame2.png");
        var d = new cc.Sprite(c);
        d.x = 281.5;
        d.y = 50.5;
        d.title = new cc.Sprite("#title/title" + getGradeByScore(a.score) + ".png");
        d.title.setPosition(40, 50);
        d.title.scale = 0.25;
        d.addChild(d.title);
        d.rank = new cc.LabelTTF("" + (b + 1), defaultTxt, 24);
        c = 77 / d.rank.getContentSize().width;
        d.rank.x = 40;
        d.rank.y = 25;
        d.rank.setScale(1 <= c ? 1 : c);
        d.rank.enableStroke(cc.color(0, 0, 0, 255), 2);
        d.addChild(d.rank);
        d.name = new cc.LabelTTF(a.name, "res/font/font.ttf", 22);
        d.name.setDimensions(cc.size(180, 28));
        d.name.x = 260;
        d.name.y = 50;
        d.name.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER);
        d.name.enableStroke(cc.color(0, 0, 0, 255), 2);
        d.addChild(d.name);
        d.score = new cc.LabelTTF("" + a.score, defaultTxt, 32);
        d.score.x = 466;
        d.score.y = 50;
        d.score.enableStroke(cc.color(0, 0, 0, 255), 2);
        c = 176 / d.score.getContentSize().width;
        d.score.setScale(1 <= c ? 1 : c);
        d.addChild(d.score);
        var c = new LoadSprite,
        e = a.photo;
        c.loadComplete = function(a) {
            a = new cc.Sprite(a);
            a.setScale(74 / a.getContentSize().width);
            a.setPosition(123, 49);
            d.addChild(a, 98)
        };
        c.setPNGUrl(e, 74);
        d.frame = new cc.Sprite("#rank/icon.png");
        d.frame.x = 124;
        d.frame.y = 47;
        d.addChild(d.frame, 99);
        return d
    }
});
var AwardLayer = cc.Layer.extend({
    mainView: null,
    ctor: function() {
        this._super();
        this.mainView = null
    },
    onEnter: function() {
        this._super();
        this.initView()
    },
    initView: function() {
        this.mainView = loadCSS(res.award_layer_json, !1);
        this.addChild(this.mainView);
        var a = this.mainView.success_light;
        a.setOpacity(0);
        a.setScale(0.1);
        a.runAction(cc.rotateBy(5, 360).repeatForever());
        a.runAction(cc.sequence(cc.spawn(cc.fadeIn(0.2), cc.scaleTo(0.2, 3).easing(cc.easeBackOut())), cc.delayTime(0.5), cc.spawn(cc.fadeOut(0.2), cc.scaleTo(0.2, 0.1)), cc.removeSelf()));
        a = this.mainView.diamond_3;
        a.setOpacity(0);
        a.setScale(0.1);
        a.runAction(cc.sequence(cc.spawn(cc.fadeIn(0.2), cc.scaleTo(0.2, 1).easing(cc.easeBackOut())), cc.delayTime(0.5), cc.spawn(cc.fadeOut(0.2), cc.scaleTo(0.2, 0.1)), cc.removeSelf(), cc.callFunc(function() {
            currentScene.layer.moneyAfter();
            this.removeFromParent()
        }.bind(this))));
        engine.gameEvent.createMouseUp(this.mainView.layer_mask, this.clickMask.bind(this))
    },
    clickMask: function() {
        engine.gameSound.playEffect(game_sound.res_sound_onland)
    }
});
var EffectLayer = cc.Layer.extend({
    score_lab_sp: null,
    main_scene: null,
    stone_count_lab: null,
    stone_score: 0,
    text_sp: null,
    lv_container: null,
    lv_img: null,
    target_img: null,
    target_score: null,
    explosion_arr: [],
    ctor: function() {
        this._super();
        this.stone_count_lab = this.score_lab_sp = null;
        this.stone_score = 0;
        this.target_score = this.target_img = this.lv_img = this.lv_container = this.text_sp = null;
        this.explosion_arr = []
    },
    onEnter: function() {
        this._super();
        this.score_lab_sp = creatGameArtWord("fnta");
        this.score_lab_sp.alignmentType = artWordMiddle;
        this.addChild(this.score_lab_sp);
        this.stone_count_lab = creatGameArtWord("fntc");
        this.stone_count_lab.alignmentType = artWordMiddle;
        this.stone_count_lab.setVisible(!1);
        this.addChild(this.stone_count_lab);
        this.text_sp = new cc.Sprite("#uipng/good.png");
        this.addChild(this.text_sp);
        this.text_sp.setPosition(cc.p(360, 900));
        this.text_sp.setVisible(!1);
        this.lv_container = new cc.Sprite("#uipng/main_level.png");
        this.addChild(this.lv_container);
        this.lv_container.setVisible(!1);
        this.lv_img = creatGameArtWord("fntlevel");
        this.addChild(this.lv_img);
        this.lv_img.setVisible(!1);
        this.target_img = new cc.Sprite("#uipng/main_score.png");
        this.addChild(this.target_img);
        this.target_img.setVisible(!1);
        this.target_score = creatGameArtWord("fntscore", 33);
        this.addChild(this.target_score);
        this.target_score.setVisible(!1);
        this.initExpEffect()
    },
    initExpEffect: function() {
        for (var a = 0; a < ROW; a++) {
            this.explosion_arr[a] = [];
            for (var b = 0; b < COL; b++) {
                var c = new cc.Sprite;
                this.addChild(c);
                this.explosion_arr[a].push(c)
            }
        }
    },
    onShowEffect: function(a, b, c, d, e, f) {
        var g = new cc.Sprite("#effects/" + a + "_0.png");
        this.addChild(g);
        g.setScale(e);
        g.setPosition(d);
        a = getEffect(a, b, c).repeat(f);
        g.runAction(cc.sequence(a, cc.removeSelf()))
    },
    onShowGetScore: function(a, b) {
        var c;
        150 >= b.x && (b.x = 200);
        650 <= b.x && (b.x = 600);
        c = creatGameArtWord("fnta", 40);
        c.alignmentType = artWordMiddle;
        c.setScale(0.1);
        this.addChild(c);
        c.setPosition(b);
        c.setString(a.toString());
        c.setCascadeOpacityEnabled(!0);
        c.contentSprite.setCascadeOpacityEnabled(!0);
        var d = cc.scaleTo(0.3, 1.3).easing(cc.easeBackOut()),
        e = cc.moveBy(1, cc.p(0, 200)).easing(cc.easeExponentialOut()),
        f = cc.fadeOut(0.5),
        d = cc.spawn(d, e);
        c.runAction(cc.sequence(d, f, cc.removeSelf()))
    },
    onShowGameWinClear: function(a) {
        0 >= this.stone_score || this.showCleanSamScore(a, !0)
    },
    showCleanSamScore: function(a, b) {
        if (0 == Global.gameModel) {
            this.stone_score = b ? this.stone_score - a: a;
            this.score_lab_sp.setVisible(!0);
            this.score_lab_sp.setOpacity(255);
            this.score_lab_sp.setPosition(400, 640);
            this.score_lab_sp.setString(this.stone_score.toString());
            this.score_lab_sp.setCascadeOpacityEnabled(!0);
            this.score_lab_sp.contentSprite.setCascadeOpacityEnabled(!0);
            this.score_lab_sp.stopAllActions();
            this.score_lab_sp.setScale(1);
            var c = cc.scaleTo(0.1, 1.5).easing(cc.easeBackInOut()),
            d = cc.scaleTo(0.1, 1);
            this.score_lab_sp.runAction(cc.sequence(c, d));
            0 >= this.stone_score && this.score_lab_sp.runAction(cc.sequence(cc.delayTime(0.2), cc.fadeOut(1), cc.callFunc(function() {
                this.score_lab_sp.setVisible(!1)
            }.bind(this))))
        } else this.score_lab_sp.setVisible(!1)
    },
    onShowFlyScore: function(a, b, c, d) {
        var e = new creatGameArtWord(d == Global.STONE_TYPE.STONE_ICE ? "fntice": "fntb");
        e.alignmentType = artWordMiddle;
        this.addChild(e);
        var f = "";
        d == Global.STONE_TYPE.STONE_ICE && (f = "a");
        e.setString(f + a.toString());
        e.setPosition(getScoreXY(b, c));
        e.setCascadeOpacityEnabled(!0);
        e.contentSprite.setCascadeOpacityEnabled(!0);
        e.setOpacity(0);
        b = cc.callFunc(function() {
            Global.currentScore += a;
            currentScene.layer.showAddScoreEffect()
        }.bind(this));
        e.runAction(cc.sequence(cc.fadeIn(0.5), cc.moveTo(0.5, Global.TargetPos).easing(cc.easeExponentialIn()), cc.removeSelf(), b));
        e.runAction(cc.sequence(cc.delayTime(1.5), cc.scaleTo(0.2, 0.1)))
    },
    onShowTextEffect: function(a, b) {
        var c = cc.spriteFrameCache.getSpriteFrame("uipng/" + a + ".png");
        b ? this.text_sp.setPosition(b) : this.text_sp.setPosition(360, 900);
        this.text_sp.setSpriteFrame(c);
        this.text_sp.setScale(3);
        this.text_sp.setOpacity(255);
        this.text_sp.setVisible(!0);
        c = cc.sequence(cc.scaleTo(0.2, 1).easing(cc.easeBackOut()), cc.delayTime(0.2), cc.blink(0.5, 5), cc.spawn(cc.fadeOut(0.5), cc.callFunc(function() {
            engine.gameSound.playEffect(game_sound.res_sound_applause_2)
        }.bind(this))), cc.callFunc(function() {
            this.text_sp.setVisible(!1)
        }.bind(this)));
        this.text_sp.runAction(c)
    },
    showStoneCount: function(a, b, c) {
        0 == a ? this.stone_count_lab.setVisible(!1) : (this.stone_count_lab.setVisible(!0), this.stone_count_lab.setString(a.toString()), this.stone_count_lab.setPosition(getStontCount(b, c)), a = cc.moveBy(0.1, cc.p(0, 20)).easing(cc.easeBackIn()), b = a.reverse(), this.stone_count_lab.runAction(cc.sequence(a, b)))
    },
    showExplosion: function(a) {
        if (!1 == a.isClean) this.onShowFlyScore(a.rate, a.x, a.y, a.type);
        else if (Global.gameStatus == GAME_SUCCESS) {
            var b = new cc.Sprite("#uipng/" + getStarEffectName(a.type) + ".png");
            this.addChild(b);
            b.setPosition(getScoreXY(a.x, a.y));
            var c = 800 + 300 * Math.random(),
            c = cc.p(b.x, c);
            b.runAction(cc.sequence(cc.moveTo(0.8, c).easing(cc.easeSineOut()), cc.removeSelf()))
        }
        var c = getStoneEffectXY(a.x, a.y),
        d = cc.spriteFrameCache.getSpriteFrame("effects/" + Global.STONE_EXPLOSION[a.type] + "_0.png"),
        b = this.explosion_arr[a.y][a.x];
        b.setVisible(!0);
        b.setSpriteFrame(d);
        b.setPosition(c);
        a.type == Global.STONE_TYPE.STONE_COLOR ? b.setScale(1.2) : b.setScale(1.5);
        c = getEffect(Global.STONE_EXPLOSION[a.type], 0, 9);
        "blue_exp" != Global.STONE_EXPLOSION[a.type] && "colorless_exp" != Global.STONE_EXPLOSION[a.type] && "green_exp" != Global.STONE_EXPLOSION[a.type] && "color_exp" != Global.STONE_EXPLOSION[a.type] && "firework_exp" != Global.STONE_EXPLOSION[a.type] && "firework_exp" != Global.STONE_EXPLOSION[a.type] && "purple_exp" != Global.STONE_EXPLOSION[a.type] && "text_effect" != Global.STONE_EXPLOSION[a.type] && "yellow_exp" != Global.STONE_EXPLOSION[a.type] && "red_exp" != Global.STONE_EXPLOSION[a.type] || b.setScale(2);
        engine.gameSound.playEffect(Global.gameStatus == GAME_SUCCESS || Global.gameStatus == GAME_FAIL || a.type == Global.STONE_TYPE.STONE_COLOR ? game_sound.res_sound_exp_color: a.type == Global.STONE_TYPE.STONE_ICE ? game_sound.res_sound_exp_ice: a.type >= Global.STONE_TYPE.STONE_LESS ? game_sound.res_sound_exp_less: Stone_Explosion_Sound[a.exp_index]);
        b.runAction(cc.sequence(c, cc.callFunc(function() {
            this.setVisible(!1)
        }.bind(b))))
    },
    showLastScoreEffect: function() {
        currentScene.layer.ui_layer.aw_fnta_scorelab.setVisible(!1);
        for (var a = Global.currentScore,
        b = a.toString().length, c = 0.5 * (cc.winSize.width - 54 * b), d = currentScene.layer.ui_layer.aw_fnta_scorelab.getPositionY(), e = [], f = 0; f < b; f++) {
            var g = a.toString().charAt(f),
            g = new cc.Sprite("#fnt/fnta_" + g + ".png");
            this.addChild(g);
            g.setPosition(c + 54 * (f + 0.5), d);
            g.setScale(2.5);
            g.setOpacity(0);
            g.runAction(cc.sequence(cc.delayTime(0.2 * f), cc.spawn(cc.scaleTo(0.5, 1).easing(cc.easeBackInOut()), cc.fadeIn(0.3))));
            e.push(g)
        }
        this.runAction(cc.sequence(cc.delayTime(0.2 * f + 1), cc.callFunc(function() {
            for (; e.length;) e.shift().removeFromParent();
            currentScene.layer.ui_layer.aw_fnta_scorelab.setVisible(!0);
            currentScene.layer.stoneLayer.explosionAfter()
        }.bind(this))))
    },
    showHammerEffect: function(a) {
        if (!Global.isUseHammer && null != a) {
            Global.isUseHammer = !0;
            if (0 < gamePlayerData.hammerNum) gamePlayerData.hammerNum -= 1;
            else {
                var b = 0 == Global.gameModel ? gamePlayerData.hammer_value * gamePlayerData.hammerCount: gamePlayerData.hammer_value * gamePlayerData.timeHammerCount;
                if (gamePlayerData.diamondValue <= b) {
                    Global.isUseHammer = !1;
                    return
                }
                gamePlayerData.diamondValue -= b;
                0 == Global.gameModel ? gamePlayerData.hammerCount++:gamePlayerData.timeHammerCount++
            }
            Global.dataEyeOb.item1++;
            b = new cc.Sprite("#uipng/main_hammerbtn.png");
            this.addChild(b);
            b.setAnchorPoint(1, 0);
            b.setRotation(45);
            b.setPosition(a.getPositionX() + WIDTH_CELL, a.getPositionY());
            var c = cc.rotateBy(0.2, -30),
            d = cc.rotateBy(0.2, 90),
            e = cc.rotateTo(0.3, -45).easing(cc.easeBounceOut());
            b.runAction(cc.sequence(c, d, e, cc.callFunc(function(a) {
                gamePlayerData.useHammer = 0;
                engine.gameSound.playEffect(game_sound.res_sound_hammer_do);
                var b = a.stoneType == Global.STONE_TYPE.STONE_ICE ? 100 : 0;
                1 == Global.gameModel && (b = Math.floor(b * Global.TIMEOUT_RATE));
                currentScene.layer.stoneLayer.updateExplosionStone([a], 0, b, getStoneEffectXY(a.gridX, a.gridY));
                currentScene.layer.changeBtnStatus();
                Global.isUseHammer = !1
            }.bind(this, a)), cc.fadeOut(0.5), cc.removeSelf()))
        }
    },
    showBrushEffect: function(a, b) {
        if (0 < gamePlayerData.brushNum) gamePlayerData.brushNum -= 1;
        else {
            var c = 0 == Global.gameModel ? gamePlayerData.brush_value * gamePlayerData.brushCount: gamePlayerData.brush_value * gamePlayerData.timeBrushCount;
            if (gamePlayerData.diamondValue <= c) return;
            gamePlayerData.diamondValue -= c;
            0 == Global.gameModel ? gamePlayerData.brushCount++:gamePlayerData.timeBrushCount++
        }
        Global.dataEyeOb.item2++;
        Global.isCanClick = !1;
        engine.gameSound.playEffect(game_sound.res_sound_brush_sound);
        this.onShowEffect("brush_effect", 0, 14, getStoneXY(a, b), 2, 1);
        this.runAction(cc.sequence(cc.delayTime(0.5), cc.callFunc(function() {
            gamePlayerData.useBrush = 0;
            currentScene.layer.changeBtnStatus();
            currentScene.layer.stoneLayer.changeStoneType();
            currentScene.layer.stoneLayer.checkStoneCanClean();
            Global.isCanClick = !0
        }.bind(this))))
    },
    showStartEffect: function() {
        this.lv_container.setPosition(850, 700);
        this.lv_container.setVisible(!0);
        this.lv_img.setPosition(this.lv_container.x + 0.5 * this.lv_container.width + 20, this.lv_container.y);
        this.lv_img.setVisible(!0);
        this.lv_img.setString(Global.currentLv.toString());
        var a = cc.delayTime(1);
        this.lv_container.runAction(cc.sequence(a, cc.moveBy(0.5, cc.p( - 520, 0)).easing(cc.easeBackOut()), a.clone(), cc.blink(1, 5), cc.callFunc(function() {
            this.lv_container.setVisible(!1)
        }.bind(this))));
        this.lv_img.runAction(cc.sequence(a.clone(), cc.moveBy(0.5, cc.p( - 520, 0)).easing(cc.easeBackOut()), a.clone(), cc.blink(1, 5), cc.callFunc(function() {
            this.lv_img.setVisible(!1)
        }.bind(this))));
        this.target_img.setPosition( - 300, 600);
        this.target_img.setVisible(!0);
        this.target_score.setPosition(this.target_img.x + 0.5 * this.target_img.width + 20, this.target_img.y);
        this.target_score.setString(Global.targetScore.toString());
        this.target_score.setVisible(!0);
        this.target_img.runAction(cc.sequence(a.clone(), cc.moveBy(0.5, cc.p(580, 0)).easing(cc.easeBackOut()), a.clone(), cc.blink(1, 5), cc.callFunc(function() {
            this.target_img.setVisible(!1)
        }.bind(this))));
        this.target_score.runAction(cc.sequence(a.clone(), cc.moveBy(0.5, cc.p(580, 0)).easing(cc.easeBackOut()), a.clone(), cc.blink(1, 5), cc.callFunc(function() {
            this.target_score.setVisible(!1)
        }.bind(this))))
    }
}),
getStarEffectName = function(a) {
    if (a == Global.STONE_TYPE.STONE_ICE || a == Global.STONE_TYPE.STONE_COLOR || a == Global.STONE_TYPE.STONE_LESS) return "other_star";
    var b = a;
    a >= Global.StoneTypeTwo && (b = a - Global.StoneTypeTwo);
    switch (b) {
    case 0:
        return "red_star";
    case 1:
        return "yellow_star";
    case 2:
        return "blue_star";
    case 3:
        return "green_star";
    case 4:
        return "purple_star"
    }
};
var GameBgLayer = cc.Layer.extend({
    star_arr: [],
    fire_work_arr: [],
    fire_work_exp_arr: [],
    bg1: null,
    bg2: null,
    ctor: function() {
        this._super();
        this.star_arr = [];
        this.fire_work_arr = [];
        this.fire_work_exp_arr = [];
        this.bg2 = this.bg1 = null
    },
    onEnter: function() {
        this._super();
        var a = new cc.Sprite("res/uipng/main_bg1.png");
        this.addChild(a);
        a.setAnchorPoint(cc.p(0.5, 0));
        a.setPosition(360, 639);
        this.bg1 = a;
        a = new cc.Sprite("res/uipng/main_bg2.png");
        this.addChild(a);
        a.setAnchorPoint(cc.p(0.5, 1));
        a.setPosition(360, 640);
        this.bg2 = a;
        for (a = 0; 6 > a; a++) {
            var b = new cc.Sprite("#effects/star_effect_0.png");
            this.addChild(b, -1);
            b.setVisible(!1);
            this.star_arr.push(b)
        }
        for (a = 0; 7 > a; a++) b = new cc.Sprite("#effects/firework_move_0.png"),
        this.addChild(b),
        b.setVisible(!1),
        this.fire_work_arr.push(b),
        b = new cc.Sprite("#effects/firework_exp_0.png"),
        this.addChild(b),
        b.setVisible(!1),
        this.fire_work_exp_arr.push(b);
        this.initView()
    },
    initView: function() {
        this.showStarEffect()
    },
    fireWorksEffect: function(a) {
        a = 0;
        for (var b = 0.5 * Math.random(), c = 3 + Math.floor(4 * Math.random()), d = 0; d < c; d++) null != this && (this.runAction(cc.sequence(cc.delayTime(a), cc.callFunc(function() {
            this.createTextFireWorks()
        }.bind(this)))), a += b)
    },
    createTextFireWorks: function() {
        var a = 100 + 420 * Math.random(),
        b = 900 + 200 * Math.random(),
        c = new cc.Sprite("#effects/firework_move_0.png");
        this.addChild(c);
        var d = Math.random();
        c.setScale(0.5 + d);
        c.setPosition(a, 130);
        var e = getEffect("firework_move", 0, 8).repeatForever();
        c.runAction(e);
        c.runAction(cc.sequence(cc.moveTo(1, cc.p(a, b)).easing(cc.easeSineOut()), cc.removeSelf(), cc.callFunc(function(c) {
            var d = new cc.Sprite("#effects/firework_exp_0.png");
            this.addChild(d);
            d.setScale(1.3 + c);
            d.setPosition(a, b);
            var e = getEffect("firework_exp", 0, 7);
            0.3 >= c ? engine.gameSound.playEffect(game_sound.res_sound_fireworks_01) : 0.6 >= c ? engine.gameSound.playEffect(game_sound.res_sound_fireworks_02) : engine.gameSound.playEffect(game_sound.res_sound_fireworks_03);
            d.runAction(cc.sequence(e, cc.removeSelf()))
        }.bind(this, d))))
    },
    showFireWorksEffect: function() {
        for (var a = 0,
        b = 0.5 * Math.random(), c = 3 + Math.floor(4 * Math.random()), d = 0; d < c; d++) this.runAction(cc.sequence(cc.delayTime(a), cc.callFunc(function(a) {
            this.createFireWoksEffect(a)
        }.bind(this, d)))),
        a += b;
        b = 1 + Math.random();
        this.runAction(cc.sequence(cc.delayTime(a + b), cc.callFunc(function() {
            this.showFireWorksEffect()
        }.bind(this))))
    },
    createFireWoksEffect: function(a) {
        var b = 100 + 420 * Math.random(),
        c = 900 + 200 * Math.random(),
        d = this.fire_work_arr[a];
        d.setVisible(!0);
        var e = Math.random();
        d.setScale(0.5 + e);
        d.setPosition(b, 130);
        var f = getEffect("firework_move", 0, 8).repeatForever();
        d.runAction(f);
        d.runAction(cc.sequence(cc.moveTo(1, cc.p(b, c)).easing(cc.easeSineOut()), cc.callFunc(function() {
            this.setVisible(!1)
        }.bind(d)), cc.callFunc(function(d) {
            var e = this.fire_work_exp_arr[a];
            e.setVisible(!0);
            e.setScale(1.3 + d);
            e.setPosition(b, c);
            var f = getEffect("firework_exp", 0, 7);
            0.3 >= d ? engine.gameSound.playEffect(game_sound.res_sound_fireworks_01) : 0.6 >= d ? engine.gameSound.playEffect(game_sound.res_sound_fireworks_02) : engine.gameSound.playEffect(game_sound.res_sound_fireworks_03);
            e.runAction(cc.sequence(f, cc.callFunc(function() {
                this.setVisible(!1)
            }.bind(e))))
        }.bind(this, e))))
    },
    showStarEffect: function() {
        for (var a = 2 + Math.floor(4 * Math.random()), b = 0, c = 0; c < a; c++) b = Math.random(),
        this.runAction(cc.sequence(cc.delayTime(b), cc.callFunc(function(a) {
            this.createStar(a)
        }.bind(this, c))));
        a = 1 + Math.random();
        this.runAction(cc.sequence(cc.delayTime(b + a), cc.callFunc(function() {
            this.showStarEffect()
        }.bind(this))))
    },
    createStar: function(a) {
        var b = 150 + 500 * Math.random(),
        c = 880 + 320 * Math.random(),
        d = 1 + 0.5 * Math.random();
        a = this.star_arr[a];
        a.setVisible(!0);
        a.setScale(d);
        a.setPosition(b, c);
        b = getEffect("star_effect", 0, 12);
        a.runAction(cc.sequence(b, cc.callFunc(function() {
            this.setVisible(!1)
        }.bind(a))))
    }
});
var GameOverLayer = cc.Layer.extend({
    mainView: null,
    ctor: function() {
        this._super();
        this.mainView = null
    },
    onEnter: function() {
        this._super();
        this.initView()
    },
    onExit: function() {
        this._super();
        this.unscheduleAllCallbacks()
    },
    initView: function() {
        this.mainView = loadCSS(res.gameover_layer_json, !1);
        this.addChild(this.mainView);
        this.mainView.aw_fnttype8_rankText.setString("");
        this.mainView.aw_fnttype8_scoreText.setString(Global.currentScore.toString());
        this.mainView.aw_fnttype8_bestScore.setString(gamePlayerData.maxScore.toString());
        this.mainView.aw_fnttype8_perText.setString(gamePlayerData.percentPage + "%");
        engine.gameEvent.createMouseUp(this.mainView.btnHome, this.clickMenuBtn.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainView.btnAdd, this.onChallenge.bind(this), buttonScalingType);
        gameSDK.setPlayerEntriesboardLeaderboardData(RANK_WORLD, null);
        gameSDK.getConnectedPlayerEntriesAsync(RANK_WORLD, 100, 0);
        this.schedule(this.checkGetRankData.bind(this), 0.1)
    },
    checkGetRankData: function() {
        var a = gameSDK.getPlayerEntriesboardLeaderboardData(RANK_WORLD);
        if (a) {
            this.unscheduleAllCallbacks();
            for (var b = 100,
            c = 0; c < a.length; c++) if (a[c].id == gameSDK.sdkPlayInfo.id) {
                b = a[c].rank;
                break
            }
            this.refreshTextInfo(b);
            cc.log("\u9644\u8fd1\u6392\u884c\u699c\u62c9\u5230\u4e86\u3002")
        }
    },
    refreshTextInfo: function(a) {
        this.mainView.aw_fnttype8_rankText.setString(a + "")
    },
    onChallenge: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        gameSDK.sendFaceBookFriend(function(a) {})
    },
    clickMenuBtn: function() {
        this.handleClick();
        transitions(HomeScene)
    },
    clickReplayBtn: function() {
        this.handleClick();
        this.removeFromParent();
        currentScene.layer.reLifeGame()
    },
    handleClick: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        engine.gameSound.playEffect(game_sound.res_sound_closeview);
        gamePlayerData.timePage = 1;
        gamePlayerData.timeOutScore = gamePlayerData.timeBaseScore = 0;
        resetPlayerData(!0)
    }
});
var PauseLayer = cc.Layer.extend({
    mainView: null,
    ctor: function() {
        this._super();
        this.mainView = null
    },
    onEnter: function() {
        this._super();
        this.main_scene = this.getParent();
        this.initView()
    },
    initView: function() {
        this.mainView = loadCSS(res.pause_layer_json, !1);
        this.addChild(this.mainView);
        this.mainView.btnsound_sound.setUIState();
        engine.gameEvent.createMouseUp(this.mainView.close_btn, this.clickCloseBtn.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainView.home_btn, this.clickBackHome.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainView.dblclick, this.clickGiveup.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainView.help_btn, this.clickHelpBtn.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainView.layer_mask, this.clickMask.bind(this));
        this.changeModel()
    },
    clickHelpBtn: function() {
        var a = new HelpLayer;
        currentScene.addChild(a)
    },
    changeModel: function() {
        var a = cc.spriteFrameCache.getSpriteFrame("uipng/" + (0 == gamePlayerData.clickModel ? "dlick": "dblclick") + ".png");
        this.mainView.dblclick.setSpriteFrame(a)
    },
    clickMask: function() {
        engine.gameSound.playEffect(game_sound.res_sound_onland)
    },
    clickCloseBtn: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        engine.gameSound.playEffect(game_sound.res_sound_closeview);
        currentScene.layer.beginGameUpdate();
        this.removeFromParent()
    },
    clickBackHome: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        engine.gameSound.playEffect(game_sound.res_sound_closeview);
        currentScene.layer.saveGameData();
        transitions(HomeScene)
    },
    clickGiveup: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        1 == gamePlayerData.clickModel ? gamePlayerData.clickModel = 0 : (gamePlayerData.clickModel = 1, currentScene.layer.stoneLayer.clearSelectedStone(), currentScene.layer.effectLayer.stone_count_lab.setVisible(!1), currentScene.layer.ui_layer.score_info.setVisible(!1));
        this.changeModel();
        saveUserData()
    }
});
var PromptLayer = cc.Layer.extend({
    mainView: null,
    ctor: function() {
        this._super();
        this.mainView = null
    },
    onEnter: function() {
        this._super();
        this.initView()
    },
    initView: function() {
        this.mainView = loadCSS(res.prompt_layer_json, !1);
        this.addChild(this.mainView);
        this.mainView.prompt_lab.setString(Global.PROMPT);
        engine.gameEvent.createMouseUp(this.mainView.yes_btn, this.clickYesBtn.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainView.no_btn, this.clickCancelBtn.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainView.layer_mask, this.clickMaskLayer.bind(this))
    },
    clickYesBtn: function() {
        engine.gameSound.playEffect(game_sound.res_sound_closeview);
        var a = Math.max(gamePlayerData.maxScore, Global.currentScore);
        gamePlayerData.maxScore = a;
        gamePlayerData.currentScore = gamePlayerData.baseScore = Global.currentScore = 0;
        gamePlayerData.currentPage = Global.currentLv = 1;
        gamePlayerData.myGameDate = [];
        resetPlayerData(!0);
        transitions(MainScene)
    },
    clickCancelBtn: function() {
        engine.gameSound.playEffect(game_sound.res_sound_closeview);
        this.removeFromParent();
        transitions(MainScene)
    },
    clickMaskLayer: function() {
        engine.gameSound.playEffect(game_sound.res_sound_landing)
    }
});
var RelifeLayer = cc.Layer.extend({
    mainView: null,
    scoreGap: null,
    ctor: function() {
        this._super();
        this.mainView = null;
        this.scoreGap = 0
    },
    onEnter: function() {
        this._super();
        this.initView()
    },
    initView: function() {
        this.mainView = loadCSS(res.relife_layer_json, !1);
        this.addChild(this.mainView);
        showByFromDownToTop(this.mainView);
        this.mainView.aw_fntf_text1.txtWidth = 20;
        var a = this.mainView.light,
        b = cc.rotateBy(5, 360);
        a.runAction(b.repeatForever());
        var a = this.mainView.star_10,
        b = cc.moveBy(2, cc.p(0, 28)),
        c = b.reverse(),
        b = cc.sequence(b, c).repeatForever();
        a.runAction(b);
        this.mainView.halo_7.runAction(b.clone());
        var d = this.mainView.wing_left_8;
        d.runAction(b.clone());
        a = cc.rotateBy(0.2, -60);
        c = a.reverse();
        d.runAction(cc.sequence(cc.sequence(a, c).repeat(3), cc.delayTime(3)).repeatForever());
        d = this.mainView.wing_right_9;
        a = cc.rotateBy(0.2, 60);
        c = a.reverse();
        d.runAction(b.clone());
        d.runAction(cc.sequence(cc.sequence(a, c).repeat(3), cc.delayTime(3)).repeatForever());
        engine.gameEvent.createMouseUp(this.mainView.close_btn, this.clickCloseBtn.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainView.btnFree, this.onFree.bind(this), buttonScalingType);
        engine.gameSound.playEffect(game_sound.res_sound_relife, !1);
        this.scoreGap = Global.targetScore - Global.currentScore;
        1 != gamePlayerData.relifeTimes ? (this.mainView.send_img_5.setVisible(!1), this.mainView.aw_fntf_text1.setVisible(!1)) : (this.mainView.send_img_6.setVisible(!1), this.mainView.aw_fntf_text1.setString("" + this.scoreGap))
    },
    onFree: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        var a = this,
        b = function() {
            0 == Global.gameModel ? (1 == gamePlayerData.relifeTimes ? (gamePlayerData.currentPage += 1, gamePlayerData.currentScore = Global.targetScore, Global.dataEyeOb.passscorre = 1) : gamePlayerData.currentScore = gamePlayerData.baseScore, gamePlayerData.myGameDate = []) : gamePlayerData.timeOutScore = gamePlayerData.timeBaseScore;
            1 == gamePlayerData.relifeTimes && (gamePlayerData.relifeWatchNum -= 1);
            gamePlayerData.relifeTimes += 1;
            saveUserData();
            showByFromTopToDown(a.mainView,
            function() {
                a.removeFromParent();
                currentScene.layer.reLifeGame()
            })
        };
        1 == gamePlayerData.relifeTimes ? gameSDK.showRewardVideoAd(rewardedVideoID4, b) : gameSDK.showRewardVideoAd(rewardedVideoID3, b)
    },
    clickMaskLayer: function() {
        engine.gameSound.playEffect(game_sound.res_sound_landing)
    },
    clickCloseBtn: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        engine.gameSound.playEffect(game_sound.res_sound_closeview);
        var a = this;
        showByFromTopToDown(a.mainView,
        function() {
            a.removeFromParent();
            currentScene.layer.showGameFail()
        })
    },
    clickContinueBtn: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        gamePlayerData.diamondValue >= this.need_money && (0 == Global.gameModel ? gamePlayerData.relifevalueCount++:gamePlayerData.timeRelifeCount++, engine.gameSound.playEffect(game_sound.res_sound_closeview), gamePlayerData.diamondValue -= this.need_money, 0 == Global.gameModel ? (gamePlayerData.currentScore = gamePlayerData.baseScore, gamePlayerData.myGameDate = []) : gamePlayerData.timeOutScore = gamePlayerData.timeBaseScore, this.removeFromParent(), currentScene.layer.reLifeGame())
    },
    handleSale: function(a) {
        a = gamePlayerData.diamondValue / a;
        var b = 0;
        1 <= a ? b = 1 : 1 > a && 0.9 <= a ? b = 0.8 : 0.9 > a && 0.8 <= a ? b = 0.7 : 0.8 > a && 0.7 <= a ? b = 0.6 : 0.7 > a && (b = 0.5);
        return b
    }
}),
getReLifeMoney = function() {
    var a = 0;
    return a = 0 == Global.gameModel ? gamePlayerData.relifeBase + gamePlayerData.relifevalue * gamePlayerData.relifevalueCount: gamePlayerData.relifeBase + gamePlayerData.relifevalue * gamePlayerData.timeRelifeCount
};
var StoneLayer = cc.Layer.extend({
    stoneTileMap: null,
    createStoneCount: 0,
    randomStoneArr: [],
    cleanStoneArr: [],
    moveStoneArr: [],
    selectedType: 0,
    selectedCol: 0,
    selectedRow: 0,
    currentPassData: null,
    selectedStoneNum: 0,
    level_random_arr: [],
    random_count: 0,
    ctor: function() {
        this._super();
        this.currentPassData = this.stoneTileMap = null;
        this.initData()
    },
    onEnter: function() {
        this._super();
        this.stoneTileMap = new TileMap;
        this.stoneTileMap.initialize({
            gridWidth: WIDTH_CELL,
            gridHeight: HEIGHT_CELL,
            gridMaxX: COL,
            gridMaxY: ROW
        })
    },
    initData: function() {
        this.cleanStoneArr = [];
        this.randomStoneArr = [];
        this.moveStoneArr = [];
        this.level_random_arr = [];
        this.selectedType = this.selectedCol = this.selectedRow = this.createStoneCount = this.selectedStoneNum = this.random_count = 0;
        Global.isPlayEffect = !1;
        Global.gameStatus = GAME_NORMAL;
        Global.currentLv = 0 == Global.gameModel ? gamePlayerData.currentPage: gamePlayerData.timePage;
        debugtest.lockLevel && (Global.currentLv = debugtest.lockLevel);
        Global.currentScore = 0 == Global.gameModel ? gamePlayerData.currentScore: gamePlayerData.timeOutScore;
        var a = Global.GameLevelConfig,
        b = 0;
        Global.currentLv > Global.GameTargetFixedLv ? (this.currentPassData = a[Global.GameTargetFixedLv - 1], b = 0 == Global.gameModel ? this.currentPassData.target: this.currentPassData.timeTarget, Global.targetScore = b + Global.GameFixedRate * (Global.currentLv - Global.GameTargetFixedLv)) : (this.currentPassData = a[Global.currentLv - 1], b = 0 == Global.gameModel ? this.currentPassData.target: this.currentPassData.timeTarget, Global.targetScore = b);
        this.handleMustStonePos();
        this.createStoneDataType()
    },
    createStoneDataType: function() {
        for (var a = 0; a < ROW; a++) {
            this.randomStoneArr[a] = [];
            for (var b = 0; b < COL; b++) {
                var c = new Stone(this.randomStoneType(b, a));
                this.addChild(c, 0);
                c.setVisible(!1);
                this.randomStoneArr[a].push(c);
                var d = new cc.Sprite("#effects/selected_effect_0.png");
                this.addChild(d, 1);
                d.setVisible(!1);
                var e = new cc.Sprite;
                this.addChild(e, 2);
                e.setVisible(!1);
                c.selectedSp = d;
                c.effectSp = e
            }
        }
    },
    resetRandomStoneType: function() {
        this.random_count++;
        for (var a = 0; a < ROW; a++) for (var b = 0; b < COL; b++) this.randomStoneArr[a][b].setStoneData(this.randomStoneType(b, a))
    },
    randomStoneType: function(a, b) {
        var c = 0,
        d = !1,
        e = Math.floor(5 * Math.random());
        if (0 < this.level_random_arr.length) for (var f = this.level_random_arr.length,
        g = 0; g < f; g++) {
            var h = this.level_random_arr[g];
            if (h.x == a && h.y == b) {
                d = !0;
                c = h.type;
                break
            }
        } else 2 <= b && (1 == Global.currentLv ? (f = this.currentPassData.rateStoneType[0], g = 0.1, !1 == this.checkHasStone(f) && Math.random() <= g && (d = !0, c = f)) : (f = this.currentPassData.rateStoneType.length, g = Math.floor(Math.random() * f), f = this.currentPassData.rateStoneType[g], g = Global.StoneRandomBaseRate[g] + Global.currentLv * Global.StoneRandomFireRate, Math.random() <= g && (d = !0, c = f))); ! 0 != d && (c = e);
        return c
    },
    startCreateStones: function() {
        Global.isCanClick = !1;
        this.createStoneCount = 0;
        0 == Global.gameModel && 1 == gamePlayerData.hasGameData && gamePlayerData.myGameDate.length ? this.createGameDataStone() : this.createRandomStone()
    },
    createRandomStone: function() {
        for (var a = 0; a < ROW; a++) for (var b = 0; b < COL; b++) this.createStone(b, a, this.getRateAndMustType(b, a));
        this.createStoneCount >= RANDOM_LENGTH && this.updateRandomStone()
    },
    createGameDataStone: function() {
        for (var a = 0; a < ROW; a++) for (var b = 0; b < COL; b++) {
            var c = gamePlayerData.myGameDate[a][b];
            null != c ? this.createStone(c.col, c.row, c.type) : (this.randomStoneArr[a][b].cleanStone(), this.randomStoneArr[a][b] = null)
        }
        this.updateRandomStone()
    },
    updateRandomStone: function() {
        for (var a = 0,
        b, c, d = 0; d < ROW; d++) for (var e = 0; e < COL; e++) if (a = this.randomStoneArr[d].length, a *= Math.random(), a = this.randomStoneArr[d].splice(a, 1)[0]) b = cc.delayTime(0.2 * Math.random() + 0.1 * d),
        c = cc.moveTo(0.5, getStoneXY(a.gridX, a.gridY)).easing(cc.easeSineIn()),
        c = cc.spawn(c, cc.scaleTo(0.3, 1), cc.fadeTo(0.5, 255)),
        a.runAction(cc.sequence(b, c, cc.callFunc(function(a) {
            engine.gameSound.playEffect(game_sound.res_sound_onland);
            a.createSpecialEffect();
            this.createStoneCount--;
            0 >= this.createStoneCount && (Global.isCanClick = !0, this.checkStoneCanClean(), currentScene.layer.beginGameUpdate(), currentScene.layer.resetDelayTime())
        }.bind(this, a))))
    },
    checkHasStone: function(a) {
        for (var b = 0,
        c = 0; c < ROW; c++) for (var d = 0; d < COL; d++) if (! (c > this.randomStoneArr.length - 1 || d > this.randomStoneArr[c].length - 1)) {
            var e = this.randomStoneArr[c][d];
            if (e && e.stoneType == a) if (b++, 1 == Global.currentLv) {
                if (1 <= b) return ! 0
            } else if (2 <= b) return ! 0
        }
        return ! 1
    },
    createStone: function(a, b, c) {
        if (null != this.randomStoneArr[b] && null != this.randomStoneArr[b][a]) {
            var d = this.randomStoneArr[b][a];
            d.setVisible(!0); - 1 != c && d.setStoneData(c);
            d.effectSp && d.effectSp.setVisible(!1);
            d.selectedSp && d.selectedSp.setVisible(!1);
            this.stoneTileMap.setGridInfo(a, b, d);
            d.setCascadeOpacityEnabled(!0);
            d.setOpacity(0);
            d.setScale(0.3);
            d.setPosition(100 + 500 * Math.random(), 880 + 300 * Math.random());
            this.createStoneCount++
        }
    },
    onClickStone: function(a) {
        var b = this.stoneTileMap.getGridByGridPoint(a.col, a.row);
        currentScene.layer.resetDelayTime();
        this.selectedCol = a.col;
        this.selectedRow = a.row;
        this.selectedType = a.type;
        0 == gamePlayerData.clickModel ? this.clickTwice(b) : (this.clearSelectedStone(), this.clickOnce(b))
    },
    clickTwice: function(a) {
        if ( - 1 != this.cleanStoneArr.indexOf(a)) {
            var b = 0,
            b = this.selectedType == Global.STONE_TYPE.STONE_COLOR ? 10 : Global.StoneBaseScore + (this.cleanStoneArr.length - Global.BASE_STONE_NUM) * Global.StoneBaseRate,
            c = b * this.cleanStoneArr.length;
            this.cleanStoneArr.sort(this.sortStone);
            1 == Global.gameModel && (b = Math.floor(b * Global.TIMEOUT_RATE), c = Math.floor(c * Global.TIMEOUT_RATE));
            currentScene.layer.effectLayer.stone_count_lab.setVisible(!1);
            currentScene.layer.ui_layer.score_info.setVisible(!1);
            this.updateExplosionStone(this.cleanStoneArr, c, b, getStoneEffectXY(a.gridX, a.gridY))
        } else this.clearSelectedStone(),
        1 == gamePlayerData.useHammer ? currentScene.layer.effectLayer.showHammerEffect(a) : 1 == gamePlayerData.useBrush ? currentScene.layer.effectLayer.showBrushEffect(this.selectedCol, this.selectedRow) : this.checkNewSelectedStones(a)
    },
    clickOnce: function(a) {
        1 == gamePlayerData.useHammer ? currentScene.layer.effectLayer.showHammerEffect(a) : 1 == gamePlayerData.useBrush ? currentScene.layer.effectLayer.showBrushEffect(this.selectedCol, this.selectedRow) : this.selectedOnceStones(a)
    },
    selectedOnceStones: function(a) {
        if (a) {
            var b = [];
            this.checkSameTypeStone(this.selectedType, this.selectedCol, this.selectedRow, b);
            var c = 0;
            if (b.length) {
                b.sort(this.sortStone);
                var c = this.selectedType == Global.STONE_TYPE.STONE_COLOR ? 10 : Global.StoneBaseScore + (b.length - Global.BASE_STONE_NUM) * Global.StoneBaseRate,
                d = c * b.length;
                1 == Global.gameModel && (c = Math.floor(c * Global.TIMEOUT_RATE), d = Math.floor(d * Global.TIMEOUT_RATE));
                this.updateExplosionStone(b, d, c, getStoneEffectXY(a.gridX, a.gridY))
            }
        }
    },
    changeStoneType: function() {
        for (var a = this.selectedCol - 1; a <= this.selectedCol + 1; a++) for (var b = this.selectedRow - 1; b <= this.selectedRow + 1; b++) if (0 <= a && a < COL && 0 <= b && b < ROW) {
            var c = this.stoneTileMap.getGridByGridPoint(a, b);
            c && c.setStoneData(this.selectedType)
        }
    },
    updateMoveStone: function() {
        for (; this.moveStoneArr.length;) {
            var a = this.moveStoneArr.shift();
            engine.gameSound.playEffect(game_sound.res_sound_onland);
            a.runAction(cc.moveTo(0.2, getStoneXY(a.gridX, a.gridY)).easing(cc.easeBackIn()))
        }
        this.runAction(cc.sequence(cc.delayTime(0.3), cc.callFunc(function() {
            0 == this.moveStoneArr.length && !0 != this.hasIceStone() && (!0 == this.checkColorLessStone() ? this.runAction(cc.sequence(cc.delayTime(0.3), cc.callFunc(function() {
                this.afterMove()
            }.bind(this)))) : this.afterMove())
        }.bind(this))))
    },
    afterMove: function() {
        this.checkStoneCanClean()
    },
    checkMove: function(a) {
        this.checkMoveDown(a);
        this.checkMoveLeft();
        this.updateMoveStone()
    },
    checkMoveDown: function(a) {
        for (; a.length;) for (var b = a.shift(), c = b.gridX, d = 1; d < ROW; d++) if (b = this.stoneTileMap.getGridByGridPoint(c, d), null != b) for (var e = d - 1; 0 <= e && null == this.stoneTileMap.getGridByGridPoint(c, e); e--) this.stoneTileMap.setGridInfo(c, b.gridY, null),
        this.stoneTileMap.setGridInfo(c, e, b),
        -1 == this.moveStoneArr.indexOf(b) && this.moveStoneArr.push(b)
    },
    checkMoveLeft: function() {
        var a, b, c;
        b = [];
        for (var d = 0; d < COL; d++) for (var e = c = 0; e < ROW; e++) a = this.stoneTileMap.getGridByGridPoint(d, e),
        null == a && (c++, c == ROW && b.push(d));
        for (d = 0; d < b.length; d++) for (c = b[d] - d, e = 0; e < ROW; e++) for (var f = c + 1; f < COL; f++) a = this.stoneTileMap.getGridByGridPoint(f, e),
        null != a && (this.stoneTileMap.setGridInfo(f - 1, e, a), this.stoneTileMap.setGridInfo(f, e, null), -1 == this.moveStoneArr.indexOf(a) && this.moveStoneArr.push(a))
    },
    correctStonePosition: function() {
        for (var a = 0; a < COL; a++) for (var b = 0; b < ROW; b++) {
            var c = this.stoneTileMap.getGridByGridPoint(a, b);
            null != c && (c.stopAllActions(), c.setPosition(getStoneXY(c.gridX, c.gridY)))
        }
    },
    updateExplosionStone: function(a, b, c, d) {
        Global.isCanClick = !1;
        var e = a.length,
        f = 0,
        g = 0;
        c && (this.selectedStoneNum += e);
        for (var h = 0; h < e; h++) {
            var k = a[h];
            this.stoneTileMap.setGridInfo(k.gridX, k.gridY, null);
            k.runAction(cc.sequence(cc.delayTime(f), cc.callFunc(function(a) {
                this.onExplosionEffect(c, a, !1)
            }.bind(k, g))));
            f += 0.1;
            5 <= g ? g = 5 : g++;
            checkClearStone(k.stoneType)
        }
        1 == Global.gameModel && e >= Global.BASE_STONE_NUM && currentScene.layer.addSecond(1 + 0.1 * e);
        this.runAction(cc.sequence(cc.delayTime(f), cc.callFunc(function() {
            this.checkMove(a)
        }.bind(this)), cc.delayTime(0.2), cc.callFunc(function() {
            Global.isCanClick = !0;
            if (e >= Global.SHOW_TEXT_BASENUMBER) {
                var a = e - Global.SHOW_TEXT_BASENUMBER,
                a = 3 <= a ? 3 : a;
                engine.gameSound.playEffect(game_sound.res_sound_applause_1);
                currentScene.layer.effectLayer.onShowTextEffect(Global.STONE_TEXT[a]);
                currentScene.layer.bg_effect_Layer.fireWorksEffect()
            }
            if (b) currentScene.layer.effectLayer.onShowGetScore(b, d)
        }.bind(this))))
    },
    hasIceStone: function() {
        for (var a = !1,
        b = [], c = 0; c < COL; c++) {
            var d = this.stoneTileMap.getGridByGridPoint(c, 0);
            if (d && d.stoneType == Global.STONE_TYPE.STONE_ICE) {
                b.push(d);
                break
            }
        }
        b.length && (a = 100, 1 == Global.gameModel && (a = Math.floor(a * Global.TIMEOUT_RATE)), this.updateExplosionStone(b, a, a, getStoneEffectXY(b[0].gridX, b[0].gridY)), a = !0);
        return a
    },
    cleanStoneObj: function() {
        for (; this.moveStoneArr.length;) this.moveStoneArr.shift();
        for (; this.randomStoneArr.length;) for (var a = this.randomStoneArr.shift(); a.length;) a.shift();
        for (; this.cleanStoneArr.length;) this.cleanStoneArr.shift()
    },
    clearLastStone: function() {
        checkAchieveData();
        for (var a = [], b = 0; b < COL; b++) for (var c = ROW - 1; 0 <= c; c--) {
            var d = this.stoneTileMap.getGridByGridPoint(b, c);
            null != d && (a.push(d), this.stoneTileMap.setGridInfo(b, c, null))
        }
        a.sort(this.sortStone);
        c = 0;
        0 == Global.gameModel ? (10 > a.length ? (b = 200, c = 2E3 - b * a.length) : (b = 200, c = 0), this.showClearAnimation(a, c, b)) : (b = 200, gamePlayerData.percentPage = 100 - a.length, Global.gameStatus == GAME_SUCCESS ? (c = Math.floor(Math.abs(currentScene.layer.timeCount * (50 - currentScene.layer.timeCount))), this.showClearAnimation(a, c, b)) : this.showClearTimeOut(a));
        this.cleanStoneObj()
    },
    showClearTimeOut: function(a) {
        for (; a.length;) {
            var b = a.shift();
            b.selectedSp.stopAllActions();
            b.selectedSp.removeFromParent();
            var c = cc.moveBy(1, cc.p(0, -HEIGHT_CELL * ROW)),
            d = cc.fadeOut(1.5),
            e = cc.removeSelf();
            b.runAction(cc.sequence(cc.spawn(c, d), e))
        }
        this.runAction(cc.sequence(cc.delayTime(1.6), cc.callFunc(function() {
            this.explosionAfter()
        }.bind(this))))
    },
    showClearAnimation: function(a, b, c) {
        var d = 0,
        e = 0;
        for (currentScene.layer.effectLayer.showCleanSamScore(2E3); a.length;) {
            var f = a.shift();
            f.runAction(cc.sequence(cc.delayTime(d), cc.callFunc(function() {
                this.onExplosionEffect(c, 0, !0)
            }.bind(f))));
            d = 10 <= e ? d + 0.1 : d + 0.3;
            e++
        }
        a = cc.callFunc(function() {
            currentScene.layer.effectLayer.score_lab_sp.runAction(cc.fadeOut(0.5));
            currentScene.layer.effectLayer.onShowFlyScore(b, 4, 5)
        }.bind(this));
        e = cc.callFunc(function() {
            currentScene.layer.effectLayer.showLastScoreEffect()
        }.bind(this));
        a = cc.sequence(a, cc.delayTime(1.8), e);
        0 < b ? (Global.gameStatus = Global.currentScore + b >= Global.targetScore ? GAME_SUCCESS: GAME_FAIL, this.runAction(cc.sequence(cc.delayTime(d + 0.5), a))) : this.runAction(cc.sequence(cc.delayTime(d + 0.5), cc.callFunc(function() {
            this.explosionAfter()
        }.bind(this))));
        Global.gameStatus == GAME_FAIL && (Global.currentScore + b > gamePlayerData.maxScore ? gameSDK.setScoreAsync(RANK_WORLD, Global.currentScore + b, {
            p: ""
        },
        function(a) {
            gameSDK.setPlayerEntriesboardLeaderboardData(RANK_WORLD, null);
            gameSDK.setEntriesLeaderboardData(RANK_WORLD, null);
            gameSDK.setNearbyEntryData(RANK_WORLD, null);
            gameSDK.getConnectedPlayerEntriesAsync(RANK_WORLD, 50, 0);
            gameSDK.getEntriesLeaderboardDataByPlayer(RANK_WORLD, 30)
        }) : (gameSDK.getEntriesNearByData(RANK_WORLD) || gameSDK.getEntriesLeaderboardDataByPlayer(RANK_WORLD, 30), gameSDK.getPlayerEntriesboardLeaderboardData(RANK_WORLD) || gameSDK.getConnectedPlayerEntriesAsync(RANK_WORLD, 50, 0)))
    },
    refreshStone: function() {
        function a(d) {
            c.runAction(cc.sequence(cc.repeat(b, d || 3), cc.callFunc(function() {
                c.checkStoneCanClean() ? (Global.isCanClick = !0, gamePlayerData.useLoop = 0, currentScene.layer.changeBtnStatus()) : a.bind(c)(1)
            })))
        }
        Global.isCanClick = !1;
        var b = cc.sequence(cc.delayTime(0.3), cc.callFunc(function() {
            this.handleExchangePos()
        }.bind(this))),
        c = this;
        a.bind(this)()
    },
    handleExchangePos: function() {
        for (var a = 0; a < ROW; a++) for (var b = 0; b < COL; b++) this.randomReFreshStone(a, b)
    },
    randomReFreshStone: function(a, b) {
        var c, d, e, f;
        c = Math.floor(Math.random() * COL);
        d = Math.floor(Math.random() * ROW);
        if (e = this.stoneTileMap.getGridByGridPoint(b, a)) if (f = this.stoneTileMap.getGridByGridPoint(c, d)) e.stopAllActions(),
        e.setPosition(getStoneXY(e.gridX, e.gridY)),
        f.stopAllActions(),
        f.setPosition(getStoneXY(f.gridX, f.gridY)),
        c = e.gridX,
        d = e.gridY,
        e.gridX = f.gridX,
        e.gridY = f.gridY,
        f.gridX = c,
        f.gridY = d,
        this.stoneTileMap.setGridInfo(e.gridX, e.gridY, e),
        this.stoneTileMap.setGridInfo(f.gridX, f.gridY, f),
        c = cc.moveTo(0.2, getStoneXY(e.gridX, e.gridY)),
        d = cc.moveTo(0.2, getStoneXY(f.gridX, f.gridY)),
        e.runAction(c),
        f.runAction(d)
    },
    reLifeStone: function() {
        this.initData();
        for (var a = 0; a < COL; a++) for (var b = 0; b < ROW; b++) {
            var c = this.stoneTileMap.getGridByGridPoint(a, b);
            c && c.cleanStone();
            this.stoneTileMap.setGridInfo(a, b, null)
        }
    },
    checkStoneCanClean: function() {
        Global.isCanClean = !1;
        for (var a = 0; a < COL; a++) for (var b = 0; b < ROW; b++) {
            var c = this.stoneTileMap.getGridByGridPoint(a, b);
            if (null != c && !1 != this.checkHasNoClick(c.stoneType, a, b)) return Global.isCanClean = !0
        }
        return ! 1
    },
    clearSelectedStone: function() {
        for (; this.cleanStoneArr.length;) this.cleanStoneArr.shift().hidSelectedEffect()
    },
    showSelectedEffect: function() {
        var a, b;
        b = this.cleanStoneArr.length;
        for (var c = 0; c < b; c++) {
            a = this.cleanStoneArr[c];
            a.showSelectedEffect("selected_effect", 0, 2, !0);
            var d = cc.moveBy(0.1, cc.p(0, 20)).easing(cc.easeBackIn()),
            e = d.reverse();
            a.runAction(cc.sequence(d, e))
        }
        currentScene.layer.effectLayer.showStoneCount(b, this.selectedCol, this.selectedRow);
        currentScene.layer.ui_layer.score_info.setVisible(!0);
        currentScene.layer.ui_layer.score_info.setString(b + " combo " + (Global.StoneBaseScore + (this.cleanStoneArr.length - Global.BASE_STONE_NUM) * Global.StoneBaseRate) * this.cleanStoneArr.length + " score")
    },
    checkNewSelectedStones: function() {
        this.checkSameTypeStone(this.selectedType, this.selectedCol, this.selectedRow, this.cleanStoneArr);
        this.cleanStoneArr.sort(this.sortStone);
        this.cleanStoneArr.length >= Global.BASE_STONE_NUM && this.showSelectedEffect()
    },
    checkSameTypeStone: function(a, b, c, d) {
        var e;
        if (this.selectedType == Global.STONE_TYPE.STONE_COLOR) for (var f = b - 1; f <= b + 1; f++) for (a = c - 1; a <= c + 1; a++) e = this.stoneTileMap.getGridByGridPoint(f, a),
        null != e && -1 == d.indexOf(e) && d.push(e);
        else for (b = this.stoneTileMap.getRectGridsPointByFour(b, c), f = 0; f < b.length; f++) c = b[f],
        e = this.stoneTileMap.getGridByGridPoint(c.x, c.y),
        null != e && this.isSameType(a, e.stoneType) && -1 == d.indexOf(e) && (d.push(e), this.checkSameTypeStone(a, c.x, c.y, d))
    },
    isSameType: function(a, b) {
        return b == Global.STONE_TYPE.STONE_COLOR || b == a || a == Global.STONE_TYPE.STONE_COLOR && (b == this.selectedType || b >= Global.StoneTypeTwo && b - Global.StoneTypeTwo == this.selectedType || this.selectedType >= Global.StoneTypeTwo && this.selectedType - Global.StoneTypeTwo == b) || b >= Global.StoneTypeTwo && b - Global.StoneTypeTwo == a || a >= Global.StoneTypeTwo && a - Global.StoneTypeTwo == b ? !0 : !1
    },
    checkColorLessStone: function() {
        for (var a, b = !1,
        c = 0; c < COL; c++) for (var d = 0; d < ROW; d++) a = this.stoneTileMap.getGridByGridPoint(c, d),
        null == a || a.stoneType < Global.STONE_TYPE.STONE_LESS || (b = !0, currentScene.layer.effectLayer.onShowEffect("colorless_exp", 0, 12, getLessStoneEffectXY(c, d), 1, 1), this.runAction(cc.sequence(cc.delayTime(0.2), cc.callFunc(function(a) {
            if (this.selectedType != Global.STONE_TYPE.STONE_COLOR) this.selectedType < Global.StoneTypeTwo ? a.setStoneData(this.selectedType + Global.StoneTypeTwo) : a.setStoneData(this.selectedType);
            else {
                var b = Global.StoneTypeTwo + Math.floor(5 * Math.random());
                a.setStoneData(b)
            }
        }.bind(this, a)))));
        return b
    },
    checkHasNoClick: function(a, b, c) {
        b = this.stoneTileMap.getRectGridsPointByFour(b, c);
        for (c = 0; c < b.length; c++) {
            var d = b[c],
            d = this.stoneTileMap.getGridByGridPoint(d.x, d.y);
            if (null != d && d.stoneType != Global.STONE_TYPE.STONE_ICE && (d.stoneType == Global.STONE_TYPE.STONE_COLOR || d.stoneType == a || a >= Global.StoneTypeTwo && a - Global.StoneTypeTwo == d.stoneType || d.stoneType >= Global.StoneTypeTwo && d.stoneType - Global.StoneTypeTwo == a)) return ! 0
        }
        return ! 1
    },
    sortStone: function(a, b) {
        return a.gridY > b.gridY ? -1 : a.gridY == b.gridY ? a.gridX < b.gridX ? -1 : a.gridX == b.gridX ? 0 : 1 : 1
    },
    explosionAfter: function() {
        Global.gameStatus == GAME_SUCCESS ? (!1 == Global.isPlayEffect && currentScene.layer.handleSuccess(), currentScene.layer.bg_effect_Layer.fireWorksEffect(), this.runAction(cc.sequence(cc.delayTime(1.5), cc.callFunc(function() {
            currentScene.layer.gotoLastPass()
        }.bind(this))))) : Global.gameStatus == GAME_FAIL && currentScene.layer.handleFail()
    },
    autoSelected: function() {
        function a() {
            var c = b[~~ (Math.random() * b.length)];
            if (c) {
                var d = [];
                this.selectedType = c.stoneType;
                this.selectedCol = c.gridX;
                this.selectedRow = c.gridY;
                this.checkSameTypeStone(c.stoneType, c.gridX, c.gridY, d);
                if (d.length >= Global.BASE_STONE_NUM) {
                    this.cleanStoneArr = d;
                    for (var d = this.cleanStoneArr.length,
                    h = 0; h < d; h++) c = this.cleanStoneArr[h],
                    c.showSelectedEffect("selected_effect", 0, 2, !0);
                    cc.log("autoend:", e)
                } else b.splice(b.indexOf(c), 1),
                e++,
                50 >= e && a.bind(this)()
            }
        }
        for (var b = [], c = 0; c < COL; c++) for (var d = 0; d < ROW; d++) stone = this.stoneTileMap.getGridByGridPoint(c, d),
        null != stone && stone.stoneType != Global.STONE_TYPE.STONE_ICE && b.push(stone);
        var e = 0;
        a.bind(this)()
    },
    handleMustStonePos: function() {
        if (null != this.currentPassData.mustStoneType) for (var a = 0; a < this.currentPassData.mustStoneType.length; a++) for (var b = this.currentPassData.mustStoneType[a], c = 0; 2 > c; c++) this.randomMustPos(b)
    },
    randomMustPos: function(a) {
        var b = this.level_random_arr.length,
        c = parseInt(Math.random() * COL),
        d = 2 + parseInt(Math.random() * (ROW - 2));
        if (0 < b) {
            for (var e = !1,
            f = 0; f < b; f++) {
                var g = this.level_random_arr[f];
                if (g.x != c || g.y != d) {
                    this.level_random_arr.push({
                        type: a,
                        x: c,
                        y: d
                    });
                    e = !0;
                    break
                }
            } ! 1 == e && this.randomMustPos(a)
        } else this.level_random_arr.push({
            type: a,
            x: c,
            y: d
        })
    },
    getRateAndMustType: function(a, b) {
        for (var c = -1,
        d = this.level_random_arr.length,
        e = 0; e < d; e++) {
            var f = this.level_random_arr[e];
            f.x == a && f.y == b && (c = f.type)
        }
        return c
    },
    findSameTypeStone: function(a, b, c, d) {
        a = this.getRandomType(a, b);
        b = a.length;
        for (var e = 0; e < b; e++) {
            var f = a[e],
            f = this.randomStoneArr[f.y][f.x];
            c == f.stoneType && -1 == d.indexOf(f) && (d.push(f), this.findSameTypeStone(f.gridX, f.gridY, c, d))
        }
    },
    getRandomType: function(a, b) {
        var c = [];
        b + 1 < ROW && c.push(cc.p(a, b + 1));
        0 <= b - 1 && c.push(cc.p(a, b - 1));
        a + 1 < COL && c.push(cc.p(a + 1, b));
        0 <= a - 1 && c.push(cc.p(a - 1, b));
        return c
    },
    checkToMuchStone: function() {
        for (var a = 0; a < ROW; a++) for (var b = 0; b < COL; b++) {
            var c = [];
            this.findSameTypeStone(b, a, this.randomStoneArr[a][b].stoneType, c);
            if (4 < c.length) {
                this.resetRandomStoneType();
                break
            }
        }
    },
    checkStoneNum: function() {
        for (var a = 0,
        b = !1,
        c = 0; c < COL; c++) for (var d = 0; d < ROW; d++) null != this.stoneTileMap.getGridByGridPoint(c, d) && a++;
        60 > a && (b = !0);
        return b
    },
    getCanClearArray: function(a, b) {
        for (var c = this.stoneTileMap.getRectGridsPointByFour(a.gridX, a.gridY), d = 0; d < c.length; d++) {
            var e = c[d],
            e = this.stoneTileMap.getGridByGridPoint(e.x, e.y);
            null != e && e.stoneType == a.stoneType && -1 == b.indexOf(e) && (b.push(e), this.getCanClearArray(e, b))
        }
    },
    isExistInArray: function(a, b) {
        for (var c = 0; c < b.length; c++) for (var d = 0; d < b[c].length; d++) if (b[c][d].gridX == a.gridX && b[c][d].gridY == a.gridY) return ! 0;
        return ! 1
    },
    computeSurplusScore: function() {
        for (var a = [], b = 0; b < COL; b++) for (var c = 0; c < ROW; c++) {
            var d = [],
            e = this.stoneTileMap.getGridByGridPoint(b, c);
            null != e && !1 == this.isExistInArray(e, a) && (d.push(e), this.getCanClearArray(e, d), 2 <= d.length && a.push(d))
        }
        for (b = c = 0; b < a.length; b++) c += (Global.StoneBaseScore + (a[b].length - Global.BASE_STONE_NUM) * Global.StoneBaseRate) * a[b].length;
        return c
    }
}),
getTargetScore = function(a) {
    var b = 0,
    b = Global.GameLevelConfig;
    a > Global.GameTargetFixedLv ? (b = b[Global.GameTargetFixedLv - 1], b = 0 == Global.gameModel ? b.target: b.timeTarget, b += Global.GameFixedRate * (a - Global.GameTargetFixedLv)) : (b = b[a - 1], b = 0 == Global.gameModel ? b.target: b.timeTarget);
    return b
};
var HelpLayer = cc.Layer.extend({
    mainView: null,
    ctor: function() {
        this._super();
        this.mainView = null
    },
    onEnter: function() {
        this._super();
        this.initView()
    },
    initView: function() {
        var a = new cc.Layer,
        b = new cc.DrawNode;
        b.drawRect(cc.p(0, 0), cc.p(gameWidth, gameHigh), cc.color(0, 0, 0, 120), 0, cc.color(0, 0, 0, 120));
        var c = new cc.Sprite;
        c.addChild(b);
        a.addChild(c);
        this.addChild(a);
        var d = new ccui.ImageView(scale_png.scalesprite1, ccui.Widget.PLIST_TEXTURE);
        d.setScale9Enabled(!0);
        d.setContentSize(cc.size(620, 920));
        this.addChild(d);
        d.x = 360;
        d.y = 620;
        b = new cc.Sprite("#uipng/imghelptitle.png");
        this.addChild(b);
        b.x = 360;
        b.y = 1060;
        for (var b = ["stone_6.png", "stone_7.png", "stone_5.png", "dblclick.png"], c = [890, 710, 530, 320], e = 0; 4 > e; e++) {
            d = new ccui.ImageView(scale_png.scalesprite2, ccui.Widget.PLIST_TEXTURE);
            d.setScale9Enabled(!0);
            d.setContentSize(cc.size(560, 168));
            this.addChild(d);
            d.x = 360;
            d.y = c[e];
            var f = new cc.LabelTTF(helpTestLanguage[e], defaultTxt, 28);
            f.setHorizontalAlignment(cc.TEXT_ALIGNMENT_LEFT);
            f.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER);
            f.enableStroke(cc.color(0, 0, 0), 1);
            f.setColor(cc.color(216, 217, 178));
            f.setAnchorPoint(cc.p(0, 0.5));
            f.x = 255;
            f.y = c[e];
            this.addChild(f);
            f = new cc.Sprite("#uipng/" + b[e]);
            this.addChild(f);
            f.x = 165;
            f.y = c[e];
            3 == e && (d.setContentSize(cc.size(560, 200)), f.y = 360, f.setScale(0.6), d = new cc.Sprite("#uipng/dlick.png"), this.addChild(d), d.x = 165, d.setScale(0.6), d.y = 285)
        }
        b = new cc.Sprite("#uipng/layer_close_btn.png");
        this.addChild(b);
        b.x = 650;
        b.y = 1060;
        engine.gameEvent.createMouseUp(b, this.clickClose.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(a, this.clickMask.bind(this), null, cc.rect(0, 0, gameWidth, gameHigh))
    },
    clickMask: function() {
        this.removeFromParent()
    },
    clickClose: function() {
        this.removeFromParent()
    }
});
var ShowTipsWindow = cc.Layer.extend({
    txtStr: null,
    isPause: null,
    ctor: function(a) {
        this._super();
        this.txtStr = a.txt;
        this.isPause = a.isPause
    },
    onEnter: function() {
        this._super();
        this.initUI()
    },
    onExit: function() {
        this._super()
    },
    initUI: function() { ! 0 == this.isPause && cc.director.pause();
        createMaskLayer(this);
        var a = new ccui.ImageView(scale_png.scalesprite1, ccui.Widget.PLIST_TEXTURE);
        a.setScale9Enabled(!0);
        a.setContentSize(cc.size(606, 327));
        this.addChild(a);
        a.x = 360;
        a.y = 700;
        a = new cc.LabelTTF(this.txtStr, defaultTxt, 32);
        a.enableStroke(cc.color(0, 0, 0, 255), 2);
        a.boundingWidth = 520;
        a.y = 720;
        a.x = 385;
        this.addChild(a);
        a = new cc.Sprite("#uipng/layer_close_btn.png");
        a.x = 650;
        a.y = 830;
        this.addChild(a);
        engine.gameEvent.createMouseUp(a, this.closeLayer.bind(this), buttonScalingType)
    },
    closeLayer: function() { ! 0 == this.isPause && cc.director.resume();
        this.removeFromParent()
    }
});
var ADMaskLayer = cc.Layer.extend({
    circle: null,
    ctor: function() {
        this._super()
    },
    onEnter: function() {
        this._super()
    },
    initialize: function(a) { ! 0 == a.isCanClick && (a = new cc.DrawNode, a.drawRect(cc.p(0, 0), cc.p(cc.winSize.width, cc.winSize.height), cc.color(0, 0, 0, 120), 0, cc.color(0, 0, 0, 120)), this.addChild(a, -1), engine.gameEvent.createMouseDown(this,
        function() {},
        null, cc.rect(0, 0, cc.winSize.width, cc.winSize.height)));
        a = new cc.Sprite("#other/circle.png");
        a.setAnchorPoint(0.5, 0.5);
        a.setPosition(375, 667);
        this.addChild(a);
        var b = cc.rotateBy(2, 360);
        b.repeatForever();
        a.runAction(b);
        this.circle = a
    },
    removeGameLayer: function() {
        this.circle.stopAllActions();
        this.removeAllChildrenWithCleanup(!0);
        this.removeFromParent()
    }
});
var CompetitionLayer = cc.Layer.extend({
    ctor: function() {
        this._super()
    },
    onEnter: function() {
        this._super();
        this.initUI()
    },
    onExit: function() {
        this._super()
    },
    initUI: function() {
        createMaskLayer(this);
        var a = new ccui.ImageView(scale_png.scalesprite4, ccui.Widget.PLIST_TEXTURE);
        a.setScale9Enabled(!0);
        a.setContentSize(cc.size(623, 423));
        a.x = 360;
        a.y = 650;
        this.addChild(a);
        a = new cc.LabelTTF("your friend " + heroData.invitePlayerInfo.name + " is challenging your best scores", defaultTxt, 28);
        a.setColor(cc.color(0, 0, 0, 255));
        a.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER);
        a.boundingWidth = 520;
        a.y = 580;
        a.x = 360;
        this.addChild(a);
        a = new cc.Sprite("#competition/vsimg.png");
        a.x = 360;
        a.y = 700;
        this.addChild(a);
        var b = new cc.Sprite("#competition/headimg.png");
        b.x = 230;
        b.y = a.y;
        this.addChild(b);
        var c = new LoadSprite,
        d = heroData.image;
        cc.log("\u6311\u6218\u65f6\u81ea\u5df1\u7684\u5934\u50cf\uff1a" + d);
        c.loadComplete = function(a) {
            a = new cc.Sprite(a);
            a.setScale(150 / a.getContentSize().width);
            this.addChild(a)
        };
        c.setPNGUrl(d, 150);
        var d = new cc.Sprite("#competition/headblack.png"),
        e = new cc.ClippingNode;
        e.stencil = d;
        e.setAlphaThreshold(0.05);
        e.addChild(c);
        e.x = b.x;
        e.y = b.y;
        this.addChild(e);
        b = new cc.Sprite("#competition/headimg.png");
        b.x = 490;
        b.y = a.y;
        this.addChild(b);
        a = new LoadSprite;
        c = heroData.invitePlayerInfo.photo;
        cc.log("\u6311\u6218\u65f6\u522b\u4eba\u7684\u5934\u50cf\uff1a" + c);
        a.loadComplete = function(a) {
            a = new cc.Sprite(a);
            a.setScale(150 / a.getContentSize().width);
            this.addChild(a)
        };
        a.setPNGUrl(c, 150);
        c = new cc.Sprite("#competition/headblack.png");
        d = new cc.ClippingNode;
        d.stencil = c;
        d.setAlphaThreshold(0.05);
        d.addChild(a);
        d.x = b.x;
        d.y = b.y;
        this.addChild(d);
        a = new cc.Sprite("#competition/closeimg.png");
        a.x = 80;
        a.y = 830;
        this.addChild(a);
        engine.gameEvent.createMouseUp(a, this.closeLayer.bind(this), buttonScalingType);
        a = new cc.Sprite("#competition/playimg.png");
        a.x = 360;
        a.y = 500;
        this.addChild(a);
        engine.gameEvent.createMouseUp(a, this.clickPlayFun.bind(this), buttonScalingType)
    },
    clickPlayFun: function() {
        gamePlayerData.hasGameData = 0;
        Global.gameModel = 0;
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        gamePlayerData.currentScore = gamePlayerData.baseScore = Global.currentScore = 0;
        gamePlayerData.currentPage = Global.currentLv = 1;
        gamePlayerData.myGameDate = [];
        transitions(MainScene)
    },
    closeLayer: function() {
        this.removeFromParent()
    }
});
var GiftLayer = cc.Layer.extend({
    type: null,
    ctor: function() {
        this._super()
    },
    onEnter: function() {
        this._super()
    },
    onExit: function() {
        this._super();
        1 == this.type ? currentScene.layer.addInvitePlayerInfo() : 2 == this.type && currentScene.layer.showGameFail()
    },
    initUI: function(a) {
        this.type = a;
        1 == this.type && cc.director.pause();
        createMaskLayer(this);
        a = new ccui.ImageView(scale_png.scalesprite1, ccui.Widget.PLIST_TEXTURE);
        a.setScale9Enabled(!0);
        a.setContentSize(cc.size(595, 650));
        this.addChild(a);
        a.x = 360;
        a.y = 600;
        a = new cc.Sprite("#other/gifttitle.png");
        a.x = 360;
        a.y = 900;
        this.addChild(a);
        1 == this.type && a.setSpriteFrame("watchad/surprisetitle.png");
        a = new cc.Sprite("#watchad/rewardlight.png");
        a.x = 360;
        a.y = 650;
        this.addChild(a);
        a = new cc.Sprite("#watchad/imgdem.png");
        a.x = 370;
        a.y = 655;
        this.addChild(a);
        var b = new creatGameArtWord("fntb");
        b.alignmentType = artWordMiddle;
        this.addChild(b);
        b.x = a.x;
        b.y = a.y - 55;
        b.setString("x50");
        a = new cc.Sprite("#watchad/imgloop.png");
        a.x = 240;
        a.y = 730;
        this.addChild(a);
        b = new creatGameArtWord("fntb");
        b.alignmentType = artWordMiddle;
        this.addChild(b);
        b.x = a.x;
        b.y = a.y - 55;
        b.setString("x1");
        a = new cc.Sprite("#watchad/imghammer.png");
        a.x = 500;
        a.y = 755;
        this.addChild(a);
        b = new creatGameArtWord("fntb");
        b.alignmentType = artWordMiddle;
        this.addChild(b);
        b.x = a.x;
        b.y = a.y - 55;
        b.setString("x2");
        a = new cc.Sprite("#other/giftdesimg.png");
        a.x = 360;
        a.y = 480;
        this.addChild(a);
        a = new cc.Sprite("#uipng/giftfree.png");
        a.x = 360;
        a.y = 370;
        this.addChild(a);
        engine.gameEvent.createMouseUp(a, this.clickWatchAdvert.bind(this), buttonScalingType);
        a = new cc.Sprite("#uipng/layer_close_btn.png");
        a.setScale(0.7);
        a.realScale = 0.7;
        a.x = 640;
        a.y = 900;
        this.addChild(a);
        engine.gameEvent.createMouseUp(a, this.closeLayer.bind(this), buttonScalingType)
    },
    clickWatchAdvert: function() {
        http_recordPlayerAction(playerActionType.giftAD, 1);
        var a = this,
        b = function() {
            gamePlayerData.diamondValue += 50;
            gamePlayerData.hammerNum += 2;
            gamePlayerData.loopNum += 1;
            0 == a.type ? (gamePlayerData.diamondGiftStu = 1, currentScene.layer.updateGiftBtn()) : 2 == a.type ? gamePlayerData.diamondGiftStu = 1 : (heroData.itemGiftTimes = 1, cc.director.resume());
            saveUserData();
            a.removeFromParent();
            var b = new cc.Sprite("#uipng/diamond.png");
            b.x = 320;
            b.y = 600;
            currentScene.addChild(b, 99999);
            b.setScale(1.2);
            b.setCascadeOpacityEnabled(!0);
            var d = new cc.LabelTTF(" + 50", defaultTxt, 30);
            d.enableStroke(cc.color(0, 0, 0, 255), 2);
            d.y = 35;
            d.x = 95;
            b.addChild(d, 1001);
            b.runAction(cc.sequence(cc.moveBy(1, cc.p(0, 120)), cc.fadeOut(0.5), cc.removeSelf()));
            b = new cc.Sprite("#uipng/main_hammerbtn.png");
            b.x = 490;
            b.y = 610;
            currentScene.addChild(b, 99999);
            b.setScale(0.8);
            b.setCascadeOpacityEnabled(!0);
            d = new cc.LabelTTF(" + 2", defaultTxt, 30);
            d.enableStroke(cc.color(0, 0, 0, 255), 2);
            d.y = 49;
            d.x = 120;
            d.setScale(1.5);
            b.addChild(d, 1001);
            b.runAction(cc.sequence(cc.moveBy(1, cc.p(0, 120)), cc.fadeOut(0.5), cc.removeSelf()));
            b = new cc.Sprite("#uipng/main_loopbtn.png");
            b.x = 175;
            b.y = 617;
            currentScene.addChild(b, 99999);
            b.setScale(0.8);
            b.setCascadeOpacityEnabled(!0);
            d = new cc.LabelTTF(" + 1", defaultTxt, 30);
            d.enableStroke(cc.color(0, 0, 0, 255), 2);
            d.y = 41;
            d.x = 120;
            d.setScale(1.5);
            b.addChild(d, 1001);
            b.runAction(cc.sequence(cc.moveBy(1, cc.p(0, 120)), cc.fadeOut(0.5), cc.removeSelf()))
        };
        1 != gamePlayerData.diamondGiftStu || 0 != this.type && 2 != this.type ? gameSDK.showRewardVideoAd(rewardedVideoID1, b) : (b = new ShowTipsWindow({
            txt: "Chances are used up, please come tomorrow.",
            isPause: !1
        }), currentScene.addChild(b, 9999999), this.removeFromParent())
    },
    closeLayer: function() {
        1 == this.type && cc.director.resume();
        this.removeFromParent()
    }
});
var TargetLayer = cc.Layer.extend({
    type: null,
    curData: null,
    ctor: function() {
        this._super()
    },
    onEnter: function() {
        this._super();
        this.initUI()
    },
    onExit: function() {
        this._super();
        currentScene.layer.addShowSurpassPlayer(this.type)
    },
    initUI: function() {
        var a = this.curData = heroData.getNextTargetPerson();
        createMaskLayer(this);
        var b = new ccui.ImageView("other/scalesprite1.png", ccui.Widget.PLIST_TEXTURE);
        b.setScale9Enabled(!0);
        b.setContentSize(cc.size(720, 312));
        this.addChild(b);
        b.x = 360;
        b.y = 640;
        var c = new cc.Sprite("#watchad/targettxt.png");
        b.addChild(c);
        c.x = 360;
        c.y = 250;
        c = new cc.Sprite("#other/touxiangkuang.png");
        c.x = 230;
        c.y = 140;
        b.addChild(c, 99);
        var d = new LoadSprite,
        e = a.photo;
        d.loadComplete = function(a) {
            a = new cc.Sprite(a);
            a.setScale(120 / a.getContentSize().width);
            this.addChild(a)
        };
        d.setPNGUrl(e, 120);
        e = new cc.Sprite("#rank/black.png");
        e.setScale(1.46);
        var f = new cc.ClippingNode;
        f.stencil = e;
        f.setAlphaThreshold(0.05);
        f.addChild(d);
        f.x = c.x;
        f.y = c.y - 2;
        b.addChild(f, 98);
        d = new cc.LabelTTF(a.name, "res/font/font.ttf", 32);
        d.x = c.x + 100;
        d.y = c.y + 18;
        d.setAnchorPoint(cc.p(0, 0.5));
        d.setHorizontalAlignment(cc.TEXT_ALIGNMENT_LEFT);
        b.addChild(d);
        a = new cc.LabelTTF("" + a.score, defaultTxt, 30);
        a.setAnchorPoint(cc.p(0, 0.5));
        a.x = c.x + 100;
        a.y = c.y - 18;
        c = 176 / a.getContentSize().width;
        a.setScale(1 <= c ? 1 : c);
        b.addChild(a);
        b.setCascadeOpacityEnabled(!0);
        b.runAction(cc.sequence(cc.delayTime(2), cc.moveBy(0.8, cc.p(0, 400)), cc.callFunc(this.onClose.bind(this))))
    },
    onClose: function() {
        this.removeFromParent()
    }
});
var AchieveItem = cc.Node.extend({
    data: null,
    isCanClick: !1,
    main: null,
    ranking_normalbg: null,
    achieve_icon: null,
    achieve_content: null,
    achieve_green_btn: null,
    aw_fntgreen_btnlab: null,
    aw_fntrank2_btnlab: null,
    ctor: function(a) {
        this._super();
        this.data = a;
        this.isCanClick = !1;
        this.aw_fntrank2_btnlab = this.aw_fntgreen_btnlab = this.achieve_green_btn = this.achieve_content = this.achieve_icon = this.ranking_normalbg = this.main = null
    },
    onEnter: function() {
        this._super();
        this.setContentSize(655, 120);
        this.main = this.parent;
        this.ranking_normalbg = new cc.Sprite("#uipng/achieve_normal.png");
        this.addChild(this.ranking_normalbg);
        var a = Math.ceil(this.data.id / 5);
        this.achieve_icon = new cc.Sprite("#uipng/achieve_icon" + a + ".png");
        this.ranking_normalbg.addChild(this.achieve_icon);
        this.achieve_icon.setPosition(68, 72);
        this.achieve_content = new cc.LabelTTF;
        this.achieve_content.setFontSize(28);
        this.addChild(this.achieve_content);
        this.achieve_content.boundingWidth = 380;
        this.achieve_content.boundingHeight = 100;
        this.achieve_content.textAlign = cc.TEXT_ALIGNMENT_LEFT;
        this.achieve_content.verticalAlign = cc.VERTICAL_TEXT_ALIGNMENT_CENTER;
        this.achieve_content.setAnchorPoint(cc.p(0, 0.5));
        this.achieve_content.setPositionX( - 200);
        this.achieve_green_btn = new cc.Sprite("#uipng/achieve_green_btn.png");
        this.addChild(this.achieve_green_btn);
        this.achieve_green_btn.setPositionX(248);
        this.aw_fntgreen_btnlab = creatGameArtWord("fntgreen", 23);
        this.achieve_green_btn.addChild(this.aw_fntgreen_btnlab);
        this.aw_fntgreen_btnlab.setPosition(70, 38);
        this.aw_fntrank2_btnlab = creatGameArtWord("fntrank2", 23);
        this.achieve_green_btn.addChild(this.aw_fntrank2_btnlab);
        this.aw_fntrank2_btnlab.setPosition(70, 38);
        engine.gameEvent.createMouseUp(this.achieve_green_btn, this.onClickBtn.bind(this), buttonScalingType);
        this.initView()
    },
    initView: function() {
        var a;
        this.data.isGetAward ? (a = "achieve_enable_btn", this.isCanClick = !1, this.aw_fntgreen_btnlab.setVisible(!1), this.aw_fntrank2_btnlab.setVisible(!1), this.changeBgPng(!1)) : this.data.isCanAward ? (a = "achieve_green_btn", this.isCanClick = !0, this.aw_fntgreen_btnlab.setVisible(!0), this.aw_fntrank2_btnlab.setVisible(!1), this.changeBgPng(!0)) : (a = "achieve_disable_btn", this.isCanClick = !1, this.aw_fntgreen_btnlab.setVisible(!1), this.aw_fntrank2_btnlab.setVisible(!0), this.changeBgPng(!1));
        a = cc.spriteFrameCache.getSpriteFrame("uipng/" + a + ".png");
        this.achieve_green_btn.setSpriteFrame(a);
        this.achieve_content.setString(this.data.content);
        this.aw_fntgreen_btnlab.setString(this.data.awardValue.toString());
        this.aw_fntrank2_btnlab.setString(this.data.awardValue.toString())
    },
    changeBgPng: function(a) {
        a = cc.spriteFrameCache.getSpriteFrame("uipng/" + (a ? "achieve_selected": "achieve_normal") + ".png");
        this.ranking_normalbg.setSpriteFrame(a)
    },
    onClickBtn: function() { ! 1 != this.isCanClick && (engine.gameSound.playEffect(game_sound.res_sound_get_award), gamePlayerData.diamondValue += this.data.awardValue, this.data.isGetAward = !0, this.data.isCanAward = !1, this.initView(), currentScene.layer.changeMoney(), saveUserData())
    }
});
var MaxLv = 4,
RankingItem = cc.Node.extend({
    index: 0,
    data: null,
    bg_img: null,
    lv_img: null,
    lv_lab: null,
    score_lab: null,
    name_lab: null,
    ctor: function(a, b) {
        this._super();
        this.index = a;
        this.data = b;
        this.name_lab = this.score_lab = this.lv_lab = this.lv_img = this.bg_img = null
    },
    onEnter: function() {
        this._super();
        this.initView()
    },
    initView: function() {
        this.bg_img = new cc.Sprite;
        this.addChild(this.bg_img);
        var a = new cc.Sprite("#uipng/score.png");
        this.addChild(a);
        a.setPositionX( - 90);
        this.lv_img = new cc.Sprite;
        this.addChild(this.lv_img);
        this.lv_img.setPositionX( - 239);
        this.lv_lab = creatGameArtWord("fntrank2");
        this.addChild(this.lv_lab);
        this.lv_lab.setPositionX( - 240);
        this.score_lab = creatGameArtWord("fntrank2");
        this.addChild(this.score_lab);
        this.score_lab.setPositionX(26);
        this.name_lab = new cc.LabelTTF;
        this.addChild(this.name_lab);
        this.name_lab.setFontSize(24);
        this.name_lab.setPositionX(210);
        var a = this.index >= MaxLv ? MaxLv: this.index,
        b = cc.spriteFrameCache.getSpriteFrame("uipng/ranking_lv_" + a + ".png");
        this.lv_img.setSpriteFrame(b);
        a != MaxLv ? this.lv_img.setPositionY( - 4) : this.lv_img.setPositionY(0);
        this.lv_lab.alignmentType = artWordToMiddle;
        this.lv_lab.setString(this.index.toString());
        var a = this.index == gamePlayerData.playerRankingLv ? "ranking_mybg": "ranking_normalbg",
        c = this.data.score,
        b = cc.spriteFrameCache.getSpriteFrame("uipng/" + a + ".png");
        this.bg_img.setSpriteFrame(b);
        this.score_lab.setString(c.toString());
        this.name_lab.setString(this.data.nameID)
    }
});
var WIDTH_CELL = 70,
HEIGHT_CELL = 70,
BLACK_HEIGHT = 100,
Stone = cc.Node.extend({
    effectSp: null,
    stoneSp: null,
    selectedSp: null,
    stoneType: 1,
    gridX: 0,
    gridY: 0,
    isExplosion: !1,
    ctor: function(a) {
        this._super();
        this.stoneType = a;
        this.gridY = this.gridX = 0;
        this.selectedSp = this.stoneSp = this.effectSp = null;
        this.isExplosion = !0
    },
    onEnter: function() {
        this._super();
        this.stoneSp = new cc.Sprite;
        this.addChild(this.stoneSp);
        this.initStone();
        this.scheduleUpdate()
    },
    update: function(a) {
        null != this.effectSp && this.effectSp.setPosition(this.getPosition());
        null != this.selectedSp && this.selectedSp.setPosition(this.getPosition())
    },
    setStoneData: function(a) {
        this.stoneType = a;
        this.changeStoneType()
    },
    initStone: function() {
        var a = cc.spriteFrameCache.getSpriteFrame("uipng/stone_" + this.stoneType + ".png");
        this.stoneSp.setSpriteFrame(a);
        engine.gameEvent.createMouseUp(this.stoneSp, this.onClickStone.bind(this), buttonScalingType)
    },
    changeStoneType: function() {
        var a = cc.spriteFrameCache.getSpriteFrame("uipng/stone_" + this.stoneType + ".png");
        this.stoneSp.setSpriteFrame(a);
        this.createSpecialEffect()
    },
    onClickStone: function() {
        if (this.stoneType != Global.STONE_TYPE.STONE_LESS && this.stoneType != Global.STONE_TYPE.STONE_ICE && !1 != Global.isCanClick && !1 != this.isExplosion) currentScene.layer.stoneLayer.onClickStone({
            type: this.stoneType,
            col: this.gridX,
            row: this.gridY
        })
    },
    createSpecialEffect: function() {
        var a;
        this.effectSp.stopAllActions();
        this.stoneType == Global.STONE_TYPE.STONE_COLOR ? a = getEffect("color_effect", 0, 19).repeatForever() : this.stoneType >= Global.STONE_TYPE.STONE_LESS && (a = getEffect("colorless", 0, 19).repeatForever());
        null != a ? (this.effectSp.runAction(a), this.effectSp.setVisible(!0)) : this.effectSp.setVisible(!1)
    },
    hidSelectedEffect: function() {
        this.selectedSp.stopAllActions();
        this.selectedSp.setVisible(!1)
    },
    showSelectedEffect: function(a, b, c, d) {
        var e = cc.spriteFrameCache.getSpriteFrame("effects/" + a + "_" + b + ".png");
        this.selectedSp.setSpriteFrame(e);
        this.selectedSp.setVisible(!0);
        a = getEffect(a, b, c);
        d ? this.selectedSp.runAction(cc.sequence(a).repeatForever()) : this.selectedSp.runAction(cc.sequence(a))
    },
    onExplosionEffect: function(a, b, c) {
        this.isExplosion = !0;
        var d = cc.spriteFrameCache.getSpriteFrame("effects/selected_effect_3.png");
        this.selectedSp.setSpriteFrame(d);
        this.selectedSp.setVisible(!0);
        d = getEffect("selected_effect", 3, 6);
        this.selectedSp.runAction(d);
        this.runAction(cc.sequence(cc.delayTime(0.3), cc.callFunc(function() {
            currentScene.layer.effectLayer.showExplosion({
                type: this.stoneType,
                x: this.gridX,
                y: this.gridY,
                exp_index: b,
                rate: a,
                isClean: c
            });
            if (!0 == c) currentScene.layer.effectLayer.onShowGameWinClear(a);
            this.cleanStone()
        }.bind(this))))
    },
    cleanStone: function() {
        this.isExplosion = !1;
        this.unscheduleUpdate();
        this.effectSp.stopAllActions();
        this.effectSp.removeFromParent();
        this.selectedSp.stopAllActions();
        this.selectedSp.removeFromParent();
        this.removeFromParent()
    }
}),
getStoneXY = function(a, b) {
    return cc.p(Math.floor((a + 0.5) * WIDTH_CELL + 10), Math.floor((b + 0.5) * HEIGHT_CELL + BLACK_HEIGHT))
},
getStoneEffectXY = function(a, b) {
    return cc.p(Math.floor((a + 0.5) * WIDTH_CELL), Math.floor((b + 0.5) * HEIGHT_CELL + 30))
},
getScoreXY = function(a, b) {
    return cc.p(Math.floor((a + 0.5) * WIDTH_CELL + 30), Math.floor((b + 0.5) * HEIGHT_CELL + BLACK_HEIGHT))
},
getStontCount = function(a, b) {
    return cc.p(Math.floor((a + 0.5) * WIDTH_CELL + 30), Math.floor((b + 0.5) * HEIGHT_CELL + BLACK_HEIGHT + 20))
},
getLessStoneEffectXY = function(a, b) {
    return cc.p(Math.floor((a + 0.5) * WIDTH_CELL), Math.floor((b + 0.5) * HEIGHT_CELL + 98))
};
var UpRankLayer = cc.Layer.extend({
    mainUI: null,
    data: null,
    isCanTouch: !1,
    texiaoMc: null,
    endFun: null,
    ctor: function() {
        this._super();
        this.initData()
    },
    initData: function() {
        var a;
        Global.currentScore >= heroData.getNextTargetPerson().score ? a = heroData.getNextTargetPerson() : (a = heroData.getTargetBeiTai(), a.score = Math.max(0, ~~ (Global.currentScore - 100 * Math.random())));
        this.mainUI = null;
        this.data = [];
        var b = {};
        b.num = Global.currentScore;
        b.rank = heroData.getOwnRankInWorldRank();
        b.name = heroData.nickname;
        b.img = heroData.image;
        this.data.push(b);
        b = {};
        b.num = a.score;
        b.name = a.name;
        b.img = a.photo;
        this.data.push(b);
        this.isCanTouch = !1
    },
    onEnter: function() {
        this._super();
        this.initUI()
    },
    onExit: function() {
        this._super();
        this.endFun && this.endFun()
    },
    initUI: function() {
        createMaskLayer(this);
        var a = new GameBgLayer;
        this.addChild(a);
        this.showRankTxt.bind(this)();
        this.showUpDown.bind(this)()
    },
    showRankTxt: function() {
        var a = getGradeByScore(gamePlayerData.maxScore);
        9 > a && (a = new cc.LabelTTF("Your ranking has risen,and you need " + (Global.gradeData[a].gradeValue - gamePlayerData.maxScore) + "\npoints to be promoted to " + Global.gradeData[a].gradeName + ".", defaultTxt, 26), a.enableStroke(cc.color(0, 0, 0, 255), 2), a.textAlign = cc.TEXT_ALIGNMENT_CENTER, a.setPosition(350, 300), this.addChild(a))
    },
    showUpDown: function() {
        this.mainUI = loadCSS(res.up_rank_layer, !1);
        this.addChild(this.mainUI);
        engine.gameEvent.createMouseUp(this.mainUI.btnContinue, this.onContinue.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainUI.btnShare, this.onShare.bind(this), buttonScalingType);
        this.lightAction();
        this.tittleDownAction();
        this.upAction();
        this.downAction();
        this.arrowUpAction()
    },
    onContinue: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        this.isCanTouch && (this.texiaoMc && (this.texiaoMc.removeFromParent(), this.texiaoMc = null), this.removeFromParent())
    },
    onShare: function() {
        gameSDK.shareGame(function(a) {})
    },
    lightAction: function() {
        var a = new cc.Sprite("#up_rank/light.png");
        this.addChild(a);
        a.x = 360;
        a.y = 707;
        a.setScale(0);
        a.runAction(cc.sequence(cc.scaleTo(7 / 24, 2.2), cc.scaleTo(7 / 24, 2), cc.rotateBy(800, 36E3)))
    },
    tittleDownAction: function() {
        var a = new cc.Sprite("#up_rank/tittle.png");
        this.addChild(a, 2);
        a.x = 360;
        a.y = 1353;
        var b = cc.sequence(cc.moveTo(4 / 24, cc.p(360, 720)), cc.scaleTo(0.125, 1.12, 0.75), cc.scaleTo(0.125, 0.96, 1.09), cc.scaleTo(0.125, 1.1, 0.9), cc.scaleTo(4 / 24, 1, 1));
        a.runAction(b)
    },
    upAction: function() {
        var a = loadCSS(res.up_rank_node);
        a.name.setString(this.data[0].name);
        a.aw_fnttype5_score.setString(this.data[0].num.toString());
        a.x = 360;
        a.y = 533;
        this.addChild(a, 3);
        a.icon_frame.setLocalZOrder(3);
        var b = new LoadSprite,
        c = this.data[0].img;
        b.loadComplete = function(a) {
            a = new cc.Sprite(a);
            a.setScale(107 / a.getContentSize().width);
            this.addChild(a)
        };
        b.setPNGUrl(c, 107);
        var c = new cc.Sprite("#up_rank/black.png"),
        d = new cc.ClippingNode;
        d.stencil = c;
        d.setAlphaThreshold(0.05);
        d.addChild(b);
        d.x = -286;
        d.y = 100;
        a.addChild(d, 1);
        b = new cc.Sprite("#title/title" + getGradeByScore(gamePlayerData.maxScore) + ".png");
        b.setPosition( - 180, 0);
        b.scale = 0.4;
        a.addChild(b);
        b = cc.sequence(cc.delayTime(0.5), cc.scaleTo(0.125, 1.3), cc.scaleTo(0.125, 1), cc.delayTime(0.125), cc.moveTo(4 / 24, cc.p(360, 915)), cc.scaleTo(0.125, 1.03, 0.95), cc.scaleTo(0.125, 1, 1), cc.callFunc(function() {
            this.isCanTouch = !0
        }.bind(this)));
        a.runAction(b)
    },
    downAction: function() {
        var a = loadCSS(res.up_rank_node);
        a.name.setString(this.data[1].name);
        a.aw_fnttype5_score.setString(this.data[1].num.toString());
        a.x = 360;
        a.y = 915;
        this.addChild(a, 3);
        a.frame.setSpriteFrame("up_rank/frame2.png");
        a.icon_frame.setLocalZOrder(3);
        var b = new LoadSprite,
        c = this.data[1].img;
        b.loadComplete = function(a) {
            a = new cc.Sprite(a);
            a.setScale(107 / a.getContentSize().width);
            this.addChild(a)
        };
        b.setPNGUrl(c, 107);
        var c = new cc.Sprite("#up_rank/black.png"),
        d = new cc.ClippingNode;
        d.stencil = c;
        d.setAlphaThreshold(0.05);
        d.addChild(b);
        d.x = -286;
        d.y = 100;
        a.addChild(d, 1);
        b = new cc.Sprite("#title/title" + getGradeByScore(this.data[1].num) + ".png");
        b.setPosition( - 180, 0);
        b.scale = 0.4;
        a.addChild(b);
        b = cc.sequence(cc.delayTime(0.5), cc.scaleTo(0.125, 1.09, 0.86), cc.scaleTo(2 / 24, 1, 1), cc.moveTo(0.25, cc.p(360, 523)));
        a.runAction(b)
    },
    arrowUpAction: function() {
        var a = new cc.Sprite("#up_rank/arrow2.png");
        a.x = 333;
        a.y = 1075;
        a.setCascadeOpacityEnabled(!0);
        a.setOpacity(0);
        this.addChild(a);
        var b = new GameArtWord("fnttype6");
        b.alignmentType = artWordMiddle;
        var c = ~~ (90 * Math.random() + 10);
        b.setString(c.toString());
        b.x = a.getContentSize().width / 2;
        b.y = a.getContentSize().height / 2;
        a.addChild(b);
        c = 55 / b.getContentSize().width;
        b.setScale(1 < c ? 1 : c);
        b = cc.sequence(cc.delayTime(1), cc.spawn(cc.fadeIn(8 / 24), cc.moveBy(8 / 24, cc.p(0, 24))), cc.scaleTo(4 / 24, 1.1, 0.9), cc.scaleTo(4 / 24, 0.9, 1.1), cc.scaleTo(4 / 24, 1, 1));
        a.runAction(b)
    },
    arrowDownAction: function() {
        var a = new cc.Sprite("#up_rank/arrow1.png");
        a.x = 385;
        a.y = 365;
        a.setCascadeOpacityEnabled(!0);
        a.setOpacity(0);
        this.addChild(a);
        var b = new GameArtWord("fnttype7");
        b.alignmentType = artWordMiddle;
        b.setString(this.data[1].rank.toString());
        b.x = a.getContentSize().width / 2;
        b.y = a.getContentSize().height / 2 + 10;
        a.addChild(b);
        var c = 55 / b.getContentSize().width;
        b.setScale(1 < c ? 1 : c);
        b = cc.sequence(cc.delayTime(1), cc.spawn(cc.fadeIn(8 / 24), cc.moveBy(8 / 24, cc.p(0, -24))), cc.scaleTo(4 / 24, 1.1, 0.9), cc.scaleTo(4 / 24, 0.9, 1.1), cc.scaleTo(4 / 24, 1, 1));
        a.runAction(b)
    }
});
var ResultLayer = cc.Layer.extend({
    mainUI: null,
    data: null,
    type: 1,
    list1: null,
    list2: null,
    upClipping: null,
    surpassInfo: null,
    isCleanSurpass: null,
    scoreTxt: null,
    fightPersonInfoArr: [],
    currentShowData: null,
    ctor: function(a) {
        this._super();
        this.surpassInfo = a;
        this.initData()
    },
    initData: function() {
        this.data = null;
        this.type = 1;
        this.upClipping = this.list2 = this.list1 = this.mainUI = null
    },
    onEnter: function() {
        this._super();
        this.schedule(this.checkGetRankData.bind(this), 0.1);
        this.initUI()
    },
    onExit: function() {
        this._super();
        this.unscheduleAllCallbacks()
    },
    initUI: function() {
        this.mainUI = loadCSS(res.result_layer, !1);
        this.addChild(this.mainUI);
        var a = new cc.Sprite("res/uipng/main_bg1.png");
        this.mainUI.addChild(a, -1);
        a.setAnchorPoint(cc.p(0.5, 0));
        a.setPosition(360, 639);
        var b = new cc.Sprite("res/uipng/main_bg2.png");
        this.mainUI.addChild(b, -1);
        b.setAnchorPoint(cc.p(0.5, 1));
        b.setPosition(360, 640);
        var c = new cc.DrawNode;
        c.drawRect(cc.p(0, 60), cc.p(720, 660), cc.color(0, 0, 0, 120), 0, cc.color(0, 0, 0, 120));
        this.upClipping = createClippingNode(0.5, 0.5, 0, 0, 1, !1, c);
        this.mainUI.addChild(this.upClipping);
        this.upClipping.isSwallowTouches = !1;
        engine.gameEvent.createMouseDown(this.upClipping, this.clickDownFun.bind(this), null, cc.rect(60, 110, 620, 530));
        engine.gameEvent.createMouseMove(this.upClipping, this.clickMoveFun.bind(this), null, cc.rect(60, 110, 620, 530));
        engine.gameEvent.createMouseUp(this.upClipping, this.clickUpFun.bind(this), null, cc.rect(60, 110, 620, 530));
        engine.gameEvent.createMouseUp(this.mainUI.btnClose, this.onClose.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainUI.btnUp, this.onUp.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainUI.btnLeft, this.onSelect.bind(this));
        engine.gameEvent.createMouseUp(this.mainUI.btnRight, this.onSelect.bind(this));
        engine.gameEvent.createMouseUp(this.mainUI.invitemorefriendbtn, this.clickInvitemorefriendbtn.bind(this));
        engine.gameEvent.createMouseUp(a,
        function() {});
        engine.gameEvent.createMouseUp(b,
        function() {});
        this.mainUI.btnUp.setLocalZOrder(3);
        this.refreshChooseBtnState();
        this.mainUI.aw_fnttype3_scoreText.setString("");
        this.mainUI.aw_fnttype4_moneyText.setString("");
        this.getDiamond();
        this.onSelect(null, null);
        heroData.lastGrade = Global.currentScore;
        this.isCleanSurpass = null != this.surpassInfo && Global.currentScore < this.surpassInfo.currentScore ? !1 : !0;
        var d = getGradeByScore(Global.currentScore),
        e = this;
        if (Global.currentScore >= gamePlayerData.maxScore && d > Global.old_grade || debugtest.shengjie_donghua_show) {
            var f = new GameBgLayer;
            this.addChild(f);
            this.scheduleOnce(function() {
                var a = new cc.DrawNode;
                a.drawRect(cc.p(0, 0), cc.p(cc.winSize.width, cc.winSize.height), cc.color(0, 0, 0, 120), 0, cc.color(0, 0, 0, 120));
                e.addChild(a);
                engine.gameEvent.createMouseDown(a,
                function() {
                    f && f.removeFromParent(!0);
                    b && b.removeFromParent(!0);
                    a && a.removeFromParent(!0);
                    e.scoreTxt && e.scoreTxt.removeFromParent(!0);
                    e.addRankUpInfo.bind(e)()
                },
                null, cc.rect(0, 0, cc.winSize.width, cc.winSize.height));
                var b = new cc.Sprite;
                this.addChild(b);
                var c = createGameSkeletalAnimation(res.title_out_json, "backstar", 24, !1, "pngdata/title_out");
                c.setPosition(350, 670);
                c.playCount = -1;
                b.addChild(c);
                c = new cc.Sprite("#title/title" + d + ".png");
                c.setPosition(350, 690);
                b.addChild(c);
                var m = createGameSkeletalAnimation(res.title_out_json, "lightcircle", 24, !1, "pngdata/title_out");
                m.setPosition(350, 690);
                m.playCount = 1;
                b.addChild(m);
                c.scale = 0.5;
                c.runAction(cc.sequence(cc.scaleTo(0.3, 1.2, 1.2), cc.scaleTo(0.13, 0.9, 0.9), cc.scaleTo(0.05, 1, 1), cc.callFunc(function() {
                    e.showRankTxt.bind(e)()
                }), cc.delayTime(1), cc.callFunc(function() {})));
                c = createGameSkeletalAnimation(res.title_out_json, "frontstar", 24, !1, "pngdata/title_out");
                c.setPosition(350, 670);
                c.playCount = -1;
                b.addChild(c);
                e.texiaoMc = b
            },
            0.3)
        } else this.addRankUpInfo()
    },
    showRankTxt: function() {
        var a = getGradeByScore(gamePlayerData.maxScore);
        9 > a && (a = new cc.LabelTTF("Your ranking has risen,and you need " + (Global.gradeData[a].gradeValue - gamePlayerData.maxScore) + "\npoints to be promoted to " + Global.gradeData[a].gradeName + ".", defaultTxt, 26), a.enableStroke(cc.color(0, 0, 0, 255), 2), a.textAlign = cc.TEXT_ALIGNMENT_CENTER, a.setPosition(350, 300), this.addChild(a), this.scoreTxt = a);
        this.refreshText()
    },
    addRankUpInfo: function() {
        if (heroData.getNextTargetPerson() && heroData.getTargetBeiTai()) {
            var a = new UpRankLayer;
            a.endFun = this.flushTargetInfo.bind(this);
            currentScene.addChild(a)
        } else this.flushTargetInfo();
        this.refreshText()
    },
    flushTargetInfo: function() {
        if (0 != this.fightPersonInfoArr.length) if (1 == this.fightPersonInfoArr.length) heroData.setNextTargetPerson(this.fightPersonInfoArr[0]),
        heroData.setTargetBeiTai(this.fightPersonInfoArr[0]);
        else {
            for (var a = this.fightPersonInfoArr,
            b = a.length,
            c, d; b;) d = Math.floor(Math.random() * b--),
            c = a[b],
            a[b] = a[d],
            a[d] = c;
            this.fightPersonInfoArr = a;
            heroData.setNextTargetPerson(this.fightPersonInfoArr.shift());
            heroData.setTargetBeiTai(this.fightPersonInfoArr.shift())
        }
        saveUserData()
    },
    addShowAdvertisement: function() {
        if (!0 != heroData.isFailToGetAD) {
            var a = this;
            gameSDK.showRewardVideoAd(rewardedVideoID6,
            function() {
                heroData.showAdTimes += 1;
                saveUserData();
                "FaceBookTest" == sdkName && alert("\u8fd9\u91cc\u4e3b\u52a8\u5f39\u51fa\u5e7f\u544a\u4e86");
                a.addRankUpInfo()
            })
        }
    },
    refreshText: function() {
        this.mainUI.aw_fnttype3_scoreText.setString(Global.currentScore.toString())
    },
    getDiamond: function() {
        var a = Math.round(Global.currentScore / 1E3);
        this.mainUI.aw_fnttype4_moneyText.setString(a.toString());
        gamePlayerData.diamondValue += a;
        saveUserData()
    },
    refreshChooseBtnState: function() {
        1 != this.type ? (this.mainUI.btnLeft.setVisible(!1), this.mainUI.weekly_score.setSpriteFrame("result/total_score2.png"), this.mainUI.btnRight.setVisible(!0), this.mainUI.total_score.setSpriteFrame("result/weekly_score1.png")) : (this.mainUI.btnRight.setVisible(!1), this.mainUI.total_score.setSpriteFrame("result/weekly_score2.png"), this.mainUI.btnLeft.setVisible(!0), this.mainUI.weekly_score.setSpriteFrame("result/total_score1.png"))
    },
    clickInvitemorefriendbtn: function() {
        gameSDK.sendFaceBookFriend(function(a) {})
    },
    onClose: function() {
        this.unscheduleAllCallbacks();
        transitions(HomeScene)
    },
    onUp: function() {
        heroData.invitePlayerInfo = heroData.getNextTargetPerson();
        this.handleClick();
        this.removeFromParent();
        currentScene.layer.reLifeGame()
    },
    handleClick: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        engine.gameSound.playEffect(game_sound.res_sound_closeview);
        gamePlayerData.timePage = 1;
        gamePlayerData.timeOutScore = gamePlayerData.timeBaseScore = 0;
        resetPlayerData(!0)
    },
    onSelect: function(a, b) {
        if (null != a) {
            var c = b.getCurrentTarget();
            if (c.getTag() == this.type) return;
            this.type = c.getTag();
            this.refreshChooseBtnState()
        }
        c = null;
        1 == this.type && (c = gameSDK.getPlayerEntriesboardLeaderboardData(RANK_WORLD));
        2 == this.type && (c = gameSDK.getEntriesNearByData(RANK_WORLD));
        c && (this.createTableView(c), this.currentShowData = c)
    },
    refreshTableView: function() {
        for (var a = 1; 2 >= a; ++a) {
            var b = this["list" + a];
            if (null !== b || this.type === a) this.type === a ? null !== b && b.setVisible(!0) : (this["list" + a].setVisible(!1), this["list" + a].y = 0)
        }
    },
    createTableView: function(a) {
        this.listShowPanle && (this.listShowPanle.removeAllChildren(), this.listShowPanle.removeFromParent());
        this.listShowPanle = new cc.Layer;
        this.upClipping.addChild(this.listShowPanle);
        Math.random();
        for (var b = 0,
        c = 0; c < a.length; c++) if (! (5E5 <= a[c].score)) {
            var d = this.createItem(a[c], b);
            d.y = 570 - 110 * b;
            b++;
            this.listShowPanle.addChild(d)
        }
    },
    clickDownFun: function(a, b) {
        this.isClick = !0;
        this.touchY = a.getLocation().y;
        this.clickDownPoint = b.getCurrentTarget().convertToNodeSpace(a.getLocation())
    },
    clickMoveFun: function(a, b) {
        var c = a.getLocation(),
        d = this.touchY - c.y,
        e = b.getCurrentTarget().convertToNodeSpace(a.getLocation());
        5 <= cc.pDistance(this.clickDownPoint, e) && (this.isClick = !1);
        this.listShowPanle && (d = this.listShowPanle.y - d, this.touchY = c.y, this.moveSetX(d))
    },
    moveSetX: function(a) {
        0 > a && (a = 0);
        var b = this.currentShowData.length - 5;
        0 > b && (b = 0);
        a > 110 * b + 80 && (a = 110 * b + 80);
        this.listShowPanle.y = a
    },
    clickUpFun: function() {},
    nearbyRankNeedGet: !0,
    friendRankNeedGet: !0,
    checkGetRankData: function() {
        if (this.nearbyRankNeedGet) {
            var a = gameSDK.getEntriesNearByData(RANK_WORLD);
            a && (this.nearbyRankNeedGet = !1, this.rankDataInitialize(a, 2), cc.log("\u9644\u8fd1\u6392\u884c\u699c\u62c9\u5230\u4e86\u3002"))
        }
        this.friendRankNeedGet && (a = gameSDK.getPlayerEntriesboardLeaderboardData(RANK_WORLD)) && (this.friendRankNeedGet = !1, this.rankDataInitialize(a, 1), cc.log("\u597d\u53cb\u6392\u884c\u699c\u62c9\u5230\u4e86\u3002"))
    },
    rankDataInitialize: function(a, b) {
        switch (b) {
        case 1:
            this.nearbyRankData = a;
            break;
        case 2:
            this.friendRankData = a
        }
        if (2 == b) {
            for (var c = [], d = ~~ (1E3 + Global.currentScore + 500 * Math.random()), e = 0; e < a.length; e++) 5E5 <= a[e].score || a[e].id != gameSDK.sdkPlayInfo.id && c.push({
                name: a[e].name,
                score: d,
                photo: a[e].photo
            });
            this.fightPersonInfoArr = c
        }
        this.type == b && this.createTableView(a)
    },
    createItem: function(a, b) {
        var c = new cc.Node;
        if (1 == b % 2) {
            var d = new ccui.ImageView("other/scalesprite5.png", ccui.Widget.PLIST_TEXTURE);
            d.setScale9Enabled(!0);
            d.setContentSize(cc.size(666, 120));
            d.x = 360;
            d.y = 47;
            c.addChild(d)
        }
        c.name = new cc.LabelTTF(a.name, defaultTxt, 22);
        c.name.setAnchorPoint(0, 0.5);
        c.name.x = 195;
        c.name.y = 48;
        c.name.setHorizontalAlignment(cc.TEXT_ALIGNMENT_LEFT);
        c.name.setFontFillColor(cc.color(77, 77, 77, 255));
        c.addChild(c.name);
        c.score = new cc.LabelTTF("" + a.score, defaultTxt, 22);
        c.score.setColor(cc.color(0, 0, 0));
        c.score.x = 425;
        c.score.y = 48;
        d = 98 / c.score.getContentSize().width;
        c.score.setScale(1 <= d ? 1 : d);
        c.addChild(c.score);
        var d = new LoadSprite,
        e = a.photo;
        d.loadComplete = function(a) {
            a = new cc.Sprite(a);
            a.setScale(76 / a.getContentSize().width);
            this.addChild(a)
        };
        d.setPNGUrl(e, 76);
        var e = new cc.Sprite("#rank/black.png"),
        f = new cc.ClippingNode;
        f.stencil = e;
        f.setAlphaThreshold(0.05);
        f.addChild(d);
        f.x = 145;
        f.y = 47;
        c.addChild(f);
        c.icon = d;
        c.rank = new cc.LabelTTF("" + (b + 1), defaultTxt, 22);
        c.rank.setColor(cc.color(0, 0, 0));
        d = 74 / c.rank.getContentSize().width;
        c.rank.x = 60;
        c.rank.y = 48;
        c.rank.setScale(1 <= d ? 1 : d);
        c.addChild(c.rank);
        d = "";
        d = gameSDK.sdkPlayInfo.id === a.id || 2 == this.type ? "result/btnShare.png": "result/btnPlay.png";
        d = new ccui.Button(d, "", "", ccui.Widget.PLIST_TEXTURE);
        d.ignoreContentAdaptWithSize(!0);
        d.setSwallowTouches(!1);
        d.x = 562;
        d.y = 47;
        d.info = a;
        c.addChild(d);
        d.addClickEventListener(this.onPlay.bind(this, d));
        return c
    },
    onPlay: function(a) {
        a = a.info;
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        var b = a.id;
        cc.log("\u6311\u6218\u597d\u53cb\u529f\u80fd-----------------------------------------------------info.playerid" + b, this.type);
        if (gameSDK.sdkPlayInfo.id === b || 2 == this.type) a = function(a) {
            cc.log("\u5206\u4eab")
        },
        gameSDK.shareGame(a);
        else {
            cc.log("\u5206\u4eab\u6d41\u7a0b");
            heroData.setNextTargetPerson(a);
            saveUserData();
            var c = this,
            b = {};
            b.pngData = [{
                url: "res/loadimage.jpg",
                posX: 0,
                posY: 0,
                imgWidth: 750,
                imgHeight: 340
            },
            {
                url: gameSDK.sdkPlayInfo.photo,
                posX: 225,
                posY: 155,
                imgWidth: 110,
                imgHeight: 114
            },
            {
                url: "res/imageicon1.png",
                posX: 220,
                posY: 150,
                imgWidth: 120,
                imgHeight: 126
            }];
            b.fontData = [{
                des: "" + Global.currentScore,
                posX: 375,
                posY: 265,
                font: "55px Microsoft YaHei",
                lineWidth: 5,
                fillStyle: "rgb(255,255,255)",
                textAlign: "left",
                strokeStyle: "#120500"
            },
            {
                des: gameSDK.sdkPlayInfo.name,
                posX: 375,
                posY: 190,
                font: "38px Microsoft YaHei",
                lineWidth: 5,
                fillStyle: "rgb(255,255,255)",
                textAlign: "left",
                strokeStyle: "#120500"
            }];
            b.width = 750;
            b.height = 340;
            b.playerid = a.id;
            b.updateAsyncTemplate = "play_turn";
            b.updateAsyncText = "Your friends is challenging you";
            b.data = {};
            b.data.id = gameSDK.sdkPlayInfo.id;
            b.data.photo = gameSDK.sdkPlayInfo.photo;
            b.data.name = gameSDK.sdkPlayInfo.name;
            b.data.score = gamePlayerData.maxScore;
            gameSDK.appointFaceBookFriend(function() {
                c.handleClick();
                c.removeFromParent();
                currentScene.layer.reLifeGame()
            },
            b)
        }
    }
});
var RewardLayer = cc.Layer.extend({
    mainUI: null,
    ctor: function() {
        this._super()
    },
    onEnter: function() {
        this._super();
        this.initUI()
    },
    onExit: function() {
        this._super()
    },
    initUI: function() {
        this.mainUI = loadCSS(res.reward_layer);
        this.addChild(this.mainUI);
        showByFromDownToTop(this.mainUI);
        this.mainUI.btnWatch.aw_fnttype9_num.setString((3 - gamePlayerData.adRewards).toString());
        engine.gameEvent.createMouseUp(this.mainUI.btnClose, this.onClose.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainUI.btnWatch, this.onWatch.bind(this), buttonScalingType)
    },
    onClose: function() {
        var a = this;
        showByFromTopToDown(this.mainUI,
        function() {
            a.removeFromParent()
        })
    },
    onWatch: function() {
        http_recordPlayerAction(playerActionType.diamondAD, 1);
        cc.log("....\u70b9\u51fb\u770b\u5e7f\u544a.....");
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        var a = this,
        b = function() {
            a.onClose();
            gamePlayerData.diamondValue += 100;
            gamePlayerData.adRewards += 1;
            saveUserData();
            currentScene.layer.updateDemPush()
        };
        3 <= gamePlayerData.adRewards ? (cc.log("....\u770b\u5e7f\u544a\u6b21\u6570\u7528\u5b8c....."), a.onClose(), b = new ShowTipsWindow({
            txt: "Chances are used up, please come tomorrow.",
            isPause: !0
        }), currentScene.addChild(b, 9999999)) : (cc.log("....\u770b\u5e7f\u544a\u8fdb\u5165\u63a5\u53e3....."), a.onClose(), gameSDK.showRewardVideoAd(rewardedVideoID2, b, a))
    }
}),
showByFromDownToTop = function(a) {
    a.setPosition(cc.pAdd(a.getPosition(), cc.p(0, -cc.winSize.height >> 1)));
    a.runAction(cc.sequence(cc.moveBy(0.5, cc.p(0, cc.winSize.height >> 1)), cc.callFunc(function() {
        createMaskLayer(a.parent)
    })))
},
showByFromTopToDown = function(a, b) {
    a.runAction(cc.sequence(cc.moveBy(0.3, cc.p(0, -cc.winSize.height >> 1)), cc.callFunc(function() {
        b && b()
    })))
};
var ParachuteRewardLayer = cc.Layer.extend({
    parachute: null,
    mainUI: null,
    ctor: function(a) {
        this._super();
        this.parachute = a
    },
    onEnter: function() {
        this._super();
        this.initView()
    },
    initView: function() {
        var a = new cc.Sprite,
        b = new cc.Sprite("#watchad/popdiban.png");
        b.scale = 2;
        b.setPosition(360, 365);
        a.addChild(b);
        b = new cc.LabelTTF("SURPRISE", defaultTxt, 30);
        b.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER);
        b.setColor(cc.color(255, 255, 255));
        b.setPosition(357, 657);
        a.addChild(b);
        var b = this.parachute.reward,
        c = new cc.Sprite(b.url);
        a.addChild(c);
        c.x = 360;
        c.y = 572;
        var d = "",
        c = null,
        e = "";
        1 == b.type ? (d = "fnta", e = "" + b.num, c = cc.p(360, 490)) : (d = "fntb", e = "x" + b.num, c = cc.p(360, 500));
        b = creatGameArtWord(d);
        b.alignmentType = artWordMiddle;
        b.setString(e);
        b.setPosition(c);
        a.addChild(b);
        b = new cc.Sprite("#watchad/rewardlight.png");
        a.addChild(b);
        b.x = 360;
        b.y = 500;
        b = new cc.Sprite("#watchad/imgfreerelift.png");
        b.x = 360;
        b.y = 313;
        a.addChild(b);
        b = new cc.Sprite("#watchad/pop_anniu2.png");
        c = new cc.Sprite("#watchad/no.png");
        c.setPosition(156, 54);
        b.addChild(c);
        a.addChild(b);
        b.x = 363;
        b.y = 84;
        c = new cc.Sprite("#watchad/pop_anniu.png");
        e = new cc.Sprite("#watchad/pop-2.png");
        e.setPosition(285, 56);
        c.addChild(e);
        e = new cc.Sprite("#watchad/watch.png");
        e.setPosition(101, 53);
        c.addChild(e);
        a.addChild(c);
        c.x = 362;
        c.y = 206;
        this.addChild(a);
        showByFromDownToTop(a);
        this.mainUI = a;
        engine.gameEvent.createMouseUp(b, this.clickCloseBtn.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(c, this.clickWatchBtn.bind(this), buttonScalingType)
    },
    clickCloseBtn: function() {
        var a = this;
        showByFromTopToDown(a.mainUI,
        function() {
            engine.gameSound.playEffect(game_sound.res_sound_home_btn);
            engine.gameSound.playEffect(game_sound.res_sound_closeview);
            a.removeFromParent()
        })
    },
    clickWatchBtn: function() {
        Global.dataEyeOb.patachute++;
        var a = this;
        gameSDK.showRewardVideoAd(rewardedVideoID5,
        function() {
            heroData.isShowParachute = !0;
            heroData.clickParaGameIndex = heroData.localGameTimes;
            var b = a.parachute.reward;
            1 == b.type ? (gamePlayerData.currentPage += 1, gamePlayerData.currentScore = Global.targetScore, gamePlayerData.baseScore = Global.targetScore, Global.isCanClick = !1, currentScene.layer.reLifeGame()) : (2 == b.type ? gamePlayerData.brushNum += b.num: 3 == b.type ? gamePlayerData.hammerNum += b.num: gamePlayerData.loopNum += b.num, saveUserData());
            showByFromTopToDown(a.mainUI,
            function() {
                a.removeFromParent()
            })
        })
    }
});
var only_one_Broadcast = [],
BroadCastLayer = cc.Layer.extend({
    mainView: null,
    txtArr: null,
    moveDistance: 0,
    selfBoradCast: "",
    titleArr: "Infant Pupil Junior Undergraduate Postgraduate Doctor Professor Savant Sophist".split(" "),
    randomNameArr: "Max Julia;Nathan Anthony;Asa Webb;Phil Harrison;Diana Hoyle;Gloria Nelly;Rodney Warner;Eunice Peggy;Henry Katrine;Oscar Anderson;Glenn Cocker;Kerr Reade;Lindsay Gill,;Vito Hobbes;Andy Hugh;Elroy MacAdam;Ternence Emma;Ruth Harrington;Sam Carmen;Yvette Spenser;Joy Eve;Erin Christ;Omar Maxwell;Devin Theresa;Godfery Collins;Edwiin Becky;Christopher Pop;Aldrich White;June Margery;Dominic Larkin;Jason Carllyle;Armand Flower;Ian Hughes;Rex Burke;Crystal Peg;Quintina Petty;Myron Yule;Kay Noel;Linda Felix;Abel Smith;Irene Fast;Ruth Nell;Wade Kit;Ivy Grant;Tom Pope;Sibyl Rhodes;Noel Lawrence;Charles Edward;Kirk Finn;Ophelia Peter;Candice Wild;Bblythe Eveline;Mary Philemon;Grace Beerbohm;Brian Rayleign;Oscar Mark;Will Carroll;Cora Garcia;Truman Kennedy;Maurice Fanny;Booth Birrell;Eve DuBois;Edwina Theresa;Marsh Roland;Salome Malan;Ryan Ellis;Morgan Chris;Byron Tracy;Eric Bertie;Hazel Evan;Chad Ferguson;Dolores Adolph;Ira Bell;Basil Moses;Eartha Lawson;Lucien Harper;Ivan Bulwer;Gloria Jim;Anna Aldridge;Wilbur Dunlop;Yale Bob;Roberta Dewar;Jo Bruce;Simon Wallace;Abel Christy;Otis Copper;Elva Sheridan;Edison Horatio;Christian Coco;Betty Pater;Janet Beaufort;Norma Matthew;Payne Anto;Bertram Dewey;Vera Ingersoll;Vincent Holmes;Jamie Lucy;Aaron Ramsden;Buck Daisy;Howar Louisa;Yvonne Wallis;Nathan Oliver;Ada Clara;Caesar Henry;Cynthia Noyes;Nathaniel Leo;Griffith Marcus;Tabitha Pulit;Chad Hewlett;Patricia Yerkes;Jennifer Nahum;Alston Sophia;Brian Martin;Leif Hamilton;Mike Conrad;Coral Gus;Matthew Isaac;Broderick Joe;Harold Cover;Orville McCar;Lena Giles;Giles Anna;Sophia Joyce;Clare Carpenter;Tab Yeates;Jacqueline Cra;Alvin MacArthur;Alvis Garcia;Omar Salome;Maud Ferguson;Eudora Cotton;Lennon Dickens;Robin Toby;Zora Buck;Tony Camilla;Hedy Wordsworth;Lesley Morgan;Devin Maud;Isidore Palmer;Benson Scripps;Phil Webster;Hyman Pearson;Magee;Hilary Martha;Grace Noah;Arm Ernest;Wendell Abraham;Adair Acheson;Betsy Larkin;Marshall Walton;Rex Bertha;Nicole Harrod;Arm Elinor;Audrey Swin;Elvira Tommy;Roxanne Eveline;Newman Bess;Dominic Wood;Nat Anderson;Nelly James;Gabriel Grote;Joseph Darwin;Gloria Joan;Hubery Conan;Tyrone Marion;Sabina Dickey;Emma Ernest;Avery Raglan;Maxine Sharp;Sarah Felix;Alfred Isabel;Wright Gall;Evange Lucius;Burnell Gal;Zoe Kennedy;Gwend Oliver;Alexia Ted;Blanche Chaplin;Aries Bell;Dolores Lincoln;Ulysses Guy;Barnett Nick;Yale Julian;Wade Peter;Benjamin Donne;Miranda Douglas;Jim Marshall;Richard Van;Saxon Leopold;Ralap Milton;Dave Surrey;Emily Barney;Thomas Christ;Cliff Thoreau;Jenny Quiller;Marina Aldridge;Augus Abe;Quinn Irving;Alice Zacharias;Winifred Troll;There Euphemia;Mandy Spring;Ida Dewar;Geoffrey Parker;Zenobia Gunther;Raymond Carroll;Jill Wilde;Jacqueline Hugh;Edwiin Eisen;Lucien Henri;Ingrid Patience;Victor Wilhel;Marvin Jennings;Teresa Maria;Faithe Rob;Cherry Morrison;Sandy Wagner".split(";"),
    drawBg: null,
    ctor: function() {
        this._super();
        this.txtArr = [];
        this.mainView = null;
        this.moveDistance = cc.winSize.width / 5;
        var a = this;
        EventMgr.register(EVENTMGR_ID.addBoradCast,
        function(b) {
            a.selfBoradCast = "Congrats, " + b.name + "' upgrades to " + a.titleArr[b.title] + ", let's celebrate!"
        });
        this.scheduleUpdate()
    },
    onEnter: function() {
        this._super();
        var a = new cc.DrawNode;
        a.drawRect(cc.p(0, 1150), cc.p(cc.winSize.width, 1200), cc.color(0, 0, 0, 120), 0, cc.color(0, 0, 0, 120));
        this.addChild(a, -1);
        this.drawBg = a;
        this.scheduleUpdate();
        this.checkNeedAddTxt()
    },
    onExit: function() {
        this._super();
        EventMgr.remove(EVENTMGR_ID.addBoradCast)
    },
    checkNeedAddTxt: function() {
        var a = this;
        only_one_Broadcast.forEach(function(b) {
            a.txtArr.push(a.buildTxtByOb(b))
        })
    },
    buildTxtByOb: function(a) {
        var b = new cc.LabelTTF(a.txt, null, 30);
        b.enableStroke(cc.color(0, 0, 0, 255), 2);
        b.setAnchorPoint(0, 0.5);
        b.setPosition(a.x, 1175);
        this.addChild(b);
        return b
    },
    randomTime: 0,
    update: function(a) {
        if (0 == only_one_Broadcast.length) {
            if ("" != this.selfBoradCast) only_one_Broadcast.push({
                txt: this.selfBoradCast,
                x: cc.winSize.width
            }),
            this.selfBoradCast = "";
            else if (this.randomTime += a, this.randomTime > 30 + 90 * Math.random()) {
                this.randomTime = 0;
                var b = this.randomNameArr[~~ (this.randomNameArr.length * Math.random())],
                c = this.titleArr[~~ (Math.random() * this.titleArr.length)];
                only_one_Broadcast.push({
                    txt: "Congrats, " + b + "' upgrades to " + c + ", let's celebrate!",
                    x: cc.winSize.width
                })
            }
            this.checkNeedAddTxt()
        }
        var d = this,
        e = null;
        this.drawBg.visible = 0 != this.txtArr.length;
        this.txtArr.forEach(function(b) {
            b.x -= a * d.moveDistance; - 10 > b.x + b.width && (b.removeFromParent(), e = b);
            only_one_Broadcast.forEach(function(a) {
                a.txt == b.string && (a.x = b.x)
            })
        });
        null != e && (this.txtArr.shift(), only_one_Broadcast.shift())
    }
});
var TitleLayer = cc.Layer.extend({
    mainView: null,
    getArr: [0, 0, 0, 0, 0, 0, 0, 0, 0],
    ctor: function() {
        this._super();
        this.getArr = gamePlayerData.getTitleArr
    },
    onEnter: function() {
        this._super();
        this.initView()
    },
    initView: function() {
        this.mainView = loadCSS(res.title_layer, !1);
        this.addChild(this.mainView);
        engine.gameEvent.createMouseUp(this.mainView.close_btn, this.clickCloseBtn.bind(this), buttonScalingType);
        engine.gameEvent.createMouseUp(this.mainView.layer_mask, this.clickMask.bind(this));
        for (var a = getGradeByScore(gamePlayerData.maxScore), b = 0; 9 > b; b++) {
            var c = this.mainView.titles["title" + (b + 1)];
            c.score_txt.setString(8 == b ? Global.gradeData[b].gradeValue + "+": Global.gradeData[b].gradeValue + "-" + Global.gradeData[b + 1].gradeValue);
            b >= a ? (this.setSpriteGray(c.title1_2), this.setSpriteGray(c.help_btn)) : engine.gameEvent.createMouseUp(c.help_btn, this.titleBtnClick.bind(this), buttonScalingType)
        }
        this.flushBtnStatus()
    },
    flushBtnStatus: function() {
        for (var a = 0; a < this.getArr.length; a++) this.mainView.titles["title" + (a + 1)].get_already.visible = "1" == this.getArr[a],
        "1" == this.getArr[a] && (this.mainView.titles["title" + (a + 1)].help_btn.x += 1E3)
    },
    titleBtnClick: function(a, b) {
        var c = b._currentTarget.parent._name.slice( - 1);
        this.getArr[c - 1] = 1;
        gamePlayerData.getTitleArr = this.getArr;
        this.flushBtnStatus();
        EventMgr.emit(EVENTMGR_ID.addBoradCast, {
            name: gameSDK.sdkPlayInfo.name,
            title: c - 1
        });
        saveUserData()
    },
    clickCloseBtn: function() {
        engine.gameSound.playEffect(game_sound.res_sound_home_btn);
        engine.gameSound.playEffect(game_sound.res_sound_closeview);
        currentScene.layer.beginGameUpdate();
        currentScene.layer.checkRankAndAchieve();
        this.removeFromParent()
    },
    clickMask: function() {
        engine.gameSound.playEffect(game_sound.res_sound_onland)
    },
    setSpriteGray: function(a) {
        cc._renderType === cc.game.RENDER_TYPE_WEBGL ? a.shaderProgram = cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR_GRAY) : 0.5 < a.scale && (a.x += 1E3)
    },
    recoverySprite: function(a) {
        a.shaderProgram = cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR)
    }
});
var debugtest = {};
"FaceBookTest" == sdkName && (debugtest = {
    very_brush: 1,
    selfMuchScore: 1,
    forceMustShowTarget: 0,
    testNewPlayer: 0,
    very_diamond: 1,
    brushTestUpRank: 0,
    pauseBtnTest_fail: 1,
    exchange_jiangluosan: 0,
    lock_jiangluosan_skiplevel: 0,
    shengjie_donghua_show: 0,
    showRobotWithR: 0,
    lockLevel: 0
});
cc.game.onStart = function() {
    console.log("gameServerVersion", gameServerVersion);
    cc.view.enableRetina(!0);
    cc.view.adjustViewPort(!0); ! 1 == cc.sys.isMobile ? cc.view.setDesignResolutionSize(gameWidth, gameHigh, cc.ResolutionPolicy.SHOW_ALL) : cc.view.setDesignResolutionSize(gameWidth, gameHigh, cc.ResolutionPolicy.EXACT_FIT);
    cc.view.resizeWithBrowserSize(!0);
    initEngine();
    initGameSDK();
    gameSDK.runSDK(getFBID)
};
function getFBID() {
    initHeroData();
    initPlayerData(null);
    "FaceBookTest" == sdkName && (faceBookDataKey += gameSDK.getPlayerInfo().id);
    cc.log("\u5f00\u59cb\u83b7\u53d6FB\u5b58\u50a8\u4fe1\u606f");
    gameSDK.getUserData([fbSaveDataKey],
    function(a) {
        null != a ? (cc.warn("\u8001\u53f7"), initPlayerData(a[fbSaveDataKey]), transitionToHomeScene()) : (gameSDK.logEvent("sendSeverUserData", 1, {
            sendSeverUserData: "sendSeverUserData"
        }), getPlayerInfo(function(a) {
            1 == a ? (cc.warn("\u65b0\u53f7"), gameSDK.logEvent("getSeverUserDataForNew", 1, {
                getSeverUserDataForNew: "getSeverUserDataForNew"
            })) : (cc.warn("\u4f20\u627f\u670d\u52a1\u5668"), gameSDK.logEvent("getSeverUserData", 1, {
                getSeverUserData: "getSeverUserData"
            }), initPlayerData(a));
            saveUserData();
            transitionToHomeScene()
        }))
    })
}
function transitionToHomeScene() {
    transitions(null, g_resources, gameSDK.getFirstLoadScene(),
    function() {
        transitions(HomeScene, g_resources, LoadScene,
        function() {
            cc.spriteFrameCache.addSpriteFrames(res.imgfnt_plist);
            cc.spriteFrameCache.addSpriteFrames(res.imgpngplist0_plist);
            cc.spriteFrameCache.addSpriteFrames(res.imgpngplist1_plist);
            cc.spriteFrameCache.addSpriteFrames(res.imgpngplist2_plist);
            cc.spriteFrameCache.addSpriteFrames(res.imgpngplist3_plist);
            cc.spriteFrameCache.addSpriteFrames(res.imgpngplist4_plist);
            cc.spriteFrameCache.addSpriteFrames(res.imgpngplist5_plist);
            cc.spriteFrameCache.addSpriteFrames(res.imgpngplist6_plist);
            cc.spriteFrameCache.addSpriteFrames(res.imgpngplist7_plist);
            cc.spriteFrameCache.addSpriteFrames(res.scaleimglist_plist);
            cc.spriteFrameCache.addSpriteFrames(res.img1_plist);
            cc.spriteFrameCache.addSpriteFrames(res.img2_plist);
            multipleAnimation(res.title_out_json, res.title_out_json);
            initGameConfigData()
        })
    })
}
cc.game.run();